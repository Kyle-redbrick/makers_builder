{"ast":null,"code":"import _toConsumableArray from \"/Users/jimmy/Documents/Wizschool/astroboy/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _objectSpread from \"/Users/jimmy/Documents/Wizschool/astroboy/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nimport _slicedToArray from \"/Users/jimmy/Documents/Wizschool/astroboy/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"/Users/jimmy/Documents/Wizschool/astroboy/src/Page/Builder3D/Component/SoundBox/Container.js\";\nimport React, { useState, useEffect, useRef } from \"react\";\nimport { connect } from \"react-redux\";\nimport AssetLibrary from \"../../../Builder/utils/assetLibrary\";\nimport * as interactionActions from \"../../Store/Reducer/interaction\";\nimport * as gameActions from \"../../Store/Reducer/game\";\nimport * as builderActions from \"../../Store/Reducer/builder\";\nimport RndWrapper from \"../RndProvider/RndWrapper\";\nimport View from \"./View\";\n\nfunction Container(props) {\n  var _useState = useState(\"bgm\"),\n      _useState2 = _slicedToArray(_useState, 2),\n      currentCategory = _useState2[0],\n      setCurrentCategory = _useState2[1];\n\n  var _useState3 = useState(\"bgm\"),\n      _useState4 = _slicedToArray(_useState3, 2),\n      currentSubCategory = _useState4[0],\n      setCurrentSubCategory = _useState4[1];\n\n  var _useState5 = useState([]),\n      _useState6 = _slicedToArray(_useState5, 2),\n      assets = _useState6[0],\n      setAssets = _useState6[1];\n\n  var _useState7 = useState(undefined),\n      _useState8 = _slicedToArray(_useState7, 2),\n      selectedAssetId = _useState8[0],\n      setSelectedAssetId = _useState8[1];\n\n  var _useState9 = useState([]),\n      _useState10 = _slicedToArray(_useState9, 2),\n      categories = _useState10[0],\n      setCategories = _useState10[1];\n\n  var container = useRef();\n  useEffect(function () {\n    AssetLibrary.loadAllSounds(function () {\n      var categories = AssetLibrary.categories.filter(function (c) {\n        return c.name === \"sfx\" || c.name === \"bgm\";\n      });\n      setCategories(categories.map(function (category) {\n        return _objectSpread({}, category, {\n          subCategories: [{\n            name: category.name,\n            localeName: JSON.stringify({\n              ko: \"전체\",\n              zh: \"All\",\n              default: \"All\"\n            })\n          }].concat(_toConsumableArray(category.subCategories))\n        });\n      }));\n    });\n  }, []);\n  useEffect(function () {\n    if (!props.isSoundBoxOn) {\n      props.stopSound();\n    }\n  }, [props.isSoundBoxOn]);\n  useEffect(function () {\n    loadAssets(currentSubCategory);\n  }, [currentSubCategory]);\n  useEffect(function () {\n    if (selectedAssetId === undefined && isPlaying()) {\n      props.stopSound();\n    }\n  }, [selectedAssetId]);\n\n  var isPlaying = function isPlaying() {\n    return props.jukebox.isPlaying;\n  };\n\n  var onClickClose = function onClickClose() {\n    props.setIsSoundBoxOn(false);\n  };\n\n  var setCurrentCategories = function setCurrentCategories(category, subCategory) {\n    if (!subCategory) subCategory = category;\n\n    if (currentSubCategory !== subCategory) {\n      setAssets([]);\n      setCurrentCategory(category);\n      setCurrentSubCategory(subCategory);\n    }\n  };\n\n  var loadAssets = function loadAssets(subCategory, callback) {\n    if (subCategory) {\n      AssetLibrary.loadAssetsByCategory(subCategory, function (assets) {\n        if (callback) {\n          callback();\n        } else {\n          setAssets(assets);\n        }\n      });\n    }\n  };\n\n  var handleSelectAsset = function handleSelectAsset(assetId) {\n    if (assetId !== selectedAssetId) {\n      setSelectedAssetId(assetId);\n      var item = AssetLibrary.getSoundAsset(assetId);\n      props.playSound(item.id, item.path, item.type);\n    } else {\n      setSelectedAssetId(undefined);\n    }\n  };\n\n  var handleAddAsset = function handleAddAsset(asset) {\n    var currentScene = props.currentScene,\n        soundIds = props.soundIds,\n        addSound = props.addSound;\n\n    if (soundIds.find(function (id) {\n      return id === asset.assetId;\n    })) {\n      return;\n    }\n\n    var assetId = asset.assetId,\n        type = asset.type,\n        subtype = asset.subtype;\n    var soundInfo = getSoundInfo({\n      assetId: assetId,\n      type: type,\n      subtype: subtype\n    });\n    addSound(currentScene.id, soundInfo);\n  };\n\n  var handleRemoveAsset = function handleRemoveAsset(assetId) {\n    props.removeSound(props.currentScene.id, assetId);\n  };\n\n  var getSoundInfo = function getSoundInfo(item) {\n    var asset = AssetLibrary.getSoundAsset(item.assetId);\n    var type = asset.type;\n    var subtype = asset.subtype;\n    var assetId = item.assetId;\n    var name = asset.defaultName;\n    return {\n      name: name,\n      assetId: assetId,\n      type: type,\n      subtype: subtype\n    };\n  };\n\n  var getRndWrapperConfig = function getRndWrapperConfig() {\n    var soundsList = document.getElementById(\"soundsList\");\n    var defaultWidth = 420;\n    var defaultHeight = 420;\n    var defaultX = soundsList ? soundsList.clientWidth + 12 : 36;\n    var defaultY = soundsList ? soundsList.getBoundingClientRect().top : 36;\n    var minWidth = 300;\n    var minHeight = 300;\n    var maxWidth = 600;\n    var maxHeight = 600;\n    return {\n      defaultX: defaultX,\n      defaultY: defaultY,\n      defaultWidth: defaultWidth,\n      defaultHeight: defaultHeight,\n      minWidth: minWidth,\n      minHeight: minHeight,\n      maxWidth: maxWidth,\n      maxHeight: maxHeight\n    };\n  };\n\n  return !props.isSoundBoxOn ? React.createElement(React.Fragment, null) : React.createElement(RndWrapper, Object.assign({\n    rndId: props.rndId,\n    rndOrder: props.rndOrder,\n    bringRndToTop: props.bringRndToTop\n  }, getRndWrapperConfig(), {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 147\n    },\n    __self: this\n  }), React.createElement(View, {\n    containerRef: container,\n    categories: categories,\n    soundIds: props.soundIds,\n    currentCategory: currentCategory,\n    currentSubCategory: currentSubCategory,\n    assets: assets,\n    selectedAssetId: selectedAssetId,\n    assetLibrary: AssetLibrary,\n    setCurrentCategories: setCurrentCategories,\n    handleSelectAsset: handleSelectAsset,\n    handleAddAsset: handleAddAsset,\n    handleRemoveAsset: handleRemoveAsset,\n    jukebox: props.jukebox,\n    onClickClose: onClickClose,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 153\n    },\n    __self: this\n  }));\n}\n\nexport default connect(function (state) {\n  var isSoundBoxOn = state.builder.isSoundBoxOn;\n  var scenes = state.game.scenes;\n  var _state$interaction = state.interaction,\n      jukebox = _state$interaction.jukebox,\n      currentSceneId = _state$interaction.currentSceneId;\n  var currentScene = currentSceneId ? scenes[currentSceneId] : null;\n  var soundIds = currentScene ? currentScene.soundIds : [];\n  soundIds = soundIds ? soundIds : [];\n  return {\n    isSoundBoxOn: isSoundBoxOn,\n    jukebox: jukebox,\n    soundIds: soundIds,\n    currentScene: currentScene\n  };\n}, {\n  playSound: interactionActions.playSound,\n  stopSound: interactionActions.stopSound,\n  removeSound: gameActions.removeSound,\n  addSound: gameActions.addSound,\n  setIsSoundBoxOn: builderActions.setIsSoundBoxOn\n})(Container);","map":{"version":3,"sources":["/Users/jimmy/Documents/Wizschool/astroboy/src/Page/Builder3D/Component/SoundBox/Container.js"],"names":["React","useState","useEffect","useRef","connect","AssetLibrary","interactionActions","gameActions","builderActions","RndWrapper","View","Container","props","currentCategory","setCurrentCategory","currentSubCategory","setCurrentSubCategory","assets","setAssets","undefined","selectedAssetId","setSelectedAssetId","categories","setCategories","container","loadAllSounds","filter","c","name","map","category","subCategories","localeName","JSON","stringify","ko","zh","default","isSoundBoxOn","stopSound","loadAssets","isPlaying","jukebox","onClickClose","setIsSoundBoxOn","setCurrentCategories","subCategory","callback","loadAssetsByCategory","handleSelectAsset","assetId","item","getSoundAsset","playSound","id","path","type","handleAddAsset","asset","currentScene","soundIds","addSound","find","subtype","soundInfo","getSoundInfo","handleRemoveAsset","removeSound","defaultName","getRndWrapperConfig","soundsList","document","getElementById","defaultWidth","defaultHeight","defaultX","clientWidth","defaultY","getBoundingClientRect","top","minWidth","minHeight","maxWidth","maxHeight","rndId","rndOrder","bringRndToTop","state","builder","scenes","game","interaction","currentSceneId"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useRef } from \"react\";\nimport { connect } from \"react-redux\";\nimport AssetLibrary from \"../../../Builder/utils/assetLibrary\";\nimport * as interactionActions from \"../../Store/Reducer/interaction\";\nimport * as gameActions from \"../../Store/Reducer/game\";\nimport * as builderActions from \"../../Store/Reducer/builder\";\nimport RndWrapper from \"../RndProvider/RndWrapper\";\nimport View from \"./View\";\n\nfunction Container(props) {\n  const [currentCategory, setCurrentCategory] = useState(\"bgm\");\n  const [currentSubCategory, setCurrentSubCategory] = useState(\"bgm\");\n  const [assets, setAssets] = useState([]);\n  const [selectedAssetId, setSelectedAssetId] = useState(undefined);\n  const [categories, setCategories] = useState([]);\n  const container = useRef();\n\n  useEffect(() => {\n    AssetLibrary.loadAllSounds(() => {\n      let categories = AssetLibrary.categories.filter(\n        c => c.name === \"sfx\" || c.name === \"bgm\"\n      );\n      setCategories(\n        categories.map(category => {\n          return {\n            ...category,\n            subCategories: [\n              {\n                name: category.name,\n                localeName: JSON.stringify({\n                  ko: \"전체\",\n                  zh: \"All\",\n                  default: \"All\"\n                })\n              },\n              ...category.subCategories\n            ]\n          };\n        })\n      );\n    });\n  }, []);\n\n  useEffect(() => {\n    if (!props.isSoundBoxOn) {\n      props.stopSound();\n    }\n  }, [props.isSoundBoxOn]);\n\n  useEffect(() => {\n    loadAssets(currentSubCategory);\n  }, [currentSubCategory]);\n\n  useEffect(() => {\n    if (selectedAssetId === undefined && isPlaying()) {\n      props.stopSound();\n    }\n  }, [selectedAssetId]);\n\n  const isPlaying = () => {\n    return props.jukebox.isPlaying;\n  };\n\n  const onClickClose = () => {\n    props.setIsSoundBoxOn(false);\n  };\n\n  const setCurrentCategories = (category, subCategory) => {\n    if (!subCategory) subCategory = category;\n    if (currentSubCategory !== subCategory) {\n      setAssets([]);\n      setCurrentCategory(category);\n      setCurrentSubCategory(subCategory);\n    }\n  };\n\n  const loadAssets = (subCategory, callback) => {\n    if (subCategory) {\n      AssetLibrary.loadAssetsByCategory(subCategory, assets => {\n        if (callback) {\n          callback();\n        } else {\n          setAssets(assets);\n        }\n      });\n    }\n  };\n\n  const handleSelectAsset = assetId => {\n    if (assetId !== selectedAssetId) {\n      setSelectedAssetId(assetId);\n      const item = AssetLibrary.getSoundAsset(assetId);\n      props.playSound(item.id, item.path, item.type);\n    } else {\n      setSelectedAssetId(undefined);\n    }\n  };\n\n  const handleAddAsset = asset => {\n    const { currentScene, soundIds, addSound } = props;\n    if (soundIds.find(id => id === asset.assetId)) {\n      return;\n    }\n    const { assetId, type, subtype } = asset;\n    let soundInfo = getSoundInfo({ assetId, type, subtype });\n    addSound(currentScene.id, soundInfo);\n  };\n\n  const handleRemoveAsset = assetId => {\n    props.removeSound(props.currentScene.id, assetId);\n  };\n\n  const getSoundInfo = item => {\n    const asset = AssetLibrary.getSoundAsset(item.assetId);\n    const type = asset.type;\n    const subtype = asset.subtype;\n    const assetId = item.assetId;\n    const name = asset.defaultName;\n    return { name, assetId, type, subtype };\n  };\n\n  const getRndWrapperConfig = () => {\n    const soundsList = document.getElementById(\"soundsList\");\n    const defaultWidth = 420;\n    const defaultHeight = 420;\n    const defaultX = soundsList ? soundsList.clientWidth + 12 : 36;\n    const defaultY = soundsList ? soundsList.getBoundingClientRect().top : 36;\n    const minWidth = 300;\n    const minHeight = 300;\n    const maxWidth = 600;\n    const maxHeight = 600;\n    return {\n      defaultX,\n      defaultY,\n      defaultWidth,\n      defaultHeight,\n      minWidth,\n      minHeight,\n      maxWidth,\n      maxHeight\n    };\n  };\n\n  return !props.isSoundBoxOn ? (\n    <></>\n  ) : (\n    <RndWrapper\n      rndId={props.rndId}\n      rndOrder={props.rndOrder}\n      bringRndToTop={props.bringRndToTop}\n      {...getRndWrapperConfig()}\n    >\n      <View\n        containerRef={container}\n        categories={categories}\n        soundIds={props.soundIds}\n        currentCategory={currentCategory}\n        currentSubCategory={currentSubCategory}\n        assets={assets}\n        selectedAssetId={selectedAssetId}\n        assetLibrary={AssetLibrary}\n        setCurrentCategories={setCurrentCategories}\n        handleSelectAsset={handleSelectAsset}\n        handleAddAsset={handleAddAsset}\n        handleRemoveAsset={handleRemoveAsset}\n        jukebox={props.jukebox}\n        onClickClose={onClickClose}\n      />\n    </RndWrapper>\n  );\n}\n\nexport default connect(\n  state => {\n    const { isSoundBoxOn } = state.builder;\n    const { scenes } = state.game;\n    const { jukebox, currentSceneId } = state.interaction;\n    const currentScene = currentSceneId ? scenes[currentSceneId] : null;\n    let soundIds = currentScene ? currentScene.soundIds : [];\n    soundIds = soundIds ? soundIds : [];\n    return { isSoundBoxOn, jukebox, soundIds, currentScene };\n  },\n  {\n    playSound: interactionActions.playSound,\n    stopSound: interactionActions.stopSound,\n    removeSound: gameActions.removeSound,\n    addSound: gameActions.addSound,\n    setIsSoundBoxOn: builderActions.setIsSoundBoxOn\n  }\n)(Container);\n"]},"metadata":{},"sourceType":"module"}