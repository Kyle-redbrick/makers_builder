{"ast":null,"code":"import _regeneratorRuntime from \"/Users/jimmy/Documents/Wizschool/wizlab_web2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/jimmy/Documents/Wizschool/wizlab_web2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"/Users/jimmy/Documents/Wizschool/wizlab_web2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/jimmy/Documents/Wizschool/wizlab_web2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/jimmy/Documents/Wizschool/wizlab_web2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/jimmy/Documents/Wizschool/wizlab_web2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/jimmy/Documents/Wizschool/wizlab_web2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/Users/jimmy/Documents/Wizschool/wizlab_web2/src/Page/Mypage/Components/Subscribe/Container.js\";\nimport React, { Component } from \"react\";\nimport * as request from \"../../../../Common/Util/HTTPRequest\";\nimport { connect } from \"react-redux\";\nimport { withRouter } from \"react-router-dom\";\nimport { injectIntl } from \"react-intl\";\nimport { withSubscribe } from \"../../../../Common/Util/Subscribe\";\nimport View from \"./View\";\n\nvar Container =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(Container, _Component);\n\n  function Container(props) {\n    var _this;\n\n    _classCallCheck(this, Container);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(Container).call(this, props));\n\n    _this.componentDidMount = function () {\n      _this.getData();\n    };\n\n    _this.getData =\n    /*#__PURE__*/\n    _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee() {\n      var _this$props, targetEmail, mode;\n\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _this$props = _this.props, targetEmail = _this$props.targetEmail, mode = _this$props.mode;\n              _context.next = 3;\n              return request.getSubscribesByType({\n                email: targetEmail,\n                type: mode\n              }).then(function (res) {\n                return res.json();\n              }).then(function (json) {\n                var users = json.map(function (user) {\n                  return user.creator ? user.creator : user.user;\n                });\n\n                _this.setState({\n                  users: users\n                });\n              }).catch(function (e) {\n                return console.error(e);\n              });\n\n            case 3:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, this);\n    }));\n\n    _this.handleSubscribe = function (targetEmail, isSubscribe) {\n      if (isSubscribe) {\n        _this.props.unsubscribe(targetEmail, function () {\n          return _this.updateSubscribeCount(targetEmail, -1);\n        });\n      } else {\n        _this.props.subscribe(targetEmail, function () {\n          return _this.updateSubscribeCount(targetEmail, 1);\n        });\n      }\n    };\n\n    _this.updateSubscribeCount = function (targetEmail, count) {\n      _this.setState({\n        users: _this.state.users.map(function (user) {\n          if (targetEmail === user.email) {\n            user.subscribeCount += count;\n          }\n\n          return user;\n        })\n      });\n    };\n\n    _this.state = {\n      users: []\n    };\n    return _this;\n  }\n\n  _createClass(Container, [{\n    key: \"render\",\n    value: function render() {\n      var users = this.state.users;\n      var _this$props2 = this.props,\n          intl = _this$props2.intl,\n          mode = _this$props2.mode,\n          subscribeInfo = _this$props2.subscribeInfo;\n      var handleSubscribe = this.handleSubscribe;\n      return React.createElement(View, {\n        intl: intl,\n        mode: mode,\n        users: users,\n        handleSubscribe: handleSubscribe,\n        subscribeInfo: subscribeInfo,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 60\n        },\n        __self: this\n      });\n    }\n  }]);\n\n  return Container;\n}(Component);\n\nexport default connect(function (state) {\n  return {\n    userinfo: state.userinfo\n  };\n}, {})(injectIntl(withRouter(withSubscribe(Container))));","map":{"version":3,"sources":["/Users/jimmy/Documents/Wizschool/wizlab_web2/src/Page/Mypage/Components/Subscribe/Container.js"],"names":["React","Component","request","connect","withRouter","injectIntl","withSubscribe","View","Container","props","componentDidMount","getData","targetEmail","mode","getSubscribesByType","email","type","then","res","json","users","map","user","creator","setState","catch","e","console","error","handleSubscribe","isSubscribe","unsubscribe","updateSubscribeCount","subscribe","count","state","subscribeCount","intl","subscribeInfo","userinfo"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport * as request from \"../../../../Common/Util/HTTPRequest\";\nimport { connect } from \"react-redux\";\nimport { withRouter } from \"react-router-dom\";\nimport { injectIntl } from \"react-intl\";\nimport { withSubscribe } from \"../../../../Common/Util/Subscribe\";\nimport View from \"./View\";\n\nclass Container extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      users: []\n    };\n  }\n\n  componentDidMount = () => {\n    this.getData();\n  };\n\n  getData = async () => {\n    const { targetEmail, mode } = this.props;\n    await request\n      .getSubscribesByType({ email: targetEmail, type: mode })\n      .then(res => res.json())\n      .then(json => {\n        const users = json.map(user=>{\n          return user.creator ? user.creator : user.user;\n        })\n        this.setState({ users });\n      })\n      .catch(e => console.error(e));\n  }\n\n  handleSubscribe = (targetEmail, isSubscribe) => {\n    if (isSubscribe) {\n      this.props.unsubscribe(targetEmail, () => this.updateSubscribeCount(targetEmail, -1));\n    } else {\n      this.props.subscribe(targetEmail, () => this.updateSubscribeCount(targetEmail, 1));\n    }\n  };\n\n  updateSubscribeCount = (targetEmail, count) => {\n    this.setState({\n      users: this.state.users.map(user=>{\n        if(targetEmail === user.email) {\n          user.subscribeCount += count;\n        }\n        return user;\n      })\n    })\n  }\n\n  render() {\n    const { users } = this.state;\n    const { intl, mode, subscribeInfo } = this.props;\n    const { handleSubscribe } = this;\n\n    return (\n      <View\n        intl={intl}\n        mode={mode}\n        users={users}\n        handleSubscribe={handleSubscribe}\n        subscribeInfo={subscribeInfo}\n      />\n    );\n  }\n}\n\nexport default connect(\n  state => ({ userinfo: state.userinfo }),\n  {}\n)(injectIntl(withRouter(withSubscribe(Container))));\n"]},"metadata":{},"sourceType":"module"}