{"ast":null,"code":"import _objectSpread from \"/Users/jimmy/Documents/Wizschool/wizlab_web2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nimport _defineProperty from \"/Users/jimmy/Documents/Wizschool/wizlab_web2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _regeneratorRuntime from \"/Users/jimmy/Documents/Wizschool/wizlab_web2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _setPrototypeOf from \"/Users/jimmy/Documents/Wizschool/wizlab_web2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/setPrototypeOf\";\nimport _asyncToGenerator from \"/Users/jimmy/Documents/Wizschool/wizlab_web2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"/Users/jimmy/Documents/Wizschool/wizlab_web2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/jimmy/Documents/Wizschool/wizlab_web2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _inherits from \"/Users/jimmy/Documents/Wizschool/wizlab_web2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _possibleConstructorReturn from \"/Users/jimmy/Documents/Wizschool/wizlab_web2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/jimmy/Documents/Wizschool/wizlab_web2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nvar _jsxFileName = \"/Users/jimmy/Documents/Wizschool/wizlab_web2/src/Page/Builder/Container.js\";\n\nfunction _wrapRegExp() { _wrapRegExp = function _wrapRegExp(re, groups) { return new BabelRegExp(re, void 0, groups); }; var _super = RegExp.prototype, _groups = new WeakMap(); function BabelRegExp(re, flags, groups) { var _this = new RegExp(re, flags); return _groups.set(_this, groups || _groups.get(re)), _setPrototypeOf(_this, BabelRegExp.prototype); } function buildGroups(result, re) { var g = _groups.get(re); return Object.keys(g).reduce(function (groups, name) { return groups[name] = result[g[name]], groups; }, Object.create(null)); } return _inherits(BabelRegExp, RegExp), BabelRegExp.prototype.exec = function (str) { var result = _super.exec.call(this, str); return result && (result.groups = buildGroups(result, this)), result; }, BabelRegExp.prototype[Symbol.replace] = function (str, substitution) { if (\"string\" == typeof substitution) { var groups = _groups.get(this); return _super[Symbol.replace].call(this, str, substitution.replace(/\\$<([^>]+)>/g, function (_, name) { return \"$\" + groups[name]; })); } if (\"function\" == typeof substitution) { var _this = this; return _super[Symbol.replace].call(this, str, function () { var args = arguments; return \"object\" != typeof args[args.length - 1] && (args = [].slice.call(args)).push(buildGroups(args, _this)), substitution.apply(this, args); }); } return _super[Symbol.replace].call(this, str, substitution); }, _wrapRegExp.apply(this, arguments); }\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\n\nimport React, { Component } from \"react\";\nimport { connect } from \"react-redux\";\nimport { injectIntl } from \"react-intl\";\nimport { DndProvider } from \"react-dnd\";\nimport { HTML5Backend } from \"react-dnd-html5-backend\";\nimport \"react-toastify/dist/ReactToastify.css\";\nimport * as projectActions from \"./Store/Reducer/project\";\nimport * as previewActions from \"./Store/Reducer/preview\";\nimport * as webrtcActions from \"./Store/Reducer/webrtc\";\nimport * as videoActions from \"./Store/Reducer/video\";\nimport * as request from \"../../Common/Util/HTTPRequest\";\nimport AssetLibrary from \"./utils/assetLibrary\";\nimport { PAGETYPE, DEFAULT_VIDEO_URL } from \"../../Common/Util/Constant\";\nimport { detectIE } from \"../../Common/Util/detectBrowser\";\nimport View from \"./View\";\nimport Popup, { showPopUp } from \"../../Common/Component/PopUp\";\nimport * as TrackingUtil from \"../../Common/Util/TrackingUtil\";\n\nvar Container = /*#__PURE__*/function (_Component) {\n  _inherits(Container, _Component);\n\n  var _super = _createSuper(Container);\n\n  function Container(props) {\n    var _this;\n\n    _classCallCheck(this, Container);\n\n    _this = _super.call(this, props);\n    _this.componentDidMount = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      var email, _this$state, pageType, params, pId, step, grade, reservationId, type, regexRoomId, _regexRoomId$exec, roomId, wizLiveRoom, wizLive1v4Room, stage, ocpClass, ocp2Template, reservation;\n\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.prev = 0;\n\n              if (!_this.isIE) {\n                _context.next = 4;\n                break;\n              }\n\n              _this.props.history.replace(\"/\" + PAGETYPE.BUILDER);\n\n              return _context.abrupt(\"return\");\n\n            case 4:\n              email = _this.props.email;\n              _this$state = _this.state, pageType = _this$state.pageType, params = _this$state.params;\n              pId = params.pId, step = params.step, grade = params.grade, reservationId = params.reservationId, type = params.type;\n\n              if (pageType === PAGETYPE.WIZLIVE_1V4) {\n                regexRoomId = /*#__PURE__*/_wrapRegExp(/([0-9A-Z_a-z]+)\\x2D([0-9A-Z_a-z]+)\\x2D([0-9A-Z_a-z]+)\\x2D([0-9A-Z_a-z]+)\\x2D([0-9A-Z_a-z]+)\\x2D([0-9A-Z_a-z]+)/, {\n                  roomId: 6\n                });\n                _regexRoomId$exec = regexRoomId.exec(pId), roomId = _regexRoomId$exec.groups.roomId;\n                _this.roomId = roomId;\n              } // this.timer = setInterval(() => {\n              //   request.updateBuilderUsageTime({\n              //     email: this.props.email,\n              //     time: new Date().getTime()\n              //   });\n              // }, 1000);\n              // TrackingUtil.sendPageEvent(\"/\" + pageType, this.props.email);\n\n\n              _context.t0 = pageType;\n              _context.next = _context.t0 === PAGETYPE.WIZLIVE ? 11 : _context.t0 === PAGETYPE.MONITOR_1V4 ? 16 : _context.t0 === PAGETYPE.WIZLIVE_1V4 ? 16 : _context.t0 === PAGETYPE.BUILDER ? 28 : _context.t0 === PAGETYPE.BUILDER_EDIT ? 30 : _context.t0 === PAGETYPE.BUILDER_READONLY ? 32 : _context.t0 === PAGETYPE.QNA_READONLY ? 35 : _context.t0 === PAGETYPE.VIDEOCLASS ? 38 : _context.t0 === PAGETYPE.OCP ? 40 : _context.t0 === PAGETYPE.OCP2 ? 45 : _context.t0 === PAGETYPE.TUTORIAL ? 47 : _context.t0 === PAGETYPE.RECORD_PLAYER ? 53 : _context.t0 === PAGETYPE.MONITOR ? 58 : _context.t0 === PAGETYPE.DREAMCLASS ? 60 : 62;\n              break;\n\n            case 11:\n              _context.next = 13;\n              return request.getWizLiveRoomId({\n                email: email\n              }).then(function (res) {\n                return res.json();\n              });\n\n            case 13:\n              wizLiveRoom = _context.sent;\n\n              if (wizLiveRoom && wizLiveRoom.roomId) {\n                wizLiveRoom.myLecture.lecture.guideVideo && _this.props.setVideoURL(wizLiveRoom.myLecture.lecture.guideVideo);\n\n                _this.setState({\n                  reservationId: wizLiveRoom.id,\n                  roomId: wizLiveRoom.roomId,\n                  isTutor: wizLiveRoom.isTutor,\n                  studentEmail: wizLiveRoom.studentEmail,\n                  tutorEmail: wizLiveRoom.tutorEmail,\n                  lectureVideos: JSON.parse(wizLiveRoom.myLecture.lecture.video),\n                  lectureSlides: JSON.parse(wizLiveRoom.myLecture.lecture.slides),\n                  lectureState: wizLiveRoom.myLecture.lecture.state,\n                  lectureTitle: wizLiveRoom.myLecture.lecture.title,\n                  isFreeTrial: wizLiveRoom.isFreeTrial\n                }, function () {\n                  _this.loadWizlab();\n                });\n              } else {\n                showPopUp(React.createElement(Popup.OneButton, {\n                  intl: _this.props.intl,\n                  titleId: \"ID_BUILDER_ALERT_MSG_CLIVE_NOT_FOUND\",\n                  buttonNameId: \"ID_BUILDER_ALERT_CONFIRMBTN\",\n                  buttonAction: function buttonAction() {\n                    if (pId) _this.props.history.replace(\"/\".concat(PAGETYPE.BUILDER, \"/\").concat(pId));else _this.props.history.replace(\"/\" + PAGETYPE.WIZLIVE);\n                  },\n                  __source: {\n                    fileName: _jsxFileName,\n                    lineNumber: 175\n                  },\n                  __self: this\n                }));\n              }\n\n              return _context.abrupt(\"break\", 64);\n\n            case 16:\n              if (!(pageType === PAGETYPE.MONITOR_1V4)) {\n                _context.next = 23;\n                break;\n              }\n\n              email = window.prompt(\"튜터의 이메일을 입력해주세요\", \"johnjs@wizschool.io\");\n              _context.next = 20;\n              return request.getMonitorRoom1v4({\n                email: email\n              }).then(function (res) {\n                return res.json();\n              });\n\n            case 20:\n              wizLive1v4Room = _context.sent;\n              _context.next = 26;\n              break;\n\n            case 23:\n              _context.next = 25;\n              return request.getWizLive1v4RoomId({\n                email: email,\n                roomId: _this.roomId\n              }).then(function (res) {\n                return res.json();\n              });\n\n            case 25:\n              wizLive1v4Room = _context.sent;\n\n            case 26:\n              if (wizLive1v4Room && wizLive1v4Room.roomId) {\n                // wizLiveRoom.myLecture.lecture.guideVideo &&\n                //   this.props.setVideoURL(wizLiveRoom.myLecture.lecture.guideVideo);\n                _this.setState({\n                  reservationId: wizLive1v4Room.id,\n                  roomId: wizLive1v4Room.roomId,\n                  isTutor: pageType === PAGETYPE.MONITOR_1V4 ? false : wizLive1v4Room.isTutor,\n                  studentEmail: wizLive1v4Room.studentEmail,\n                  tutorEmail: wizLive1v4Room.tutorEmail,\n                  lectureVideos: JSON.parse(wizLive1v4Room.myLecture.lecture.video),\n                  lectureSlides: JSON.parse(wizLive1v4Room.myLecture.lecture.slides),\n                  lectureState: wizLive1v4Room.myLecture.lecture.state,\n                  lectureTitle: wizLive1v4Room.myLecture.lecture.title,\n                  isFreeTrial: wizLive1v4Room.isFreeTrial\n                }, function () {\n                  if (pageType === PAGETYPE.WIZLIVE_1V4) {\n                    _this.loadWizlab();\n                  } else if (pageType === PAGETYPE.MONITOR_1V4) {\n                    _this.defaultMonitor();\n                  }\n                });\n              } else {\n                showPopUp(React.createElement(Popup.OneButton, {\n                  intl: _this.props.intl,\n                  titleId: \"ID_BUILDER_ALERT_MSG_CLIVE_NOT_FOUND\",\n                  buttonNameId: \"ID_BUILDER_ALERT_CONFIRMBTN\",\n                  buttonAction: function buttonAction() {\n                    if (pId) _this.props.history.replace(\"/\".concat(PAGETYPE.BUILDER, \"/\").concat(pId));else _this.props.history.replace(\"/\" + PAGETYPE.WIZLIVE);\n                  },\n                  __source: {\n                    fileName: _jsxFileName,\n                    lineNumber: 241\n                  },\n                  __self: this\n                }));\n              }\n\n              return _context.abrupt(\"break\", 64);\n\n            case 28:\n              _this.loadWizlab();\n\n              return _context.abrupt(\"break\", 64);\n\n            case 30:\n              _this.loadWizlab();\n\n              return _context.abrupt(\"break\", 64);\n\n            case 32:\n              showPopUp(React.createElement(Popup.OneButton, {\n                intl: _this.props.intl,\n                titleId: \"ID_BUILDER_ALERT_MSG_READONLY\",\n                buttonNameId: \"ID_BUILDER_ALERT_CONFIRMBTN\",\n                __source: {\n                  fileName: _jsxFileName,\n                  lineNumber: 262\n                },\n                __self: this\n              }));\n\n              _this.loadWizlab();\n\n              return _context.abrupt(\"break\", 64);\n\n            case 35:\n              showPopUp(React.createElement(Popup.OneButton, {\n                intl: _this.props.intl,\n                titleId: \"ID_BUILDER_ALERT_MSG_READONLY\",\n                buttonNameId: \"ID_BUILDER_ALERT_CONFIRMBTN\",\n                __source: {\n                  fileName: _jsxFileName,\n                  lineNumber: 272\n                },\n                __self: this\n              }));\n\n              _this.loadWizlabForQuestion();\n\n              return _context.abrupt(\"break\", 64);\n\n            case 38:\n              _this.loadDefaultProject();\n\n              return _context.abrupt(\"break\", 64);\n\n            case 40:\n              stage = require(\"./utils/ocp/\".concat(grade, \"/stages/\").concat(step > 10 ? 10 : step));\n              ocpClass = stage.data;\n              ocpClass.state = stage.state;\n              AssetLibrary.loadAssetsFromScene(ocpClass.state.scene, function () {\n                _this.props.setProject({\n                  state: ocpClass.state,\n                  videoclass: ocpClass\n                });\n\n                _this.setState({\n                  isLoading: false\n                });\n              });\n              return _context.abrupt(\"break\", 64);\n\n            case 45:\n              try {\n                if (_this.props.location.path.split(\"/\")[2] === PAGETYPE.BLOCK) {\n                  ocp2Template = require(\"./Component/OCP2/template/block/\".concat(grade, \"/\").concat(step));\n                } else if (_this.props.location.path.split(\"/\")[2] === PAGETYPE.JS) {\n                  ocp2Template = require(\"./Component/OCP2/template/\".concat(type, \"/\").concat(grade, \"/\").concat(step));\n                }\n\n                AssetLibrary.loadAssetsFromScene(ocp2Template.state.scene, function () {\n                  _this.props.setProject({\n                    state: ocp2Template.state,\n                    videoclass: ocp2Template.data\n                  });\n\n                  _this.setState({\n                    isLoading: false\n                  });\n                });\n              } catch (e) {\n                console.error(e);\n                showPopUp(React.createElement(Popup.OneButton, {\n                  title: \"\\uC218\\uC5C5\\uC815\\uBCF4\\uAC00 \\uC62C\\uBC14\\uB974\\uC9C0 \\uC54A\\uC2B5\\uB2C8\\uB2E4\",\n                  buttonName: \"\\uD655\\uC778\",\n                  __source: {\n                    fileName: _jsxFileName,\n                    lineNumber: 315\n                  },\n                  __self: this\n                }));\n              }\n\n              return _context.abrupt(\"break\", 64);\n\n            case 47:\n              if (_this.props.email) {\n                _context.next = 51;\n                break;\n              }\n\n              showPopUp(React.createElement(Popup.OneButton, {\n                title: \"\\uB85C\\uADF8\\uC778 \\uD6C4 \\uC774\\uC6A9\\uD574\\uC8FC\\uC138\\uC694\",\n                buttonName: \"\\uD655\\uC778\",\n                __source: {\n                  fileName: _jsxFileName,\n                  lineNumber: 325\n                },\n                __self: this\n              }));\n\n              _this.loadDefaultProject();\n\n              return _context.abrupt(\"return\");\n\n            case 51:\n              _this.loadTutorial();\n\n              return _context.abrupt(\"break\", 64);\n\n            case 53:\n              _context.next = 55;\n              return request.getReservationById({\n                reservationId: reservationId\n              }).then(function (res) {\n                return res.json();\n              });\n\n            case 55:\n              reservation = _context.sent;\n\n              _this.setState({\n                reservation: reservation.reservation\n              }, function () {\n                _this.loadRecordProject();\n              });\n\n              return _context.abrupt(\"break\", 64);\n\n            case 58:\n              _this.defaultMonitor();\n\n              return _context.abrupt(\"break\", 64);\n\n            case 60:\n              _this.setState({\n                isLoading: false,\n                popupStates: {\n                  video: false,\n                  snippet: false,\n                  api: false,\n                  chat: false,\n                  property: false,\n                  spriteBox: false,\n                  preview: false,\n                  soundBox: false,\n                  scene: false,\n                  animation: false,\n                  qna: false\n                }\n              });\n\n              return _context.abrupt(\"break\", 64);\n\n            case 62:\n              _this.loadWizlab();\n\n              return _context.abrupt(\"break\", 64);\n\n            case 64:\n              _context.next = 69;\n              break;\n\n            case 66:\n              _context.prev = 66;\n              _context.t1 = _context[\"catch\"](0);\n              console.error(_context.t1);\n\n            case 69:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, this, [[0, 66]]);\n    }));\n\n    _this.componentWillUnmount = function () {\n      // this.timer && clearInterval(this.timer);\n      localStorage.removeItem(\"templateId\");\n    };\n\n    _this.loadTutorial = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n      var myLevelInx, res, list, completeArr, levelItem, template, tutorialState;\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              /** load & valid check */\n              myLevelInx = 0;\n              _context2.next = 3;\n              return request.getMyTutorialList({\n                email: _this.props.email\n              });\n\n            case 3:\n              res = _context2.sent;\n              _context2.next = 6;\n              return res.json();\n\n            case 6:\n              list = _context2.sent;\n              completeArr = list.rows.filter(function (item) {\n                return item.isComplete;\n              });\n\n              if (completeArr.length) {\n                myLevelInx = completeArr.reduce(function (pv, cv) {\n                  return pv.tutorial.level > cv.tutorial.level ? pv : cv;\n                }).tutorial.level;\n              }\n\n              _context2.next = 11;\n              return request.getMyTutorial({\n                email: _this.props.email,\n                level: _this.state.params.level\n              }).then(function (res) {\n                return res.json();\n              });\n\n            case 11:\n              levelItem = _context2.sent;\n\n              if (levelItem) {\n                _context2.next = 22;\n                break;\n              }\n\n              if (!(myLevelInx + 1 === Number(_this.state.params.level))) {\n                _context2.next = 19;\n                break;\n              }\n\n              _context2.next = 16;\n              return request.createTutorialItem({\n                email: _this.props.email,\n                level: _this.state.params.level\n              });\n\n            case 16:\n              window.location.reload();\n              _context2.next = 20;\n              break;\n\n            case 19:\n              showPopUp(React.createElement(Popup.OneButton, {\n                title: \"\\uC798\\uBABB\\uB41C \\uACBD\\uB85C\\uC785\\uB2C8\\uB2E4\",\n                buttonName: \"\\uD655\\uC778\",\n                buttonAction: function buttonAction() {\n                  return _this.loadDefaultProject();\n                },\n                __source: {\n                  fileName: _jsxFileName,\n                  lineNumber: 408\n                },\n                __self: this\n              }));\n\n            case 20:\n              _context2.next = 25;\n              break;\n\n            case 22:\n              template = JSON.parse(levelItem.tutorial.template);\n              tutorialState = JSON.parse(levelItem.tutorial.state);\n              AssetLibrary.loadAssetsFromScene(tutorialState.scene, function () {\n                _this.props.setProject({\n                  state: tutorialState,\n                  videoclass: template\n                });\n\n                _this.setState({\n                  isLoading: false,\n                  currentTutorial: levelItem\n                });\n              });\n\n            case 25:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2, this);\n    }));\n    _this.defaultMonitor = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3() {\n      var response, project;\n      return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              _context3.prev = 0;\n              _context3.next = 3;\n              return request.getDefaultProject();\n\n            case 3:\n              response = _context3.sent;\n              _context3.next = 6;\n              return response.json();\n\n            case 6:\n              project = _context3.sent;\n\n              _this.setBrowserTitle(project.name);\n\n              project.state = JSON.parse(project.state);\n              AssetLibrary.loadAssetsFromScene(project.state.scene, function () {\n                _this.props.setProject(project);\n\n                _this.setState({\n                  isLoading: false\n                });\n              });\n              _context3.next = 15;\n              break;\n\n            case 12:\n              _context3.prev = 12;\n              _context3.t0 = _context3[\"catch\"](0);\n              console.error(_context3.t0);\n\n            case 15:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3, null, [[0, 12]]);\n    }));\n\n    _this.loadWizlab = function () {\n      document.title = \"Dreamclass - Coding Party\"; // const { pId } = this.state.params;\n      // if (pId) {\n      //   if (this.props.email) {\n      //     this.loadProject(pId);\n      //   } else {\n      //     this.handleDefaultCase();\n      //   }\n      // } else {\n      //   this.handleDefaultCase();\n      // }\n\n      var pId = _this.state.params.pId;\n\n      if (_this.props.email) {\n        if (pId) {\n          _this.loadProject(pId);\n        } else {\n          _this.setState({\n            isProjectPopupOpened: true\n          });\n        }\n      } else {\n        // this.handleDefaultCase();\n        if (!_this.props.email && _this.templateId) {\n          _this.loadTemplateProject(_this.templateId);\n\n          localStorage.removeItem(\"templateId\");\n          return;\n        }\n\n        try {\n          var urlParams = new URLSearchParams(window.location.search);\n          var templateId = urlParams.get(\"t\");\n\n          if (templateId) {\n            _this.loadTemplateProject(templateId);\n          } else {\n            _this.setState({\n              isProjectPopupOpened: true\n            });\n          }\n        } catch (e) {\n          _this.setState({\n            isProjectPopupOpened: false\n          });\n        }\n      }\n    };\n\n    _this.loadWizlabForQuestion = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee4() {\n      var questionId, response, projectState;\n      return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n        while (1) {\n          switch (_context4.prev = _context4.next) {\n            case 0:\n              questionId = _this.state.params.questionId;\n              _context4.next = 3;\n              return request.getQuestionState({\n                id: questionId\n              });\n\n            case 3:\n              response = _context4.sent;\n              _context4.next = 6;\n              return response.json();\n\n            case 6:\n              projectState = _context4.sent;\n\n              if (projectState) {\n                projectState = JSON.parse(projectState.state);\n                AssetLibrary.loadAssetsFromScene(projectState.scene, function () {\n                  var project = {\n                    state: projectState,\n                    name: \"\"\n                  };\n\n                  _this.props.setProject(project);\n\n                  _this.setState({\n                    isLoading: false\n                  });\n                });\n              }\n\n            case 8:\n            case \"end\":\n              return _context4.stop();\n          }\n        }\n      }, _callee4);\n    }));\n\n    _this.openProjectPopup = function () {\n      _this.setState({\n        isProjectPopupOpened: true\n      });\n    };\n\n    _this.closeProjectPopup = function () {\n      _this.setState({\n        isProjectPopupOpened: false\n      });\n    };\n\n    _this.loadRecordProject = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee5() {\n      var state;\n      return _regeneratorRuntime.wrap(function _callee5$(_context5) {\n        while (1) {\n          switch (_context5.prev = _context5.next) {\n            case 0:\n              state = JSON.parse(_this.state.reservation.myLecture.lecture.state);\n              AssetLibrary.loadAssetsFromScene(state.scene, function () {\n                _this.props.setProject({\n                  state: state\n                });\n\n                _this.setState({\n                  isLoading: false\n                });\n              });\n\n            case 2:\n            case \"end\":\n              return _context5.stop();\n          }\n        }\n      }, _callee5);\n    }));\n\n    _this.loadProject = /*#__PURE__*/function () {\n      var _ref6 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee6(pId) {\n        var response, project, templateId;\n        return _regeneratorRuntime.wrap(function _callee6$(_context6) {\n          while (1) {\n            switch (_context6.prev = _context6.next) {\n              case 0:\n                _context6.prev = 0;\n                _context6.next = 3;\n                return request.getDevelopingProject({\n                  pId: pId\n                });\n\n              case 3:\n                response = _context6.sent;\n                _context6.next = 6;\n                return response.json();\n\n              case 6:\n                project = _context6.sent;\n\n                if (!project) {\n                  _context6.next = 22;\n                  break;\n                }\n\n                if (!(_this.state.pageType === PAGETYPE.BUILDER_READONLY || _this.state.pageType === PAGETYPE.QNA_READONLY)) {\n                  _context6.next = 14;\n                  break;\n                }\n\n                if (_this.props.isTutor) {\n                  _context6.next = 12;\n                  break;\n                }\n\n                _this.props.history.replace({\n                  pathname: \"/\" + PAGETYPE.BUILDER\n                });\n\n                return _context6.abrupt(\"return\");\n\n              case 12:\n                _context6.next = 17;\n                break;\n\n              case 14:\n                if (!(project.email !== _this.props.email && _this.state.pageType !== PAGETYPE.WIZLIVE && _this.state.pageType !== PAGETYPE.WIZLIVE_1V4)) {\n                  _context6.next = 17;\n                  break;\n                }\n\n                _this.props.history.replace({\n                  pathname: \"/\" + PAGETYPE.BUILDER\n                });\n\n                return _context6.abrupt(\"return\");\n\n              case 17:\n                _this.setBrowserTitle(project.name);\n\n                project.state = JSON.parse(project.state);\n                AssetLibrary.loadAssetsFromScene(project.state.scene, function () {\n                  _this.props.setProject(project);\n\n                  _this.setState({\n                    isLoading: false\n                  });\n                });\n                _context6.next = 24;\n                break;\n\n              case 22:\n                templateId = _this.state.params.templateId;\n\n                _this.createNewProjectFromServer(pId, templateId);\n\n              case 24:\n                _context6.next = 29;\n                break;\n\n              case 26:\n                _context6.prev = 26;\n                _context6.t0 = _context6[\"catch\"](0);\n                console.error(_context6.t0);\n\n              case 29:\n              case \"end\":\n                return _context6.stop();\n            }\n          }\n        }, _callee6, null, [[0, 26]]);\n      }));\n\n      return function (_x) {\n        return _ref6.apply(this, arguments);\n      };\n    }();\n\n    _this.setBrowserTitle = function (title) {\n      document.title = \"Dreamclass - Coding Party\";\n      if (title) document.title += \" - \".concat(title);\n    };\n\n    _this.createNewProjectFromServer = /*#__PURE__*/function () {\n      var _ref7 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee7(pId, templateId) {\n        var name, email, randomChar, params, response, project;\n        return _regeneratorRuntime.wrap(function _callee7$(_context7) {\n          while (1) {\n            switch (_context7.prev = _context7.next) {\n              case 0:\n                email = _this.props.email;\n\n                if (_this.state.lectureTitle) {\n                  name = _this.state.lectureTitle;\n                } else {\n                  randomChar = String.fromCharCode(Math.floor(Math.random() * Math.floor(48)) + 48); //temp\n\n                  name = _this.props.intl.formatMessage({\n                    id: \"ID_TIP_LAYOUT_NEW_PROJECT_FORMAT\"\n                  }, {\n                    randomChar: randomChar\n                  });\n                }\n\n                params = {\n                  pId: pId,\n                  email: email,\n                  name: name\n                };\n\n                if (_this.state.lectureState) {\n                  params.state = _this.state.lectureState;\n                }\n\n                if (templateId) {\n                  params.templateId = templateId;\n                }\n\n                _context7.prev = 5;\n                _context7.next = 8;\n                return request.postDevelopingProject(params);\n\n              case 8:\n                response = _context7.sent;\n                _context7.next = 11;\n                return response.json();\n\n              case 11:\n                project = _context7.sent;\n\n                _this.setBrowserTitle(project.name);\n\n                project.state = JSON.parse(project.state);\n                project.video = {\n                  videoURL: DEFAULT_VIDEO_URL\n                };\n                AssetLibrary.loadAssetsFromScene(project.state.scene, function () {\n                  _this.props.setProject(project);\n\n                  _this.setState({\n                    isLoading: false\n                  });\n                });\n                _context7.next = 21;\n                break;\n\n              case 18:\n                _context7.prev = 18;\n                _context7.t0 = _context7[\"catch\"](5);\n                console.error(_context7.t0);\n\n              case 21:\n              case \"end\":\n                return _context7.stop();\n            }\n          }\n        }, _callee7, null, [[5, 18]]);\n      }));\n\n      return function (_x2, _x3) {\n        return _ref7.apply(this, arguments);\n      };\n    }();\n\n    _this.loadDefaultProject = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee8() {\n      var response, project;\n      return _regeneratorRuntime.wrap(function _callee8$(_context8) {\n        while (1) {\n          switch (_context8.prev = _context8.next) {\n            case 0:\n              _context8.next = 2;\n              return request.getDefaultProject();\n\n            case 2:\n              response = _context8.sent;\n              _context8.next = 5;\n              return response.json();\n\n            case 5:\n              project = _context8.sent;\n              project.name = \"\";\n\n              _this.setBrowserTitle(project.name);\n\n              project.state = JSON.parse(project.state);\n              project.video = {\n                videoURL: DEFAULT_VIDEO_URL\n              };\n              AssetLibrary.loadAssetsFromScene(project.state.scene, function () {\n                _this.props.setProject(project);\n\n                _this.setState({\n                  isLoading: false\n                });\n              });\n\n            case 11:\n            case \"end\":\n              return _context8.stop();\n          }\n        }\n      }, _callee8);\n    }));\n\n    _this.loadTemplateProject = /*#__PURE__*/function () {\n      var _ref9 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee9(templateId) {\n        var response, project;\n        return _regeneratorRuntime.wrap(function _callee9$(_context9) {\n          while (1) {\n            switch (_context9.prev = _context9.next) {\n              case 0:\n                _context9.next = 2;\n                return request.getDefaultTemplateProject({\n                  id: templateId\n                });\n\n              case 2:\n                response = _context9.sent;\n                _context9.next = 5;\n                return response.json();\n\n              case 5:\n                project = _context9.sent;\n                project.name = \"\";\n\n                _this.setBrowserTitle(project.name);\n\n                project.state = JSON.parse(project.state);\n                project.video = {\n                  videoURL: DEFAULT_VIDEO_URL\n                };\n                AssetLibrary.loadAssetsFromScene(project.state.scene, function () {\n                  _this.props.setProject(project);\n\n                  _this.setState({\n                    isLoading: false\n                  });\n                });\n\n              case 11:\n              case \"end\":\n                return _context9.stop();\n            }\n          }\n        }, _callee9);\n      }));\n\n      return function (_x4) {\n        return _ref9.apply(this, arguments);\n      };\n    }();\n\n    _this.handleSelectMainViewMode = function (mainViewMode) {\n      _this.setState({\n        mainViewMode: mainViewMode\n      });\n    };\n\n    _this.handleChangeZIndex = function (name) {\n      var sort = function sort(arr) {\n        var indexes = arr.slice();\n\n        for (var i = 0; i < indexes.length; i++) {\n          if (name === indexes[i]) {\n            var value = indexes[i];\n            indexes.splice(i, 1);\n            indexes.push(value);\n            break;\n          }\n        }\n\n        return indexes;\n      };\n\n      _this.setState(function (state) {\n        return {\n          popupZIndexes: sort(state.popupZIndexes)\n        };\n      }, function () {\n        localStorage.setItem(\"popupZIndexes\", JSON.stringify(_this.state.popupZIndexes));\n      });\n    };\n\n    _this.handleSelectTab = function (name, from) {\n      _this.props.setLog(_defineProperty({}, name, !_this.state.popupStates[name]));\n\n      if (!_this.state.popupStates[name]) {\n        if (name === \"spriteView\" || name === \"sound\" || name === \"preview\") {\n          TrackingUtil.sendGAEvent({\n            category: \"Builder\",\n            action: \"MenuActions\",\n            label: name[0].toUpperCase() + name.slice(1)\n          });\n        }\n\n        if (name === \"spriteBox\") {\n          TrackingUtil.sendGAEvent({\n            category: \"Builder\",\n            action: \"AddSprite\",\n            label: from\n          });\n        }\n      }\n\n      _this.setState(function (state) {\n        return {\n          popupStates: _objectSpread({}, state.popupStates, _defineProperty({}, name, !state.popupStates[name]))\n        };\n      }, function () {\n        localStorage.setItem(\"popupStates\", JSON.stringify(_objectSpread({}, _this.state.popupStates, {\n          ocp: undefined,\n          tutorial: undefined,\n          live: undefined\n        })));\n\n        if (_this.state.popupStates[name]) {\n          _this.handleChangeZIndex(name);\n        }\n      });\n    };\n\n    _this.showModal = function (modalContent) {\n      _this.setState({\n        modalContent: modalContent\n      });\n    };\n\n    _this.handleHelp = function (isHelpOpened) {\n      _this.setState({\n        isHelpOpened: isHelpOpened\n      });\n    };\n\n    _this.setVideoclassRef = function (ref) {\n      _this.setState({\n        videoclassRef: ref\n      });\n    };\n\n    var popupStates = JSON.parse(localStorage.getItem(\"popupStates\"));\n\n    if (!popupStates) {\n      popupStates = {\n        video: false,\n        snippet: false,\n        api: false,\n        chat: false,\n        property: false,\n        spriteBox: false,\n        preview: false,\n        soundBox: false,\n        scene: false,\n        animation: false,\n        qna: false\n      };\n    }\n\n    popupStates = _objectSpread({}, popupStates, {\n      ocp: props.location.path.split(\"/\")[1] === PAGETYPE.OCP,\n      ocp2block: props.location.path.split(\"/\")[1] === PAGETYPE.OCP2 && props.location.path.split(\"/\")[2] === PAGETYPE.BLOCK,\n      ocp2js: props.location.path.split(\"/\")[1] === PAGETYPE.OCP2 && props.location.path.split(\"/\")[2] === PAGETYPE.JS,\n      tutorial: props.location.path.split(\"/\")[1] === PAGETYPE.TUTORIAL,\n      live: props.location.path.split(\"/\")[1] === PAGETYPE.WIZLIVE,\n      live1v4: props.location.path.split(\"/\")[1] === PAGETYPE.WIZLIVE_1V4,\n      monitor1v4: props.location.path.split(\"/\")[1] === PAGETYPE.MONITOR_1V4\n    });\n    var popupZIndexes = JSON.parse(localStorage.getItem(\"popupZIndexes\"));\n\n    if (!popupZIndexes || !popupZIndexes.includes(\"snippet\")) {\n      popupZIndexes = [\"ocp\", \"ocp2block\", \"ocp2js\", \"tutorial\", \"live\", \"video\", \"snippet\", \"api\", \"chat\", \"property\", \"spriteBox\", \"preview\", \"soundBox\", \"scene\", \"animation\", \"qna\"];\n    }\n\n    _this.templateId = localStorage.getItem(\"templateId\");\n    _this.roomId = null;\n    _this.state = {\n      isLoading: true,\n      isProjectPopupOpened: false,\n      params: props.location.params,\n      pageType: props.location.path.split(\"/\")[1],\n      popupStates: popupStates,\n      popupZIndexes: popupZIndexes,\n      currentTutorial: undefined,\n      videoclassRef: undefined\n    };\n\n    switch (_this.state.pageType) {\n      case PAGETYPE.WIZLIVE:\n        _this.state.reservationId = null;\n        _this.state.roomId = null;\n        _this.state.isTutor = null;\n        _this.state.studentEmail = null;\n        _this.state.tutorEmail = null;\n        _this.state.isFreeTrial = null;\n        break;\n\n      case PAGETYPE.WIZLIVE_1V4:\n      case PAGETYPE.MONITOR_1V4:\n        _this.state.reservationId = null;\n        _this.state.roomId = null;\n        _this.state.isTutor = null;\n        _this.state.studentEmail = null;\n        _this.state.tutorEmail = null;\n        _this.state.isFreeTrial = null;\n        break;\n\n      case PAGETYPE.RECORD_PLAYER:\n        _this.state.reservationId = _this.state.params.reservationId;\n        break;\n\n      default:\n        break;\n    }\n\n    _this.isIE = detectIE();\n    return _this;\n  }\n\n  _createClass(Container, [{\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate(prevProps, prevState) {\n      if (prevProps.email && !this.props.email) {\n        this.props.history.replace({\n          pathname: \"/\" + PAGETYPE.BUILDER\n        });\n        window.location.reload();\n      } else if (!prevProps.email && this.props.email && this.state.pageType !== PAGETYPE.OCP && this.state.pageType !== PAGETYPE.OCP2BLOCK && this.state.pageType !== PAGETYPE.OCP2JS && this.state.pageType !== PAGETYPE.OCP2) {\n        this.props.history.replace({\n          pathname: \"/\" + PAGETYPE.BUILDER\n        });\n        window.location.reload();\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$props = this.props,\n          screenMode = _this$props.screenMode,\n          location = _this$props.location,\n          email = _this$props.email,\n          name = _this$props.name;\n      var _this$state2 = this.state,\n          pageType = _this$state2.pageType,\n          roomId = _this$state2.roomId,\n          reservationId = _this$state2.reservationId,\n          isTutor = _this$state2.isTutor,\n          isLoading = _this$state2.isLoading,\n          tutorEmail = _this$state2.tutorEmail,\n          studentEmail = _this$state2.studentEmail,\n          lectureVideos = _this$state2.lectureVideos,\n          lectureSlides = _this$state2.lectureSlides,\n          reservation = _this$state2.reservation,\n          isProjectPopupOpened = _this$state2.isProjectPopupOpened,\n          modalContent = _this$state2.modalContent,\n          isHelpOpened = _this$state2.isHelpOpened,\n          popupStates = _this$state2.popupStates,\n          popupZIndexes = _this$state2.popupZIndexes,\n          currentTutorial = _this$state2.currentTutorial,\n          isFreeTrial = _this$state2.isFreeTrial,\n          videoclassRef = _this$state2.videoclassRef;\n      var pId = this.state.params.pId;\n      var isIE = this.isIE,\n          openProjectPopup = this.openProjectPopup,\n          closeProjectPopup = this.closeProjectPopup,\n          handleHelp = this.handleHelp,\n          handleChangeZIndex = this.handleChangeZIndex,\n          handleSelectTab = this.handleSelectTab,\n          showModal = this.showModal,\n          setVideoclassRef = this.setVideoclassRef;\n      return React.createElement(DndProvider, {\n        backend: HTML5Backend,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 780\n        },\n        __self: this\n      }, React.createElement(View, {\n        screenMode: screenMode,\n        location: location,\n        pageType: pageType,\n        roomId: roomId,\n        reservationId: reservationId,\n        isTutor: isTutor,\n        isLoading: isLoading,\n        isIE: isIE,\n        tutorEmail: tutorEmail,\n        studentEmail: studentEmail,\n        lectureVideos: lectureVideos,\n        lectureSlides: lectureSlides,\n        pId: pId,\n        reservation: reservation,\n        isProjectPopupOpened: isProjectPopupOpened,\n        openProjectPopup: openProjectPopup,\n        closeProjectPopup: closeProjectPopup,\n        modalContent: modalContent,\n        showModal: showModal,\n        isHelpOpened: isHelpOpened,\n        handleHelp: handleHelp,\n        popupStates: popupStates,\n        popupZIndexes: popupZIndexes,\n        handleChangeZIndex: handleChangeZIndex,\n        handleSelectTab: handleSelectTab,\n        currentTutorial: currentTutorial,\n        isFreeTrial: isFreeTrial,\n        videoclassRef: videoclassRef,\n        setVideoclassRef: setVideoclassRef,\n        email: email,\n        name: name,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 781\n        },\n        __self: this\n      }));\n    }\n  }]);\n\n  return Container;\n}(Component);\n\nexport default connect(function (state) {\n  return {\n    email: state.userinfo.email,\n    name: state.userinfo.name,\n    isTutor: state.userinfo.isTutor,\n    screenMode: state.preview.screenMode\n  };\n}, {\n  setProject: projectActions.setProject,\n  resetProject: projectActions.resetProject,\n  setGameVolume: previewActions.setGameVolume,\n  setLog: webrtcActions.setLog,\n  setVideoURL: videoActions.setVideoURL\n})(injectIntl(Container));","map":{"version":3,"sources":["/Users/jimmy/Documents/Wizschool/wizlab_web2/src/Page/Builder/Container.js"],"names":["React","Component","connect","injectIntl","DndProvider","HTML5Backend","projectActions","previewActions","webrtcActions","videoActions","request","AssetLibrary","PAGETYPE","DEFAULT_VIDEO_URL","detectIE","View","Popup","showPopUp","TrackingUtil","Container","props","componentDidMount","isIE","history","replace","BUILDER","email","state","pageType","params","pId","step","grade","reservationId","type","WIZLIVE_1V4","regexRoomId","exec","roomId","groups","WIZLIVE","MONITOR_1V4","BUILDER_EDIT","BUILDER_READONLY","QNA_READONLY","VIDEOCLASS","OCP","OCP2","TUTORIAL","RECORD_PLAYER","MONITOR","DREAMCLASS","getWizLiveRoomId","then","res","json","wizLiveRoom","myLecture","lecture","guideVideo","setVideoURL","setState","id","isTutor","studentEmail","tutorEmail","lectureVideos","JSON","parse","video","lectureSlides","slides","lectureState","lectureTitle","title","isFreeTrial","loadWizlab","intl","window","prompt","getMonitorRoom1v4","wizLive1v4Room","getWizLive1v4RoomId","defaultMonitor","loadWizlabForQuestion","loadDefaultProject","stage","require","ocpClass","data","loadAssetsFromScene","scene","setProject","videoclass","isLoading","location","path","split","BLOCK","ocp2Template","JS","e","console","error","loadTutorial","getReservationById","reservation","loadRecordProject","popupStates","snippet","api","chat","property","spriteBox","preview","soundBox","animation","qna","componentWillUnmount","localStorage","removeItem","myLevelInx","getMyTutorialList","list","completeArr","rows","filter","item","isComplete","length","reduce","pv","cv","tutorial","level","getMyTutorial","levelItem","Number","createTutorialItem","reload","template","tutorialState","currentTutorial","getDefaultProject","response","project","setBrowserTitle","name","document","loadProject","isProjectPopupOpened","templateId","loadTemplateProject","urlParams","URLSearchParams","search","get","questionId","getQuestionState","projectState","openProjectPopup","closeProjectPopup","getDevelopingProject","pathname","createNewProjectFromServer","randomChar","String","fromCharCode","Math","floor","random","formatMessage","postDevelopingProject","videoURL","getDefaultTemplateProject","handleSelectMainViewMode","mainViewMode","handleChangeZIndex","sort","arr","indexes","slice","i","value","splice","push","popupZIndexes","setItem","stringify","handleSelectTab","from","setLog","sendGAEvent","category","action","label","toUpperCase","ocp","undefined","live","showModal","modalContent","handleHelp","isHelpOpened","setVideoclassRef","ref","videoclassRef","getItem","ocp2block","ocp2js","live1v4","monitor1v4","includes","prevProps","prevState","OCP2BLOCK","OCP2JS","screenMode","userinfo","resetProject","setGameVolume"],"mappings":";;;;;;;;;;;;;;;;;;AAAA,OAAOA,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC;AACA,SAASC,OAAT,QAAwB,aAAxB;AACA,SAASC,UAAT,QAA2B,YAA3B;AACA,SAASC,WAAT,QAA4B,WAA5B;AACA,SAASC,YAAT,QAA6B,yBAA7B;AACA,OAAO,uCAAP;AACA,OAAO,KAAKC,cAAZ,MAAgC,yBAAhC;AACA,OAAO,KAAKC,cAAZ,MAAgC,yBAAhC;AACA,OAAO,KAAKC,aAAZ,MAA+B,wBAA/B;AACA,OAAO,KAAKC,YAAZ,MAA8B,uBAA9B;AACA,OAAO,KAAKC,OAAZ,MAAyB,+BAAzB;AACA,OAAOC,YAAP,MAAyB,sBAAzB;AACA,SAASC,QAAT,EAAmBC,iBAAnB,QAA4C,4BAA5C;AACA,SAASC,QAAT,QAAyB,iCAAzB;AACA,OAAOC,IAAP,MAAiB,QAAjB;AACA,OAAOC,KAAP,IAAgBC,SAAhB,QAAiC,8BAAjC;AACA,OAAO,KAAKC,YAAZ,MAA8B,gCAA9B;;IAEMC,S;;;;;AACJ,qBAAYC,KAAZ,EAAmB;AAAA;;AAAA;;AACjB,8BAAMA,KAAN;AADiB,UAkGnBC,iBAlGmB,yEAkGC;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA,mBAEZ,MAAKC,IAFO;AAAA;AAAA;AAAA;;AAGd,oBAAKF,KAAL,CAAWG,OAAX,CAAmBC,OAAnB,CAA2B,MAAMZ,QAAQ,CAACa,OAA1C;;AAHc;;AAAA;AAOVC,cAAAA,KAPU,GAOA,MAAKN,KAPL,CAOVM,KAPU;AAAA,4BAQa,MAAKC,KARlB,EAQRC,QARQ,eAQRA,QARQ,EAQEC,MARF,eAQEA,MARF;AASRC,cAAAA,GATQ,GASkCD,MATlC,CASRC,GATQ,EASHC,IATG,GASkCF,MATlC,CASHE,IATG,EASGC,KATH,GASkCH,MATlC,CASGG,KATH,EASUC,aATV,GASkCJ,MATlC,CASUI,aATV,EASyBC,IATzB,GASkCL,MATlC,CASyBK,IATzB;;AAWhB,kBAAIN,QAAQ,KAAKhB,QAAQ,CAACuB,WAA1B,EAAuC;AAC/BC,gBAAAA,WAD+B,4BACjB,gHADiB;AAAA;AAAA;AAAA,oCAKjCA,WAAW,CAACC,IAAZ,CAAiBP,GAAjB,CALiC,EAIzBQ,MAJyB,qBAInCC,MAJmC,CAIzBD,MAJyB;AAOrC,sBAAKA,MAAL,GAAcA,MAAd;AACD,eAnBe,CAqBhB;AACA;AACA;AACA;AACA;AACA;AAEA;;;AA5BgB,4BA8BRV,QA9BQ;AAAA,8CA+BThB,QAAQ,CAAC4B,OA/BA,wBAsET5B,QAAQ,CAAC6B,WAtEA,wBAuET7B,QAAQ,CAACuB,WAvEA,wBAwITvB,QAAQ,CAACa,OAxIA,wBA2ITb,QAAQ,CAAC8B,YA3IA,wBA8IT9B,QAAQ,CAAC+B,gBA9IA,wBAwJT/B,QAAQ,CAACgC,YAxJA,wBAkKThC,QAAQ,CAACiC,UAlKA,wBAqKTjC,QAAQ,CAACkC,GArKA,wBAmLTlC,QAAQ,CAACmC,IAnLA,wBA4MTnC,QAAQ,CAACoC,QA5MA,wBAyNTpC,QAAQ,CAACqC,aAzNA,wBAiOTrC,QAAQ,CAACsC,OAjOA,wBAoOTtC,QAAQ,CAACuC,UApOA;AAAA;;AAAA;AAAA;AAAA,qBAgCczC,OAAO,CAC9B0C,gBADuB,CACN;AAAE1B,gBAAAA,KAAK,EAALA;AAAF,eADM,EAEvB2B,IAFuB,CAElB,UAAAC,GAAG;AAAA,uBAAIA,GAAG,CAACC,IAAJ,EAAJ;AAAA,eAFe,CAhCd;;AAAA;AAgCNC,cAAAA,WAhCM;;AAmCZ,kBAAIA,WAAW,IAAIA,WAAW,CAAClB,MAA/B,EAAuC;AACrCkB,gBAAAA,WAAW,CAACC,SAAZ,CAAsBC,OAAtB,CAA8BC,UAA9B,IACE,MAAKvC,KAAL,CAAWwC,WAAX,CAAuBJ,WAAW,CAACC,SAAZ,CAAsBC,OAAtB,CAA8BC,UAArD,CADF;;AAEA,sBAAKE,QAAL,CACE;AACE5B,kBAAAA,aAAa,EAAEuB,WAAW,CAACM,EAD7B;AAEExB,kBAAAA,MAAM,EAAEkB,WAAW,CAAClB,MAFtB;AAGEyB,kBAAAA,OAAO,EAAEP,WAAW,CAACO,OAHvB;AAIEC,kBAAAA,YAAY,EAAER,WAAW,CAACQ,YAJ5B;AAKEC,kBAAAA,UAAU,EAAET,WAAW,CAACS,UAL1B;AAMEC,kBAAAA,aAAa,EAAEC,IAAI,CAACC,KAAL,CAAWZ,WAAW,CAACC,SAAZ,CAAsBC,OAAtB,CAA8BW,KAAzC,CANjB;AAOEC,kBAAAA,aAAa,EAAEH,IAAI,CAACC,KAAL,CAAWZ,WAAW,CAACC,SAAZ,CAAsBC,OAAtB,CAA8Ba,MAAzC,CAPjB;AAQEC,kBAAAA,YAAY,EAAEhB,WAAW,CAACC,SAAZ,CAAsBC,OAAtB,CAA8B/B,KAR9C;AASE8C,kBAAAA,YAAY,EAAEjB,WAAW,CAACC,SAAZ,CAAsBC,OAAtB,CAA8BgB,KAT9C;AAUEC,kBAAAA,WAAW,EAAEnB,WAAW,CAACmB;AAV3B,iBADF,EAaE,YAAM;AACJ,wBAAKC,UAAL;AACD,iBAfH;AAiBD,eApBD,MAoBO;AACL3D,gBAAAA,SAAS,CACP,oBAAC,KAAD,CAAO,SAAP;AACE,kBAAA,IAAI,EAAE,MAAKG,KAAL,CAAWyD,IADnB;AAEE,kBAAA,OAAO,EAAC,sCAFV;AAGE,kBAAA,YAAY,EAAC,6BAHf;AAIE,kBAAA,YAAY,EAAE,wBAAM;AAClB,wBAAI/C,GAAJ,EACE,MAAKV,KAAL,CAAWG,OAAX,CAAmBC,OAAnB,YAA+BZ,QAAQ,CAACa,OAAxC,cAAmDK,GAAnD,GADF,KAEK,MAAKV,KAAL,CAAWG,OAAX,CAAmBC,OAAnB,CAA2B,MAAMZ,QAAQ,CAAC4B,OAA1C;AACN,mBARH;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBADO,CAAT;AAYD;;AApEW;;AAAA;AAAA,oBA0ERZ,QAAQ,KAAKhB,QAAQ,CAAC6B,WA1Ed;AAAA;AAAA;AAAA;;AA2EVf,cAAAA,KAAK,GAAGoD,MAAM,CAACC,MAAP,CACN,iBADM,EAEN,qBAFM,CAAR;AA3EU;AAAA,qBAgFarE,OAAO,CAC3BsE,iBADoB,CACF;AAAEtD,gBAAAA,KAAK,EAALA;AAAF,eADE,EAEpB2B,IAFoB,CAEf,UAAAC,GAAG;AAAA,uBAAIA,GAAG,CAACC,IAAJ,EAAJ;AAAA,eAFY,CAhFb;;AAAA;AAgFV0B,cAAAA,cAhFU;AAAA;AAAA;;AAAA;AAAA;AAAA,qBAqFavE,OAAO,CAC3BwE,mBADoB,CACA;AAAExD,gBAAAA,KAAK,EAALA,KAAF;AAASY,gBAAAA,MAAM,EAAE,MAAKA;AAAtB,eADA,EAEpBe,IAFoB,CAEf,UAAAC,GAAG;AAAA,uBAAIA,GAAG,CAACC,IAAJ,EAAJ;AAAA,eAFY,CArFb;;AAAA;AAqFV0B,cAAAA,cArFU;;AAAA;AA0FZ,kBAAIA,cAAc,IAAIA,cAAc,CAAC3C,MAArC,EAA6C;AAC3C;AACA;AACA,sBAAKuB,QAAL,CACE;AACE5B,kBAAAA,aAAa,EAAEgD,cAAc,CAACnB,EADhC;AAEExB,kBAAAA,MAAM,EAAE2C,cAAc,CAAC3C,MAFzB;AAGEyB,kBAAAA,OAAO,EACLnC,QAAQ,KAAKhB,QAAQ,CAAC6B,WAAtB,GACI,KADJ,GAEIwC,cAAc,CAAClB,OANvB;AAOEC,kBAAAA,YAAY,EAAEiB,cAAc,CAACjB,YAP/B;AAQEC,kBAAAA,UAAU,EAAEgB,cAAc,CAAChB,UAR7B;AASEC,kBAAAA,aAAa,EAAEC,IAAI,CAACC,KAAL,CACba,cAAc,CAACxB,SAAf,CAAyBC,OAAzB,CAAiCW,KADpB,CATjB;AAYEC,kBAAAA,aAAa,EAAEH,IAAI,CAACC,KAAL,CACba,cAAc,CAACxB,SAAf,CAAyBC,OAAzB,CAAiCa,MADpB,CAZjB;AAeEC,kBAAAA,YAAY,EAAES,cAAc,CAACxB,SAAf,CAAyBC,OAAzB,CAAiC/B,KAfjD;AAgBE8C,kBAAAA,YAAY,EAAEQ,cAAc,CAACxB,SAAf,CAAyBC,OAAzB,CAAiCgB,KAhBjD;AAiBEC,kBAAAA,WAAW,EAAEM,cAAc,CAACN;AAjB9B,iBADF,EAoBE,YAAM;AACJ,sBAAI/C,QAAQ,KAAKhB,QAAQ,CAACuB,WAA1B,EAAuC;AACrC,0BAAKyC,UAAL;AACD,mBAFD,MAEO,IAAIhD,QAAQ,KAAKhB,QAAQ,CAAC6B,WAA1B,EAAuC;AAC5C,0BAAK0C,cAAL;AACD;AACF,iBA1BH;AA4BD,eA/BD,MA+BO;AACLlE,gBAAAA,SAAS,CACP,oBAAC,KAAD,CAAO,SAAP;AACE,kBAAA,IAAI,EAAE,MAAKG,KAAL,CAAWyD,IADnB;AAEE,kBAAA,OAAO,EAAC,sCAFV;AAGE,kBAAA,YAAY,EAAC,6BAHf;AAIE,kBAAA,YAAY,EAAE,wBAAM;AAClB,wBAAI/C,GAAJ,EACE,MAAKV,KAAL,CAAWG,OAAX,CAAmBC,OAAnB,YAA+BZ,QAAQ,CAACa,OAAxC,cAAmDK,GAAnD,GADF,KAEK,MAAKV,KAAL,CAAWG,OAAX,CAAmBC,OAAnB,CAA2B,MAAMZ,QAAQ,CAAC4B,OAA1C;AACN,mBARH;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBADO,CAAT;AAYD;;AAtIW;;AAAA;AAyIZ,oBAAKoC,UAAL;;AAzIY;;AAAA;AA4IZ,oBAAKA,UAAL;;AA5IY;;AAAA;AA+IZ3D,cAAAA,SAAS,CACP,oBAAC,KAAD,CAAO,SAAP;AACE,gBAAA,IAAI,EAAE,MAAKG,KAAL,CAAWyD,IADnB;AAEE,gBAAA,OAAO,EAAC,+BAFV;AAGE,gBAAA,YAAY,EAAC,6BAHf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBADO,CAAT;;AAOA,oBAAKD,UAAL;;AAtJY;;AAAA;AAyJZ3D,cAAAA,SAAS,CACP,oBAAC,KAAD,CAAO,SAAP;AACE,gBAAA,IAAI,EAAE,MAAKG,KAAL,CAAWyD,IADnB;AAEE,gBAAA,OAAO,EAAC,+BAFV;AAGE,gBAAA,YAAY,EAAC,6BAHf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBADO,CAAT;;AAOA,oBAAKO,qBAAL;;AAhKY;;AAAA;AAmKZ,oBAAKC,kBAAL;;AAnKY;;AAAA;AAsKNC,cAAAA,KAtKM,GAsKEC,OAAO,uBAAgBvD,KAAhB,qBACnBD,IAAI,GAAG,EAAP,GAAY,EAAZ,GAAiBA,IADE,EAtKT;AAyKRyD,cAAAA,QAzKQ,GAyKGF,KAAK,CAACG,IAzKT;AA0KZD,cAAAA,QAAQ,CAAC7D,KAAT,GAAiB2D,KAAK,CAAC3D,KAAvB;AACAhB,cAAAA,YAAY,CAAC+E,mBAAb,CAAiCF,QAAQ,CAAC7D,KAAT,CAAegE,KAAhD,EAAuD,YAAM;AAC3D,sBAAKvE,KAAL,CAAWwE,UAAX,CAAsB;AACpBjE,kBAAAA,KAAK,EAAE6D,QAAQ,CAAC7D,KADI;AAEpBkE,kBAAAA,UAAU,EAAEL;AAFQ,iBAAtB;;AAIA,sBAAK3B,QAAL,CAAc;AAAEiC,kBAAAA,SAAS,EAAE;AAAb,iBAAd;AACD,eAND;AA3KY;;AAAA;AAoLZ,kBAAI;AAEF,oBAAI,MAAK1E,KAAL,CAAW2E,QAAX,CAAoBC,IAApB,CAAyBC,KAAzB,CAA+B,GAA/B,EAAoC,CAApC,MAA2CrF,QAAQ,CAACsF,KAAxD,EAA+D;AAC7DC,kBAAAA,YAAY,GAAGZ,OAAO,2CAAoCvD,KAApC,cAA6CD,IAA7C,EAAtB;AACD,iBAFD,MAEO,IAAI,MAAKX,KAAL,CAAW2E,QAAX,CAAoBC,IAApB,CAAyBC,KAAzB,CAA+B,GAA/B,EAAoC,CAApC,MAA2CrF,QAAQ,CAACwF,EAAxD,EAA4D;AACjED,kBAAAA,YAAY,GAAGZ,OAAO,qCAA8BrD,IAA9B,cAAsCF,KAAtC,cAA+CD,IAA/C,EAAtB;AACD;;AACDpB,gBAAAA,YAAY,CAAC+E,mBAAb,CAAiCS,YAAY,CAACxE,KAAb,CAAmBgE,KAApD,EAA2D,YAAM;AAC/D,wBAAKvE,KAAL,CAAWwE,UAAX,CAAsB;AACpBjE,oBAAAA,KAAK,EAAEwE,YAAY,CAACxE,KADA;AAEpBkE,oBAAAA,UAAU,EAAEM,YAAY,CAACV;AAFL,mBAAtB;;AAIA,wBAAK5B,QAAL,CAAc;AAAEiC,oBAAAA,SAAS,EAAE;AAAb,mBAAd;AACD,iBAND;AAOD,eAdD,CAcE,OAAOO,CAAP,EAAU;AACVC,gBAAAA,OAAO,CAACC,KAAR,CAAcF,CAAd;AACApF,gBAAAA,SAAS,CACP,oBAAC,KAAD,CAAO,SAAP;AACE,kBAAA,KAAK,EAAC,kFADR;AAEE,kBAAA,UAAU,EAAC,cAFb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBADO,CAAT;AAMD;;AA1MW;;AAAA;AAAA,kBA6MP,MAAKG,KAAL,CAAWM,KA7MJ;AAAA;AAAA;AAAA;;AA8MVT,cAAAA,SAAS,CACP,oBAAC,KAAD,CAAO,SAAP;AACE,gBAAA,KAAK,EAAC,gEADR;AAEE,gBAAA,UAAU,EAAC,cAFb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBADO,CAAT;;AAMA,oBAAKoE,kBAAL;;AApNU;;AAAA;AAuNZ,oBAAKmB,YAAL;;AAvNY;;AAAA;AAAA;AAAA,qBA0Nc9F,OAAO,CAC9B+F,kBADuB,CACJ;AAAExE,gBAAAA,aAAa,EAAbA;AAAF,eADI,EAEvBoB,IAFuB,CAElB,UAAAC,GAAG;AAAA,uBAAIA,GAAG,CAACC,IAAJ,EAAJ;AAAA,eAFe,CA1Nd;;AAAA;AA0NNmD,cAAAA,WA1NM;;AA6NZ,oBAAK7C,QAAL,CAAc;AAAE6C,gBAAAA,WAAW,EAAEA,WAAW,CAACA;AAA3B,eAAd,EAAwD,YAAM;AAC5D,sBAAKC,iBAAL;AACD,eAFD;;AA7NY;;AAAA;AAkOZ,oBAAKxB,cAAL;;AAlOY;;AAAA;AAqOZ,oBAAKtB,QAAL,CAAc;AACZiC,gBAAAA,SAAS,EAAE,KADC;AAEZc,gBAAAA,WAAW,EAAE;AACXvC,kBAAAA,KAAK,EAAE,KADI;AAEXwC,kBAAAA,OAAO,EAAE,KAFE;AAGXC,kBAAAA,GAAG,EAAE,KAHM;AAIXC,kBAAAA,IAAI,EAAE,KAJK;AAKXC,kBAAAA,QAAQ,EAAE,KALC;AAMXC,kBAAAA,SAAS,EAAE,KANA;AAOXC,kBAAAA,OAAO,EAAE,KAPE;AAQXC,kBAAAA,QAAQ,EAAE,KARC;AASXxB,kBAAAA,KAAK,EAAE,KATI;AAUXyB,kBAAAA,SAAS,EAAE,KAVA;AAWXC,kBAAAA,GAAG,EAAE;AAXM;AAFD,eAAd;;AArOY;;AAAA;AAuPZ,oBAAKzC,UAAL;;AAvPY;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AA2PhB0B,cAAAA,OAAO,CAACC,KAAR;;AA3PgB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAlGD;;AAAA,UAiWnBe,oBAjWmB,GAiWI,YAAM;AAC3B;AACAC,MAAAA,YAAY,CAACC,UAAb,CAAwB,YAAxB;AACD,KApWkB;;AAAA,UAsWnBhB,YAtWmB,yEAsWJ;AAAA;AAAA;AAAA;AAAA;AAAA;AACb;AACIiB,cAAAA,UAFS,GAEI,CAFJ;AAAA;AAAA,qBAGG/G,OAAO,CAACgH,iBAAR,CAA0B;AAAEhG,gBAAAA,KAAK,EAAE,MAAKN,KAAL,CAAWM;AAApB,eAA1B,CAHH;;AAAA;AAGT4B,cAAAA,GAHS;AAAA;AAAA,qBAIIA,GAAG,CAACC,IAAJ,EAJJ;;AAAA;AAIToE,cAAAA,IAJS;AAKTC,cAAAA,WALS,GAKKD,IAAI,CAACE,IAAL,CAAUC,MAAV,CAAiB,UAAAC,IAAI,EAAI;AACzC,uBAAOA,IAAI,CAACC,UAAZ;AACD,eAFiB,CALL;;AAQb,kBAAIJ,WAAW,CAACK,MAAhB,EAAwB;AACtBR,gBAAAA,UAAU,GAAGG,WAAW,CAACM,MAAZ,CAAmB,UAACC,EAAD,EAAKC,EAAL,EAAY;AAC1C,yBAAOD,EAAE,CAACE,QAAH,CAAYC,KAAZ,GAAoBF,EAAE,CAACC,QAAH,CAAYC,KAAhC,GAAwCH,EAAxC,GAA6CC,EAApD;AACD,iBAFY,EAEVC,QAFU,CAEDC,KAFZ;AAGD;;AAZY;AAAA,qBAcW5H,OAAO,CAC5B6H,aADqB,CACP;AACb7G,gBAAAA,KAAK,EAAE,MAAKN,KAAL,CAAWM,KADL;AAEb4G,gBAAAA,KAAK,EAAE,MAAK3G,KAAL,CAAWE,MAAX,CAAkByG;AAFZ,eADO,EAKrBjF,IALqB,CAKhB,UAAAC,GAAG;AAAA,uBAAIA,GAAG,CAACC,IAAJ,EAAJ;AAAA,eALa,CAdX;;AAAA;AAcPiF,cAAAA,SAdO;;AAAA,kBAqBRA,SArBQ;AAAA;AAAA;AAAA;;AAAA,oBAsBPf,UAAU,GAAG,CAAb,KAAmBgB,MAAM,CAAC,MAAK9G,KAAL,CAAWE,MAAX,CAAkByG,KAAnB,CAtBlB;AAAA;AAAA;AAAA;;AAAA;AAAA,qBAuBH5H,OAAO,CAACgI,kBAAR,CAA2B;AAC/BhH,gBAAAA,KAAK,EAAE,MAAKN,KAAL,CAAWM,KADa;AAE/B4G,gBAAAA,KAAK,EAAE,MAAK3G,KAAL,CAAWE,MAAX,CAAkByG;AAFM,eAA3B,CAvBG;;AAAA;AA2BTxD,cAAAA,MAAM,CAACiB,QAAP,CAAgB4C,MAAhB;AA3BS;AAAA;;AAAA;AA6BT1H,cAAAA,SAAS,CACP,oBAAC,KAAD,CAAO,SAAP;AACE,gBAAA,KAAK,EAAC,mDADR;AAEE,gBAAA,UAAU,EAAC,cAFb;AAGE,gBAAA,YAAY,EAAE;AAAA,yBAAM,MAAKoE,kBAAL,EAAN;AAAA,iBAHhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBADO,CAAT;;AA7BS;AAAA;AAAA;;AAAA;AAsCLuD,cAAAA,QAtCK,GAsCMzE,IAAI,CAACC,KAAL,CAAWoE,SAAS,CAACH,QAAV,CAAmBO,QAA9B,CAtCN;AAuCLC,cAAAA,aAvCK,GAuCW1E,IAAI,CAACC,KAAL,CAAWoE,SAAS,CAACH,QAAV,CAAmB1G,KAA9B,CAvCX;AAwCXhB,cAAAA,YAAY,CAAC+E,mBAAb,CAAiCmD,aAAa,CAAClD,KAA/C,EAAsD,YAAM;AAC1D,sBAAKvE,KAAL,CAAWwE,UAAX,CAAsB;AACpBjE,kBAAAA,KAAK,EAAEkH,aADa;AAEpBhD,kBAAAA,UAAU,EAAE+C;AAFQ,iBAAtB;;AAIA,sBAAK/E,QAAL,CAAc;AAAEiC,kBAAAA,SAAS,EAAE,KAAb;AAAoBgD,kBAAAA,eAAe,EAAEN;AAArC,iBAAd;AACD,eAND;;AAxCW;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAtWI;AAAA,UAwZnBrD,cAxZmB,yEAwZF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qBAEQzE,OAAO,CAACqI,iBAAR,EAFR;;AAAA;AAETC,cAAAA,QAFS;AAAA;AAAA,qBAGSA,QAAQ,CAACzF,IAAT,EAHT;;AAAA;AAGP0F,cAAAA,OAHO;;AAKb,oBAAKC,eAAL,CAAqBD,OAAO,CAACE,IAA7B;;AACAF,cAAAA,OAAO,CAACtH,KAAR,GAAgBwC,IAAI,CAACC,KAAL,CAAW6E,OAAO,CAACtH,KAAnB,CAAhB;AAEAhB,cAAAA,YAAY,CAAC+E,mBAAb,CAAiCuD,OAAO,CAACtH,KAAR,CAAcgE,KAA/C,EAAsD,YAAM;AAC1D,sBAAKvE,KAAL,CAAWwE,UAAX,CAAsBqD,OAAtB;;AACA,sBAAKpF,QAAL,CAAc;AAAEiC,kBAAAA,SAAS,EAAE;AAAb,iBAAd;AACD,eAHD;AARa;AAAA;;AAAA;AAAA;AAAA;AAabQ,cAAAA,OAAO,CAACC,KAAR;;AAba;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAxZE;;AAAA,UAyanB3B,UAzamB,GAyaN,YAAM;AACjBwE,MAAAA,QAAQ,CAAC1E,KAAT,GAAiB,2BAAjB,CADiB,CAEjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAXiB,UAYT5C,GAZS,GAYD,MAAKH,KAAL,CAAWE,MAZV,CAYTC,GAZS;;AAajB,UAAI,MAAKV,KAAL,CAAWM,KAAf,EAAsB;AACpB,YAAII,GAAJ,EAAS;AACP,gBAAKuH,WAAL,CAAiBvH,GAAjB;AACD,SAFD,MAEO;AACL,gBAAK+B,QAAL,CAAc;AAAEyF,YAAAA,oBAAoB,EAAE;AAAxB,WAAd;AACD;AACF,OAND,MAMO;AACL;AACA,YAAI,CAAC,MAAKlI,KAAL,CAAWM,KAAZ,IAAqB,MAAK6H,UAA9B,EAA0C;AACxC,gBAAKC,mBAAL,CAAyB,MAAKD,UAA9B;;AACAhC,UAAAA,YAAY,CAACC,UAAb,CAAwB,YAAxB;AACA;AACD;;AAED,YAAI;AACF,cAAMiC,SAAS,GAAG,IAAIC,eAAJ,CAAoB5E,MAAM,CAACiB,QAAP,CAAgB4D,MAApC,CAAlB;AACA,cAAMJ,UAAU,GAAGE,SAAS,CAACG,GAAV,CAAc,GAAd,CAAnB;;AACA,cAAIL,UAAJ,EAAgB;AACd,kBAAKC,mBAAL,CAAyBD,UAAzB;AACD,WAFD,MAEO;AACL,kBAAK1F,QAAL,CAAc;AAAEyF,cAAAA,oBAAoB,EAAE;AAAxB,aAAd;AACD;AACF,SARD,CAQE,OAAOjD,CAAP,EAAU;AACV,gBAAKxC,QAAL,CAAc;AAAEyF,YAAAA,oBAAoB,EAAE;AAAxB,WAAd;AACD;AACF;AACF,KAhdkB;;AAAA,UAkdnBlE,qBAldmB,yEAkdK;AAAA;AAAA;AAAA;AAAA;AAAA;AAChByE,cAAAA,UADgB,GACH,MAAKlI,KAAL,CAAWE,MAAX,CAAkBgI,UADf;AAAA;AAAA,qBAEDnJ,OAAO,CAACoJ,gBAAR,CAAyB;AAAEhG,gBAAAA,EAAE,EAAE+F;AAAN,eAAzB,CAFC;;AAAA;AAElBb,cAAAA,QAFkB;AAAA;AAAA,qBAGGA,QAAQ,CAACzF,IAAT,EAHH;;AAAA;AAGlBwG,cAAAA,YAHkB;;AAItB,kBAAIA,YAAJ,EAAkB;AAChBA,gBAAAA,YAAY,GAAG5F,IAAI,CAACC,KAAL,CAAW2F,YAAY,CAACpI,KAAxB,CAAf;AAEAhB,gBAAAA,YAAY,CAAC+E,mBAAb,CAAiCqE,YAAY,CAACpE,KAA9C,EAAqD,YAAM;AACzD,sBAAMsD,OAAO,GAAG;AACdtH,oBAAAA,KAAK,EAAEoI,YADO;AAEdZ,oBAAAA,IAAI,EAAE;AAFQ,mBAAhB;;AAIA,wBAAK/H,KAAL,CAAWwE,UAAX,CAAsBqD,OAAtB;;AACA,wBAAKpF,QAAL,CAAc;AAAEiC,oBAAAA,SAAS,EAAE;AAAb,mBAAd;AACD,iBAPD;AAQD;;AAfqB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAldL;;AAAA,UAqfnBkE,gBArfmB,GAqfA,YAAM;AACvB,YAAKnG,QAAL,CAAc;AAAEyF,QAAAA,oBAAoB,EAAE;AAAxB,OAAd;AACD,KAvfkB;;AAAA,UAyfnBW,iBAzfmB,GAyfC,YAAM;AACxB,YAAKpG,QAAL,CAAc;AAAEyF,QAAAA,oBAAoB,EAAE;AAAxB,OAAd;AACD,KA3fkB;;AAAA,UA6fnB3C,iBA7fmB,yEA6fC;AAAA;AAAA;AAAA;AAAA;AAAA;AACZhF,cAAAA,KADY,GACJwC,IAAI,CAACC,KAAL,CAAW,MAAKzC,KAAL,CAAW+E,WAAX,CAAuBjD,SAAvB,CAAiCC,OAAjC,CAAyC/B,KAApD,CADI;AAElBhB,cAAAA,YAAY,CAAC+E,mBAAb,CAAiC/D,KAAK,CAACgE,KAAvC,EAA8C,YAAM;AAClD,sBAAKvE,KAAL,CAAWwE,UAAX,CAAsB;AAAEjE,kBAAAA,KAAK,EAALA;AAAF,iBAAtB;;AACA,sBAAKkC,QAAL,CAAc;AAAEiC,kBAAAA,SAAS,EAAE;AAAb,iBAAd;AACD,eAHD;;AAFkB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KA7fD;;AAAA,UAqgBnBuD,WArgBmB;AAAA,2EAqgBL,kBAAMvH,GAAN;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uBAEWpB,OAAO,CAACwJ,oBAAR,CAA6B;AAAEpI,kBAAAA,GAAG,EAAHA;AAAF,iBAA7B,CAFX;;AAAA;AAENkH,gBAAAA,QAFM;AAAA;AAAA,uBAGYA,QAAQ,CAACzF,IAAT,EAHZ;;AAAA;AAGJ0F,gBAAAA,OAHI;;AAAA,qBAINA,OAJM;AAAA;AAAA;AAAA;;AAAA,sBAMN,MAAKtH,KAAL,CAAWC,QAAX,KAAwBhB,QAAQ,CAAC+B,gBAAjC,IACA,MAAKhB,KAAL,CAAWC,QAAX,KAAwBhB,QAAQ,CAACgC,YAP3B;AAAA;AAAA;AAAA;;AAAA,oBASD,MAAKxB,KAAL,CAAW2C,OATV;AAAA;AAAA;AAAA;;AAUJ,sBAAK3C,KAAL,CAAWG,OAAX,CAAmBC,OAAnB,CAA2B;AAAE2I,kBAAAA,QAAQ,EAAE,MAAMvJ,QAAQ,CAACa;AAA3B,iBAA3B;;AAVI;;AAAA;AAAA;AAAA;;AAAA;AAAA,sBAcNwH,OAAO,CAACvH,KAAR,KAAkB,MAAKN,KAAL,CAAWM,KAA7B,IACA,MAAKC,KAAL,CAAWC,QAAX,KAAwBhB,QAAQ,CAAC4B,OADjC,IAEA,MAAKb,KAAL,CAAWC,QAAX,KAAwBhB,QAAQ,CAACuB,WAhB3B;AAAA;AAAA;AAAA;;AAkBN,sBAAKf,KAAL,CAAWG,OAAX,CAAmBC,OAAnB,CAA2B;AACzB2I,kBAAAA,QAAQ,EAAE,MAAMvJ,QAAQ,CAACa;AADA,iBAA3B;;AAlBM;;AAAA;AAwBR,sBAAKyH,eAAL,CAAqBD,OAAO,CAACE,IAA7B;;AACAF,gBAAAA,OAAO,CAACtH,KAAR,GAAgBwC,IAAI,CAACC,KAAL,CAAW6E,OAAO,CAACtH,KAAnB,CAAhB;AAEAhB,gBAAAA,YAAY,CAAC+E,mBAAb,CAAiCuD,OAAO,CAACtH,KAAR,CAAcgE,KAA/C,EAAsD,YAAM;AAC1D,wBAAKvE,KAAL,CAAWwE,UAAX,CAAsBqD,OAAtB;;AACA,wBAAKpF,QAAL,CAAc;AAAEiC,oBAAAA,SAAS,EAAE;AAAb,mBAAd;AACD,iBAHD;AA3BQ;AAAA;;AAAA;AAgCAyD,gBAAAA,UAhCA,GAgCe,MAAK5H,KAAL,CAAWE,MAhC1B,CAgCA0H,UAhCA;;AAiCR,sBAAKa,0BAAL,CAAgCtI,GAAhC,EAAqCyH,UAArC;;AAjCQ;AAAA;AAAA;;AAAA;AAAA;AAAA;AAoCVjD,gBAAAA,OAAO,CAACC,KAAR;;AApCU;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OArgBK;;AAAA;AAAA;AAAA;AAAA;;AAAA,UA6iBnB2C,eA7iBmB,GA6iBD,UAAAxE,KAAK,EAAI;AACzB0E,MAAAA,QAAQ,CAAC1E,KAAT;AACA,UAAIA,KAAJ,EAAW0E,QAAQ,CAAC1E,KAAT,iBAAwBA,KAAxB;AACZ,KAhjBkB;;AAAA,UAkjBnB0F,0BAljBmB;AAAA,2EAkjBU,kBAAOtI,GAAP,EAAYyH,UAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAErB7H,gBAAAA,KAFqB,GAEb,MAAKN,KAAL,CAAWM,KAFE;;AAI3B,oBAAI,MAAKC,KAAL,CAAW8C,YAAf,EAA6B;AAC3B0E,kBAAAA,IAAI,GAAG,MAAKxH,KAAL,CAAW8C,YAAlB;AACD,iBAFD,MAEO;AACC4F,kBAAAA,UADD,GACcC,MAAM,CAACC,YAAP,CACjBC,IAAI,CAACC,KAAL,CAAWD,IAAI,CAACE,MAAL,KAAgBF,IAAI,CAACC,KAAL,CAAW,EAAX,CAA3B,IAA6C,EAD5B,CADd,EAGF;;AACHtB,kBAAAA,IAAI,GAAG,MAAK/H,KAAL,CAAWyD,IAAX,CAAgB8F,aAAhB,CACL;AAAE7G,oBAAAA,EAAE,EAAE;AAAN,mBADK,EAEL;AAAEuG,oBAAAA,UAAU,EAAEA;AAAd,mBAFK,CAAP;AAID;;AACGxI,gBAAAA,MAfuB,GAed;AAAEC,kBAAAA,GAAG,EAAHA,GAAF;AAAOJ,kBAAAA,KAAK,EAALA,KAAP;AAAcyH,kBAAAA,IAAI,EAAJA;AAAd,iBAfc;;AAgB3B,oBAAI,MAAKxH,KAAL,CAAW6C,YAAf,EAA6B;AAC3B3C,kBAAAA,MAAM,CAACF,KAAP,GAAe,MAAKA,KAAL,CAAW6C,YAA1B;AACD;;AACD,oBAAI+E,UAAJ,EAAgB;AACd1H,kBAAAA,MAAM,CAAC0H,UAAP,GAAoBA,UAApB;AACD;;AArB0B;AAAA;AAAA,uBAuBF7I,OAAO,CAACkK,qBAAR,CAA8B/I,MAA9B,CAvBE;;AAAA;AAuBnBmH,gBAAAA,QAvBmB;AAAA;AAAA,uBAwBHA,QAAQ,CAACzF,IAAT,EAxBG;;AAAA;AAwBnB0F,gBAAAA,OAxBmB;;AAyBzB,sBAAKC,eAAL,CAAqBD,OAAO,CAACE,IAA7B;;AACAF,gBAAAA,OAAO,CAACtH,KAAR,GAAgBwC,IAAI,CAACC,KAAL,CAAW6E,OAAO,CAACtH,KAAnB,CAAhB;AACAsH,gBAAAA,OAAO,CAAC5E,KAAR,GAAgB;AACdwG,kBAAAA,QAAQ,EAAEhK;AADI,iBAAhB;AAIAF,gBAAAA,YAAY,CAAC+E,mBAAb,CAAiCuD,OAAO,CAACtH,KAAR,CAAcgE,KAA/C,EAAsD,YAAM;AAC1D,wBAAKvE,KAAL,CAAWwE,UAAX,CAAsBqD,OAAtB;;AACA,wBAAKpF,QAAL,CAAc;AAAEiC,oBAAAA,SAAS,EAAE;AAAb,mBAAd;AACD,iBAHD;AA/ByB;AAAA;;AAAA;AAAA;AAAA;AAoCzBQ,gBAAAA,OAAO,CAACC,KAAR;;AApCyB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAljBV;;AAAA;AAAA;AAAA;AAAA;;AAAA,UA0lBnBlB,kBA1lBmB,yEA0lBE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qBACI3E,OAAO,CAACqI,iBAAR,EADJ;;AAAA;AACbC,cAAAA,QADa;AAAA;AAAA,qBAEGA,QAAQ,CAACzF,IAAT,EAFH;;AAAA;AAEb0F,cAAAA,OAFa;AAInBA,cAAAA,OAAO,CAACE,IAAR,GAAe,EAAf;;AACA,oBAAKD,eAAL,CAAqBD,OAAO,CAACE,IAA7B;;AACAF,cAAAA,OAAO,CAACtH,KAAR,GAAgBwC,IAAI,CAACC,KAAL,CAAW6E,OAAO,CAACtH,KAAnB,CAAhB;AACAsH,cAAAA,OAAO,CAAC5E,KAAR,GAAgB;AACdwG,gBAAAA,QAAQ,EAAEhK;AADI,eAAhB;AAGAF,cAAAA,YAAY,CAAC+E,mBAAb,CAAiCuD,OAAO,CAACtH,KAAR,CAAcgE,KAA/C,EAAsD,YAAM;AAC1D,sBAAKvE,KAAL,CAAWwE,UAAX,CAAsBqD,OAAtB;;AACA,sBAAKpF,QAAL,CAAc;AAAEiC,kBAAAA,SAAS,EAAE;AAAb,iBAAd;AACD,eAHD;;AAVmB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KA1lBF;;AAAA,UA0mBnB0D,mBA1mBmB;AAAA,2EA0mBG,kBAAMD,UAAN;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uBACG7I,OAAO,CAACoK,yBAAR,CAAkC;AACvDhH,kBAAAA,EAAE,EAAEyF;AADmD,iBAAlC,CADH;;AAAA;AACdP,gBAAAA,QADc;AAAA;AAAA,uBAIEA,QAAQ,CAACzF,IAAT,EAJF;;AAAA;AAId0F,gBAAAA,OAJc;AAMpBA,gBAAAA,OAAO,CAACE,IAAR,GAAe,EAAf;;AACA,sBAAKD,eAAL,CAAqBD,OAAO,CAACE,IAA7B;;AACAF,gBAAAA,OAAO,CAACtH,KAAR,GAAgBwC,IAAI,CAACC,KAAL,CAAW6E,OAAO,CAACtH,KAAnB,CAAhB;AACAsH,gBAAAA,OAAO,CAAC5E,KAAR,GAAgB;AACdwG,kBAAAA,QAAQ,EAAEhK;AADI,iBAAhB;AAGAF,gBAAAA,YAAY,CAAC+E,mBAAb,CAAiCuD,OAAO,CAACtH,KAAR,CAAcgE,KAA/C,EAAsD,YAAM;AAC1D,wBAAKvE,KAAL,CAAWwE,UAAX,CAAsBqD,OAAtB;;AACA,wBAAKpF,QAAL,CAAc;AAAEiC,oBAAAA,SAAS,EAAE;AAAb,mBAAd;AACD,iBAHD;;AAZoB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OA1mBH;;AAAA;AAAA;AAAA;AAAA;;AAAA,UA4nBnBiF,wBA5nBmB,GA4nBQ,UAAAC,YAAY,EAAI;AACzC,YAAKnH,QAAL,CAAc;AAAEmH,QAAAA,YAAY,EAAZA;AAAF,OAAd;AACD,KA9nBkB;;AAAA,UAgoBnBC,kBAhoBmB,GAgoBE,UAAA9B,IAAI,EAAI;AAC3B,UAAM+B,IAAI,GAAG,SAAPA,IAAO,CAAAC,GAAG,EAAI;AAClB,YAAIC,OAAO,GAAGD,GAAG,CAACE,KAAJ,EAAd;;AACA,aAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGF,OAAO,CAACnD,MAA5B,EAAoCqD,CAAC,EAArC,EAAyC;AACvC,cAAInC,IAAI,KAAKiC,OAAO,CAACE,CAAD,CAApB,EAAyB;AACvB,gBAAMC,KAAK,GAAGH,OAAO,CAACE,CAAD,CAArB;AACAF,YAAAA,OAAO,CAACI,MAAR,CAAeF,CAAf,EAAkB,CAAlB;AACAF,YAAAA,OAAO,CAACK,IAAR,CAAaF,KAAb;AACA;AACD;AACF;;AACD,eAAOH,OAAP;AACD,OAXD;;AAaA,YAAKvH,QAAL,CACE,UAAAlC,KAAK,EAAI;AACP,eAAO;AACL+J,UAAAA,aAAa,EAAER,IAAI,CAACvJ,KAAK,CAAC+J,aAAP;AADd,SAAP;AAGD,OALH,EAME,YAAM;AACJnE,QAAAA,YAAY,CAACoE,OAAb,CACE,eADF,EAEExH,IAAI,CAACyH,SAAL,CAAe,MAAKjK,KAAL,CAAW+J,aAA1B,CAFF;AAID,OAXH;AAaD,KA3pBkB;;AAAA,UA6pBnBG,eA7pBmB,GA6pBD,UAAC1C,IAAD,EAAO2C,IAAP,EAAgB;AAChC,YAAK1K,KAAL,CAAW2K,MAAX,qBAAqB5C,IAArB,EAA4B,CAAC,MAAKxH,KAAL,CAAWiF,WAAX,CAAuBuC,IAAvB,CAA7B;;AACA,UAAI,CAAC,MAAKxH,KAAL,CAAWiF,WAAX,CAAuBuC,IAAvB,CAAL,EAAmC;AACjC,YAAIA,IAAI,KAAK,YAAT,IAAyBA,IAAI,KAAK,OAAlC,IAA6CA,IAAI,KAAK,SAA1D,EAAqE;AACnEjI,UAAAA,YAAY,CAAC8K,WAAb,CAAyB;AACvBC,YAAAA,QAAQ,EAAE,SADa;AAEvBC,YAAAA,MAAM,eAFiB;AAGvBC,YAAAA,KAAK,EAAEhD,IAAI,CAAC,CAAD,CAAJ,CAAQiD,WAAR,KAAwBjD,IAAI,CAACkC,KAAL,CAAW,CAAX;AAHR,WAAzB;AAKD;;AAED,YAAIlC,IAAI,KAAK,WAAb,EAA0B;AACxBjI,UAAAA,YAAY,CAAC8K,WAAb,CAAyB;AACvBC,YAAAA,QAAQ,EAAE,SADa;AAEvBC,YAAAA,MAAM,aAFiB;AAGvBC,YAAAA,KAAK,EAAEL;AAHgB,WAAzB;AAKD;AACF;;AACD,YAAKjI,QAAL,CACE,UAAAlC,KAAK,EAAI;AACP,eAAO;AACLiF,UAAAA,WAAW,oBACNjF,KAAK,CAACiF,WADA,sBAERuC,IAFQ,EAED,CAACxH,KAAK,CAACiF,WAAN,CAAkBuC,IAAlB,CAFA;AADN,SAAP;AAMD,OARH,EASE,YAAM;AACJ5B,QAAAA,YAAY,CAACoE,OAAb,CACE,aADF,EAEExH,IAAI,CAACyH,SAAL,mBACK,MAAKjK,KAAL,CAAWiF,WADhB;AAEEyF,UAAAA,GAAG,EAAEC,SAFP;AAGEjE,UAAAA,QAAQ,EAAEiE,SAHZ;AAIEC,UAAAA,IAAI,EAAED;AAJR,WAFF;;AASA,YAAI,MAAK3K,KAAL,CAAWiF,WAAX,CAAuBuC,IAAvB,CAAJ,EAAkC;AAChC,gBAAK8B,kBAAL,CAAwB9B,IAAxB;AACD;AACF,OAtBH;AAwBD,KAxsBkB;;AAAA,UA0sBnBqD,SA1sBmB,GA0sBP,UAAAC,YAAY,EAAI;AAC1B,YAAK5I,QAAL,CAAc;AAAE4I,QAAAA,YAAY,EAAZA;AAAF,OAAd;AACD,KA5sBkB;;AAAA,UA6sBnBC,UA7sBmB,GA6sBN,UAAAC,YAAY,EAAI;AAC3B,YAAK9I,QAAL,CAAc;AAAE8I,QAAAA,YAAY,EAAZA;AAAF,OAAd;AACD,KA/sBkB;;AAAA,UAitBnBC,gBAjtBmB,GAitBA,UAAAC,GAAG,EAAI;AACxB,YAAKhJ,QAAL,CAAc;AAAEiJ,QAAAA,aAAa,EAAED;AAAjB,OAAd;AACD,KAntBkB;;AAEjB,QAAIjG,WAAW,GAAGzC,IAAI,CAACC,KAAL,CAAWmD,YAAY,CAACwF,OAAb,CAAqB,aAArB,CAAX,CAAlB;;AACA,QAAI,CAACnG,WAAL,EAAkB;AAChBA,MAAAA,WAAW,GAAG;AACZvC,QAAAA,KAAK,EAAE,KADK;AAEZwC,QAAAA,OAAO,EAAE,KAFG;AAGZC,QAAAA,GAAG,EAAE,KAHO;AAIZC,QAAAA,IAAI,EAAE,KAJM;AAKZC,QAAAA,QAAQ,EAAE,KALE;AAMZC,QAAAA,SAAS,EAAE,KANC;AAOZC,QAAAA,OAAO,EAAE,KAPG;AAQZC,QAAAA,QAAQ,EAAE,KARE;AASZxB,QAAAA,KAAK,EAAE,KATK;AAUZyB,QAAAA,SAAS,EAAE,KAVC;AAWZC,QAAAA,GAAG,EAAE;AAXO,OAAd;AAaD;;AACDT,IAAAA,WAAW,qBACNA,WADM;AAETyF,MAAAA,GAAG,EAAEjL,KAAK,CAAC2E,QAAN,CAAeC,IAAf,CAAoBC,KAApB,CAA0B,GAA1B,EAA+B,CAA/B,MAAsCrF,QAAQ,CAACkC,GAF3C;AAGTkK,MAAAA,SAAS,EACP5L,KAAK,CAAC2E,QAAN,CAAeC,IAAf,CAAoBC,KAApB,CAA0B,GAA1B,EAA+B,CAA/B,MAAsCrF,QAAQ,CAACmC,IAA/C,IACA3B,KAAK,CAAC2E,QAAN,CAAeC,IAAf,CAAoBC,KAApB,CAA0B,GAA1B,EAA+B,CAA/B,MAAsCrF,QAAQ,CAACsF,KALxC;AAMT+G,MAAAA,MAAM,EACJ7L,KAAK,CAAC2E,QAAN,CAAeC,IAAf,CAAoBC,KAApB,CAA0B,GAA1B,EAA+B,CAA/B,MAAsCrF,QAAQ,CAACmC,IAA/C,IACA3B,KAAK,CAAC2E,QAAN,CAAeC,IAAf,CAAoBC,KAApB,CAA0B,GAA1B,EAA+B,CAA/B,MAAsCrF,QAAQ,CAACwF,EARxC;AASTiC,MAAAA,QAAQ,EAAEjH,KAAK,CAAC2E,QAAN,CAAeC,IAAf,CAAoBC,KAApB,CAA0B,GAA1B,EAA+B,CAA/B,MAAsCrF,QAAQ,CAACoC,QAThD;AAUTuJ,MAAAA,IAAI,EAAEnL,KAAK,CAAC2E,QAAN,CAAeC,IAAf,CAAoBC,KAApB,CAA0B,GAA1B,EAA+B,CAA/B,MAAsCrF,QAAQ,CAAC4B,OAV5C;AAWT0K,MAAAA,OAAO,EAAE9L,KAAK,CAAC2E,QAAN,CAAeC,IAAf,CAAoBC,KAApB,CAA0B,GAA1B,EAA+B,CAA/B,MAAsCrF,QAAQ,CAACuB,WAX/C;AAYTgL,MAAAA,UAAU,EAAE/L,KAAK,CAAC2E,QAAN,CAAeC,IAAf,CAAoBC,KAApB,CAA0B,GAA1B,EAA+B,CAA/B,MAAsCrF,QAAQ,CAAC6B;AAZlD,MAAX;AAeA,QAAIiJ,aAAa,GAAGvH,IAAI,CAACC,KAAL,CAAWmD,YAAY,CAACwF,OAAb,CAAqB,eAArB,CAAX,CAApB;;AACA,QAAI,CAACrB,aAAD,IAAkB,CAACA,aAAa,CAAC0B,QAAd,CAAuB,SAAvB,CAAvB,EAA0D;AACxD1B,MAAAA,aAAa,GAAG,CACd,KADc,EAEd,WAFc,EAGd,QAHc,EAId,UAJc,EAKd,MALc,EAMd,OANc,EAOd,SAPc,EAQd,KARc,EASd,MATc,EAUd,UAVc,EAWd,WAXc,EAYd,SAZc,EAad,UAbc,EAcd,OAdc,EAed,WAfc,EAgBd,KAhBc,CAAhB;AAkBD;;AAED,UAAKnC,UAAL,GAAkBhC,YAAY,CAACwF,OAAb,CAAqB,YAArB,CAAlB;AAEA,UAAKzK,MAAL,GAAc,IAAd;AAEA,UAAKX,KAAL,GAAa;AACXmE,MAAAA,SAAS,EAAE,IADA;AAEXwD,MAAAA,oBAAoB,EAAE,KAFX;AAGXzH,MAAAA,MAAM,EAAET,KAAK,CAAC2E,QAAN,CAAelE,MAHZ;AAIXD,MAAAA,QAAQ,EAAER,KAAK,CAAC2E,QAAN,CAAeC,IAAf,CAAoBC,KAApB,CAA0B,GAA1B,EAA+B,CAA/B,CAJC;AAKXW,MAAAA,WAAW,EAAXA,WALW;AAMX8E,MAAAA,aAAa,EAAbA,aANW;AAOX5C,MAAAA,eAAe,EAAEwD,SAPN;AAQXQ,MAAAA,aAAa,EAAER;AARJ,KAAb;;AAWA,YAAQ,MAAK3K,KAAL,CAAWC,QAAnB;AACE,WAAKhB,QAAQ,CAAC4B,OAAd;AACE,cAAKb,KAAL,CAAWM,aAAX,GAA2B,IAA3B;AACA,cAAKN,KAAL,CAAWW,MAAX,GAAoB,IAApB;AACA,cAAKX,KAAL,CAAWoC,OAAX,GAAqB,IAArB;AACA,cAAKpC,KAAL,CAAWqC,YAAX,GAA0B,IAA1B;AACA,cAAKrC,KAAL,CAAWsC,UAAX,GAAwB,IAAxB;AACA,cAAKtC,KAAL,CAAWgD,WAAX,GAAyB,IAAzB;AACA;;AACF,WAAK/D,QAAQ,CAACuB,WAAd;AACA,WAAKvB,QAAQ,CAAC6B,WAAd;AACE,cAAKd,KAAL,CAAWM,aAAX,GAA2B,IAA3B;AACA,cAAKN,KAAL,CAAWW,MAAX,GAAoB,IAApB;AACA,cAAKX,KAAL,CAAWoC,OAAX,GAAqB,IAArB;AACA,cAAKpC,KAAL,CAAWqC,YAAX,GAA0B,IAA1B;AACA,cAAKrC,KAAL,CAAWsC,UAAX,GAAwB,IAAxB;AACA,cAAKtC,KAAL,CAAWgD,WAAX,GAAyB,IAAzB;AACA;;AACF,WAAK/D,QAAQ,CAACqC,aAAd;AACE,cAAKtB,KAAL,CAAWM,aAAX,GAA2B,MAAKN,KAAL,CAAWE,MAAX,CAAkBI,aAA7C;AACA;;AACF;AACE;AAtBJ;;AAyBA,UAAKX,IAAL,GAAYR,QAAQ,EAApB;AA/FiB;AAgGlB;;;;WAoYD,4BAAmBuM,SAAnB,EAA8BC,SAA9B,EAAyC;AACvC,UAAID,SAAS,CAAC3L,KAAV,IAAmB,CAAC,KAAKN,KAAL,CAAWM,KAAnC,EAA0C;AACxC,aAAKN,KAAL,CAAWG,OAAX,CAAmBC,OAAnB,CAA2B;AAAE2I,UAAAA,QAAQ,EAAE,MAAMvJ,QAAQ,CAACa;AAA3B,SAA3B;AACAqD,QAAAA,MAAM,CAACiB,QAAP,CAAgB4C,MAAhB;AACD,OAHD,MAGO,IACL,CAAC0E,SAAS,CAAC3L,KAAX,IACA,KAAKN,KAAL,CAAWM,KADX,IAEA,KAAKC,KAAL,CAAWC,QAAX,KAAwBhB,QAAQ,CAACkC,GAFjC,IAGA,KAAKnB,KAAL,CAAWC,QAAX,KAAwBhB,QAAQ,CAAC2M,SAHjC,IAIA,KAAK5L,KAAL,CAAWC,QAAX,KAAwBhB,QAAQ,CAAC4M,MAJjC,IAKA,KAAK7L,KAAL,CAAWC,QAAX,KAAwBhB,QAAQ,CAACmC,IAN5B,EAOL;AACA,aAAK3B,KAAL,CAAWG,OAAX,CAAmBC,OAAnB,CAA2B;AAAE2I,UAAAA,QAAQ,EAAE,MAAMvJ,QAAQ,CAACa;AAA3B,SAA3B;AACAqD,QAAAA,MAAM,CAACiB,QAAP,CAAgB4C,MAAhB;AACD;AACF;;;WAkOD,kBAAS;AAAA,wBACuC,KAAKvH,KAD5C;AAAA,UACCqM,UADD,eACCA,UADD;AAAA,UACa1H,QADb,eACaA,QADb;AAAA,UACuBrE,KADvB,eACuBA,KADvB;AAAA,UAC8ByH,IAD9B,eAC8BA,IAD9B;AAAA,yBAqBH,KAAKxH,KArBF;AAAA,UAGLC,QAHK,gBAGLA,QAHK;AAAA,UAILU,MAJK,gBAILA,MAJK;AAAA,UAKLL,aALK,gBAKLA,aALK;AAAA,UAML8B,OANK,gBAMLA,OANK;AAAA,UAOL+B,SAPK,gBAOLA,SAPK;AAAA,UAQL7B,UARK,gBAQLA,UARK;AAAA,UASLD,YATK,gBASLA,YATK;AAAA,UAULE,aAVK,gBAULA,aAVK;AAAA,UAWLI,aAXK,gBAWLA,aAXK;AAAA,UAYLoC,WAZK,gBAYLA,WAZK;AAAA,UAaL4C,oBAbK,gBAaLA,oBAbK;AAAA,UAcLmD,YAdK,gBAcLA,YAdK;AAAA,UAeLE,YAfK,gBAeLA,YAfK;AAAA,UAgBL/F,WAhBK,gBAgBLA,WAhBK;AAAA,UAiBL8E,aAjBK,gBAiBLA,aAjBK;AAAA,UAkBL5C,eAlBK,gBAkBLA,eAlBK;AAAA,UAmBLnE,WAnBK,gBAmBLA,WAnBK;AAAA,UAoBLmI,aApBK,gBAoBLA,aApBK;AAAA,UAsBChL,GAtBD,GAsBS,KAAKH,KAAL,CAAWE,MAtBpB,CAsBCC,GAtBD;AAAA,UAwBLR,IAxBK,GAgCH,IAhCG,CAwBLA,IAxBK;AAAA,UAyBL0I,gBAzBK,GAgCH,IAhCG,CAyBLA,gBAzBK;AAAA,UA0BLC,iBA1BK,GAgCH,IAhCG,CA0BLA,iBA1BK;AAAA,UA2BLyC,UA3BK,GAgCH,IAhCG,CA2BLA,UA3BK;AAAA,UA4BLzB,kBA5BK,GAgCH,IAhCG,CA4BLA,kBA5BK;AAAA,UA6BLY,eA7BK,GAgCH,IAhCG,CA6BLA,eA7BK;AAAA,UA8BLW,SA9BK,GAgCH,IAhCG,CA8BLA,SA9BK;AAAA,UA+BLI,gBA/BK,GAgCH,IAhCG,CA+BLA,gBA/BK;AAkCP,aACE,oBAAC,WAAD;AAAa,QAAA,OAAO,EAAEvM,YAAtB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE,oBAAC,IAAD;AACE,QAAA,UAAU,EAAEoN,UADd;AAEE,QAAA,QAAQ,EAAE1H,QAFZ;AAGE,QAAA,QAAQ,EAAEnE,QAHZ;AAIE,QAAA,MAAM,EAAEU,MAJV;AAKE,QAAA,aAAa,EAAEL,aALjB;AAME,QAAA,OAAO,EAAE8B,OANX;AAOE,QAAA,SAAS,EAAE+B,SAPb;AAQE,QAAA,IAAI,EAAExE,IARR;AASE,QAAA,UAAU,EAAE2C,UATd;AAUE,QAAA,YAAY,EAAED,YAVhB;AAWE,QAAA,aAAa,EAAEE,aAXjB;AAYE,QAAA,aAAa,EAAEI,aAZjB;AAaE,QAAA,GAAG,EAAExC,GAbP;AAcE,QAAA,WAAW,EAAE4E,WAdf;AAeE,QAAA,oBAAoB,EAAE4C,oBAfxB;AAgBE,QAAA,gBAAgB,EAAEU,gBAhBpB;AAiBE,QAAA,iBAAiB,EAAEC,iBAjBrB;AAkBE,QAAA,YAAY,EAAEwC,YAlBhB;AAmBE,QAAA,SAAS,EAAED,SAnBb;AAoBE,QAAA,YAAY,EAAEG,YApBhB;AAqBE,QAAA,UAAU,EAAED,UArBd;AAsBE,QAAA,WAAW,EAAE9F,WAtBf;AAuBE,QAAA,aAAa,EAAE8E,aAvBjB;AAwBE,QAAA,kBAAkB,EAAET,kBAxBtB;AAyBE,QAAA,eAAe,EAAEY,eAzBnB;AA0BE,QAAA,eAAe,EAAE/C,eA1BnB;AA2BE,QAAA,WAAW,EAAEnE,WA3Bf;AA4BE,QAAA,aAAa,EAAEmI,aA5BjB;AA6BE,QAAA,gBAAgB,EAAEF,gBA7BpB;AA8BE,QAAA,KAAK,EAAElL,KA9BT;AA+BE,QAAA,IAAI,EAAEyH,IA/BR;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QADF,CADF;AAqCD;;;;EA7xBqBlJ,S;;AAgyBxB,eAAeC,OAAO,CACpB,UAAAyB,KAAK;AAAA,SAAK;AACRD,IAAAA,KAAK,EAAEC,KAAK,CAAC+L,QAAN,CAAehM,KADd;AAERyH,IAAAA,IAAI,EAAExH,KAAK,CAAC+L,QAAN,CAAevE,IAFb;AAGRpF,IAAAA,OAAO,EAAEpC,KAAK,CAAC+L,QAAN,CAAe3J,OAHhB;AAIR0J,IAAAA,UAAU,EAAE9L,KAAK,CAACuF,OAAN,CAAcuG;AAJlB,GAAL;AAAA,CADe,EAOpB;AACE7H,EAAAA,UAAU,EAAEtF,cAAc,CAACsF,UAD7B;AAEE+H,EAAAA,YAAY,EAAErN,cAAc,CAACqN,YAF/B;AAGEC,EAAAA,aAAa,EAAErN,cAAc,CAACqN,aAHhC;AAIE7B,EAAAA,MAAM,EAAEvL,aAAa,CAACuL,MAJxB;AAKEnI,EAAAA,WAAW,EAAEnD,YAAY,CAACmD;AAL5B,CAPoB,CAAP,CAcbzD,UAAU,CAACgB,SAAD,CAdG,CAAf","sourcesContent":["import React, { Component } from \"react\";\nimport { connect } from \"react-redux\";\nimport { injectIntl } from \"react-intl\";\nimport { DndProvider } from \"react-dnd\";\nimport { HTML5Backend } from \"react-dnd-html5-backend\";\nimport \"react-toastify/dist/ReactToastify.css\";\nimport * as projectActions from \"./Store/Reducer/project\";\nimport * as previewActions from \"./Store/Reducer/preview\";\nimport * as webrtcActions from \"./Store/Reducer/webrtc\";\nimport * as videoActions from \"./Store/Reducer/video\";\nimport * as request from \"../../Common/Util/HTTPRequest\";\nimport AssetLibrary from \"./utils/assetLibrary\";\nimport { PAGETYPE, DEFAULT_VIDEO_URL } from \"../../Common/Util/Constant\";\nimport { detectIE } from \"../../Common/Util/detectBrowser\";\nimport View from \"./View\";\nimport Popup, { showPopUp } from \"../../Common/Component/PopUp\";\nimport * as TrackingUtil from \"../../Common/Util/TrackingUtil\";\n\nclass Container extends Component {\n  constructor(props) {\n    super(props);\n    let popupStates = JSON.parse(localStorage.getItem(\"popupStates\"));\n    if (!popupStates) {\n      popupStates = {\n        video: false,\n        snippet: false,\n        api: false,\n        chat: false,\n        property: false,\n        spriteBox: false,\n        preview: false,\n        soundBox: false,\n        scene: false,\n        animation: false,\n        qna: false\n      };\n    }\n    popupStates = {\n      ...popupStates,\n      ocp: props.location.path.split(\"/\")[1] === PAGETYPE.OCP,\n      ocp2block:\n        props.location.path.split(\"/\")[1] === PAGETYPE.OCP2 &&\n        props.location.path.split(\"/\")[2] === PAGETYPE.BLOCK,\n      ocp2js:\n        props.location.path.split(\"/\")[1] === PAGETYPE.OCP2 &&\n        props.location.path.split(\"/\")[2] === PAGETYPE.JS,\n      tutorial: props.location.path.split(\"/\")[1] === PAGETYPE.TUTORIAL,\n      live: props.location.path.split(\"/\")[1] === PAGETYPE.WIZLIVE,\n      live1v4: props.location.path.split(\"/\")[1] === PAGETYPE.WIZLIVE_1V4,\n      monitor1v4: props.location.path.split(\"/\")[1] === PAGETYPE.MONITOR_1V4\n    };\n\n    let popupZIndexes = JSON.parse(localStorage.getItem(\"popupZIndexes\"));\n    if (!popupZIndexes || !popupZIndexes.includes(\"snippet\")) {\n      popupZIndexes = [\n        \"ocp\",\n        \"ocp2block\",\n        \"ocp2js\",\n        \"tutorial\",\n        \"live\",\n        \"video\",\n        \"snippet\",\n        \"api\",\n        \"chat\",\n        \"property\",\n        \"spriteBox\",\n        \"preview\",\n        \"soundBox\",\n        \"scene\",\n        \"animation\",\n        \"qna\"\n      ];\n    }\n\n    this.templateId = localStorage.getItem(\"templateId\");\n\n    this.roomId = null;\n\n    this.state = {\n      isLoading: true,\n      isProjectPopupOpened: false,\n      params: props.location.params,\n      pageType: props.location.path.split(\"/\")[1],\n      popupStates,\n      popupZIndexes,\n      currentTutorial: undefined,\n      videoclassRef: undefined\n    };\n\n    switch (this.state.pageType) {\n      case PAGETYPE.WIZLIVE:\n        this.state.reservationId = null;\n        this.state.roomId = null;\n        this.state.isTutor = null;\n        this.state.studentEmail = null;\n        this.state.tutorEmail = null;\n        this.state.isFreeTrial = null;\n        break;\n      case PAGETYPE.WIZLIVE_1V4:\n      case PAGETYPE.MONITOR_1V4:\n        this.state.reservationId = null;\n        this.state.roomId = null;\n        this.state.isTutor = null;\n        this.state.studentEmail = null;\n        this.state.tutorEmail = null;\n        this.state.isFreeTrial = null;\n        break;\n      case PAGETYPE.RECORD_PLAYER:\n        this.state.reservationId = this.state.params.reservationId;\n        break;\n      default:\n        break;\n    }\n\n    this.isIE = detectIE();\n  }\n\n  componentDidMount = async () => {\n    try {\n      if (this.isIE) {\n        this.props.history.replace(\"/\" + PAGETYPE.BUILDER);\n        return;\n      }\n\n      let { email } = this.props;\n      const { pageType, params } = this.state;\n      const { pId, step, grade, reservationId, type } = params;\n\n      if (pageType === PAGETYPE.WIZLIVE_1V4) {\n        const regexRoomId = /(\\w+)-(\\w+)-(\\w+)-(\\w+)-(\\w+)-(?<roomId>\\w+)/;\n\n        const {\n          groups: { roomId }\n        } = regexRoomId.exec(pId);\n\n        this.roomId = roomId;\n      }\n\n      // this.timer = setInterval(() => {\n      //   request.updateBuilderUsageTime({\n      //     email: this.props.email,\n      //     time: new Date().getTime()\n      //   });\n      // }, 1000);\n\n      // TrackingUtil.sendPageEvent(\"/\" + pageType, this.props.email);\n\n      switch (pageType) {\n        case PAGETYPE.WIZLIVE:\n          const wizLiveRoom = await request\n            .getWizLiveRoomId({ email })\n            .then(res => res.json());\n          if (wizLiveRoom && wizLiveRoom.roomId) {\n            wizLiveRoom.myLecture.lecture.guideVideo &&\n              this.props.setVideoURL(wizLiveRoom.myLecture.lecture.guideVideo);\n            this.setState(\n              {\n                reservationId: wizLiveRoom.id,\n                roomId: wizLiveRoom.roomId,\n                isTutor: wizLiveRoom.isTutor,\n                studentEmail: wizLiveRoom.studentEmail,\n                tutorEmail: wizLiveRoom.tutorEmail,\n                lectureVideos: JSON.parse(wizLiveRoom.myLecture.lecture.video),\n                lectureSlides: JSON.parse(wizLiveRoom.myLecture.lecture.slides),\n                lectureState: wizLiveRoom.myLecture.lecture.state,\n                lectureTitle: wizLiveRoom.myLecture.lecture.title,\n                isFreeTrial: wizLiveRoom.isFreeTrial\n              },\n              () => {\n                this.loadWizlab();\n              }\n            );\n          } else {\n            showPopUp(\n              <Popup.OneButton\n                intl={this.props.intl}\n                titleId=\"ID_BUILDER_ALERT_MSG_CLIVE_NOT_FOUND\"\n                buttonNameId=\"ID_BUILDER_ALERT_CONFIRMBTN\"\n                buttonAction={() => {\n                  if (pId)\n                    this.props.history.replace(`/${PAGETYPE.BUILDER}/${pId}`);\n                  else this.props.history.replace(\"/\" + PAGETYPE.WIZLIVE);\n                }}\n              />\n            );\n          }\n          break;\n        case PAGETYPE.MONITOR_1V4:\n        case PAGETYPE.WIZLIVE_1V4:\n          let wizLive1v4Room;\n\n          if (pageType === PAGETYPE.MONITOR_1V4) {\n            email = window.prompt(\n              \"튜터의 이메일을 입력해주세요\",\n              \"johnjs@wizschool.io\"\n            );\n\n            wizLive1v4Room = await request\n              .getMonitorRoom1v4({ email })\n              .then(res => res.json());\n          } else {\n            // WIZLIVE_1v4\n            wizLive1v4Room = await request\n              .getWizLive1v4RoomId({ email, roomId: this.roomId })\n              .then(res => res.json());\n          }\n\n          if (wizLive1v4Room && wizLive1v4Room.roomId) {\n            // wizLiveRoom.myLecture.lecture.guideVideo &&\n            //   this.props.setVideoURL(wizLiveRoom.myLecture.lecture.guideVideo);\n            this.setState(\n              {\n                reservationId: wizLive1v4Room.id,\n                roomId: wizLive1v4Room.roomId,\n                isTutor:\n                  pageType === PAGETYPE.MONITOR_1V4\n                    ? false\n                    : wizLive1v4Room.isTutor,\n                studentEmail: wizLive1v4Room.studentEmail,\n                tutorEmail: wizLive1v4Room.tutorEmail,\n                lectureVideos: JSON.parse(\n                  wizLive1v4Room.myLecture.lecture.video\n                ),\n                lectureSlides: JSON.parse(\n                  wizLive1v4Room.myLecture.lecture.slides\n                ),\n                lectureState: wizLive1v4Room.myLecture.lecture.state,\n                lectureTitle: wizLive1v4Room.myLecture.lecture.title,\n                isFreeTrial: wizLive1v4Room.isFreeTrial\n              },\n              () => {\n                if (pageType === PAGETYPE.WIZLIVE_1V4) {\n                  this.loadWizlab();\n                } else if (pageType === PAGETYPE.MONITOR_1V4) {\n                  this.defaultMonitor();\n                }\n              }\n            );\n          } else {\n            showPopUp(\n              <Popup.OneButton\n                intl={this.props.intl}\n                titleId=\"ID_BUILDER_ALERT_MSG_CLIVE_NOT_FOUND\"\n                buttonNameId=\"ID_BUILDER_ALERT_CONFIRMBTN\"\n                buttonAction={() => {\n                  if (pId)\n                    this.props.history.replace(`/${PAGETYPE.BUILDER}/${pId}`);\n                  else this.props.history.replace(\"/\" + PAGETYPE.WIZLIVE);\n                }}\n              />\n            );\n          }\n          break;\n        case PAGETYPE.BUILDER:\n          this.loadWizlab();\n          break;\n        case PAGETYPE.BUILDER_EDIT:\n          this.loadWizlab();\n          break;\n        case PAGETYPE.BUILDER_READONLY:\n          showPopUp(\n            <Popup.OneButton\n              intl={this.props.intl}\n              titleId=\"ID_BUILDER_ALERT_MSG_READONLY\"\n              buttonNameId=\"ID_BUILDER_ALERT_CONFIRMBTN\"\n            />\n          );\n          this.loadWizlab();\n          break;\n        case PAGETYPE.QNA_READONLY:\n          showPopUp(\n            <Popup.OneButton\n              intl={this.props.intl}\n              titleId=\"ID_BUILDER_ALERT_MSG_READONLY\"\n              buttonNameId=\"ID_BUILDER_ALERT_CONFIRMBTN\"\n            />\n          );\n          this.loadWizlabForQuestion();\n          break;\n        case PAGETYPE.VIDEOCLASS:\n          this.loadDefaultProject();\n          break;\n        case PAGETYPE.OCP:\n          const stage = require(`./utils/ocp/${grade}/stages/${\n            step > 10 ? 10 : step\n          }`);\n          let ocpClass = stage.data;\n          ocpClass.state = stage.state;\n          AssetLibrary.loadAssetsFromScene(ocpClass.state.scene, () => {\n            this.props.setProject({\n              state: ocpClass.state,\n              videoclass: ocpClass\n            });\n            this.setState({ isLoading: false });\n          });\n          break;\n        case PAGETYPE.OCP2:\n          try {\n            let ocp2Template;\n            if (this.props.location.path.split(\"/\")[2] === PAGETYPE.BLOCK) {\n              ocp2Template = require(`./Component/OCP2/template/block/${grade}/${step}`);\n            } else if (this.props.location.path.split(\"/\")[2] === PAGETYPE.JS) {\n              ocp2Template = require(`./Component/OCP2/template/${type}/${grade}/${step}`);\n            }\n            AssetLibrary.loadAssetsFromScene(ocp2Template.state.scene, () => {\n              this.props.setProject({\n                state: ocp2Template.state,\n                videoclass: ocp2Template.data\n              });\n              this.setState({ isLoading: false });\n            });\n          } catch (e) {\n            console.error(e);\n            showPopUp(\n              <Popup.OneButton\n                title=\"수업정보가 올바르지 않습니다\"\n                buttonName=\"확인\"\n              />\n            );\n          }\n          break;\n        case PAGETYPE.TUTORIAL:\n          if (!this.props.email) {\n            showPopUp(\n              <Popup.OneButton\n                title=\"로그인 후 이용해주세요\"\n                buttonName=\"확인\"\n              />\n            );\n            this.loadDefaultProject();\n            return;\n          }\n          this.loadTutorial();\n          break;\n        case PAGETYPE.RECORD_PLAYER:\n          const reservation = await request\n            .getReservationById({ reservationId })\n            .then(res => res.json());\n          this.setState({ reservation: reservation.reservation }, () => {\n            this.loadRecordProject();\n          });\n          break;\n        case PAGETYPE.MONITOR:\n          this.defaultMonitor();\n          break;\n        case PAGETYPE.DREAMCLASS:\n          this.setState({ \n            isLoading: false, \n            popupStates: {\n              video: false,\n              snippet: false,\n              api: false,\n              chat: false,\n              property: false,\n              spriteBox: false,\n              preview: false,\n              soundBox: false,\n              scene: false,\n              animation: false,\n              qna: false\n            } \n          });\n          break;\n        default:\n          this.loadWizlab();\n          break;\n      }\n    } catch (err) {\n      console.error(err);\n    }\n  };\n\n  componentWillUnmount = () => {\n    // this.timer && clearInterval(this.timer);\n    localStorage.removeItem(\"templateId\");\n  };\n\n  loadTutorial = async () => {\n    /** load & valid check */\n    let myLevelInx = 0;\n    let res = await request.getMyTutorialList({ email: this.props.email });\n    let list = await res.json();\n    let completeArr = list.rows.filter(item => {\n      return item.isComplete;\n    });\n    if (completeArr.length) {\n      myLevelInx = completeArr.reduce((pv, cv) => {\n        return pv.tutorial.level > cv.tutorial.level ? pv : cv;\n      }).tutorial.level;\n    }\n\n    const levelItem = await request\n      .getMyTutorial({\n        email: this.props.email,\n        level: this.state.params.level\n      })\n      .then(res => res.json());\n\n    if (!levelItem) {\n      if (myLevelInx + 1 === Number(this.state.params.level)) {\n        await request.createTutorialItem({\n          email: this.props.email,\n          level: this.state.params.level\n        });\n        window.location.reload();\n      } else {\n        showPopUp(\n          <Popup.OneButton\n            title=\"잘못된 경로입니다\"\n            buttonName=\"확인\"\n            buttonAction={() => this.loadDefaultProject()}\n          />\n        );\n      }\n    } else {\n      const template = JSON.parse(levelItem.tutorial.template);\n      const tutorialState = JSON.parse(levelItem.tutorial.state);\n      AssetLibrary.loadAssetsFromScene(tutorialState.scene, () => {\n        this.props.setProject({\n          state: tutorialState,\n          videoclass: template\n        });\n        this.setState({ isLoading: false, currentTutorial: levelItem });\n      });\n    }\n  };\n\n  defaultMonitor = async () => {\n    try {\n      let response = await request.getDefaultProject();\n      const project = await response.json();\n\n      this.setBrowserTitle(project.name);\n      project.state = JSON.parse(project.state);\n\n      AssetLibrary.loadAssetsFromScene(project.state.scene, () => {\n        this.props.setProject(project);\n        this.setState({ isLoading: false });\n      });\n    } catch (e) {\n      console.error(e);\n    }\n  };\n\n  loadWizlab = () => {\n    document.title = \"Dreamclass - Coding Party\";\n    // const { pId } = this.state.params;\n    // if (pId) {\n    //   if (this.props.email) {\n    //     this.loadProject(pId);\n    //   } else {\n    //     this.handleDefaultCase();\n    //   }\n    // } else {\n    //   this.handleDefaultCase();\n    // }\n    const { pId } = this.state.params;\n    if (this.props.email) {\n      if (pId) {\n        this.loadProject(pId);\n      } else {\n        this.setState({ isProjectPopupOpened: true });\n      }\n    } else {\n      // this.handleDefaultCase();\n      if (!this.props.email && this.templateId) {\n        this.loadTemplateProject(this.templateId);\n        localStorage.removeItem(\"templateId\");\n        return;\n      }\n\n      try {\n        const urlParams = new URLSearchParams(window.location.search);\n        const templateId = urlParams.get(\"t\");\n        if (templateId) {\n          this.loadTemplateProject(templateId);\n        } else {\n          this.setState({ isProjectPopupOpened: true });\n        }\n      } catch (e) {\n        this.setState({ isProjectPopupOpened: false });\n      }\n    }\n  };\n\n  loadWizlabForQuestion = async () => {\n    const questionId = this.state.params.questionId;\n    let response = await request.getQuestionState({ id: questionId });\n    let projectState = await response.json();\n    if (projectState) {\n      projectState = JSON.parse(projectState.state);\n\n      AssetLibrary.loadAssetsFromScene(projectState.scene, () => {\n        const project = {\n          state: projectState,\n          name: \"\"\n        };\n        this.props.setProject(project);\n        this.setState({ isLoading: false });\n      });\n    }\n  };\n\n  componentDidUpdate(prevProps, prevState) {\n    if (prevProps.email && !this.props.email) {\n      this.props.history.replace({ pathname: \"/\" + PAGETYPE.BUILDER });\n      window.location.reload();\n    } else if (\n      !prevProps.email &&\n      this.props.email &&\n      this.state.pageType !== PAGETYPE.OCP &&\n      this.state.pageType !== PAGETYPE.OCP2BLOCK &&\n      this.state.pageType !== PAGETYPE.OCP2JS &&\n      this.state.pageType !== PAGETYPE.OCP2\n    ) {\n      this.props.history.replace({ pathname: \"/\" + PAGETYPE.BUILDER });\n      window.location.reload();\n    }\n  }\n\n  openProjectPopup = () => {\n    this.setState({ isProjectPopupOpened: true });\n  };\n\n  closeProjectPopup = () => {\n    this.setState({ isProjectPopupOpened: false });\n  };\n\n  loadRecordProject = async () => {\n    const state = JSON.parse(this.state.reservation.myLecture.lecture.state);\n    AssetLibrary.loadAssetsFromScene(state.scene, () => {\n      this.props.setProject({ state });\n      this.setState({ isLoading: false });\n    });\n  };\n\n  loadProject = async pId => {\n    try {\n      let response = await request.getDevelopingProject({ pId });\n      const project = await response.json();\n      if (project) {\n        if (\n          this.state.pageType === PAGETYPE.BUILDER_READONLY ||\n          this.state.pageType === PAGETYPE.QNA_READONLY\n        ) {\n          if (!this.props.isTutor) {\n            this.props.history.replace({ pathname: \"/\" + PAGETYPE.BUILDER });\n            return;\n          }\n        } else if (\n          project.email !== this.props.email &&\n          this.state.pageType !== PAGETYPE.WIZLIVE &&\n          this.state.pageType !== PAGETYPE.WIZLIVE_1V4\n        ) {\n          this.props.history.replace({\n            pathname: \"/\" + PAGETYPE.BUILDER\n          });\n          return;\n        }\n\n        this.setBrowserTitle(project.name);\n        project.state = JSON.parse(project.state);\n\n        AssetLibrary.loadAssetsFromScene(project.state.scene, () => {\n          this.props.setProject(project);\n          this.setState({ isLoading: false });\n        });\n      } else {\n        const { templateId } = this.state.params;\n        this.createNewProjectFromServer(pId, templateId);\n      }\n    } catch (e) {\n      console.error(e);\n    }\n  };\n\n  setBrowserTitle = title => {\n    document.title = `Dreamclass - Coding Party`;\n    if (title) document.title += ` - ${title}`;\n  };\n\n  createNewProjectFromServer = async (pId, templateId) => {\n    let name;\n    const email = this.props.email;\n\n    if (this.state.lectureTitle) {\n      name = this.state.lectureTitle;\n    } else {\n      const randomChar = String.fromCharCode(\n        Math.floor(Math.random() * Math.floor(48)) + 48\n      ); //temp\n      name = this.props.intl.formatMessage(\n        { id: \"ID_TIP_LAYOUT_NEW_PROJECT_FORMAT\" },\n        { randomChar: randomChar }\n      );\n    }\n    let params = { pId, email, name };\n    if (this.state.lectureState) {\n      params.state = this.state.lectureState;\n    }\n    if (templateId) {\n      params.templateId = templateId;\n    }\n    try {\n      const response = await request.postDevelopingProject(params);\n      const project = await response.json();\n      this.setBrowserTitle(project.name);\n      project.state = JSON.parse(project.state);\n      project.video = {\n        videoURL: DEFAULT_VIDEO_URL\n      };\n\n      AssetLibrary.loadAssetsFromScene(project.state.scene, () => {\n        this.props.setProject(project);\n        this.setState({ isLoading: false });\n      });\n    } catch (e) {\n      console.error(e);\n    }\n  };\n\n  loadDefaultProject = async () => {\n    const response = await request.getDefaultProject();\n    const project = await response.json();\n\n    project.name = \"\";\n    this.setBrowserTitle(project.name);\n    project.state = JSON.parse(project.state);\n    project.video = {\n      videoURL: DEFAULT_VIDEO_URL\n    };\n    AssetLibrary.loadAssetsFromScene(project.state.scene, () => {\n      this.props.setProject(project);\n      this.setState({ isLoading: false });\n    });\n  };\n\n  loadTemplateProject = async templateId => {\n    const response = await request.getDefaultTemplateProject({\n      id: templateId\n    });\n    const project = await response.json();\n\n    project.name = \"\";\n    this.setBrowserTitle(project.name);\n    project.state = JSON.parse(project.state);\n    project.video = {\n      videoURL: DEFAULT_VIDEO_URL\n    };\n    AssetLibrary.loadAssetsFromScene(project.state.scene, () => {\n      this.props.setProject(project);\n      this.setState({ isLoading: false });\n    });\n  };\n\n  handleSelectMainViewMode = mainViewMode => {\n    this.setState({ mainViewMode });\n  };\n\n  handleChangeZIndex = name => {\n    const sort = arr => {\n      let indexes = arr.slice();\n      for (let i = 0; i < indexes.length; i++) {\n        if (name === indexes[i]) {\n          const value = indexes[i];\n          indexes.splice(i, 1);\n          indexes.push(value);\n          break;\n        }\n      }\n      return indexes;\n    };\n\n    this.setState(\n      state => {\n        return {\n          popupZIndexes: sort(state.popupZIndexes)\n        };\n      },\n      () => {\n        localStorage.setItem(\n          \"popupZIndexes\",\n          JSON.stringify(this.state.popupZIndexes)\n        );\n      }\n    );\n  };\n\n  handleSelectTab = (name, from) => {\n    this.props.setLog({ [name]: !this.state.popupStates[name] });\n    if (!this.state.popupStates[name]) {\n      if (name === \"spriteView\" || name === \"sound\" || name === \"preview\") {\n        TrackingUtil.sendGAEvent({\n          category: \"Builder\",\n          action: `MenuActions`,\n          label: name[0].toUpperCase() + name.slice(1)\n        });\n      }\n\n      if (name === \"spriteBox\") {\n        TrackingUtil.sendGAEvent({\n          category: \"Builder\",\n          action: `AddSprite`,\n          label: from\n        });\n      }\n    }\n    this.setState(\n      state => {\n        return {\n          popupStates: {\n            ...state.popupStates,\n            [name]: !state.popupStates[name]\n          }\n        };\n      },\n      () => {\n        localStorage.setItem(\n          \"popupStates\",\n          JSON.stringify({\n            ...this.state.popupStates,\n            ocp: undefined,\n            tutorial: undefined,\n            live: undefined\n          })\n        );\n        if (this.state.popupStates[name]) {\n          this.handleChangeZIndex(name);\n        }\n      }\n    );\n  };\n\n  showModal = modalContent => {\n    this.setState({ modalContent });\n  };\n  handleHelp = isHelpOpened => {\n    this.setState({ isHelpOpened });\n  };\n\n  setVideoclassRef = ref => {\n    this.setState({ videoclassRef: ref });\n  };\n\n  render() {\n    const { screenMode, location, email, name } = this.props;\n    const {\n      pageType,\n      roomId,\n      reservationId,\n      isTutor,\n      isLoading,\n      tutorEmail,\n      studentEmail,\n      lectureVideos,\n      lectureSlides,\n      reservation,\n      isProjectPopupOpened,\n      modalContent,\n      isHelpOpened,\n      popupStates,\n      popupZIndexes,\n      currentTutorial,\n      isFreeTrial,\n      videoclassRef\n    } = this.state;\n    const { pId } = this.state.params;\n    const {\n      isIE,\n      openProjectPopup,\n      closeProjectPopup,\n      handleHelp,\n      handleChangeZIndex,\n      handleSelectTab,\n      showModal,\n      setVideoclassRef\n    } = this;\n\n    return (\n      <DndProvider backend={HTML5Backend}>\n        <View\n          screenMode={screenMode}\n          location={location}\n          pageType={pageType}\n          roomId={roomId}\n          reservationId={reservationId}\n          isTutor={isTutor}\n          isLoading={isLoading}\n          isIE={isIE}\n          tutorEmail={tutorEmail}\n          studentEmail={studentEmail}\n          lectureVideos={lectureVideos}\n          lectureSlides={lectureSlides}\n          pId={pId}\n          reservation={reservation}\n          isProjectPopupOpened={isProjectPopupOpened}\n          openProjectPopup={openProjectPopup}\n          closeProjectPopup={closeProjectPopup}\n          modalContent={modalContent}\n          showModal={showModal}\n          isHelpOpened={isHelpOpened}\n          handleHelp={handleHelp}\n          popupStates={popupStates}\n          popupZIndexes={popupZIndexes}\n          handleChangeZIndex={handleChangeZIndex}\n          handleSelectTab={handleSelectTab}\n          currentTutorial={currentTutorial}\n          isFreeTrial={isFreeTrial}\n          videoclassRef={videoclassRef}\n          setVideoclassRef={setVideoclassRef}\n          email={email}\n          name={name}\n        />\n      </DndProvider>\n    );\n  }\n}\n\nexport default connect(\n  state => ({\n    email: state.userinfo.email,\n    name: state.userinfo.name,\n    isTutor: state.userinfo.isTutor,\n    screenMode: state.preview.screenMode\n  }),\n  {\n    setProject: projectActions.setProject,\n    resetProject: projectActions.resetProject,\n    setGameVolume: previewActions.setGameVolume,\n    setLog: webrtcActions.setLog,\n    setVideoURL: videoActions.setVideoURL\n  }\n)(injectIntl(Container));\n"]},"metadata":{},"sourceType":"module"}