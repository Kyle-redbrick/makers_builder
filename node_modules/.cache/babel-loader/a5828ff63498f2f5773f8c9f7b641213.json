{"ast":null,"code":"import _objectSpread from \"/Users/jimmy/Documents/Wizschool/wizlab_web2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nvar _jsxFileName = \"/Users/jimmy/Documents/Wizschool/wizlab_web2/src/Page/Builder3D/Component/Socket/Container.js\";\nimport React, { useEffect, useRef } from \"react\";\nimport { connect } from \"react-redux\";\nimport io from \"socket.io-client\";\nimport { URL } from \"../../../../Common/Util/Constant\";\n\nfunction Container(props) {\n  var EVENT_STATE = \"state\";\n  var SOCKET_INTERVAL = 2000;\n  var socket = useRef(null);\n  var socketTimer = undefined;\n  useEffect(function () {\n    setSocket();\n    return function () {\n      if (socket.current) {\n        socket.current.disconnect();\n      }\n    };\n  }, []);\n  useEffect(function () {\n    if (props.email) {\n      socketTimer = setTimeout(function () {\n        var pId = props.pId,\n            game = props.game,\n            interaction = props.interaction;\n        var state = JSON.stringify({\n          game: game,\n          interaction: _objectSpread({}, interaction, {\n            isPublished: undefined\n          })\n        });\n        var data = {\n          pId: pId,\n          state: state\n        };\n\n        if (socket.current && socket.current.connected) {\n          socket.current.emit(EVENT_STATE, data);\n        }\n      }, SOCKET_INTERVAL);\n    }\n\n    return function () {\n      if (socketTimer) {\n        clearTimeout(socketTimer);\n      }\n    };\n  }, [props]);\n\n  var setSocket = function setSocket() {\n    var options = {}; //socket.current = io(URL.SOCKET_SERVER, options);\n  };\n\n  return React.createElement(\"div\", {\n    style: {\n      display: \"none\"\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 50\n    },\n    __self: this\n  });\n}\n\nexport default connect(function (state) {\n  var _state$interaction = state.interaction,\n      currentSceneId = _state$interaction.currentSceneId,\n      currentGameObjectIds = _state$interaction.currentGameObjectIds;\n  var currentObject = currentGameObjectIds[currentSceneId];\n  return {\n    currentSceneId: currentSceneId,\n    currentObject: currentObject,\n    pId: state.project.pId,\n    game: state.game,\n    interaction: _objectSpread({}, state.interaction),\n    email: state.userinfo.email\n  };\n})(Container);","map":{"version":3,"sources":["/Users/jimmy/Documents/Wizschool/wizlab_web2/src/Page/Builder3D/Component/Socket/Container.js"],"names":["React","useEffect","useRef","connect","io","URL","Container","props","EVENT_STATE","SOCKET_INTERVAL","socket","socketTimer","undefined","setSocket","current","disconnect","email","setTimeout","pId","game","interaction","state","JSON","stringify","isPublished","data","connected","emit","clearTimeout","options","display","currentSceneId","currentGameObjectIds","currentObject","project","userinfo"],"mappings":";;AAAA,OAAOA,KAAP,IAAgBC,SAAhB,EAA2BC,MAA3B,QAAyC,OAAzC;AACA,SAASC,OAAT,QAAwB,aAAxB;AACA,OAAOC,EAAP,MAAe,kBAAf;AACA,SAASC,GAAT,QAAoB,kCAApB;;AAEA,SAASC,SAAT,CAAmBC,KAAnB,EAA0B;AACxB,MAAMC,WAAW,GAAG,OAApB;AACA,MAAMC,eAAe,GAAG,IAAxB;AAEA,MAAMC,MAAM,GAAGR,MAAM,CAAC,IAAD,CAArB;AACA,MAAIS,WAAW,GAAGC,SAAlB;AAEAX,EAAAA,SAAS,CAAC,YAAM;AACdY,IAAAA,SAAS;AAET,WAAO,YAAM;AACX,UAAIH,MAAM,CAACI,OAAX,EAAoB;AAClBJ,QAAAA,MAAM,CAACI,OAAP,CAAeC,UAAf;AACD;AACF,KAJD;AAKD,GARQ,EAQN,EARM,CAAT;AAUAd,EAAAA,SAAS,CAAC,YAAM;AACd,QAAIM,KAAK,CAACS,KAAV,EAAiB;AACfL,MAAAA,WAAW,GAAGM,UAAU,CAAC,YAAM;AAAA,YACrBC,GADqB,GACMX,KADN,CACrBW,GADqB;AAAA,YAChBC,IADgB,GACMZ,KADN,CAChBY,IADgB;AAAA,YACVC,WADU,GACMb,KADN,CACVa,WADU;AAE7B,YAAMC,KAAK,GAAGC,IAAI,CAACC,SAAL,CAAe;AAC3BJ,UAAAA,IAAI,EAAJA,IAD2B;AAE3BC,UAAAA,WAAW,oBAAOA,WAAP;AAAoBI,YAAAA,WAAW,EAAEZ;AAAjC;AAFgB,SAAf,CAAd;AAIA,YAAMa,IAAI,GAAG;AAAEP,UAAAA,GAAG,EAAHA,GAAF;AAAOG,UAAAA,KAAK,EAALA;AAAP,SAAb;;AACA,YAAIX,MAAM,CAACI,OAAP,IAAkBJ,MAAM,CAACI,OAAP,CAAeY,SAArC,EAAgD;AAC9ChB,UAAAA,MAAM,CAACI,OAAP,CAAea,IAAf,CAAoBnB,WAApB,EAAiCiB,IAAjC;AACD;AACF,OAVuB,EAUrBhB,eAVqB,CAAxB;AAWD;;AAED,WAAO,YAAM;AACX,UAAIE,WAAJ,EAAiB;AACfiB,QAAAA,YAAY,CAACjB,WAAD,CAAZ;AACD;AACF,KAJD;AAKD,GApBQ,EAoBN,CAACJ,KAAD,CApBM,CAAT;;AAsBA,MAAMM,SAAS,GAAG,SAAZA,SAAY,GAAM;AACtB,QAAMgB,OAAO,GAAG,EAAhB,CADsB,CAEtB;AACD,GAHD;;AAKA,SAAO;AAAK,IAAA,KAAK,EAAE;AAAEC,MAAAA,OAAO,EAAE;AAAX,KAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAAP;AACD;;AAED,eAAe3B,OAAO,CAAC,UAAAkB,KAAK,EAAI;AAAA,2BACmBA,KAAK,CAACD,WADzB;AAAA,MACtBW,cADsB,sBACtBA,cADsB;AAAA,MACNC,oBADM,sBACNA,oBADM;AAE9B,MAAMC,aAAa,GAAGD,oBAAoB,CAACD,cAAD,CAA1C;AACA,SAAO;AACLA,IAAAA,cAAc,EAAdA,cADK;AAELE,IAAAA,aAAa,EAAbA,aAFK;AAGLf,IAAAA,GAAG,EAAEG,KAAK,CAACa,OAAN,CAAchB,GAHd;AAILC,IAAAA,IAAI,EAAEE,KAAK,CAACF,IAJP;AAKLC,IAAAA,WAAW,oBACNC,KAAK,CAACD,WADA,CALN;AAQLJ,IAAAA,KAAK,EAAEK,KAAK,CAACc,QAAN,CAAenB;AARjB,GAAP;AAUD,CAbqB,CAAP,CAaZV,SAbY,CAAf","sourcesContent":["import React, { useEffect, useRef } from \"react\";\nimport { connect } from \"react-redux\";\nimport io from \"socket.io-client\";\nimport { URL } from \"../../../../Common/Util/Constant\";\n\nfunction Container(props) {\n  const EVENT_STATE = \"state\";\n  const SOCKET_INTERVAL = 2000;\n\n  const socket = useRef(null);\n  let socketTimer = undefined;\n\n  useEffect(() => {\n    setSocket();\n\n    return () => {\n      if (socket.current) {\n        socket.current.disconnect();\n      }\n    };\n  }, []);\n\n  useEffect(() => {\n    if (props.email) {\n      socketTimer = setTimeout(() => {\n        const { pId, game, interaction } = props;\n        const state = JSON.stringify({\n          game,\n          interaction: { ...interaction, isPublished: undefined }\n        });\n        const data = { pId, state };\n        if (socket.current && socket.current.connected) {\n          socket.current.emit(EVENT_STATE, data);\n        }\n      }, SOCKET_INTERVAL);\n    }\n\n    return () => {\n      if (socketTimer) {\n        clearTimeout(socketTimer);\n      }\n    };\n  }, [props]);\n\n  const setSocket = () => {\n    const options = {};\n    //socket.current = io(URL.SOCKET_SERVER, options);\n  };\n\n  return <div style={{ display: \"none\" }} />;\n}\n\nexport default connect(state => {\n  const { currentSceneId, currentGameObjectIds } = state.interaction;\n  const currentObject = currentGameObjectIds[currentSceneId];\n  return {\n    currentSceneId,\n    currentObject,\n    pId: state.project.pId,\n    game: state.game,\n    interaction: {\n      ...state.interaction\n    },\n    email: state.userinfo.email\n  };\n})(Container);\n"]},"metadata":{},"sourceType":"module"}