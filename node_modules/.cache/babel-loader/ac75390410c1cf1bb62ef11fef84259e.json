{"ast":null,"code":"import _regeneratorRuntime from \"/Users/jimmy/Documents/Wizschool/wizlab_web2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/jimmy/Documents/Wizschool/wizlab_web2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _slicedToArray from \"/Users/jimmy/Documents/Wizschool/wizlab_web2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nimport _objectWithoutProperties from \"/Users/jimmy/Documents/Wizschool/wizlab_web2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties\";\nimport _taggedTemplateLiteral from \"/Users/jimmy/Documents/Wizschool/wizlab_web2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";\n\nvar _templateObject,\n    _templateObject2,\n    _templateObject3,\n    _templateObject4,\n    _this = this,\n    _jsxFileName = \"/Users/jimmy/Documents/Wizschool/wizlab_web2/src/Page/CourseDetail/Components/CommentChildItem.js\";\n\nimport React, { useCallback, useEffect, useState } from \"react\";\nimport { connect } from \"react-redux\";\nimport styled from \"@emotion/styled\";\nimport CommentDetail from \"./CommentDetail\";\nimport CommentMore from \"./CommentMore\";\nimport CommentWrite from \"./CommentWrite\";\nimport { deleteComment, postComment\n/*putComment,*/\n, reportComment } from \"../api\";\nvar Self = styled.div(_templateObject || (_templateObject = _taggedTemplateLiteral([\"\"])));\nvar Image = styled.div(_templateObject2 || (_templateObject2 = _taggedTemplateLiteral([\"\\n  width: 45px;\\n  height: 45px;\\n  margin-right: 15px;\\n  border-radius: 50%;\\n  background-image: url(\", \");\\n  background-size: cover;\\n  background-repeat: no-repeat;\\n  background-position: center;\\n\\n  @media screen and (max-width: 1169px) {\\n    width: 35px;\\n    height: 35px;\\n  }\\n\"])), function (props) {\n  return props.image;\n});\nvar Comment = styled.div(_templateObject3 || (_templateObject3 = _taggedTemplateLiteral([\"\\n  display: flex;\\n  align-items: flex-start;\\n  padding-top: 16px;\\n  position: relative;\\n\"])));\nvar CommentBody = styled.div(_templateObject4 || (_templateObject4 = _taggedTemplateLiteral([\"\\n  flex: 1;\\n\"])));\n\nvar CommentChildItem = function CommentChildItem(_ref) {\n  var lectureId = _ref.lectureId,\n      item = _ref.item,\n      parents = _ref.parents,\n      onAfterSubmit = _ref.onAfterSubmit,\n      currentIdOnComment = _ref.currentIdOnComment,\n      currentIdOnMore = _ref.currentIdOnMore,\n      handleChangeComment = _ref.handleChangeComment,\n      handleChangeMore = _ref.handleChangeMore,\n      onAppearCommentWrite = _ref.onAppearCommentWrite,\n      onDisappearCommentWrite = _ref.onDisappearCommentWrite,\n      props = _objectWithoutProperties(_ref, [\"lectureId\", \"item\", \"parents\", \"onAfterSubmit\", \"currentIdOnComment\", \"currentIdOnMore\", \"handleChangeComment\", \"handleChangeMore\", \"onAppearCommentWrite\", \"onDisappearCommentWrite\"]);\n\n  var _useState = useState(false),\n      _useState2 = _slicedToArray(_useState, 2),\n      writeMode = _useState2[0],\n      setWriteMode = _useState2[1];\n\n  useEffect(function () {\n    if (currentIdOnComment !== item.id) {\n      setWriteMode(false);\n    }\n  }, [currentIdOnComment]);\n  var showWriteComponent = useCallback(function () {\n    setWriteMode(true);\n    handleChangeComment(item.id);\n  }, []);\n  var hideWriteComponent = useCallback(function () {\n    setWriteMode(false);\n  }, []);\n  var onSubmit = useCallback( /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(text) {\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.prev = 0;\n              _context.next = 3;\n              return postComment({\n                email: props.email,\n                lectureId: lectureId,\n                message: text,\n                parentCommentId: item.id\n              });\n\n            case 3:\n              onAfterSubmit();\n              _context.next = 9;\n              break;\n\n            case 6:\n              _context.prev = 6;\n              _context.t0 = _context[\"catch\"](0);\n              window.alert(_context.t0.message);\n\n            case 9:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[0, 6]]);\n    }));\n\n    return function (_x) {\n      return _ref2.apply(this, arguments);\n    };\n  }(), [postComment]);\n  var editComment = useCallback(function () {});\n  var handleDeleteComment = useCallback( /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n    return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            _context2.prev = 0;\n            _context2.next = 3;\n            return deleteComment({\n              commentId: item.id\n            });\n\n          case 3:\n            onAfterSubmit();\n            _context2.next = 9;\n            break;\n\n          case 6:\n            _context2.prev = 6;\n            _context2.t0 = _context2[\"catch\"](0);\n            window.alert(_context2.t0.message);\n\n          case 9:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, _callee2, null, [[0, 6]]);\n  })), [deleteComment]);\n  var handleReportComment = useCallback( /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3() {\n    return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n      while (1) {\n        switch (_context3.prev = _context3.next) {\n          case 0:\n            _context3.prev = 0;\n            _context3.next = 3;\n            return reportComment({\n              commentId: item.id,\n              email: props.email\n            });\n\n          case 3:\n            onAfterSubmit();\n            _context3.next = 9;\n            break;\n\n          case 6:\n            _context3.prev = 6;\n            _context3.t0 = _context3[\"catch\"](0);\n            window.alert(_context3.t0.message);\n\n          case 9:\n          case \"end\":\n            return _context3.stop();\n        }\n      }\n    }, _callee3, null, [[0, 6]]);\n  })), [reportComment]);\n  return /*#__PURE__*/React.createElement(Self, Object.assign({}, props, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 116,\n      columnNumber: 5\n    }\n  }), /*#__PURE__*/React.createElement(Comment, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 117,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(Image, {\n    image: item.user && item.user.icon,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 118,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(CommentBody, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 119,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(CommentDetail, {\n    item: item,\n    showWriteComponent: showWriteComponent,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 120,\n      columnNumber: 11\n    }\n  }), /*#__PURE__*/React.createElement(CommentWrite, {\n    isChild: true,\n    onSubmit: onSubmit,\n    writeMode: writeMode,\n    hideCommentWrite: hideWriteComponent,\n    onAppear: onAppearCommentWrite,\n    onDisappear: onDisappearCommentWrite,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 124,\n      columnNumber: 11\n    }\n  })), /*#__PURE__*/React.createElement(CommentMore, {\n    item: item,\n    editComment: editComment,\n    deleteComment: handleDeleteComment,\n    reportComment: handleReportComment,\n    currentIdOnMore: currentIdOnMore,\n    handleChangeMore: handleChangeMore,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 133,\n      columnNumber: 9\n    }\n  })));\n};\n\nexport default connect(function (state) {\n  return {\n    email: state.userinfo.email\n  };\n}, {})(CommentChildItem);","map":{"version":3,"sources":["/Users/jimmy/Documents/Wizschool/wizlab_web2/src/Page/CourseDetail/Components/CommentChildItem.js"],"names":["React","useCallback","useEffect","useState","connect","styled","CommentDetail","CommentMore","CommentWrite","deleteComment","postComment","reportComment","Self","div","Image","props","image","Comment","CommentBody","CommentChildItem","lectureId","item","parents","onAfterSubmit","currentIdOnComment","currentIdOnMore","handleChangeComment","handleChangeMore","onAppearCommentWrite","onDisappearCommentWrite","writeMode","setWriteMode","id","showWriteComponent","hideWriteComponent","onSubmit","text","email","message","parentCommentId","window","alert","editComment","handleDeleteComment","commentId","handleReportComment","user","icon","state","userinfo"],"mappings":"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","sourcesContent":["import React, { useCallback, useEffect, useState } from \"react\";\nimport { connect } from \"react-redux\";\nimport styled from \"@emotion/styled\";\n\nimport CommentDetail from \"./CommentDetail\";\nimport CommentMore from \"./CommentMore\";\nimport CommentWrite from \"./CommentWrite\";\nimport { deleteComment, postComment, /*putComment,*/ reportComment } from \"../api\";\n\nconst Self = styled.div``;\n\nconst Image = styled.div`\n  width: 45px;\n  height: 45px;\n  margin-right: 15px;\n  border-radius: 50%;\n  background-image: url(${(props) => props.image});\n  background-size: cover;\n  background-repeat: no-repeat;\n  background-position: center;\n\n  @media screen and (max-width: 1169px) {\n    width: 35px;\n    height: 35px;\n  }\n`;\n\nconst Comment = styled.div`\n  display: flex;\n  align-items: flex-start;\n  padding-top: 16px;\n  position: relative;\n`;\n\nconst CommentBody = styled.div`\n  flex: 1;\n`;\n\nconst CommentChildItem = ({ \n  lectureId,\n  item,\n  parents,\n  onAfterSubmit,\n  currentIdOnComment,\n  currentIdOnMore,\n  handleChangeComment,\n  handleChangeMore,\n  onAppearCommentWrite,\n  onDisappearCommentWrite,\n  ...props\n}) => {\n  const [writeMode, setWriteMode] = useState(false);\n\n  useEffect(() => {\n    if (currentIdOnComment !== item.id) {\n      setWriteMode(false);\n    }\n  }, [currentIdOnComment])\n\n  const showWriteComponent = useCallback(() => {\n    setWriteMode(true);\n    handleChangeComment(item.id);\n  }, []);\n\n  const hideWriteComponent = useCallback(() => {\n    setWriteMode(false);\n  }, []);\n\n  const onSubmit = useCallback(\n    async (text) => {\n      try {\n        await postComment({\n          email: props.email,\n          lectureId,\n          message: text,\n          parentCommentId: item.id,\n        });\n        onAfterSubmit();\n      } catch (e) {\n        window.alert(e.message);\n      }\n    },\n    [postComment]\n  );\n\n  const editComment = useCallback(() => {});\n\n  const handleDeleteComment = useCallback(\n    async () => {\n      try {\n        await deleteComment({ commentId: item.id });\n        onAfterSubmit();\n      } catch (e) {\n        window.alert(e.message);\n      }\n    },\n    [deleteComment]\n  );\n\n  const handleReportComment = useCallback(\n    async () => {\n      try {\n        await reportComment({ \n          commentId: item.id,\n          email: props.email,\n        });\n        onAfterSubmit();\n      } catch (e) {\n        window.alert(e.message);\n      }\n    },\n    [reportComment]\n  );\n\n  return (\n    <Self {...props}>\n      <Comment>\n        <Image image={item.user && item.user.icon} />\n        <CommentBody>\n          <CommentDetail\n            item={item}\n            showWriteComponent={showWriteComponent}\n          />\n          <CommentWrite\n            isChild={true}\n            onSubmit={onSubmit}\n            writeMode={writeMode}\n            hideCommentWrite={hideWriteComponent}\n            onAppear={onAppearCommentWrite}\n            onDisappear={onDisappearCommentWrite}\n          />\n        </CommentBody>\n        <CommentMore\n          item={item}\n          editComment={editComment}\n          deleteComment={handleDeleteComment}\n          reportComment={handleReportComment}\n          currentIdOnMore={currentIdOnMore}\n          handleChangeMore={handleChangeMore}\n        />\n      </Comment>\n    </Self>\n  );\n};\n\nexport default connect(\n  (state) => ({\n    email: state.userinfo.email,\n  }),\n  {}\n)(CommentChildItem);\n"]},"metadata":{},"sourceType":"module"}