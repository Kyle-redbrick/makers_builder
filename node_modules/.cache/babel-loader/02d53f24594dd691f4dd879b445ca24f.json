{"ast":null,"code":"import _regeneratorRuntime from \"/Users/jimmy/Documents/Wizschool/astroboy/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/jimmy/Documents/Wizschool/astroboy/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"/Users/jimmy/Documents/Wizschool/astroboy/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/jimmy/Documents/Wizschool/astroboy/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _inherits from \"/Users/jimmy/Documents/Wizschool/astroboy/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _possibleConstructorReturn from \"/Users/jimmy/Documents/Wizschool/astroboy/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/jimmy/Documents/Wizschool/astroboy/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nvar _jsxFileName = \"/Users/jimmy/Documents/Wizschool/astroboy/src/Page/OCP/Container.js\";\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\n\nimport React, { Component } from \"react\";\nimport View from \"./View\";\nimport { connect } from \"react-redux\";\nimport { injectIntl } from \"react-intl\";\nimport * as request from \"../../Common/Util/HTTPRequest\";\nimport PopUp, { showPopUp } from \"../../Common/Component/PopUp\";\nimport SignIn from \"../../Common/Component/SignIn\";\nimport SignUp from \"../../Common/Component/SignUp\";\nimport eventImg from \"../../Image/event5_popup.png\";\n\nvar Container = /*#__PURE__*/function (_Component) {\n  _inherits(Container, _Component);\n\n  var _super = _createSuper(Container);\n\n  function Container(props) {\n    var _this;\n\n    _classCallCheck(this, Container);\n\n    _this = _super.call(this, props);\n    _this.componentDidMount = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      var res, rank, projects;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              /** get total user count  */\n              request.getOcpSuccessUser().then(function (res) {\n                return res.json();\n              }).then(function (json) {\n                return _this.setState({\n                  count: json\n                });\n              });\n              _context.next = 3;\n              return request.getRoomEscape({\n                limit: 14,\n                order: \"likeCount\"\n              });\n\n            case 3:\n              res = _context.sent;\n              _context.next = 6;\n              return res.json();\n\n            case 6:\n              rank = _context.sent;\n              _context.next = 9;\n              return request.getRoomEscape({\n                limit: 14,\n                order: \"editedAt\"\n              });\n\n            case 9:\n              res = _context.sent;\n              _context.next = 12;\n              return res.json();\n\n            case 12:\n              projects = _context.sent;\n\n              _this.setState({\n                rank: rank,\n                projects: projects\n              });\n              /** check my stage   */\n\n\n              _context.next = 16;\n              return _this.getMyOcp();\n\n            case 16:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    _this.componentDidUpdate = /*#__PURE__*/function () {\n      var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(prevProps, prevState) {\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                if (!(_this.props.userinfo.email && !prevProps.userinfo.email)) {\n                  _context2.next = 5;\n                  break;\n                }\n\n                _context2.next = 3;\n                return _this.getMyOcp();\n\n              case 3:\n                _context2.next = 8;\n                break;\n\n              case 5:\n                if (!(!_this.props.userinfo.email && prevProps.userinfo.email)) {\n                  _context2.next = 8;\n                  break;\n                }\n\n                _context2.next = 8;\n                return _this.getMyOcp();\n\n              case 8:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2);\n      }));\n\n      return function (_x, _x2) {\n        return _ref2.apply(this, arguments);\n      };\n    }();\n\n    _this.getMyOcp = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3() {\n      var res, json, data;\n      return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              if (!(_this.props.userinfo.email || _this.guest)) {\n                _context3.next = 8;\n                break;\n              }\n\n              _context3.next = 3;\n              return request.getMyOcp(_this.props.userinfo.email ? {\n                email: _this.props.userinfo.email\n              } : {\n                guestId: _this.guest && _this.guest.id\n              });\n\n            case 3:\n              res = _context3.sent;\n              _context3.next = 6;\n              return res.json();\n\n            case 6:\n              json = _context3.sent;\n\n              if (json) {\n                data = {};\n                json.forEach(function (element) {\n                  data[element.grade] = element.level;\n                });\n\n                _this.setState({\n                  beginner: Number(data.beginner),\n                  intermediate: Number(data.intermediate),\n                  advanced: Number(data.advanced)\n                });\n              }\n\n            case 8:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3);\n    }));\n\n    _this.handleMore = function (type) {\n      if (type === \"rank\") {\n        _this.setState(function (prev) {\n          return {\n            rankLimit: prev.rankLimit + 10\n          };\n        });\n      } else {\n        _this.setState(function (prev) {\n          return {\n            projectsLimit: prev.projectsLimit + 8\n          };\n        });\n      }\n    };\n\n    _this.handleParticipation = function () {\n      if (!_this.props.userinfo.email) {\n        showPopUp(React.createElement(PopUp.TwoButton, {\n          title: \"로그인 후 이용해주세요\",\n          confirmButtonNameId: \"ID_SIGNUP\",\n          cancelButtonNameId: \"ID_SIGNIN\",\n          content: React.createElement(\"div\", {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 105\n            },\n            __self: this\n          }, React.createElement(\"img\", {\n            style: {\n              width: \"100%\",\n              marginTop: \"25px\"\n            },\n            src: eventImg,\n            alt: \"evt\",\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 106\n            },\n            __self: this\n          })),\n          cancelAction: function cancelAction() {\n            showPopUp(React.createElement(SignIn, {\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 114\n              },\n              __self: this\n            }), {\n              mobileFullscreen: true,\n              darkmode: true\n            });\n          },\n          confirmAction: function confirmAction() {\n            showPopUp(React.createElement(SignUp, {\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 120\n              },\n              __self: this\n            }), {\n              mobileFullscreen: true,\n              darkmode: true\n            });\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 100\n          },\n          __self: this\n        }), {\n          mobileFullscreen: true,\n          darkmode: true\n        });\n        return;\n      }\n\n      window.open(\"/builder\", \"_blank\");\n    };\n\n    _this.guest = localStorage.getItem(\"ocpId\") && JSON.parse(localStorage.getItem(\"ocpId\"));\n    _this.state = {\n      beginner: undefined,\n      intermediate: undefined,\n      advanced: undefined,\n      count: {},\n      rank: [],\n      rankLimit: 10,\n      projects: [],\n      projectsLimit: 8\n    };\n    _this.referrer = \"sef\";\n    var urlParams = new URLSearchParams(_this.props.location.search);\n    var referrer = urlParams.get(\"referrer\");\n\n    if (referrer !== \"sef\") {\n      _this.referrer = \"ocp\";\n    }\n\n    return _this;\n  }\n\n  _createClass(Container, [{\n    key: \"render\",\n    value: function render() {\n      var intl = this.props.intl;\n      var _this$state = this.state,\n          beginner = _this$state.beginner,\n          intermediate = _this$state.intermediate,\n          advanced = _this$state.advanced,\n          count = _this$state.count,\n          rank = _this$state.rank,\n          rankLimit = _this$state.rankLimit,\n          projects = _this$state.projects,\n          projectsLimit = _this$state.projectsLimit;\n      var handleMore = this.handleMore,\n          handleParticipation = this.handleParticipation;\n      return React.createElement(View, {\n        intl: intl,\n        beginner: beginner,\n        intermediate: intermediate,\n        advanced: advanced,\n        count: count,\n        rank: rank,\n        rankLimit: rankLimit,\n        handleMore: handleMore,\n        projects: projects,\n        projectsLimit: projectsLimit,\n        handleParticipation: handleParticipation,\n        type: this.referrer,\n        userId: this.props.userinfo.id,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 149\n        },\n        __self: this\n      });\n    }\n  }]);\n\n  return Container;\n}(Component);\n\nexport default connect(function (state) {\n  return {\n    userinfo: state.userinfo\n  };\n}, {})(injectIntl(Container));","map":{"version":3,"sources":["/Users/jimmy/Documents/Wizschool/astroboy/src/Page/OCP/Container.js"],"names":["React","Component","View","connect","injectIntl","request","PopUp","showPopUp","SignIn","SignUp","eventImg","Container","props","componentDidMount","getOcpSuccessUser","then","res","json","setState","count","getRoomEscape","limit","order","rank","projects","getMyOcp","componentDidUpdate","prevProps","prevState","userinfo","email","guest","guestId","id","data","forEach","element","grade","level","beginner","Number","intermediate","advanced","handleMore","type","prev","rankLimit","projectsLimit","handleParticipation","width","marginTop","mobileFullscreen","darkmode","window","open","localStorage","getItem","JSON","parse","state","undefined","referrer","urlParams","URLSearchParams","location","search","get","intl"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport View from \"./View\";\nimport { connect } from \"react-redux\";\nimport { injectIntl } from \"react-intl\";\nimport * as request from \"../../Common/Util/HTTPRequest\";\nimport PopUp, { showPopUp } from \"../../Common/Component/PopUp\";\nimport SignIn from \"../../Common/Component/SignIn\";\nimport SignUp from \"../../Common/Component/SignUp\";\nimport eventImg from \"../../Image/event5_popup.png\";\n\nclass Container extends Component {\n  constructor(props) {\n    super(props);\n    this.guest =\n      localStorage.getItem(\"ocpId\") &&\n      JSON.parse(localStorage.getItem(\"ocpId\"));\n    this.state = {\n      beginner: undefined,\n      intermediate: undefined,\n      advanced: undefined,\n      count: {},\n      rank: [],\n      rankLimit: 10,\n      projects: [],\n      projectsLimit: 8\n    };\n    this.referrer = \"sef\";\n    const urlParams = new URLSearchParams(this.props.location.search);\n    const referrer = urlParams.get(\"referrer\");\n    if (referrer !== \"sef\") {\n      this.referrer = \"ocp\";\n    }\n  }\n\n  componentDidMount = async () => {\n    /** get total user count  */\n    request\n      .getOcpSuccessUser()\n      .then(res => res.json())\n      .then(json => this.setState({ count: json }));\n\n    let res = await request.getRoomEscape({ limit: 14, order: \"likeCount\" });\n    let rank = await res.json();\n    res = await request.getRoomEscape({ limit: 14, order: \"editedAt\" });\n    let projects = await res.json();\n\n    this.setState({\n      rank,\n      projects\n    });\n    /** check my stage   */\n    await this.getMyOcp();\n  };\n\n  componentDidUpdate = async (prevProps, prevState) => {\n    if (this.props.userinfo.email && !prevProps.userinfo.email) {\n      await this.getMyOcp();\n    } else if (!this.props.userinfo.email && prevProps.userinfo.email) {\n      //로그아웃했을때\n      await this.getMyOcp();\n    }\n  };\n\n  getMyOcp = async () => {\n    if (this.props.userinfo.email || this.guest) {\n      let res = await request.getMyOcp(\n        this.props.userinfo.email\n          ? { email: this.props.userinfo.email }\n          : { guestId: this.guest && this.guest.id }\n      );\n      let json = await res.json();\n      if (json) {\n        let data = {};\n        json.forEach(element => {\n          data[element.grade] = element.level;\n        });\n        this.setState({\n          beginner: Number(data.beginner),\n          intermediate: Number(data.intermediate),\n          advanced: Number(data.advanced)\n        });\n      }\n    }\n  };\n\n  handleMore = type => {\n    if (type === \"rank\") {\n      this.setState(prev => ({\n        rankLimit: prev.rankLimit + 10\n      }));\n    } else {\n      this.setState(prev => ({\n        projectsLimit: prev.projectsLimit + 8\n      }));\n    }\n  };\n  handleParticipation = () => {\n    if (!this.props.userinfo.email) {\n      showPopUp(\n        <PopUp.TwoButton\n          title={\"로그인 후 이용해주세요\"}\n          confirmButtonNameId={\"ID_SIGNUP\"}\n          cancelButtonNameId={\"ID_SIGNIN\"}\n          content={\n            <div>\n              <img\n                style={{ width: \"100%\", marginTop: \"25px\" }}\n                src={eventImg}\n                alt=\"evt\"\n              />\n            </div>\n          }\n          cancelAction={() => {\n            showPopUp(<SignIn />, {\n              mobileFullscreen: true,\n              darkmode: true\n            });\n          }}\n          confirmAction={() => {\n            showPopUp(<SignUp />, {\n              mobileFullscreen: true,\n              darkmode: true\n            });\n          }}\n        />,\n        {\n          mobileFullscreen: true,\n          darkmode: true\n        }\n      );\n      return;\n    }\n    window.open(`/builder`, \"_blank\");\n  };\n  render() {\n    const { intl } = this.props;\n    const {\n      beginner,\n      intermediate,\n      advanced,\n      count,\n      rank,\n      rankLimit,\n      projects,\n      projectsLimit\n    } = this.state;\n    const { handleMore, handleParticipation } = this;\n    return (\n      <View\n        intl={intl}\n        beginner={beginner}\n        intermediate={intermediate}\n        advanced={advanced}\n        count={count}\n        rank={rank}\n        rankLimit={rankLimit}\n        handleMore={handleMore}\n        projects={projects}\n        projectsLimit={projectsLimit}\n        handleParticipation={handleParticipation}\n        type={this.referrer}\n        userId={this.props.userinfo.id}\n      />\n    );\n  }\n}\nexport default connect(\n  state => ({ userinfo: state.userinfo }),\n  {}\n)(injectIntl(Container));\n"]},"metadata":{},"sourceType":"module"}