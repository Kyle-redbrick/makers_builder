{"ast":null,"code":"import _regeneratorRuntime from \"/Users/jimmy/Documents/Wizschool/astroboy/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/jimmy/Documents/Wizschool/astroboy/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"/Users/jimmy/Documents/Wizschool/astroboy/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/jimmy/Documents/Wizschool/astroboy/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _inherits from \"/Users/jimmy/Documents/Wizschool/astroboy/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _possibleConstructorReturn from \"/Users/jimmy/Documents/Wizschool/astroboy/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/jimmy/Documents/Wizschool/astroboy/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nvar _jsxFileName = \"/Users/jimmy/Documents/Wizschool/astroboy/src/Page/News/Container.js\";\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\n\nimport React, { Component } from \"react\";\nimport { withRouter } from \"react-router-dom\";\nimport { injectIntl } from \"react-intl\";\nimport { connect } from \"react-redux\";\nimport View from \"./View\";\nimport * as request from \"../../Common/Util/HTTPRequest\";\n\nvar Container = /*#__PURE__*/function (_Component) {\n  _inherits(Container, _Component);\n\n  var _super = _createSuper(Container);\n\n  function Container(props) {\n    var _this;\n\n    _classCallCheck(this, Container);\n\n    _this = _super.call(this, props);\n\n    _this.componentDidMount = function () {\n      _this.fetchNews();\n    };\n\n    _this.fetchNews = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      var res, news;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return request.getNewsList({\n                type: \"all\",\n                limit: _this.limit,\n                offset: _this.limit * (_this.state.currentPage - 1)\n              });\n\n            case 2:\n              res = _context.sent;\n              _context.next = 5;\n              return res.json();\n\n            case 5:\n              news = _context.sent;\n\n              _this.setState(function (prev) {\n                return {\n                  news: prev.news.concat(news.rows),\n                  newsCount: news.count\n                };\n              });\n\n            case 7:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    _this.onClickMore = function () {\n      _this.setState(function (prev) {\n        return {\n          currentPage: prev.currentPage + 1\n        };\n      }, function () {\n        _this.fetchNews();\n      });\n    };\n\n    _this.limit = 10;\n    _this.state = {\n      news: [],\n      currentPage: 1,\n      newsCount: 0\n    };\n    return _this;\n  }\n\n  _createClass(Container, [{\n    key: \"render\",\n    value: function render() {\n      var _this$state = this.state,\n          news = _this$state.news,\n          newsCount = _this$state.newsCount;\n      var onClickMore = this.onClickMore;\n      return React.createElement(View, {\n        news: news,\n        onClickMore: onClickMore,\n        newsCount: newsCount,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 39\n        },\n        __self: this\n      });\n    }\n  }]);\n\n  return Container;\n}(Component);\n\nexport default connect(function (state) {\n  return {\n    email: state.userinfo.email\n  };\n}, {})(withRouter(injectIntl(Container)));","map":{"version":3,"sources":["/Users/jimmy/Documents/Wizschool/astroboy/src/Page/News/Container.js"],"names":["React","Component","withRouter","injectIntl","connect","View","request","Container","props","componentDidMount","fetchNews","getNewsList","type","limit","offset","state","currentPage","res","json","news","setState","prev","concat","rows","newsCount","count","onClickMore","email","userinfo"],"mappings":";;;;;;;;;;;;;AAAA,OAAOA,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC;AACA,SAASC,UAAT,QAA2B,kBAA3B;AACA,SAASC,UAAT,QAA2B,YAA3B;AACA,SAASC,OAAT,QAAwB,aAAxB;AACA,OAAOC,IAAP,MAAiB,QAAjB;AACA,OAAO,KAAKC,OAAZ,MAAyB,+BAAzB;;IACMC,S;;;;;AACJ,qBAAYC,KAAZ,EAAmB;AAAA;;AAAA;;AACjB,8BAAMA,KAAN;;AADiB,UAKnBC,iBALmB,GAKC,YAAM;AACxB,YAAKC,SAAL;AACD,KAPkB;;AAAA,UAQnBA,SARmB,yEAQP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qBACMJ,OAAO,CAACK,WAAR,CAAoB;AAClCC,gBAAAA,IAAI,EAAE,KAD4B;AAElCC,gBAAAA,KAAK,EAAE,MAAKA,KAFsB;AAGlCC,gBAAAA,MAAM,EAAE,MAAKD,KAAL,IAAc,MAAKE,KAAL,CAAWC,WAAX,GAAyB,CAAvC;AAH0B,eAApB,CADN;;AAAA;AACNC,cAAAA,GADM;AAAA;AAAA,qBAMOA,GAAG,CAACC,IAAJ,EANP;;AAAA;AAMNC,cAAAA,IANM;;AAOV,oBAAKC,QAAL,CAAc,UAAAC,IAAI;AAAA,uBAAK;AACrBF,kBAAAA,IAAI,EAAEE,IAAI,CAACF,IAAL,CAAUG,MAAV,CAAiBH,IAAI,CAACI,IAAtB,CADe;AAErBC,kBAAAA,SAAS,EAAEL,IAAI,CAACM;AAFK,iBAAL;AAAA,eAAlB;;AAPU;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KARO;;AAAA,UAoBnBC,WApBmB,GAoBL,YAAM;AAClB,YAAKN,QAAL,CACE,UAAAC,IAAI;AAAA,eAAK;AAAEL,UAAAA,WAAW,EAAEK,IAAI,CAACL,WAAL,GAAmB;AAAlC,SAAL;AAAA,OADN,EAEE,YAAM;AACJ,cAAKN,SAAL;AACD,OAJH;AAMD,KA3BkB;;AAEjB,UAAKG,KAAL,GAAa,EAAb;AACA,UAAKE,KAAL,GAAa;AAAEI,MAAAA,IAAI,EAAE,EAAR;AAAYH,MAAAA,WAAW,EAAE,CAAzB;AAA4BQ,MAAAA,SAAS,EAAE;AAAvC,KAAb;AAHiB;AAIlB;;;;WAwBD,kBAAS;AAAA,wBACqB,KAAKT,KAD1B;AAAA,UACCI,IADD,eACCA,IADD;AAAA,UACOK,SADP,eACOA,SADP;AAAA,UAECE,WAFD,GAEiB,IAFjB,CAECA,WAFD;AAGP,aAAO,oBAAC,IAAD;AAAM,QAAA,IAAI,EAAEP,IAAZ;AAAkB,QAAA,WAAW,EAAEO,WAA/B;AAA4C,QAAA,SAAS,EAAEF,SAAvD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAAP;AACD;;;;EAjCqBvB,S;;AAmCxB,eAAeG,OAAO,CACpB,UAAAW,KAAK;AAAA,SAAK;AAAEY,IAAAA,KAAK,EAAEZ,KAAK,CAACa,QAAN,CAAeD;AAAxB,GAAL;AAAA,CADe,EAEpB,EAFoB,CAAP,CAGbzB,UAAU,CAACC,UAAU,CAACI,SAAD,CAAX,CAHG,CAAf","sourcesContent":["import React, { Component } from \"react\";\nimport { withRouter } from \"react-router-dom\";\nimport { injectIntl } from \"react-intl\";\nimport { connect } from \"react-redux\";\nimport View from \"./View\";\nimport * as request from \"../../Common/Util/HTTPRequest\";\nclass Container extends Component {\n  constructor(props) {\n    super(props);\n    this.limit = 10;\n    this.state = { news: [], currentPage: 1, newsCount: 0 };\n  }\n  componentDidMount = () => {\n    this.fetchNews();\n  };\n  fetchNews = async () => {\n    let res = await request.getNewsList({\n      type: \"all\",\n      limit: this.limit,\n      offset: this.limit * (this.state.currentPage - 1)\n    });\n    let news = await res.json();\n    this.setState(prev => ({\n      news: prev.news.concat(news.rows),\n      newsCount: news.count\n    }));\n  };\n  onClickMore = () => {\n    this.setState(\n      prev => ({ currentPage: prev.currentPage + 1 }),\n      () => {\n        this.fetchNews();\n      }\n    );\n  };\n  render() {\n    const { news, newsCount } = this.state;\n    const { onClickMore } = this;\n    return <View news={news} onClickMore={onClickMore} newsCount={newsCount} />;\n  }\n}\nexport default connect(\n  state => ({ email: state.userinfo.email }),\n  {}\n)(withRouter(injectIntl(Container)));\n"]},"metadata":{},"sourceType":"module"}