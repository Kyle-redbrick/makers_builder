{"ast":null,"code":"import _regeneratorRuntime from \"/Users/jimmy/Documents/Wizschool/wizlab_web2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/jimmy/Documents/Wizschool/wizlab_web2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"/Users/jimmy/Documents/Wizschool/wizlab_web2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/jimmy/Documents/Wizschool/wizlab_web2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/jimmy/Documents/Wizschool/wizlab_web2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/jimmy/Documents/Wizschool/wizlab_web2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/jimmy/Documents/Wizschool/wizlab_web2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/Users/jimmy/Documents/Wizschool/wizlab_web2/src/Page/Mypage/Components/Subscribe/Container.js\";\nimport { Redirect } from \"react-router-dom\";\nimport React, { Component } from \"react\";\nimport * as request from \"../../../../Common/Util/HTTPRequest\";\nimport { MYPAGE_MODE } from \"../../../../Common/Util/Constant\";\nimport * as userInfoActions from \"../../../../Common/Store/Reducer/UserInfo\";\nimport { connect } from \"react-redux\";\nimport { withRouter } from \"react-router-dom\";\nimport { injectIntl } from \"react-intl\";\nimport View from \"./View\"; // import * as TrackingUtil from \"../../../../Common/Util/TrackingUtil\";\n\nimport PopUp, { showPopUp } from \"../../../../Common/Component/PopUp\";\nimport SignIn from \"../../../../Common/Component/SignIn\";\n\nvar Container =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(Container, _Component);\n\n  function Container(props) {\n    var _this;\n\n    _classCallCheck(this, Container);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(Container).call(this, props));\n\n    _this.componentDidMount = function () {\n      // TrackingUtil.sendPageEvent(\n      //   this.props.location.pathname,\n      //   this.props.userinfo.email\n      // );\n      if (_this.isMyPage) {\n        var email = _this.props.userinfo.email;\n\n        if (_this.mode === MYPAGE_MODE.SUBSCRIBE) {\n          _this.getSubscribersToMe(email, email);\n        } else if (_this.mode === MYPAGE_MODE.INTERESTED) {\n          _this.getInterestedUsers(email, email);\n        }\n      } else {\n        _this.getUserEmail();\n      }\n    };\n\n    _this.getUserEmail =\n    /*#__PURE__*/\n    _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee() {\n      var email;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return request.userEmailById({\n                id: _this.props.match.params.id\n              }).then(function (res) {\n                return res.json();\n              }).then(function (json) {\n                if (json.email) {\n                  if (json.signedOut) {\n                    window.location = \"\";\n                  } else {\n                    return json.email;\n                  }\n                } else {\n                  window.location = \"\";\n                }\n              }).catch(function (e) {\n                return console.error(e);\n              });\n\n            case 2:\n              email = _context.sent;\n\n              _this.getProfile(email);\n\n              if (_this.mode === MYPAGE_MODE.SUBSCRIBE) {\n                _this.getSubscribersToMe(email, _this.props.userinfo.email);\n              } else if (_this.mode === MYPAGE_MODE.INTERESTED) {\n                _this.getInterestedUsers(email, _this.props.userinfo.email);\n              }\n\n            case 5:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, this);\n    }));\n\n    _this.getProfile =\n    /*#__PURE__*/\n    function () {\n      var _ref2 = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee2(email) {\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                _context2.next = 2;\n                return request.userProfile({\n                  email: email\n                }).then(function (res) {\n                  return res.json();\n                }).then(function (json) {\n                  _this.setState({\n                    profile: json\n                  });\n                }).catch(function (e) {\n                  return console.error(e);\n                });\n\n              case 2:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n\n      return function (_x) {\n        return _ref2.apply(this, arguments);\n      };\n    }();\n\n    _this.getInterestedUsers =\n    /*#__PURE__*/\n    function () {\n      var _ref3 = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee3(email, loginEmail) {\n        return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                _context3.next = 2;\n                return request.getSubscribesByType({\n                  email: email,\n                  loginEmail: loginEmail,\n                  type: \"subjective\"\n                }).then(function (res) {\n                  return res.json();\n                }).then(function (json) {\n                  _this.setState({\n                    interestedUsers: json\n                  });\n                }).catch(function (e) {\n                  return console.error(e);\n                });\n\n              case 2:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this);\n      }));\n\n      return function (_x2, _x3) {\n        return _ref3.apply(this, arguments);\n      };\n    }();\n\n    _this.getSubscribersToMe =\n    /*#__PURE__*/\n    function () {\n      var _ref4 = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee4(email, loginEmail) {\n        return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                _context4.next = 2;\n                return request.getSubscribesByType({\n                  email: email,\n                  loginEmail: loginEmail,\n                  type: \"objective\"\n                }).then(function (res) {\n                  return res.json();\n                }).then(function (json) {\n                  _this.setState({\n                    subscribers: json\n                  });\n                }).catch(function (e) {\n                  return console.error(e);\n                });\n\n              case 2:\n              case \"end\":\n                return _context4.stop();\n            }\n          }\n        }, _callee4, this);\n      }));\n\n      return function (_x4, _x5) {\n        return _ref4.apply(this, arguments);\n      };\n    }();\n\n    _this.handleSubscribe = function (email) {\n      if (_this.lastLikeTime) {\n        if (new Date().getTime() - _this.lastLikeTime < 1200) {\n          _this.lastLikeTime = new Date().getTime();\n          showPopUp(React.createElement(PopUp.OneButton, {\n            title: _this.props.intl.formatMessage({\n              id: \"ID_POPUP_WARNING_REPEAT_CLICK_TITLE\"\n            }),\n            buttonName: _this.props.intl.formatMessage({\n              id: \"ID_POPUP_WARNING_REPEAT_CLICK_BTN\"\n            }),\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 112\n            },\n            __self: this\n          }), {\n            darkmode: true\n          });\n          return;\n        }\n      }\n\n      _this.lastLikeTime = new Date().getTime(); // 비 로그인 상태의 userpage 에서 구독하기를 누를 때\n\n      if (!_this.isMyPage && !_this.props.userinfo.email) {\n        showPopUp(React.createElement(PopUp.OneButton, {\n          intl: _this.props.intl,\n          titleId: \"ID_MYPAGE_POPUP_LOGIN_MESSAGE\",\n          buttonNameId: \"ID_MYPAGE_POPUP_LOGIN\",\n          buttonAction: function buttonAction() {\n            showPopUp(React.createElement(SignIn, {\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 135\n              },\n              __self: this\n            }), {\n              darkmode: true,\n              mobileFullscreen: true\n            });\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 130\n          },\n          __self: this\n        }), {\n          darkmode: true\n        });\n        return;\n      }\n\n      var params = {\n        creatorEmail: email,\n        email: _this.props.userinfo.email\n      };\n      request.addSubscribe(params).then(function (res) {\n        return res.json();\n      }).then(function (json) {\n        if (json) {\n          _this.componentDidMount();\n        } else {\n          showPopUp(React.createElement(PopUp.OneButton, {\n            title: _this.props.intl.formatMessage({\n              id: \"ID_POPUP_WARNING_REPEAT_CLICK_TITLE\"\n            }),\n            buttonName: _this.props.intl.formatMessage({\n              id: \"ID_POPUP_WARNING_REPEAT_CLICK_BTN\"\n            }),\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 151\n            },\n            __self: this\n          }), {\n            darkmode: true\n          });\n        }\n      });\n    };\n\n    _this.handleUnSubscribe = function (email) {\n      if (_this.lastLikeTime) {\n        if (new Date().getTime() - _this.lastLikeTime < 1200) {\n          _this.lastLikeTime = new Date().getTime();\n          showPopUp(React.createElement(PopUp.OneButton, {\n            title: _this.props.intl.formatMessage({\n              id: \"ID_POPUP_WARNING_REPEAT_CLICK_TITLE\"\n            }),\n            buttonName: _this.props.intl.formatMessage({\n              id: \"ID_POPUP_WARNING_REPEAT_CLICK_BTN\"\n            }),\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 170\n            },\n            __self: this\n          }), {\n            darkmode: true\n          });\n          return;\n        }\n      }\n\n      _this.lastLikeTime = new Date().getTime();\n      var params = {\n        creatorEmail: email,\n        email: _this.props.userinfo.email\n      };\n      request.removeSubscribe(params).then(function (res) {\n        return res.json();\n      }).then(function (json) {\n        if (json.success) {\n          _this.componentDidMount();\n        } else {\n          showPopUp(React.createElement(PopUp.OneButton, {\n            title: _this.props.intl.formatMessage({\n              id: \"ID_POPUP_WARNING_REPEAT_CLICK_TITLE\"\n            }),\n            buttonName: _this.props.intl.formatMessage({\n              id: \"ID_POPUP_WARNING_REPEAT_CLICK_BTN\"\n            }),\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 194\n            },\n            __self: this\n          }), {\n            darkmode: true\n          });\n        }\n      });\n    };\n\n    _this.onMouseHover = function (onHover, index) {\n      _this.setState({\n        hoverInfo: {\n          onHover: onHover,\n          index: index\n        }\n      });\n    };\n\n    _this.mode = _this.props.match.params.mode;\n    _this.isMyPage = _this.props.match.path.includes(\"mypage\");\n    _this.state = {\n      hoverInfo: {\n        onHover: false,\n        index: undefined\n      },\n      profile: undefined,\n      interestedUsers: undefined,\n      subscribers: undefined\n    };\n    return _this;\n  }\n\n  _createClass(Container, [{\n    key: \"render\",\n    value: function render() {\n      if (this.isMyPage && !this.props.userinfo.email) {\n        return React.createElement(Redirect, {\n          to: \"/\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 219\n          },\n          __self: this\n        });\n      }\n\n      var _this$state = this.state,\n          interestedUsers = _this$state.interestedUsers,\n          subscribers = _this$state.subscribers,\n          hoverInfo = _this$state.hoverInfo,\n          profile = _this$state.profile;\n      return React.createElement(View, {\n        intl: this.props.intl,\n        profile: profile,\n        isMyPage: this.isMyPage,\n        mode: this.mode,\n        MYPAGE_MODE: MYPAGE_MODE,\n        interestedUsers: interestedUsers,\n        subscribers: subscribers,\n        hoverInfo: hoverInfo // event\n        ,\n        handleSubscribe: this.handleSubscribe,\n        handleUnSubscribe: this.handleUnSubscribe,\n        onMouseHover: this.onMouseHover,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 225\n        },\n        __self: this\n      });\n    }\n  }]);\n\n  return Container;\n}(Component);\n\nexport default connect(function (state) {\n  return {\n    userinfo: state.userinfo\n  };\n}, {\n  updateUserInfo: userInfoActions.updateUserInfo\n})(injectIntl(withRouter(Container)));","map":{"version":3,"sources":["/Users/jimmy/Documents/Wizschool/wizlab_web2/src/Page/Mypage/Components/Subscribe/Container.js"],"names":["Redirect","React","Component","request","MYPAGE_MODE","userInfoActions","connect","withRouter","injectIntl","View","PopUp","showPopUp","SignIn","Container","props","componentDidMount","isMyPage","email","userinfo","mode","SUBSCRIBE","getSubscribersToMe","INTERESTED","getInterestedUsers","getUserEmail","userEmailById","id","match","params","then","res","json","signedOut","window","location","catch","e","console","error","getProfile","userProfile","setState","profile","loginEmail","getSubscribesByType","type","interestedUsers","subscribers","handleSubscribe","lastLikeTime","Date","getTime","intl","formatMessage","darkmode","mobileFullscreen","creatorEmail","addSubscribe","handleUnSubscribe","removeSubscribe","success","onMouseHover","onHover","index","hoverInfo","path","includes","state","undefined","updateUserInfo"],"mappings":"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","sourcesContent":["import { Redirect } from \"react-router-dom\";\nimport React, { Component } from \"react\";\nimport * as request from \"../../../../Common/Util/HTTPRequest\";\nimport { MYPAGE_MODE } from \"../../../../Common/Util/Constant\";\nimport * as userInfoActions from \"../../../../Common/Store/Reducer/UserInfo\";\nimport { connect } from \"react-redux\";\nimport { withRouter } from \"react-router-dom\";\nimport { injectIntl } from \"react-intl\";\nimport View from \"./View\";\n// import * as TrackingUtil from \"../../../../Common/Util/TrackingUtil\";\nimport PopUp, { showPopUp } from \"../../../../Common/Component/PopUp\";\nimport SignIn from \"../../../../Common/Component/SignIn\";\n\nclass Container extends Component {\n  constructor(props) {\n    super(props);\n\n    this.mode = this.props.match.params.mode;\n    this.isMyPage = this.props.match.path.includes(\"mypage\");\n    this.state = {\n      hoverInfo: {\n        onHover: false,\n        index: undefined\n      },\n      profile: undefined,\n      interestedUsers: undefined,\n      subscribers: undefined\n    };\n  }\n\n  componentDidMount = () => {\n    // TrackingUtil.sendPageEvent(\n    //   this.props.location.pathname,\n    //   this.props.userinfo.email\n    // );\n    if (this.isMyPage) {\n      const { email } = this.props.userinfo;\n      if (this.mode === MYPAGE_MODE.SUBSCRIBE) {\n        this.getSubscribersToMe(email, email);\n      } else if (this.mode === MYPAGE_MODE.INTERESTED) {\n        this.getInterestedUsers(email, email);\n      }\n    } else {\n      this.getUserEmail();\n    }\n  };\n\n  getUserEmail = async () => {\n    const email = await request\n      .userEmailById({ id: this.props.match.params.id })\n      .then(res => res.json())\n      .then(json => {\n        if (json.email) {\n          if (json.signedOut) {\n            window.location = \"\";\n          } else {\n            return json.email;\n          }\n        } else {\n          window.location = \"\";\n        }\n      })\n      .catch(e => console.error(e));\n\n    this.getProfile(email);\n    if (this.mode === MYPAGE_MODE.SUBSCRIBE) {\n      this.getSubscribersToMe(email, this.props.userinfo.email);\n    } else if (this.mode === MYPAGE_MODE.INTERESTED) {\n      this.getInterestedUsers(email, this.props.userinfo.email);\n    }\n  };\n\n  getProfile = async email => {\n    await request\n      .userProfile({ email })\n      .then(res => res.json())\n      .then(json => {\n        this.setState({\n          profile: json\n        });\n      })\n      .catch(e => console.error(e));\n  };\n\n  // 관심회원 목록\n  getInterestedUsers = async (email, loginEmail) => {\n    await request\n      .getSubscribesByType({ email, loginEmail, type: \"subjective\" })\n      .then(res => res.json())\n      .then(json => {\n        this.setState({ interestedUsers: json });\n      })\n      .catch(e => console.error(e));\n  };\n\n  // 구독자\n  getSubscribersToMe = async (email, loginEmail) => {\n    await request\n      .getSubscribesByType({ email, loginEmail, type: \"objective\" })\n      .then(res => res.json())\n      .then(json => {\n        this.setState({ subscribers: json });\n      })\n      .catch(e => console.error(e));\n  };\n\n  handleSubscribe = email => {\n    if (this.lastLikeTime) {\n      if (new Date().getTime() - this.lastLikeTime < 1200) {\n        this.lastLikeTime = new Date().getTime();\n        showPopUp(\n          <PopUp.OneButton\n            title={this.props.intl.formatMessage({\n              id: \"ID_POPUP_WARNING_REPEAT_CLICK_TITLE\"\n            })}\n            buttonName={this.props.intl.formatMessage({\n              id: \"ID_POPUP_WARNING_REPEAT_CLICK_BTN\"\n            })}\n          />,\n          { darkmode: true }\n        );\n        return;\n      }\n    }\n    this.lastLikeTime = new Date().getTime();\n\n    // 비 로그인 상태의 userpage 에서 구독하기를 누를 때\n    if (!this.isMyPage && !this.props.userinfo.email) {\n      showPopUp(\n        <PopUp.OneButton\n          intl={this.props.intl}\n          titleId=\"ID_MYPAGE_POPUP_LOGIN_MESSAGE\"\n          buttonNameId=\"ID_MYPAGE_POPUP_LOGIN\"\n          buttonAction={() => {\n            showPopUp(<SignIn />, { darkmode: true, mobileFullscreen: true });\n          }}\n        />,\n        { darkmode: true }\n      );\n      return;\n    }\n    const params = { creatorEmail: email, email: this.props.userinfo.email };\n    request\n      .addSubscribe(params)\n      .then(res => res.json())\n      .then(json => {\n        if (json) {\n          this.componentDidMount();\n        } else {\n          showPopUp(\n            <PopUp.OneButton\n              title={this.props.intl.formatMessage({\n                id: \"ID_POPUP_WARNING_REPEAT_CLICK_TITLE\"\n              })}\n              buttonName={this.props.intl.formatMessage({\n                id: \"ID_POPUP_WARNING_REPEAT_CLICK_BTN\"\n              })}\n            />,\n            { darkmode: true }\n          );\n        }\n      });\n  };\n\n  handleUnSubscribe = email => {\n    if (this.lastLikeTime) {\n      if (new Date().getTime() - this.lastLikeTime < 1200) {\n        this.lastLikeTime = new Date().getTime();\n        showPopUp(\n          <PopUp.OneButton\n            title={this.props.intl.formatMessage({\n              id: \"ID_POPUP_WARNING_REPEAT_CLICK_TITLE\"\n            })}\n            buttonName={this.props.intl.formatMessage({\n              id: \"ID_POPUP_WARNING_REPEAT_CLICK_BTN\"\n            })}\n          />,\n          { darkmode: true }\n        );\n        return;\n      }\n    }\n    this.lastLikeTime = new Date().getTime();\n\n    const params = { creatorEmail: email, email: this.props.userinfo.email };\n    request\n      .removeSubscribe(params)\n      .then(res => res.json())\n      .then(json => {\n        if (json.success) {\n          this.componentDidMount();\n        } else {\n          showPopUp(\n            <PopUp.OneButton\n              title={this.props.intl.formatMessage({\n                id: \"ID_POPUP_WARNING_REPEAT_CLICK_TITLE\"\n              })}\n              buttonName={this.props.intl.formatMessage({\n                id: \"ID_POPUP_WARNING_REPEAT_CLICK_BTN\"\n              })}\n            />,\n            { darkmode: true }\n          );\n        }\n      });\n  };\n\n  onMouseHover = (onHover, index) => {\n    this.setState({\n      hoverInfo: {\n        onHover,\n        index\n      }\n    });\n  };\n\n  render() {\n    if (this.isMyPage && !this.props.userinfo.email) {\n      return <Redirect to=\"/\" />;\n    }\n\n    const { interestedUsers, subscribers, hoverInfo, profile } = this.state;\n\n    return (\n      <View\n        intl={this.props.intl}\n        profile={profile}\n        isMyPage={this.isMyPage}\n        mode={this.mode}\n        MYPAGE_MODE={MYPAGE_MODE}\n        interestedUsers={interestedUsers}\n        subscribers={subscribers}\n        hoverInfo={hoverInfo}\n        // event\n        handleSubscribe={this.handleSubscribe}\n        handleUnSubscribe={this.handleUnSubscribe}\n        onMouseHover={this.onMouseHover}\n      />\n    );\n  }\n}\n\nexport default connect(\n  state => ({ userinfo: state.userinfo }),\n  {\n    updateUserInfo: userInfoActions.updateUserInfo\n  }\n)(injectIntl(withRouter(Container)));\n"]},"metadata":{},"sourceType":"module"}