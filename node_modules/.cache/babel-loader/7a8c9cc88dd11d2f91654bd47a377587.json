{"ast":null,"code":"import _regeneratorRuntime from \"/Users/jimmy/Documents/Wizschool/wizlab_web2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/jimmy/Documents/Wizschool/wizlab_web2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"/Users/jimmy/Documents/Wizschool/wizlab_web2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/jimmy/Documents/Wizschool/wizlab_web2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _assertThisInitialized from \"/Users/jimmy/Documents/Wizschool/wizlab_web2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";\nimport _inherits from \"/Users/jimmy/Documents/Wizschool/wizlab_web2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _possibleConstructorReturn from \"/Users/jimmy/Documents/Wizschool/wizlab_web2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/jimmy/Documents/Wizschool/wizlab_web2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nvar _jsxFileName = \"/Users/jimmy/Documents/Wizschool/wizlab_web2/src/Page/Builder/Component/Project/Container.js\";\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\n\nimport React, { Component } from \"react\";\nimport { connect } from \"react-redux\";\nimport { injectIntl } from \"react-intl\";\nimport View from \"./View\";\nimport * as request from \"../../../../Common/Util/HTTPRequest\";\nimport { PAGETYPE } from \"../../../../Common/Util/Constant\";\nimport generatePID from \"../../../../Common/Util/PIDGenerator\";\nimport * as TrackingUtil from \"../../../../Common/Util/TrackingUtil\";\nimport store from \"../../Store\";\nimport PopUp, { showPopUp } from \"../../../../Common/Component/PopUp\";\nimport { withRouter } from \"react-router-dom\";\nexport var PROJECT_CATEGORY = {\n  NEW: \"NEW\",\n  LOAD: \"LOAD\"\n};\n\nvar Container = /*#__PURE__*/function (_Component) {\n  _inherits(Container, _Component);\n\n  var _super = _createSuper(Container);\n\n  function Container(_props) {\n    var _this;\n\n    _classCallCheck(this, Container);\n\n    _this = _super.call(this, _props);\n\n    _this.componentDidMount = function () {\n      _this.getMyProjects({\n        currentPage: 1,\n        keyword: \"\"\n      });\n\n      request.getTemplateProjects().then(function (res) {\n        return res.json();\n      }).then(function (json) {\n        _this.setState({\n          templateProjects: json\n        }, function () {\n          _this.loadTemplateByHome();\n        });\n      }).catch(function (e) {\n        console.error(e);\n      });\n\n      _this.onSizeChange();\n\n      window.addEventListener(\"resize\", _this.onSizeChange);\n    };\n\n    _this.componentWillUnmount = function () {\n      window.removeEventListener(\"resize\", _this.onSizeChange);\n      localStorage.removeItem(\"templateId\");\n    };\n\n    _this.onSizeChange = function () {\n      if (!document.getElementById(\"ProjectItems\")) return;\n      var wrapWidth = document.getElementById(\"ProjectItems\").getBoundingClientRect().width;\n      var unitWidth = 180;\n      var itemCount = parseInt(wrapWidth / 200);\n      var extraWidth = wrapWidth % 200;\n      var projectItemWidth = unitWidth + extraWidth / itemCount;\n\n      _this.setState({\n        projectItemWidth: projectItemWidth,\n        lastItemIndex: itemCount\n      });\n    };\n\n    _this.getMyProjects = function (props) {\n      if (!_this.props.email) return;\n      var currentPage = props.currentPage,\n          keyword = props.keyword;\n      var pageOffset = Math.ceil((currentPage - 1) * _this.pageSize);\n      var limit = _this.pageSize;\n      keyword = encodeURIComponent(keyword);\n      var params = {\n        email: _this.props.email,\n        offset: pageOffset,\n        limit: limit,\n        keyword: keyword\n      };\n      request.getDevelopingProjects(params).then(function (res) {\n        return res.json();\n      }).then(function (result) {\n        var count = result.count,\n            rows = result.rows;\n\n        _this.setState(function (prev) {\n          return {\n            myprojects: currentPage === 1 ? rows : prev.myprojects.concat(rows),\n            myprojectCnt: count\n          };\n        });\n      }).catch(function (err) {\n        return console.error(err);\n      });\n    };\n\n    _this.createNewProject = function (template) {\n      var email = _this.props.email;\n      var is3dProject = template.type === \"js3d\";\n\n      if (email) {\n        var isEmptyTemplete = template.order === 0;\n        TrackingUtil.sendGAEvent({\n          category: \"Builder\",\n          action: \"Create\".concat(isEmptyTemplete ? \"New\" : \"Templete\", \"Project\"),\n          label: isEmptyTemplete ? undefined : template.name\n        });\n        var pageURL = \"/\".concat(is3dProject ? PAGETYPE.BUILDER3D : PAGETYPE.BUILDER, \"/\").concat(generatePID(email));\n\n        if (template.id) {\n          pageURL += \"/\".concat(template.id);\n        }\n\n        _this.props.history.replace({\n          pathname: pageURL\n        });\n\n        if (!is3dProject) window.location.reload();\n      } else {\n        var _pageURL = \"/\".concat(is3dProject ? PAGETYPE.BUILDER3D : PAGETYPE.BUILDER, \"?t=\").concat(template.id);\n\n        _this.props.history.replace({\n          pathname: _pageURL\n        });\n\n        window.location.reload();\n      }\n    };\n\n    _this.loadProject = function (pId, type) {\n      var is3dProject = type === \"js3d\";\n      TrackingUtil.sendGAEvent({\n        category: \"Builder\",\n        action: \"LoadProject\"\n      });\n\n      _this.props.history.replace({\n        pathname: \"/\".concat(is3dProject ? PAGETYPE.BUILDER3D : PAGETYPE.BUILDER, \"/\").concat(pId)\n      });\n\n      if (!is3dProject) window.location.reload();\n    };\n\n    _this.loadMore = function () {\n      _this.setState(function (prev) {\n        return {\n          currentPage: prev.currentPage + 1\n        };\n      }, function () {\n        _this.getMyProjects({\n          currentPage: _this.state.currentPage,\n          keyword: _this.state.keyword\n        });\n      });\n    };\n\n    _this.loadTemplateByHome = function () {\n      if (_this.templateId && _this.state.templateProjects.length > 0) {\n        _this.state.templateProjects.forEach(function (element) {\n          if (element.id === Number(_this.templateId)) {\n            _this.createNewProject(element);\n\n            localStorage.removeItem(\"templateId\");\n            return;\n          }\n        });\n      }\n    };\n\n    _this.handleKeywordChange = function (e) {\n      _this.setState({\n        keyword: e.target.value,\n        currentPage: 1\n      }, function () {\n        if (_this.searchTimer) {\n          clearTimeout(_this.searchTimer);\n        }\n\n        _this.searchTimer = setTimeout(function () {\n          TrackingUtil.sendGAEvent({\n            category: \"Builder\",\n            action: \"SearchProject\"\n          });\n\n          _this.getMyProjects({\n            currentPage: _this.state.currentPage,\n            keyword: _this.state.keyword\n          });\n        }, 500);\n      });\n    };\n\n    _this.handleOnScroll = function () {\n      var container = _this.projectsRef.current;\n\n      if (container.offsetHeight + container.scrollTop >= container.scrollHeight) {\n        _this.loadMore();\n      }\n    };\n\n    _this.handleCopy = function (pId) {\n      TrackingUtil.sendGAEvent({\n        category: \"Builder\",\n        action: \"ProjectActions\",\n        label: \"Copy\"\n      });\n      showPopUp( /*#__PURE__*/React.createElement(PopUp.TwoButton, {\n        titleId: \"ID_PROJECT_POPUP_COPY_TITLE\",\n        cancelButtonNameId: \"ID_PROJECT_POPUP_COPY_CANCEL\",\n        confirmButtonNameId: \"ID_PROJECT_POPUP_COPY_OK\",\n        confirmAction: function confirmAction() {\n          return _this.copyProject(pId);\n        },\n        darkMode: true,\n        __self: _assertThisInitialized(_this),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 205,\n          columnNumber: 7\n        }\n      }), {\n        store: store,\n        dismissOverlay: true\n      });\n    };\n\n    _this.handleEdit = function (pId, name) {\n      TrackingUtil.sendGAEvent({\n        category: \"Builder\",\n        action: \"ProjectActions\",\n        label: \"Edit\"\n      });\n      showPopUp( /*#__PURE__*/React.createElement(PopUp.OneInput, {\n        titleId: \"ID_PROJECT_POPUP_EDIT_TITLE\",\n        defaultInput: name,\n        buttonNameId: \"ID_PROJECT_POPUP_EDIT_OK\",\n        buttonAction: function buttonAction(newVal) {\n          _this.editProject(pId, newVal);\n        },\n        __self: _assertThisInitialized(_this),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 222,\n          columnNumber: 7\n        }\n      }), {\n        store: store,\n        dismissOverlay: true\n      });\n    };\n\n    _this.handleRemove = function (pId, name) {\n      TrackingUtil.sendGAEvent({\n        category: \"Builder\",\n        action: \"ProjectActions\",\n        label: \"Remove\"\n      });\n      showPopUp( /*#__PURE__*/React.createElement(PopUp.TwoButton, {\n        titleId: \"ID_PROJECT_POPUP_DELETE_TITLE\",\n        titleValue: {\n          projectName: name\n        },\n        subtitleId: \"ID_PROJECT_POPUP_DELETE_SUB_TITLE\",\n        cancelButtonNameId: \"ID_PROJECT_POPUP_DELETE_CANCEL\",\n        confirmButtonNameId: \"ID_PROJECT_POPUP_DELETE_OK\",\n        confirmAction: function confirmAction() {\n          return _this.deleteProject(pId);\n        },\n        __self: _assertThisInitialized(_this),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 240,\n          columnNumber: 7\n        }\n      }), {\n        store: store,\n        dismissOverlay: true\n      });\n    };\n\n    _this.deleteProject = function (pId) {\n      request.deleteDevelopingProject({\n        pId: pId,\n        email: _this.props.email\n      }).then(function (res) {\n        return res.json();\n      }).then(function (json) {\n        _this.getMyProjects({\n          currentPage: _this.state.currentPage,\n          keyword: _this.state.keyword\n        });\n      }).catch(function (e) {\n        console.error(e);\n      });\n    };\n\n    _this.copyProject = /*#__PURE__*/function () {\n      var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(pId) {\n        var project, param;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.next = 2;\n                return request.getDevelopingProject({\n                  pId: pId\n                }).then(function (res) {\n                  return res.json();\n                });\n\n              case 2:\n                project = _context.sent;\n                param = {\n                  pId: generatePID(_this.props.email),\n                  email: project.email,\n                  icon: project.icon,\n                  name: \"\".concat(project.name, \" copy\"),\n                  state: project.state,\n                  url: project.url,\n                  useCustomIcon: project.useCustomIcon\n                };\n                request.copyDevelopingProject({\n                  param: param\n                }).then(function (res) {\n                  return res.json();\n                }).then(function (json) {\n                  _this.getMyProjects({\n                    currentPage: _this.state.currentPage,\n                    keyword: _this.state.keyword\n                  });\n                }).catch(function (e) {\n                  return console.error(e);\n                });\n\n              case 5:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee);\n      }));\n\n      return function (_x) {\n        return _ref.apply(this, arguments);\n      };\n    }();\n\n    _this.editProject = function (pId, newName) {\n      request.updateDevelopingProject({\n        pId: pId,\n        name: newName\n      }).then(function (res) {\n        return res.json;\n      }).then(function (json) {\n        _this.getMyProjects({\n          currentPage: _this.state.currentPage,\n          keyword: _this.state.keyword\n        });\n      }).catch(function (e) {\n        return console.error(e);\n      });\n    };\n\n    _this.state = {\n      myprojects: [],\n      myprojectCnt: undefined,\n      currentPage: 1,\n      keyword: \"\",\n      templateProjects: [],\n      projectItemWidth: 180,\n      lastItemIndex: 0,\n      // for More Popup Position\n      isLoading: false\n    };\n    _this.pageSize = 50;\n    _this.projectsRef = React.createRef();\n    _this.templateId = localStorage.getItem(\"templateId\");\n    return _this;\n  }\n\n  _createClass(Container, [{\n    key: \"render\",\n    value: function render() {\n      var _this$props = this.props,\n          canClose = _this$props.canClose,\n          closeProjectPopup = _this$props.closeProjectPopup,\n          intl = _this$props.intl,\n          userId = _this$props.userId,\n          email = _this$props.email,\n          pageType = _this$props.pageType;\n      var _this$state = this.state,\n          myprojects = _this$state.myprojects,\n          myprojectCnt = _this$state.myprojectCnt,\n          templateProjects = _this$state.templateProjects,\n          keyword = _this$state.keyword,\n          projectItemWidth = _this$state.projectItemWidth,\n          lastItemIndex = _this$state.lastItemIndex;\n      var getMyProjects = this.getMyProjects,\n          pageSize = this.pageSize,\n          createNewProject = this.createNewProject,\n          handleKeywordChange = this.handleKeywordChange,\n          handleOnScroll = this.handleOnScroll,\n          projectsRef = this.projectsRef,\n          loadProject = this.loadProject,\n          handleCopy = this.handleCopy,\n          handleEdit = this.handleEdit,\n          handleRemove = this.handleRemove;\n      return /*#__PURE__*/React.createElement(View, {\n        canClose: canClose,\n        closeProjectPopup: closeProjectPopup,\n        getMyProjects: getMyProjects,\n        myprojects: myprojects,\n        myprojectCnt: myprojectCnt,\n        pageSize: pageSize,\n        templateProjects: templateProjects,\n        keyword: keyword,\n        createNewProject: createNewProject,\n        handleKeywordChange: handleKeywordChange,\n        handleOnScroll: handleOnScroll,\n        loadProject: loadProject,\n        handleCopy: handleCopy,\n        handleEdit: handleEdit,\n        handleRemove: handleRemove,\n        intl: intl,\n        projectsRef: projectsRef,\n        projectItemWidth: projectItemWidth,\n        lastItemIndex: lastItemIndex,\n        userId: userId,\n        email: email,\n        pageType: pageType,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 336,\n          columnNumber: 7\n        }\n      });\n    }\n  }]);\n\n  return Container;\n}(Component);\n\nexport default connect(function (state) {\n  return {\n    email: state.userinfo.email,\n    userId: state.userinfo.id\n  };\n}, {})(injectIntl(withRouter(Container)));","map":{"version":3,"sources":["/Users/jimmy/Documents/Wizschool/wizlab_web2/src/Page/Builder/Component/Project/Container.js"],"names":["React","Component","connect","injectIntl","View","request","PAGETYPE","generatePID","TrackingUtil","store","PopUp","showPopUp","withRouter","PROJECT_CATEGORY","NEW","LOAD","Container","props","componentDidMount","getMyProjects","currentPage","keyword","getTemplateProjects","then","res","json","setState","templateProjects","loadTemplateByHome","catch","e","console","error","onSizeChange","window","addEventListener","componentWillUnmount","removeEventListener","localStorage","removeItem","document","getElementById","wrapWidth","getBoundingClientRect","width","unitWidth","itemCount","parseInt","extraWidth","projectItemWidth","lastItemIndex","email","pageOffset","Math","ceil","pageSize","limit","encodeURIComponent","params","offset","getDevelopingProjects","result","count","rows","prev","myprojects","concat","myprojectCnt","err","createNewProject","template","is3dProject","type","isEmptyTemplete","order","sendGAEvent","category","action","label","undefined","name","pageURL","BUILDER3D","BUILDER","id","history","replace","pathname","location","reload","loadProject","pId","loadMore","state","templateId","length","forEach","element","Number","handleKeywordChange","target","value","searchTimer","clearTimeout","setTimeout","handleOnScroll","container","projectsRef","current","offsetHeight","scrollTop","scrollHeight","handleCopy","copyProject","dismissOverlay","handleEdit","newVal","editProject","handleRemove","projectName","deleteProject","deleteDevelopingProject","getDevelopingProject","project","param","icon","url","useCustomIcon","copyDevelopingProject","newName","updateDevelopingProject","isLoading","createRef","getItem","canClose","closeProjectPopup","intl","userId","pageType","userinfo"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport { connect } from \"react-redux\";\nimport { injectIntl } from \"react-intl\";\nimport View from \"./View\";\nimport * as request from \"../../../../Common/Util/HTTPRequest\";\nimport { PAGETYPE } from \"../../../../Common/Util/Constant\";\nimport generatePID from \"../../../../Common/Util/PIDGenerator\";\nimport * as TrackingUtil from \"../../../../Common/Util/TrackingUtil\";\nimport store from \"../../Store\";\nimport PopUp, { showPopUp } from \"../../../../Common/Component/PopUp\";\nimport { withRouter } from \"react-router-dom\";\nexport const PROJECT_CATEGORY = { NEW: \"NEW\", LOAD: \"LOAD\" };\n\nclass Container extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      myprojects: [],\n      myprojectCnt: undefined,\n      currentPage: 1,\n      keyword: \"\",\n      templateProjects: [],\n      projectItemWidth: 180,\n      lastItemIndex: 0, // for More Popup Position\n\n      isLoading: false\n    };\n    this.pageSize = 50;\n    this.projectsRef = React.createRef();\n    this.templateId = localStorage.getItem(\"templateId\");\n  }\n\n  componentDidMount = () => {\n    this.getMyProjects({ currentPage: 1, keyword: \"\" });\n    request\n      .getTemplateProjects()\n      .then(res => res.json())\n      .then(json => {\n        this.setState({ templateProjects: json }, () => {\n          this.loadTemplateByHome();\n        });\n      })\n      .catch(e => {\n        console.error(e);\n      });\n    this.onSizeChange();\n    window.addEventListener(\"resize\", this.onSizeChange);\n  };\n\n  componentWillUnmount = () => {\n    window.removeEventListener(\"resize\", this.onSizeChange);\n    localStorage.removeItem(\"templateId\");\n  };\n\n  onSizeChange = () => {\n    if (!document.getElementById(\"ProjectItems\")) return;\n    const wrapWidth = document\n      .getElementById(\"ProjectItems\")\n      .getBoundingClientRect().width;\n    const unitWidth = 180;\n    const itemCount = parseInt(wrapWidth / 200);\n    const extraWidth = wrapWidth % 200;\n    const projectItemWidth = unitWidth + extraWidth / itemCount;\n\n    this.setState({\n      projectItemWidth,\n      lastItemIndex: itemCount\n    });\n  };\n\n  getMyProjects = props => {\n    if (!this.props.email) return;\n    let { currentPage, keyword } = props;\n    let pageOffset = Math.ceil((currentPage - 1) * this.pageSize);\n    let limit = this.pageSize;\n    keyword = encodeURIComponent(keyword);\n\n    let params = {\n      email: this.props.email,\n      offset: pageOffset,\n      limit: limit,\n      keyword: keyword\n    };\n    request\n      .getDevelopingProjects(params)\n      .then(res => res.json())\n      .then(result => {\n        const { count, rows } = result;\n        this.setState(prev => {\n          return {\n            myprojects: currentPage === 1 ? rows : prev.myprojects.concat(rows),\n            myprojectCnt: count\n          };\n        });\n      })\n      .catch(err => console.error(err));\n  };\n  createNewProject = template => {\n    const { email } = this.props;\n    const is3dProject = template.type === \"js3d\";\n    if (email) {\n      const isEmptyTemplete = template.order === 0;\n      TrackingUtil.sendGAEvent({\n        category: \"Builder\",\n        action: `Create${isEmptyTemplete ? \"New\" : \"Templete\"}Project`,\n        label: isEmptyTemplete ? undefined : template.name\n      });\n      let pageURL = `/${\n        is3dProject ? PAGETYPE.BUILDER3D : PAGETYPE.BUILDER\n      }/${generatePID(email)}`;\n      if (template.id) {\n        pageURL += `/${template.id}`;\n      }\n\n      this.props.history.replace({\n        pathname: pageURL\n      });\n      if (!is3dProject) window.location.reload();\n    } else {\n      let pageURL = `/${\n        is3dProject ? PAGETYPE.BUILDER3D : PAGETYPE.BUILDER\n      }?t=${template.id}`;\n\n      this.props.history.replace({\n        pathname: pageURL\n      });\n      window.location.reload();\n    }\n  };\n\n  loadProject = (pId, type) => {\n    const is3dProject = type === \"js3d\";\n    TrackingUtil.sendGAEvent({\n      category: \"Builder\",\n      action: `LoadProject`\n    });\n    this.props.history.replace({\n      pathname: `/${is3dProject ? PAGETYPE.BUILDER3D : PAGETYPE.BUILDER}/${pId}`\n    });\n    if (!is3dProject) window.location.reload();\n  };\n\n  loadMore = () => {\n    this.setState(\n      prev => {\n        return { currentPage: prev.currentPage + 1 };\n      },\n      () => {\n        this.getMyProjects({\n          currentPage: this.state.currentPage,\n          keyword: this.state.keyword\n        });\n      }\n    );\n  };\n\n  loadTemplateByHome = () => {\n    if (this.templateId && this.state.templateProjects.length > 0) {\n      this.state.templateProjects.forEach(element => {\n        if (element.id === Number(this.templateId)) {\n          this.createNewProject(element);\n          localStorage.removeItem(\"templateId\");\n          return;\n        }\n      });\n    }\n  };\n\n  handleKeywordChange = e => {\n    this.setState({ keyword: e.target.value, currentPage: 1 }, () => {\n      if (this.searchTimer) {\n        clearTimeout(this.searchTimer);\n      }\n      this.searchTimer = setTimeout(() => {\n        TrackingUtil.sendGAEvent({\n          category: \"Builder\",\n          action: `SearchProject`\n        });\n\n        this.getMyProjects({\n          currentPage: this.state.currentPage,\n          keyword: this.state.keyword\n        });\n      }, 500);\n    });\n  };\n\n  handleOnScroll = () => {\n    const container = this.projectsRef.current;\n    if (\n      container.offsetHeight + container.scrollTop >=\n      container.scrollHeight\n    ) {\n      this.loadMore();\n    }\n  };\n\n  handleCopy = pId => {\n    TrackingUtil.sendGAEvent({\n      category: \"Builder\",\n      action: `ProjectActions`,\n      label: \"Copy\"\n    });\n    showPopUp(\n      <PopUp.TwoButton\n        titleId=\"ID_PROJECT_POPUP_COPY_TITLE\"\n        cancelButtonNameId=\"ID_PROJECT_POPUP_COPY_CANCEL\"\n        confirmButtonNameId=\"ID_PROJECT_POPUP_COPY_OK\"\n        confirmAction={() => this.copyProject(pId)}\n        darkMode={true}\n      />,\n      { store, dismissOverlay: true }\n    );\n  };\n  handleEdit = (pId, name) => {\n    TrackingUtil.sendGAEvent({\n      category: \"Builder\",\n      action: `ProjectActions`,\n      label: \"Edit\"\n    });\n    showPopUp(\n      <PopUp.OneInput\n        titleId=\"ID_PROJECT_POPUP_EDIT_TITLE\"\n        defaultInput={name}\n        buttonNameId=\"ID_PROJECT_POPUP_EDIT_OK\"\n        buttonAction={newVal => {\n          this.editProject(pId, newVal);\n        }}\n      />,\n      { store, dismissOverlay: true }\n    );\n  };\n  handleRemove = (pId, name) => {\n    TrackingUtil.sendGAEvent({\n      category: \"Builder\",\n      action: `ProjectActions`,\n      label: \"Remove\"\n    });\n    showPopUp(\n      <PopUp.TwoButton\n        titleId=\"ID_PROJECT_POPUP_DELETE_TITLE\"\n        titleValue={{ projectName: name }}\n        subtitleId=\"ID_PROJECT_POPUP_DELETE_SUB_TITLE\"\n        cancelButtonNameId=\"ID_PROJECT_POPUP_DELETE_CANCEL\"\n        confirmButtonNameId=\"ID_PROJECT_POPUP_DELETE_OK\"\n        confirmAction={() => this.deleteProject(pId)}\n      />,\n      { store, dismissOverlay: true }\n    );\n  };\n\n  deleteProject = pId => {\n    request\n      .deleteDevelopingProject({ pId, email: this.props.email })\n      .then(res => res.json())\n      .then(json => {\n        this.getMyProjects({\n          currentPage: this.state.currentPage,\n          keyword: this.state.keyword\n        });\n      })\n      .catch(e => {\n        console.error(e);\n      });\n  };\n\n  copyProject = async pId => {\n    let project = await request\n      .getDevelopingProject({ pId })\n      .then(res => res.json());\n    let param = {\n      pId: generatePID(this.props.email),\n      email: project.email,\n      icon: project.icon,\n      name: `${project.name} copy`,\n      state: project.state,\n      url: project.url,\n      useCustomIcon: project.useCustomIcon\n    };\n\n    request\n      .copyDevelopingProject({ param })\n      .then(res => res.json())\n      .then(json => {\n        this.getMyProjects({\n          currentPage: this.state.currentPage,\n          keyword: this.state.keyword\n        });\n      })\n      .catch(e => console.error(e));\n  };\n\n  editProject = (pId, newName) => {\n    request\n      .updateDevelopingProject({ pId, name: newName })\n      .then(res => res.json)\n      .then(json => {\n        this.getMyProjects({\n          currentPage: this.state.currentPage,\n          keyword: this.state.keyword\n        });\n      })\n      .catch(e => console.error(e));\n  };\n\n  render() {\n    const {\n      canClose,\n      closeProjectPopup,\n      intl,\n      userId,\n      email,\n      pageType\n    } = this.props;\n    const {\n      myprojects,\n      myprojectCnt,\n      templateProjects,\n      keyword,\n      projectItemWidth,\n      lastItemIndex\n    } = this.state;\n    const {\n      getMyProjects,\n      pageSize,\n      createNewProject,\n      handleKeywordChange,\n      handleOnScroll,\n      projectsRef,\n      loadProject,\n      handleCopy,\n      handleEdit,\n      handleRemove\n    } = this;\n    return (\n      <View\n        canClose={canClose}\n        closeProjectPopup={closeProjectPopup}\n        getMyProjects={getMyProjects}\n        myprojects={myprojects}\n        myprojectCnt={myprojectCnt}\n        pageSize={pageSize}\n        templateProjects={templateProjects}\n        keyword={keyword}\n        createNewProject={createNewProject}\n        handleKeywordChange={handleKeywordChange}\n        handleOnScroll={handleOnScroll}\n        loadProject={loadProject}\n        handleCopy={handleCopy}\n        handleEdit={handleEdit}\n        handleRemove={handleRemove}\n        intl={intl}\n        projectsRef={projectsRef}\n        projectItemWidth={projectItemWidth}\n        lastItemIndex={lastItemIndex}\n        userId={userId}\n        email={email}\n        pageType={pageType}\n      />\n    );\n  }\n}\n\nexport default connect(\n  state => ({ email: state.userinfo.email, userId: state.userinfo.id }),\n  {}\n)(injectIntl(withRouter(Container)));\n"]},"metadata":{},"sourceType":"module"}