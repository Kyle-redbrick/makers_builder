{"ast":null,"code":"import _defineProperty from \"/Users/jimmy/Documents/Wizschool/wizlab_web2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _regeneratorRuntime from \"/Users/jimmy/Documents/Wizschool/wizlab_web2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/jimmy/Documents/Wizschool/wizlab_web2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"/Users/jimmy/Documents/Wizschool/wizlab_web2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/jimmy/Documents/Wizschool/wizlab_web2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _assertThisInitialized from \"/Users/jimmy/Documents/Wizschool/wizlab_web2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";\nimport _inherits from \"/Users/jimmy/Documents/Wizschool/wizlab_web2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _possibleConstructorReturn from \"/Users/jimmy/Documents/Wizschool/wizlab_web2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/jimmy/Documents/Wizschool/wizlab_web2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nvar _jsxFileName = \"/Users/jimmy/Documents/Wizschool/wizlab_web2/src/Page/MyAPK/Components/APKInfo/Container.js\";\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\n\nimport React, { Component } from \"react\";\nimport * as request from \"../../../../Common/Util/HTTPRequest\";\nimport { URL } from \"../../../../Common/Util/Constant\";\nimport { connect } from \"react-redux\";\nimport { injectIntl } from \"react-intl\";\nimport View from \"./View\";\nimport PopUp, { showPopUp } from \"../../../../Common/Component/PopUp\";\n\nvar Container = /*#__PURE__*/function (_Component) {\n  _inherits(Container, _Component);\n\n  var _super = _createSuper(Container);\n\n  function Container(props) {\n    var _this;\n\n    _classCallCheck(this, Container);\n\n    _this = _super.call(this, props);\n\n    _this.componentDidMount = function () {};\n\n    _this.componentDidUpdate = function (prevProps, prevState) {\n      if (prevProps.isShowAPKInfo !== _this.props.isShowAPKInfo) {\n        _this.handleIsShowAPKInfo(_this.props.isShowAPKInfo);\n      }\n    };\n\n    _this.handleIsShowAPKInfo = function (isShowAPKInfo) {\n      _this.setState({\n        isShowAPKInfo: isShowAPKInfo\n      });\n    };\n\n    _this.checkIsValidAppName = function () {\n      var appName = _this.state.appName;\n      var emptyString = appName === \"\";\n      var whiteSpace = appName[0] === \" \";\n      var isValidAppName = !emptyString && !whiteSpace;\n\n      _this.setState({\n        isValidAppName: isValidAppName\n      });\n    };\n\n    _this.onClickDuplicationCheck = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _this.checkIsValidPackageName();\n\n            case 1:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n    _this.checkIsValidPackageName = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n      var packageName, emptyString, whiteSpace, koreanString, duplication, isValidPackageName;\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              packageName = _this.state.packageName;\n              emptyString = packageName === \"\";\n              whiteSpace = packageName[0] === \" \";\n              koreanString = /[ㄱ-ㅎ|ㅏ-ㅣ|가-힣]/.test(packageName);\n              _context2.next = 6;\n              return _this.checkIsDuplicatePackageName();\n\n            case 6:\n              duplication = _context2.sent;\n              isValidPackageName = !emptyString && !whiteSpace && !koreanString && !duplication;\n\n              _this.setState({\n                isValidPackageName: isValidPackageName\n              });\n\n            case 9:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }));\n    _this.checkIsDuplicatePackageName = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3() {\n      var duplicateInfo;\n      return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              _context3.next = 2;\n              return _this.getIsPackageNameDuplicate();\n\n            case 2:\n              duplicateInfo = _context3.sent;\n\n              if (!(!duplicateInfo || !duplicateInfo.success)) {\n                _context3.next = 5;\n                break;\n              }\n\n              return _context3.abrupt(\"return\", false);\n\n            case 5:\n              return _context3.abrupt(\"return\", duplicateInfo.isDuplicate);\n\n            case 6:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3);\n    }));\n    _this.getIsPackageNameDuplicate = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee4() {\n      var packageName, json;\n      return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n        while (1) {\n          switch (_context4.prev = _context4.next) {\n            case 0:\n              packageName = _this.state.packageName;\n              _context4.next = 3;\n              return request.getIsPackageNameDuplicate({\n                packageName: packageName\n              }).then(function (res) {\n                return res.json();\n              }).catch(function (e) {\n                console.error(e.message);\n                return undefined;\n              });\n\n            case 3:\n              json = _context4.sent;\n              return _context4.abrupt(\"return\", json);\n\n            case 5:\n            case \"end\":\n              return _context4.stop();\n          }\n        }\n      }, _callee4);\n    }));\n\n    _this.checkIsValidAppIcon = function () {\n      var emptyIcon = _this.state.appIcon === undefined;\n\n      _this.setState({\n        isValidAppIcon: !emptyIcon\n      });\n    };\n\n    _this.onClickCreate = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee5() {\n      var _this$state, isValidAppName, isValidPackageName, isValidAppIcon, isSuccess;\n\n      return _regeneratorRuntime.wrap(function _callee5$(_context5) {\n        while (1) {\n          switch (_context5.prev = _context5.next) {\n            case 0:\n              _this$state = _this.state, isValidAppName = _this$state.isValidAppName, isValidPackageName = _this$state.isValidPackageName, isValidAppIcon = _this$state.isValidAppIcon;\n\n              if (!(isValidAppName && isValidPackageName && isValidAppIcon)) {\n                _context5.next = 9;\n                break;\n              }\n\n              _context5.next = 4;\n              return _this.postCreateWizlabAPK();\n\n            case 4:\n              isSuccess = _context5.sent;\n\n              if (!(!isSuccess || !isSuccess.success)) {\n                _context5.next = 8;\n                break;\n              }\n\n              // error handling\n              showPopUp( /*#__PURE__*/React.createElement(PopUp.OneButton, {\n                title: \"\\uC2E4\\uD328\",\n                __self: _assertThisInitialized(_this),\n                __source: {\n                  fileName: _jsxFileName,\n                  lineNumber: 106,\n                  columnNumber: 19\n                }\n              }));\n              return _context5.abrupt(\"return\");\n\n            case 8:\n              // apk 생성 success popup\n              showPopUp( /*#__PURE__*/React.createElement(PopUp.OneButton, {\n                title: \"\\uC131\\uACF5\",\n                __self: _assertThisInitialized(_this),\n                __source: {\n                  fileName: _jsxFileName,\n                  lineNumber: 110,\n                  columnNumber: 17\n                }\n              }));\n\n            case 9:\n            case \"end\":\n              return _context5.stop();\n          }\n        }\n      }, _callee5);\n    }));\n    _this.postCreateWizlabAPK = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee6() {\n      var _this$state2, packageName, appName, appIcon, json;\n\n      return _regeneratorRuntime.wrap(function _callee6$(_context6) {\n        while (1) {\n          switch (_context6.prev = _context6.next) {\n            case 0:\n              _this$state2 = _this.state, packageName = _this$state2.packageName, appName = _this$state2.appName, appIcon = _this$state2.appIcon;\n              _context6.next = 3;\n              return request.createWizlabAPK({\n                userId: _this.props.userinfo.id,\n                packageName: packageName,\n                appName: appName,\n                appIcon: appIcon,\n                pId: _this.props.selectedProject.pId\n              }).then(function (res) {\n                return res.json();\n              }).catch(function (e) {\n                console.error(e);\n                return undefined;\n              });\n\n            case 3:\n              json = _context6.sent;\n              return _context6.abrupt(\"return\", json);\n\n            case 5:\n            case \"end\":\n              return _context6.stop();\n          }\n        }\n      }, _callee6);\n    }));\n\n    _this.onChangeInput = function (e) {\n      var value = e.target.value;\n      var name = e.target.name;\n\n      _this.setState(_defineProperty({}, name, value), function () {\n        _this.checkIsValidAppName();\n      });\n    };\n\n    _this.onChangeIconImage = /*#__PURE__*/function () {\n      var _ref7 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee7(e) {\n        var file, filename, url;\n        return _regeneratorRuntime.wrap(function _callee7$(_context7) {\n          while (1) {\n            switch (_context7.prev = _context7.next) {\n              case 0:\n                //TODO : upload Image\n                file = e.target.files[0];\n\n                if (file) {\n                  _context7.next = 3;\n                  break;\n                }\n\n                return _context7.abrupt(\"return\");\n\n              case 3:\n                _context7.next = 5;\n                return _this.getUploadedImageName(file);\n\n              case 5:\n                filename = _context7.sent;\n                url = URL.S3_WIZLABAPK + \"/\" + filename;\n\n                _this.setState({\n                  appIcon: url\n                }, function () {\n                  _this.checkIsValidAppIcon();\n                });\n\n              case 8:\n              case \"end\":\n                return _context7.stop();\n            }\n          }\n        }, _callee7);\n      }));\n\n      return function (_x) {\n        return _ref7.apply(this, arguments);\n      };\n    }();\n\n    _this.getUploadedImageName = /*#__PURE__*/function () {\n      var _ref8 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee8(file) {\n        var uploadInfo;\n        return _regeneratorRuntime.wrap(function _callee8$(_context8) {\n          while (1) {\n            switch (_context8.prev = _context8.next) {\n              case 0:\n                _context8.next = 2;\n                return _this.uploadImage(file);\n\n              case 2:\n                uploadInfo = _context8.sent;\n\n                if (!(!uploadInfo || !uploadInfo.success)) {\n                  _context8.next = 5;\n                  break;\n                }\n\n                return _context8.abrupt(\"return\");\n\n              case 5:\n                return _context8.abrupt(\"return\", uploadInfo.filename);\n\n              case 6:\n              case \"end\":\n                return _context8.stop();\n            }\n          }\n        }, _callee8);\n      }));\n\n      return function (_x2) {\n        return _ref8.apply(this, arguments);\n      };\n    }();\n\n    _this.uploadImage = /*#__PURE__*/function () {\n      var _ref9 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee9(file) {\n        var data, json;\n        return _regeneratorRuntime.wrap(function _callee9$(_context9) {\n          while (1) {\n            switch (_context9.prev = _context9.next) {\n              case 0:\n                data = new FormData();\n                data.append(\"file\", file);\n                _context9.next = 4;\n                return request.uploadWizlabAPKIcon(data).then(function (res) {\n                  return res.json();\n                }).catch(function (e) {\n                  console.error(e.message);\n                  return undefined;\n                });\n\n              case 4:\n                json = _context9.sent;\n                return _context9.abrupt(\"return\", json);\n\n              case 6:\n              case \"end\":\n                return _context9.stop();\n            }\n          }\n        }, _callee9);\n      }));\n\n      return function (_x3) {\n        return _ref9.apply(this, arguments);\n      };\n    }();\n\n    _this.state = {\n      isShowAPKInfo: false,\n      appName: \"\",\n      isValidAppName: false,\n      packageName: \"\",\n      isValidPackageName: false,\n      appIcon: undefined,\n      isValidAppIcon: false\n    };\n    return _this;\n  }\n\n  _createClass(Container, [{\n    key: \"render\",\n    value: function render() {\n      var _this$state3 = this.state,\n          isShowAPKInfo = _this$state3.isShowAPKInfo,\n          appName = _this$state3.appName,\n          packageName = _this$state3.packageName,\n          appIcon = _this$state3.appIcon,\n          isValidAppName = _this$state3.isValidAppName,\n          isValidPackageName = _this$state3.isValidPackageName,\n          isValidAppIcon = _this$state3.isValidAppIcon;\n      return /*#__PURE__*/React.createElement(View, {\n        intl: this.props.intl,\n        isShowAPKInfo: isShowAPKInfo,\n        appName: appName,\n        packageName: packageName,\n        appIcon: appIcon,\n        isValidAppName: isValidAppName,\n        isValidPackageName: isValidPackageName,\n        isValidAppIcon: isValidAppIcon,\n        onClickDuplicationCheck: this.onClickDuplicationCheck,\n        onClickCreate: this.onClickCreate,\n        onChangeInput: this.onChangeInput,\n        onChangeIconImage: this.onChangeIconImage,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 196,\n          columnNumber: 7\n        }\n      });\n    }\n  }]);\n\n  return Container;\n}(Component);\n\nexport default connect(function (state) {\n  return {\n    userinfo: state.userinfo\n  };\n})(injectIntl(Container));","map":{"version":3,"sources":["/Users/jimmy/Documents/Wizschool/wizlab_web2/src/Page/MyAPK/Components/APKInfo/Container.js"],"names":["React","Component","request","URL","connect","injectIntl","View","PopUp","showPopUp","Container","props","componentDidMount","componentDidUpdate","prevProps","prevState","isShowAPKInfo","handleIsShowAPKInfo","setState","checkIsValidAppName","appName","state","emptyString","whiteSpace","isValidAppName","onClickDuplicationCheck","checkIsValidPackageName","packageName","koreanString","test","checkIsDuplicatePackageName","duplication","isValidPackageName","getIsPackageNameDuplicate","duplicateInfo","success","isDuplicate","then","res","json","catch","e","console","error","message","undefined","checkIsValidAppIcon","emptyIcon","appIcon","isValidAppIcon","onClickCreate","postCreateWizlabAPK","isSuccess","createWizlabAPK","userId","userinfo","id","pId","selectedProject","onChangeInput","value","target","name","onChangeIconImage","file","files","getUploadedImageName","filename","url","S3_WIZLABAPK","uploadImage","uploadInfo","data","FormData","append","uploadWizlabAPKIcon","intl"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport * as request from \"../../../../Common/Util/HTTPRequest\";\nimport { URL } from \"../../../../Common/Util/Constant\";\nimport { connect } from \"react-redux\";\nimport { injectIntl } from \"react-intl\";\nimport View from \"./View\";\nimport PopUp, { showPopUp } from \"../../../../Common/Component/PopUp\";\n\nclass Container extends Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      isShowAPKInfo: false,\n      appName: \"\",\n      isValidAppName: false,\n      packageName: \"\",\n      isValidPackageName: false,\n      appIcon: undefined,\n      isValidAppIcon: false\n    };\n  }\n\n  componentDidMount = () => {};\n\n  componentDidUpdate = (prevProps, prevState) => {\n    if (prevProps.isShowAPKInfo !== this.props.isShowAPKInfo) {\n      this.handleIsShowAPKInfo(this.props.isShowAPKInfo);\n    }\n  };\n\n  handleIsShowAPKInfo = isShowAPKInfo => {\n    this.setState({\n      isShowAPKInfo\n    });\n  };\n\n  checkIsValidAppName = () => {\n    const { appName } = this.state;\n    const emptyString = appName === \"\";\n    const whiteSpace = appName[0] === \" \";\n\n    const isValidAppName = !emptyString && !whiteSpace;\n    this.setState({\n      isValidAppName\n    });\n  };\n\n  onClickDuplicationCheck = async () => {\n    this.checkIsValidPackageName();\n  };\n\n  checkIsValidPackageName = async () => {\n    const { packageName } = this.state;\n    const emptyString = packageName === \"\";\n    const whiteSpace = packageName[0] === \" \";\n    const koreanString = /[ㄱ-ㅎ|ㅏ-ㅣ|가-힣]/.test(packageName);\n    const duplication = await this.checkIsDuplicatePackageName();\n\n    const isValidPackageName =\n      !emptyString && !whiteSpace && !koreanString && !duplication;\n    this.setState({\n      isValidPackageName\n    });\n  };\n\n  checkIsDuplicatePackageName = async () => {\n    const duplicateInfo = await this.getIsPackageNameDuplicate();\n    if (!duplicateInfo || !duplicateInfo.success) {\n      // error handling for user exercise\n      return false;\n    }\n\n    // duplicateInfo.isValid;\n    return duplicateInfo.isDuplicate;\n  };\n\n  getIsPackageNameDuplicate = async () => {\n    const { packageName } = this.state;\n    const json = await request\n      .getIsPackageNameDuplicate({\n        packageName\n      })\n      .then(res => res.json())\n      .catch(e => {\n        console.error(e.message);\n        return undefined;\n      });\n    return json;\n  };\n\n  checkIsValidAppIcon = () => {\n    const emptyIcon = this.state.appIcon === undefined;\n    this.setState({\n      isValidAppIcon: !emptyIcon\n    });\n  };\n\n  onClickCreate = async () => {\n    const { isValidAppName, isValidPackageName, isValidAppIcon } = this.state;\n    if (isValidAppName && isValidPackageName && isValidAppIcon) {\n      // validation success\n      const isSuccess = await this.postCreateWizlabAPK();\n      if (!isSuccess || !isSuccess.success) {\n        // error handling\n        showPopUp(<PopUp.OneButton title=\"실패\" />);\n        return;\n      }\n      // apk 생성 success popup\n      showPopUp(<PopUp.OneButton title=\"성공\" />);\n    }\n  };\n\n  postCreateWizlabAPK = async () => {\n    const { packageName, appName, appIcon } = this.state;\n    const json = await request\n      .createWizlabAPK({\n        userId: this.props.userinfo.id,\n        packageName,\n        appName,\n        appIcon,\n        pId: this.props.selectedProject.pId\n      })\n      .then(res => res.json())\n      .catch(e => {\n        console.error(e);\n        return undefined;\n      });\n    return json;\n  };\n\n  onChangeInput = e => {\n    const value = e.target.value;\n    const name = e.target.name;\n    this.setState(\n      {\n        [name]: value\n      },\n      () => {\n        this.checkIsValidAppName();\n      }\n    );\n  };\n\n  onChangeIconImage = async e => {\n    //TODO : upload Image\n    const file = e.target.files[0];\n    if (!file) return;\n    const filename = await this.getUploadedImageName(file);\n    const url = URL.S3_WIZLABAPK + \"/\" + filename;\n    this.setState(\n      {\n        appIcon: url\n      },\n      () => {\n        this.checkIsValidAppIcon();\n      }\n    );\n  };\n\n  getUploadedImageName = async file => {\n    const uploadInfo = await this.uploadImage(file);\n    if (!uploadInfo || !uploadInfo.success) {\n      // error handling\n      return;\n    }\n    return uploadInfo.filename;\n  };\n\n  uploadImage = async file => {\n    const data = new FormData();\n    data.append(\"file\", file);\n    const json = await request\n      .uploadWizlabAPKIcon(data)\n      .then(res => res.json())\n      .catch(e => {\n        console.error(e.message);\n        return undefined;\n      });\n\n    return json;\n  };\n\n  render() {\n    const {\n      isShowAPKInfo,\n      appName,\n      packageName,\n      appIcon,\n      isValidAppName,\n      isValidPackageName,\n      isValidAppIcon\n    } = this.state;\n\n    return (\n      <View\n        intl={this.props.intl}\n        isShowAPKInfo={isShowAPKInfo}\n        appName={appName}\n        packageName={packageName}\n        appIcon={appIcon}\n        isValidAppName={isValidAppName}\n        isValidPackageName={isValidPackageName}\n        isValidAppIcon={isValidAppIcon}\n        onClickDuplicationCheck={this.onClickDuplicationCheck}\n        onClickCreate={this.onClickCreate}\n        onChangeInput={this.onChangeInput}\n        onChangeIconImage={this.onChangeIconImage}\n      />\n    );\n  }\n}\n\nexport default connect(state => ({ userinfo: state.userinfo }))(\n  injectIntl(Container)\n);\n"]},"metadata":{},"sourceType":"module"}