{"ast":null,"code":"var _jsxFileName = \"/Users/jimmy/Documents/Wizschool/wizlab_web2/src/Page/Builder/Component/Editor/Component/OOBCEditor/View.js\";\nimport React from \"react\"; // import AssetLibrary from \"../../../../utils/assetLibrary\";\n// import { SpriteType } from \"../../../../../../Common/Util/Constant\";\n\nimport { BLOCK } from \"./Util/Type\";\nimport Context from \"./Component/Context\";\nimport Line from \"./Component/Line\";\nimport Block from \"./Component/Block\";\nimport { getColorTheme } from \"../../../../utils/colorThemeUtil\";\nimport \"./index.scss\"; // import backBtnDefault from \"../../../../../../Image/builder/oobceditor/back-default.png\";\n// import backBtnTouched from \"../../../../../../Image/builder/oobceditor/back-touched.png\";\n// import playBtnDefault from \"../../../../../../Image/builder/oobceditor/play-default.png\";\n// import playBtnTouched from \"../../../../../../Image/builder/oobceditor/play-touched.png\";\n// import closeBtnDefault from \"../../../../../../Image/builder/oobceditor/close-default.svg\";\n// import closeBtnTouched from \"../../../../../../Image/builder/oobceditor/close-touched.svg\";\n// import textIcon from \"../../../../../../Image/builder/oobceditor/sprite_text.png\";\n\nimport closeBtnDark from \"../../../../../../Image/builder/close-white.png\";\nimport closeBtnLight from \"../../../../../../Image/builder/close-black.png\";\nimport blockVariableAdd from \"../../../../../../Image/builder/oobceditor/block_variable-add.svg\";\nexport default function (props) {\n  var _this = this;\n\n  var intl = props.intl,\n      lines = props.lines,\n      currentLine = props.currentLine,\n      isDragging = props.isDragging,\n      currentBlock = props.currentBlock,\n      categories = props.categories,\n      currentCategory = props.currentCategory,\n      selectorBlocks = props.selectorBlocks,\n      popupContent = props.popupContent,\n      lineContextMenu = props.lineContextMenu,\n      sprites = props.sprites,\n      currentSprite = props.currentSprite,\n      onClickLine = props.onClickLine,\n      onRightClickLine = props.onRightClickLine,\n      onClickFoldLine = props.onClickFoldLine,\n      onClickDeleteLine = props.onClickDeleteLine,\n      onDragLine = props.onDragLine,\n      onDragBegin = props.onDragBegin,\n      onDragEnd = props.onDragEnd,\n      onClickLineContextMenu = props.onClickLineContextMenu,\n      onClickContextBlock = props.onClickContextBlock,\n      onClickPrototypeBlock = props.onClickPrototypeBlock,\n      onClickConstantEdit = props.onClickConstantEdit,\n      onClickPopupOverlay = props.onClickPopupOverlay,\n      onClickContext = props.onClickContext,\n      onClickCategory = props.onClickCategory,\n      onClickAddVariable = props.onClickAddVariable,\n      onClickSelectorClose = props.onClickSelectorClose;\n  var formatMessage = intl.formatMessage;\n  var darkmode = getColorTheme() === \"darkMode\";\n\n  if (!currentSprite) {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      id: \"oobceditor\",\n      className: \"oobceditor_old\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 64,\n        columnNumber: 12\n      }\n    });\n  }\n\n  var selectorStyle = {};\n\n  if (currentBlock) {\n    var contextElement = document.getElementById(\"oobceditor_context\");\n    var currentBlockElement = document.getElementById(\"oobceditor_block-\".concat(currentBlock.id));\n    selectorStyle.display = popupContent ? \"none\" : undefined;\n\n    if (contextElement && currentBlockElement) {\n      var contextRect = contextElement.getBoundingClientRect();\n      var currentBlockRect = currentBlockElement.getBoundingClientRect();\n      selectorStyle.top = contextElement.scrollTop + currentBlockRect.top + currentBlockRect.height / 2 + 12;\n      selectorStyle.left = currentBlockElement.offsetLeft;\n      var maxSelectorLeft = contextRect.width - 540 - 12;\n\n      if (selectorStyle.left > maxSelectorLeft && maxSelectorLeft > 12) {\n        selectorStyle.left = maxSelectorLeft;\n      }\n    }\n  }\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    id: \"oobceditor\",\n    className: \"oobceditor_old\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 91,\n      columnNumber: 5\n    }\n  }, lines && /*#__PURE__*/React.createElement(Context, {\n    currentBlock: currentBlock,\n    onClickContext: onClickContext,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 94,\n      columnNumber: 9\n    }\n  }, lines.map(function (line) {\n    return /*#__PURE__*/React.createElement(Line, {\n      key: line.id,\n      line: line,\n      currentLine: currentLine,\n      isDragging: isDragging,\n      onClickLine: onClickLine,\n      onRightClickLine: onRightClickLine,\n      onClickFoldLine: onClickFoldLine,\n      onClickDeleteLine: onClickDeleteLine,\n      onDragLine: onDragLine,\n      onDragBegin: onDragBegin,\n      onDragEnd: onDragEnd,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 97,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(Block, {\n      block: line.block,\n      currentBlock: currentBlock,\n      onClickBlock: onClickContextBlock,\n      onClickConstantEdit: onClickConstantEdit,\n      sprites: sprites,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 110,\n        columnNumber: 15\n      }\n    }));\n  }), currentBlock && /*#__PURE__*/React.createElement(\"div\", {\n    id: \"oobceditor_selector\",\n    className: \"_oobceditor_selector\",\n    style: selectorStyle,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 121,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"_oobceditor_selector_categories\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 126,\n      columnNumber: 15\n    }\n  }, categories.map(function (category, index) {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      key: category,\n      className: \"_oobceditor_selector_category\".concat(category === currentCategory ? \" _oobceditor_selector_category-current\" : \"\"),\n      onClick: function onClick(e) {\n        if (!e.target.closest(\".oobc_highlight_clone\")) {\n          if (e.preventDefault) e.preventDefault();\n          if (e.stopPropagation) e.stopPropagation();\n        }\n\n        onClickCategory(category);\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 128,\n        columnNumber: 19\n      }\n    }, formatMessage({\n      id: \"ID_OOBC_BLOCK_CATEGORY_\" + category.toUpperCase()\n    }));\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"_oobceditor_selector_blocks\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 149,\n      columnNumber: 15\n    }\n  }, currentCategory === BLOCK.VARIABLE && /*#__PURE__*/React.createElement(\"div\", {\n    className: \"oobceditor_block oobceditor_block-prototype\",\n    onClick: onClickAddVariable,\n    onTouchStart: function onTouchStart(e) {\n      e.target.classList.add(\"oobceditor_block-touched\");\n    },\n    onTouchEnd: function onTouchEnd(e) {\n      e.target.classList.remove(\"oobceditor_block-touched\");\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 151,\n      columnNumber: 19\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"oobceditor_block_background\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 161,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"img\", {\n    className: \"oobceditor_block_background_img\",\n    src: blockVariableAdd,\n    alt: \"addVar\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 162,\n      columnNumber: 23\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"oobceditor_block_contents\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 168,\n      columnNumber: 21\n    }\n  })), selectorBlocks.map(function (block, index) {\n    return /*#__PURE__*/React.createElement(Block, {\n      key: index,\n      block: block,\n      onClickBlock: onClickPrototypeBlock,\n      sprites: sprites,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 172,\n        columnNumber: 19\n      }\n    });\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"_oobceditor_selector_closeBtn\",\n    onClick: onClickSelectorClose,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 180,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"img\", {\n    src: darkmode ? closeBtnDark : closeBtnLight,\n    alt: \"close\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 184,\n      columnNumber: 17\n    }\n  }))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"oobceditor_popup\".concat(popupContent ? \" oobceditor_popup-visible\" : \"\"),\n    onClick: function onClick(e) {\n      if (e.preventDefault) e.preventDefault();\n      if (e.stopPropagation) e.stopPropagation();\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 192,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"oobceditor_popup_overlay\",\n    onClick: onClickPopupOverlay,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 201,\n      columnNumber: 13\n    }\n  }), popupContent), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"oobceditor_lineContextMenus\",\n    style: lineContextMenu && lineContextMenu.style || {\n      opacity: 0,\n      pointerEvents: \"none\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 208,\n      columnNumber: 11\n    }\n  }, [\"delete\", \"copy\", \"paste\", \"add\", \"disable\", \"comment\"].map(function (contextmenu) {\n    var icon = require(\"../../../../../../Image/builder/oobceditor/contextmenu_\".concat(contextmenu, \".png\"));\n\n    var title = formatMessage({\n      id: \"ID_OOBC_LINE_CONTEXTMENU_\".concat(contextmenu.toUpperCase())\n    });\n\n    if (contextmenu === \"disable\" && currentLine && currentLine.disabled) {\n      title = formatMessage({\n        id: \"ID_OOBC_LINE_CONTEXTMENU_ENABLE\"\n      });\n    }\n\n    return /*#__PURE__*/React.createElement(\"div\", {\n      key: contextmenu,\n      className: \"oobceditor_lineContextMenu oobceditor_lineContextMenu-\".concat(contextmenu).concat(lineContextMenu && lineContextMenu[contextmenu] ? \"\" : \" oobceditor_lineContextMenu-inactive\"),\n      onClick: function onClick() {\n        onClickLineContextMenu(currentLine, contextmenu);\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 233,\n        columnNumber: 19\n      }\n    }, /*#__PURE__*/React.createElement(\"img\", {\n      src: icon,\n      alt: contextmenu,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 244,\n        columnNumber: 21\n      }\n    }), title);\n  }))));\n}","map":{"version":3,"sources":["/Users/jimmy/Documents/Wizschool/wizlab_web2/src/Page/Builder/Component/Editor/Component/OOBCEditor/View.js"],"names":["React","BLOCK","Context","Line","Block","getColorTheme","closeBtnDark","closeBtnLight","props","intl","lines","currentLine","isDragging","currentBlock","categories","currentCategory","selectorBlocks","popupContent","lineContextMenu","sprites","currentSprite","onClickLine","onRightClickLine","onClickFoldLine","onClickDeleteLine","onDragLine","onDragBegin","onDragEnd","onClickLineContextMenu","onClickContextBlock","onClickPrototypeBlock","onClickConstantEdit","onClickPopupOverlay","onClickContext","onClickCategory","onClickAddVariable","onClickSelectorClose","formatMessage","darkmode","selectorStyle","contextElement","document","getElementById","currentBlockElement","id","display","undefined","contextRect","getBoundingClientRect","currentBlockRect","top","scrollTop","height","left","offsetLeft","maxSelectorLeft","width","map","line","block","category","index","e","target","closest","preventDefault","stopPropagation","toUpperCase","VARIABLE","classList","add","remove","blockVariableAdd","style","opacity","pointerEvents","contextmenu","icon","require","title","disabled"],"mappings":"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","sourcesContent":["import React from \"react\";\n// import AssetLibrary from \"../../../../utils/assetLibrary\";\n// import { SpriteType } from \"../../../../../../Common/Util/Constant\";\nimport { BLOCK } from \"./Util/Type\";\nimport Context from \"./Component/Context\";\nimport Line from \"./Component/Line\";\nimport Block from \"./Component/Block\";\nimport { getColorTheme } from \"../../../../utils/colorThemeUtil\";\nimport \"./index.scss\";\n\n// import backBtnDefault from \"../../../../../../Image/builder/oobceditor/back-default.png\";\n// import backBtnTouched from \"../../../../../../Image/builder/oobceditor/back-touched.png\";\n// import playBtnDefault from \"../../../../../../Image/builder/oobceditor/play-default.png\";\n// import playBtnTouched from \"../../../../../../Image/builder/oobceditor/play-touched.png\";\n// import closeBtnDefault from \"../../../../../../Image/builder/oobceditor/close-default.svg\";\n// import closeBtnTouched from \"../../../../../../Image/builder/oobceditor/close-touched.svg\";\n// import textIcon from \"../../../../../../Image/builder/oobceditor/sprite_text.png\";\nimport closeBtnDark from \"../../../../../../Image/builder/close-white.png\";\nimport closeBtnLight from \"../../../../../../Image/builder/close-black.png\";\nimport blockVariableAdd from \"../../../../../../Image/builder/oobceditor/block_variable-add.svg\";\n\nexport default function(props) {\n  const {\n    intl,\n    // isPlaying,\n    // pageType,\n    // storySplitviewOn,\n    lines,\n    currentLine,\n    isDragging,\n    currentBlock,\n    categories,\n    currentCategory,\n    selectorBlocks,\n    popupContent,\n    lineContextMenu,\n    sprites,\n    currentSprite,\n    // onClickSprite,\n    // onClickPreview,\n    // onClickPlay,\n    onClickLine,\n    onRightClickLine,\n    onClickFoldLine,\n    onClickDeleteLine,\n    onDragLine,\n    onDragBegin,\n    onDragEnd,\n    onClickLineContextMenu,\n    onClickContextBlock,\n    onClickPrototypeBlock,\n    onClickConstantEdit,\n    onClickPopupOverlay,\n    onClickContext,\n    // onClickSelector,\n    onClickCategory,\n    onClickAddVariable,\n    onClickSelectorClose\n  } = props;\n  const { formatMessage } = intl;\n  const darkmode = getColorTheme() === \"darkMode\";\n\n  if (!currentSprite) {\n    return <div id=\"oobceditor\" className=\"oobceditor_old\" />;\n  }\n\n  let selectorStyle = {};\n  if (currentBlock) {\n    const contextElement = document.getElementById(\"oobceditor_context\");\n    const currentBlockElement = document.getElementById(\n      `oobceditor_block-${currentBlock.id}`\n    );\n    selectorStyle.display = popupContent ? \"none\" : undefined;\n    if (contextElement && currentBlockElement) {\n      const contextRect = contextElement.getBoundingClientRect();\n      const currentBlockRect = currentBlockElement.getBoundingClientRect();\n      selectorStyle.top =\n        contextElement.scrollTop +\n        currentBlockRect.top +\n        currentBlockRect.height / 2 +\n        12;\n      selectorStyle.left = currentBlockElement.offsetLeft;\n      const maxSelectorLeft = contextRect.width - 540 - 12;\n      if (selectorStyle.left > maxSelectorLeft && maxSelectorLeft > 12) {\n        selectorStyle.left = maxSelectorLeft;\n      }\n    }\n  }\n\n  return (\n    <div id=\"oobceditor\" className=\"oobceditor_old\">\n      {/* context */}\n      {lines && (\n        <Context currentBlock={currentBlock} onClickContext={onClickContext}>\n          {/* lines */}\n          {lines.map(line => (\n            <Line\n              key={line.id}\n              line={line}\n              currentLine={currentLine}\n              isDragging={isDragging}\n              onClickLine={onClickLine}\n              onRightClickLine={onRightClickLine}\n              onClickFoldLine={onClickFoldLine}\n              onClickDeleteLine={onClickDeleteLine}\n              onDragLine={onDragLine}\n              onDragBegin={onDragBegin}\n              onDragEnd={onDragEnd}\n            >\n              <Block\n                block={line.block}\n                currentBlock={currentBlock}\n                onClickBlock={onClickContextBlock}\n                onClickConstantEdit={onClickConstantEdit}\n                sprites={sprites}\n              />\n            </Line>\n          ))}\n          {/* selector */}\n          {currentBlock && (\n            <div\n              id=\"oobceditor_selector\"\n              className=\"_oobceditor_selector\"\n              style={selectorStyle}\n            >\n              <div className=\"_oobceditor_selector_categories\">\n                {categories.map((category, index) => (\n                  <div\n                    key={category}\n                    className={`_oobceditor_selector_category${\n                      category === currentCategory\n                        ? \" _oobceditor_selector_category-current\"\n                        : \"\"\n                    }`}\n                    onClick={e => {\n                      if (!e.target.closest(\".oobc_highlight_clone\")) {\n                        if (e.preventDefault) e.preventDefault();\n                        if (e.stopPropagation) e.stopPropagation();\n                      }\n                      onClickCategory(category);\n                    }}\n                  >\n                    {formatMessage({\n                      id: \"ID_OOBC_BLOCK_CATEGORY_\" + category.toUpperCase()\n                    })}\n                  </div>\n                ))}\n              </div>\n              <div className=\"_oobceditor_selector_blocks\">\n                {currentCategory === BLOCK.VARIABLE && (\n                  <div\n                    className=\"oobceditor_block oobceditor_block-prototype\"\n                    onClick={onClickAddVariable}\n                    onTouchStart={e => {\n                      e.target.classList.add(\"oobceditor_block-touched\");\n                    }}\n                    onTouchEnd={e => {\n                      e.target.classList.remove(\"oobceditor_block-touched\");\n                    }}\n                  >\n                    <div className=\"oobceditor_block_background\">\n                      <img\n                        className=\"oobceditor_block_background_img\"\n                        src={blockVariableAdd}\n                        alt=\"addVar\"\n                      />\n                    </div>\n                    <div className=\"oobceditor_block_contents\" />\n                  </div>\n                )}\n                {selectorBlocks.map((block, index) => (\n                  <Block\n                    key={index}\n                    block={block}\n                    onClickBlock={onClickPrototypeBlock}\n                    sprites={sprites}\n                  />\n                ))}\n              </div>\n              <div\n                className=\"_oobceditor_selector_closeBtn\"\n                onClick={onClickSelectorClose}\n              >\n                <img\n                  src={darkmode ? closeBtnDark : closeBtnLight}\n                  alt=\"close\"\n                />\n              </div>\n            </div>\n          )}\n          {/* popup */}\n          <div\n            className={`oobceditor_popup${\n              popupContent ? \" oobceditor_popup-visible\" : \"\"\n            }`}\n            onClick={e => {\n              if (e.preventDefault) e.preventDefault();\n              if (e.stopPropagation) e.stopPropagation();\n            }}\n          >\n            <div\n              className=\"oobceditor_popup_overlay\"\n              onClick={onClickPopupOverlay}\n            />\n            {popupContent}\n          </div>\n          {/* line contextmenu */}\n          <div\n            className=\"oobceditor_lineContextMenus\"\n            style={\n              (lineContextMenu && lineContextMenu.style) || {\n                opacity: 0,\n                pointerEvents: \"none\"\n              }\n            }\n          >\n            {[\"delete\", \"copy\", \"paste\", \"add\", \"disable\", \"comment\"].map(\n              contextmenu => {\n                let icon = require(`../../../../../../Image/builder/oobceditor/contextmenu_${contextmenu}.png`);\n                let title = formatMessage({\n                  id: `ID_OOBC_LINE_CONTEXTMENU_${contextmenu.toUpperCase()}`\n                });\n                if (\n                  contextmenu === \"disable\" &&\n                  currentLine &&\n                  currentLine.disabled\n                ) {\n                  title = formatMessage({\n                    id: \"ID_OOBC_LINE_CONTEXTMENU_ENABLE\"\n                  });\n                }\n                return (\n                  <div\n                    key={contextmenu}\n                    className={`oobceditor_lineContextMenu oobceditor_lineContextMenu-${contextmenu}${\n                      lineContextMenu && lineContextMenu[contextmenu]\n                        ? \"\"\n                        : \" oobceditor_lineContextMenu-inactive\"\n                    }`}\n                    onClick={() => {\n                      onClickLineContextMenu(currentLine, contextmenu);\n                    }}\n                  >\n                    <img src={icon} alt={contextmenu} />\n                    {title}\n                  </div>\n                );\n              }\n            )}\n          </div>\n        </Context>\n      )}\n    </div>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}