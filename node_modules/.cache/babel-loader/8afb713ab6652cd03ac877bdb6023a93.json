{"ast":null,"code":"import _regeneratorRuntime from \"/Users/jimmy/Documents/Wizschool/wizlab_web2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/jimmy/Documents/Wizschool/wizlab_web2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"/Users/jimmy/Documents/Wizschool/wizlab_web2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/jimmy/Documents/Wizschool/wizlab_web2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _inherits from \"/Users/jimmy/Documents/Wizschool/wizlab_web2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _possibleConstructorReturn from \"/Users/jimmy/Documents/Wizschool/wizlab_web2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/jimmy/Documents/Wizschool/wizlab_web2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nvar _jsxFileName = \"/Users/jimmy/Documents/Wizschool/wizlab_web2/src/Page/News/Container.js\";\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\n\nimport React, { Component } from \"react\";\nimport { withRouter } from \"react-router-dom\";\nimport { injectIntl } from \"react-intl\";\nimport { connect } from \"react-redux\";\nimport View from \"./View\";\nimport * as request from \"../../Common/Util/HTTPRequest\";\n\nvar Container = /*#__PURE__*/function (_Component) {\n  _inherits(Container, _Component);\n\n  var _super = _createSuper(Container);\n\n  function Container(props) {\n    var _this;\n\n    _classCallCheck(this, Container);\n\n    _this = _super.call(this, props);\n\n    _this.componentDidMount = function () {\n      _this.fetchNews();\n    };\n\n    _this.fetchNews = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      var res, news;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return request.getNewsList({\n                type: \"all\",\n                limit: _this.limit,\n                offset: _this.limit * (_this.state.currentPage - 1)\n              });\n\n            case 2:\n              res = _context.sent;\n              _context.next = 5;\n              return res.json();\n\n            case 5:\n              news = _context.sent;\n              console.log(\"news\", news);\n\n              _this.setState(function (prev) {\n                return {\n                  news: prev.news.concat(news.rows),\n                  newsCount: news.count,\n                  totalNewsPage: Math.ceil(news.count / _this.state.pageSize) // 검색 page \n\n                };\n              });\n\n            case 8:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    _this.onClickMore = function () {\n      _this.setState(function (prev) {\n        return {\n          currentPage: prev.currentPage + 1\n        };\n      }, function () {\n        _this.fetchNews();\n      });\n    };\n\n    _this.onClickPageNumber = function (pageNo) {\n      _this.setState({\n        currentPage: pageNo\n      }, function () {\n        _this.fetchNews();\n      });\n    };\n\n    _this.getPageInfo = function () {\n      var pages = [];\n\n      for (var i = _this.state.startPage; i <= _this.state.totalNewsPage; i++) {\n        pages.push(i);\n        if (pages.length === 10) break;\n      }\n\n      return {\n        pages: pages,\n        currentPage: _this.state.currentPage\n      };\n    };\n\n    _this.onClickPageHandler = function (type) {\n      var _this$getPageInfo = _this.getPageInfo(),\n          pages = _this$getPageInfo.pages;\n\n      if (type === \"next\") {\n        // 다음 버튼 눌렀을때\n        // 현재 보여주는 page다음의 페이지가 총 페이지 수 보다 작을때\n        if (pages[pages.length - 1] + 1 <= _this.state.totalRankingPage) {\n          _this.setState({\n            startPage: pages[pages.length - 1] + 1\n          });\n\n          _this.onClickPageNumber(pages[pages.length - 1] + 1);\n        }\n      } else {\n        // 이전 버튼 눌렀을때\n        if (pages[0] - _this.state.pageSize > 0) {\n          // 현재 pageList의 첫번보다 pageSize만큼 더 있는지 확인\n          _this.setState({\n            startPage: pages[0] - 10\n          });\n\n          _this.onClickPageNumber(pages[0] - 10);\n        } else {\n          //없으면 현재 pageList에서 첫번째로 이돔\n          _this.setState({\n            startPage: pages[0]\n          });\n\n          _this.onClickPageNumber(pages[0]);\n        }\n      }\n    };\n\n    _this.limit = 10;\n    _this.state = {\n      news: [],\n      currentPage: 1,\n      newsCount: 0,\n      offset: 0,\n      // paging\n      pageSize: 10,\n      //paging\n      startPage: 1 // start\n\n    };\n    return _this;\n  }\n\n  _createClass(Container, [{\n    key: \"render\",\n    value: function render() {\n      var _this$state = this.state,\n          news = _this$state.news,\n          newsCount = _this$state.newsCount;\n      var onClickMore = this.onClickMore,\n          getPageInfo = this.getPageInfo,\n          onClickPageNumber = this.onClickPageNumber,\n          onClickPageHandler = this.onClickPageHandler;\n      var pageInfo = getPageInfo();\n      return React.createElement(View, {\n        news: news,\n        onClickMore: onClickMore,\n        newsCount: newsCount,\n        pages: pageInfo.pages,\n        currentPage: pageInfo.currentPage,\n        onClickPageNumber: onClickPageNumber,\n        onClickPageHandler: onClickPageHandler,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 90\n        },\n        __self: this\n      });\n    }\n  }]);\n\n  return Container;\n}(Component);\n\nexport default connect(function (state) {\n  return {\n    email: state.userinfo.email\n  };\n}, {})(withRouter(injectIntl(Container)));","map":{"version":3,"sources":["/Users/jimmy/Documents/Wizschool/wizlab_web2/src/Page/News/Container.js"],"names":["React","Component","withRouter","injectIntl","connect","View","request","Container","props","componentDidMount","fetchNews","getNewsList","type","limit","offset","state","currentPage","res","json","news","console","log","setState","prev","concat","rows","newsCount","count","totalNewsPage","Math","ceil","pageSize","onClickMore","onClickPageNumber","pageNo","getPageInfo","pages","i","startPage","push","length","onClickPageHandler","totalRankingPage","pageInfo","email","userinfo"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport { withRouter } from \"react-router-dom\";\nimport { injectIntl } from \"react-intl\";\nimport { connect } from \"react-redux\";\nimport View from \"./View\";\nimport * as request from \"../../Common/Util/HTTPRequest\";\nclass Container extends Component {\n  constructor(props) {\n    super(props);\n    this.limit = 10;\n    this.state = { \n      news: [], \n      currentPage: 1, \n      newsCount: 0,\n      offset: 0, // paging\n      pageSize: 10, //paging\n      startPage: 1 // start\n    };\n  }\n  componentDidMount = () => {\n    this.fetchNews();\n  };\n  fetchNews = async () => {\n    let res = await request.getNewsList({\n      type: \"all\",\n      limit: this.limit,\n      offset: this.limit * (this.state.currentPage - 1)\n    });\n    let news = await res.json();\n    console.log(\"news\", news)\n    this.setState(prev => ({\n      news: prev.news.concat(news.rows),\n      newsCount: news.count,\n      totalNewsPage: Math.ceil(news.count/this.state.pageSize), // 검색 page \n    }));\n  };\n  onClickMore = () => {\n    this.setState(\n      prev => ({ currentPage: prev.currentPage + 1 }),\n      () => {\n        this.fetchNews();\n      }\n    );\n  };\n\n  onClickPageNumber = (pageNo) => {\n    this.setState(\n      { currentPage: pageNo }, \n      () => { this.fetchNews() }\n    );\n\n  }\n\n  getPageInfo = () => {\n    let pages = []\n    for(let i = this.state.startPage; i <= this.state.totalNewsPage; i++){\n      pages.push(i)\n      if(pages.length === 10) break;\n    }\n    return {\n      pages: pages,\n      currentPage: this.state.currentPage\n    }\n  }\n\n  onClickPageHandler = (type) => {\n    const {pages} = this.getPageInfo();\n    if(type === \"next\") {  // 다음 버튼 눌렀을때\n      // 현재 보여주는 page다음의 페이지가 총 페이지 수 보다 작을때\n      if(pages[pages.length-1]+1 <= this.state.totalRankingPage) {\n        this.setState({startPage:pages[pages.length-1]+1})\n        this.onClickPageNumber(pages[pages.length-1]+1)\n      }\n    } else { // 이전 버튼 눌렀을때\n      if(pages[0]-this.state.pageSize > 0){ // 현재 pageList의 첫번보다 pageSize만큼 더 있는지 확인\n        this.setState({startPage:pages[0]-10})\n        this.onClickPageNumber(pages[0]-10)\n      } else { //없으면 현재 pageList에서 첫번째로 이돔\n        this.setState({startPage:pages[0]})\n        this.onClickPageNumber(pages[0])\n      }\n    }\n  }\n\n  render() {\n    const { news, newsCount } = this.state;\n    const { onClickMore, getPageInfo, onClickPageNumber, onClickPageHandler } = this;\n    const pageInfo = getPageInfo();\n\n    return <View \n      news={news} \n      onClickMore={onClickMore} \n      newsCount={newsCount} \n      pages={pageInfo.pages}\n      currentPage={pageInfo.currentPage}\n      onClickPageNumber={onClickPageNumber}\n      onClickPageHandler={onClickPageHandler}\n    />;\n  }\n}\nexport default connect(\n  state => ({ email: state.userinfo.email }),\n  {}\n)(withRouter(injectIntl(Container)));\n"]},"metadata":{},"sourceType":"module"}