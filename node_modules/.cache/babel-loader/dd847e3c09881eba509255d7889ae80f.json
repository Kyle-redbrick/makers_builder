{"ast":null,"code":"import _regeneratorRuntime from \"/Users/jimmy/Documents/Wizschool/wizlab_web2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/jimmy/Documents/Wizschool/wizlab_web2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"/Users/jimmy/Documents/Wizschool/wizlab_web2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/jimmy/Documents/Wizschool/wizlab_web2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _inherits from \"/Users/jimmy/Documents/Wizschool/wizlab_web2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _possibleConstructorReturn from \"/Users/jimmy/Documents/Wizschool/wizlab_web2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/jimmy/Documents/Wizschool/wizlab_web2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nvar _jsxFileName = \"/Users/jimmy/Documents/Wizschool/wizlab_web2/src/Page/Challenge/components/ChallengeWorks/index.js\";\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\n\nimport React, { Component } from \"react\";\nimport ChallengeWork from \"../ChallengeWork\";\nimport DateDropDown from \"./DateDropDown\";\nimport * as request from \"../../../../Common/Util/HTTPRequest\";\nimport searchIcon from \"../../../../Image/challenge-search-icon.svg\";\nimport \"./index.scss\";\n\nvar View = /*#__PURE__*/function (_Component) {\n  _inherits(View, _Component);\n\n  var _super = _createSuper(View);\n\n  function View(props) {\n    var _this;\n\n    _classCallCheck(this, View);\n\n    _this = _super.call(this, props);\n\n    _this.onWindowScroll = function (e) {\n      var target = document.documentElement;\n\n      if (target.scrollTop >= target.scrollHeight - target.clientHeight - 100 && !_this.isAllProjectsLoaded && !_this.isLoadingProjects) {\n        _this.loadMoreProjects();\n      }\n    };\n\n    _this.onClickTab = function (tab) {\n      _this.setState({\n        currentTab: tab\n      });\n    };\n\n    _this.onClickDropdown = function () {\n      _this.setState({\n        isClickedDropdown: !_this.state.isClickedDropdown\n      });\n    };\n\n    _this.onClickDropDownOutside = function () {\n      _this.setState({\n        isClickedDropdown: false\n      });\n    };\n\n    _this.onClickDropdownList = function (date) {\n      _this.setState({\n        currentDropdownMenu: date\n      });\n\n      _this.updateProjects(date);\n    };\n\n    _this.onChangeInput = function (e) {\n      var filterProjects = _this.state.projects.filter(function (project) {\n        return project.published.name.includes(e.target.value) || project.published.user.name.includes(e.target.value);\n      });\n\n      _this.setState({\n        searchValue: e.target.value,\n        filterProjects: filterProjects\n      });\n    };\n\n    _this.state = {\n      currentTab: \"new\",\n      projects: [],\n      filterProjects: [],\n      isClickedDropdown: false,\n      searchValue: \"\",\n      currentDropdownMenu: \"2022-01\"\n    };\n    return _this;\n  }\n\n  _createClass(View, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.initProjects();\n      window.addEventListener(\"scroll\", this.onWindowScroll);\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      window.removeEventListener(\"scroll\", this.onWindowScroll);\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate(prevProps, prevState) {\n      if (prevState.currentTab !== this.state.currentTab) {\n        this.didUpdateCurrentTab();\n      }\n    }\n  }, {\n    key: \"didUpdateCurrentTab\",\n    value: function didUpdateCurrentTab() {\n      this.initProjects();\n    }\n  }, {\n    key: \"initProjects\",\n    value: function () {\n      var _initProjects = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n        var projects;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                this.isAllProjectsLoaded = false;\n                _context.next = 3;\n                return this.loadProjects({\n                  offset: 0,\n                  limit: 20,\n                  date: this.state.currentDropdownMenu\n                });\n\n              case 3:\n                projects = _context.sent;\n                this.setState({\n                  projects: projects\n                });\n\n              case 5:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function initProjects() {\n        return _initProjects.apply(this, arguments);\n      }\n\n      return initProjects;\n    }()\n  }, {\n    key: \"updateProjects\",\n    value: function () {\n      var _updateProjects = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(date) {\n        var projects;\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                this.isAllProjectsLoaded = false;\n                _context2.next = 3;\n                return this.loadProjects({\n                  offset: 0,\n                  limit: 20,\n                  date: date\n                });\n\n              case 3:\n                projects = _context2.sent;\n                this.setState({\n                  projects: projects\n                });\n\n              case 5:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n\n      function updateProjects(_x) {\n        return _updateProjects.apply(this, arguments);\n      }\n\n      return updateProjects;\n    }()\n  }, {\n    key: \"loadMoreProjects\",\n    value: function () {\n      var _loadMoreProjects = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3() {\n        var projects;\n        return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                _context3.next = 2;\n                return this.loadProjects({\n                  offset: this.state.projects.length,\n                  limit: 20,\n                  date: this.state.currentDropdownMenu\n                });\n\n              case 2:\n                projects = _context3.sent;\n                this.setState(function (prevState) {\n                  return {\n                    projects: [].concat(prevState.projects, projects)\n                  };\n                });\n\n              case 4:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this);\n      }));\n\n      function loadMoreProjects() {\n        return _loadMoreProjects.apply(this, arguments);\n      }\n\n      return loadMoreProjects;\n    }()\n  }, {\n    key: \"loadProjects\",\n    value: function () {\n      var _loadProjects = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee4(options) {\n        var _this2 = this;\n\n        var projects;\n        return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                if (!this.isLoadingProjects) {\n                  _context4.next = 2;\n                  break;\n                }\n\n                return _context4.abrupt(\"return\");\n\n              case 2:\n                this.isLoadingProjects = true;\n                _context4.next = 5;\n                return request.getCreateChallenge({\n                  offset: options.offset,\n                  limit: options.limit,\n                  order: this.order,\n                  date: options.date\n                }).then(function (res) {\n                  return res.json();\n                }).finally(function () {\n                  _this2.isLoadingProjects = false;\n                });\n\n              case 5:\n                projects = _context4.sent;\n\n                if (projects.length < options.limit) {\n                  this.isAllProjectsLoaded = true;\n                }\n\n                return _context4.abrupt(\"return\", projects.projects.rows);\n\n              case 8:\n              case \"end\":\n                return _context4.stop();\n            }\n          }\n        }, _callee4, this);\n      }));\n\n      function loadProjects(_x2) {\n        return _loadProjects.apply(this, arguments);\n      }\n\n      return loadProjects;\n    }()\n  }, {\n    key: \"order\",\n    get: function get() {\n      var tabToOrder = {\n        new: \"createdAt\",\n        popular: \"likeCount\"\n      };\n      return tabToOrder[this.state.currentTab];\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$state = this.state,\n          currentTab = _this$state.currentTab,\n          isClickedDropdown = _this$state.isClickedDropdown,\n          projects = _this$state.projects,\n          searchValue = _this$state.searchValue,\n          filterProjects = _this$state.filterProjects,\n          currentDropdownMenu = _this$state.currentDropdownMenu;\n      var onClickTab = this.onClickTab,\n          onClickDropdown = this.onClickDropdown,\n          onClickDropdownList = this.onClickDropdownList,\n          onChangeInput = this.onChangeInput,\n          onClickDropDownOutside = this.onClickDropDownOutside;\n      var challengeProjects = searchValue ? filterProjects : projects;\n      return React.createElement(\"div\", {\n        className: \"challenge-work\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 142\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"challenge-work__header\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 143\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"challenge-work__tabs\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 144\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"challenge-work__tab \".concat(currentTab === \"new\" && \"tab--active\"),\n        onClick: function onClick() {\n          return onClickTab(\"new\");\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 145\n        },\n        __self: this\n      }, \"\\uC2E0\\uADDC \\uC791\\uD488\"), React.createElement(\"div\", {\n        className: \"challenge-work__tab \".concat(currentTab === \"popular\" && \"tab--active\"),\n        onClick: function onClick() {\n          return onClickTab(\"popular\");\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 151\n        },\n        __self: this\n      }, \"\\uC778\\uAE30 \\uC791\\uD488\")), React.createElement(\"div\", {\n        className: \"challenge_work__search-wrap\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 158\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"challenge_work__search-wrap__search\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 159\n        },\n        __self: this\n      }, React.createElement(\"input\", {\n        type: \"text\",\n        placeholder: \"\\uAC80\\uC0C9\\uC5B4\\uB97C \\uC785\\uB825\\uD574\\uC8FC\\uC138\\uC694.\",\n        value: searchValue,\n        onChange: onChangeInput,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 160\n        },\n        __self: this\n      }), React.createElement(\"img\", {\n        src: searchIcon,\n        alt: \"\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 166\n        },\n        __self: this\n      })), React.createElement(DateDropDown, {\n        onClickDropdown: onClickDropdown,\n        isClickedDropdown: isClickedDropdown,\n        currentDropdownMenu: currentDropdownMenu,\n        onClickDropdownList: onClickDropdownList,\n        onClickDropDownOutside: onClickDropDownOutside,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 168\n        },\n        __self: this\n      }))), React.createElement(\"div\", {\n        className: \"challenge-work__list\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 178\n        },\n        __self: this\n      }, challengeProjects.length > 0 ? challengeProjects.map(function (project) {\n        return React.createElement(ChallengeWork, {\n          key: project.id,\n          project: project,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 181\n          },\n          __self: this\n        });\n      }) : React.createElement(\"div\", {\n        className: \"challenge-work__list__placeholder\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 183\n        },\n        __self: this\n      }, \"\\uCC38\\uC5EC \\uC791\\uD488\\uC774 \\uC5C6\\uC2B5\\uB2C8\\uB2E4.\")));\n    }\n  }]);\n\n  return View;\n}(Component);\n\nexport { View as default };","map":{"version":3,"sources":["/Users/jimmy/Documents/Wizschool/wizlab_web2/src/Page/Challenge/components/ChallengeWorks/index.js"],"names":["React","Component","ChallengeWork","DateDropDown","request","View","props","onWindowScroll","e","target","document","documentElement","scrollTop","scrollHeight","clientHeight","isAllProjectsLoaded","isLoadingProjects","loadMoreProjects","onClickTab","tab","setState","currentTab","onClickDropdown","isClickedDropdown","state","onClickDropDownOutside","onClickDropdownList","date","currentDropdownMenu","updateProjects","onChangeInput","filterProjects","projects","filter","project","published","name","includes","value","user","searchValue","initProjects","window","addEventListener","removeEventListener","prevProps","prevState","didUpdateCurrentTab","loadProjects","offset","limit","length","concat","options","getCreateChallenge","order","then","res","json","finally","rows","tabToOrder","new","popular","challengeProjects","searchIcon","map","id"],"mappings":";;;;;;;;;;;;;AAAA,OAAOA,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC;AACA,OAAOC,aAAP,MAA0B,kBAA1B;AACA,OAAOC,YAAP,MAAyB,gBAAzB;AACA,OAAO,KAAKC,OAAZ,MAAyB,qCAAzB;;AAEA,OAAO,cAAP;;IAEqBC,I;;;;;AACnB,gBAAYC,KAAZ,EAAmB;AAAA;;AAAA;;AACjB,8BAAMA,KAAN;;AADiB,UA6FnBC,cA7FmB,GA6FF,UAAAC,CAAC,EAAI;AACpB,UAAMC,MAAM,GAAGC,QAAQ,CAACC,eAAxB;;AACA,UACEF,MAAM,CAACG,SAAP,IAAoBH,MAAM,CAACI,YAAP,GAAsBJ,MAAM,CAACK,YAA7B,GAA4C,GAAhE,IACG,CAAC,MAAKC,mBADT,IAEG,CAAC,MAAKC,iBAHX,EAIE;AACA,cAAKC,gBAAL;AACD;AACF,KAtGkB;;AAAA,UAwGnBC,UAxGmB,GAwGN,UAACC,GAAD,EAAS;AACpB,YAAKC,QAAL,CAAc;AAAEC,QAAAA,UAAU,EAAGF;AAAf,OAAd;AACD,KA1GkB;;AAAA,UA4GnBG,eA5GmB,GA4GD,YAAM;AACtB,YAAKF,QAAL,CAAc;AAAEG,QAAAA,iBAAiB,EAAE,CAAC,MAAKC,KAAL,CAAWD;AAAjC,OAAd;AACD,KA9GkB;;AAAA,UAgHnBE,sBAhHmB,GAgHM,YAAM;AAC7B,YAAKL,QAAL,CAAc;AAAEG,QAAAA,iBAAiB,EAAE;AAArB,OAAd;AACD,KAlHkB;;AAAA,UAoHnBG,mBApHmB,GAoHG,UAACC,IAAD,EAAU;AAC9B,YAAKP,QAAL,CAAc;AAAEQ,QAAAA,mBAAmB,EAAGD;AAAxB,OAAd;;AACA,YAAKE,cAAL,CAAoBF,IAApB;AACD,KAvHkB;;AAAA,UAyHnBG,aAzHmB,GAyHH,UAACtB,CAAD,EAAO;AACrB,UAAMuB,cAAc,GAAG,MAAKP,KAAL,CAAWQ,QAAX,CAAoBC,MAApB,CAA2B,UAACC,OAAD;AAAA,eAChDA,OAAO,CAACC,SAAR,CAAkBC,IAAlB,CAAuBC,QAAvB,CAAgC7B,CAAC,CAACC,MAAF,CAAS6B,KAAzC,KAAmDJ,OAAO,CAACC,SAAR,CAAkBI,IAAlB,CAAuBH,IAAvB,CAA4BC,QAA5B,CAAqC7B,CAAC,CAACC,MAAF,CAAS6B,KAA9C,CADH;AAAA,OAA3B,CAAvB;;AAGA,YAAKlB,QAAL,CAAc;AAAEoB,QAAAA,WAAW,EAAEhC,CAAC,CAACC,MAAF,CAAS6B,KAAxB;AAA+BP,QAAAA,cAAc,EAAdA;AAA/B,OAAd;AACD,KA9HkB;;AAEjB,UAAKP,KAAL,GAAa;AACXH,MAAAA,UAAU,EAAE,KADD;AAEXW,MAAAA,QAAQ,EAAE,EAFC;AAGXD,MAAAA,cAAc,EAAE,EAHL;AAIXR,MAAAA,iBAAiB,EAAE,KAJR;AAKXiB,MAAAA,WAAW,EAAE,EALF;AAMXZ,MAAAA,mBAAmB,EAAE;AANV,KAAb;AAFiB;AAUlB;;;;WAED,6BAAoB;AAClB,WAAKa,YAAL;AACAC,MAAAA,MAAM,CAACC,gBAAP,CAAwB,QAAxB,EAAkC,KAAKpC,cAAvC;AACD;;;WAED,gCAAuB;AACrBmC,MAAAA,MAAM,CAACE,mBAAP,CAA2B,QAA3B,EAAqC,KAAKrC,cAA1C;AACD;;;WAED,4BAAmBsC,SAAnB,EAA8BC,SAA9B,EAAyC;AACvC,UAAGA,SAAS,CAACzB,UAAV,KAAyB,KAAKG,KAAL,CAAWH,UAAvC,EAAmD;AACjD,aAAK0B,mBAAL;AACD;AACF;;;WAED,+BAAsB;AACpB,WAAKN,YAAL;AACD;;;;mFAED;AAAA;AAAA;AAAA;AAAA;AAAA;AACE,qBAAK1B,mBAAL,GAA2B,KAA3B;AADF;AAAA,uBAEyB,KAAKiC,YAAL,CAAkB;AACvCC,kBAAAA,MAAM,EAAE,CAD+B;AAEvCC,kBAAAA,KAAK,EAAE,EAFgC;AAGvCvB,kBAAAA,IAAI,EAAE,KAAKH,KAAL,CAAWI;AAHsB,iBAAlB,CAFzB;;AAAA;AAEQI,gBAAAA,QAFR;AAOE,qBAAKZ,QAAL,CAAc;AAAEY,kBAAAA,QAAQ,EAARA;AAAF,iBAAd;;AAPF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,O;;;;;;;;;;;qFAUA,kBAAqBL,IAArB;AAAA;AAAA;AAAA;AAAA;AAAA;AACE,qBAAKZ,mBAAL,GAA2B,KAA3B;AADF;AAAA,uBAEyB,KAAKiC,YAAL,CAAkB;AACvCC,kBAAAA,MAAM,EAAE,CAD+B;AAEvCC,kBAAAA,KAAK,EAAE,EAFgC;AAGvCvB,kBAAAA,IAAI,EAAJA;AAHuC,iBAAlB,CAFzB;;AAAA;AAEQK,gBAAAA,QAFR;AAOE,qBAAKZ,QAAL,CAAc;AAAEY,kBAAAA,QAAQ,EAARA;AAAF,iBAAd;;AAPF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,O;;;;;;;;;;;uFAUA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uBACyB,KAAKgB,YAAL,CAAkB;AACvCC,kBAAAA,MAAM,EAAE,KAAKzB,KAAL,CAAWQ,QAAX,CAAoBmB,MADW;AAEvCD,kBAAAA,KAAK,EAAE,EAFgC;AAGvCvB,kBAAAA,IAAI,EAAE,KAAKH,KAAL,CAAWI;AAHsB,iBAAlB,CADzB;;AAAA;AACQI,gBAAAA,QADR;AAME,qBAAKZ,QAAL,CAAc,UAAA0B,SAAS;AAAA,yBAAK;AAC1Bd,oBAAAA,QAAQ,EAAE,GAAGoB,MAAH,CAAUN,SAAS,CAACd,QAApB,EAA8BA,QAA9B;AADgB,mBAAL;AAAA,iBAAvB;;AANF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,O;;;;;;;;;;;mFAWA,kBAAmBqB,OAAnB;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qBACK,KAAKrC,iBADV;AAAA;AAAA;AAAA;;AAAA;;AAAA;AAIE,qBAAKA,iBAAL,GAAyB,IAAzB;AAJF;AAAA,uBAKyBZ,OAAO,CAC3BkD,kBADoB,CACD;AAClBL,kBAAAA,MAAM,EAAEI,OAAO,CAACJ,MADE;AAElBC,kBAAAA,KAAK,EAAEG,OAAO,CAACH,KAFG;AAGlBK,kBAAAA,KAAK,EAAE,KAAKA,KAHM;AAIlB5B,kBAAAA,IAAI,EAAE0B,OAAO,CAAC1B;AAJI,iBADC,EAOpB6B,IAPoB,CAOf,UAAAC,GAAG;AAAA,yBAAIA,GAAG,CAACC,IAAJ,EAAJ;AAAA,iBAPY,EAQpBC,OARoB,CAQZ,YAAM;AACb,kBAAA,MAAI,CAAC3C,iBAAL,GAAyB,KAAzB;AACD,iBAVoB,CALzB;;AAAA;AAKQgB,gBAAAA,QALR;;AAiBE,oBAAGA,QAAQ,CAACmB,MAAT,GAAkBE,OAAO,CAACH,KAA7B,EAAoC;AAClC,uBAAKnC,mBAAL,GAA2B,IAA3B;AACD;;AAnBH,kDAqBSiB,QAAQ,CAACA,QAAT,CAAkB4B,IArB3B;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,O;;;;;;;;;;SAuBA,eAAY;AACV,UAAMC,UAAU,GAAG;AACjBC,QAAAA,GAAG,EAAE,WADY;AAEjBC,QAAAA,OAAO,EAAE;AAFQ,OAAnB;AAIA,aAAOF,UAAU,CAAC,KAAKrC,KAAL,CAAWH,UAAZ,CAAjB;AACD;;;WAqCD,kBAAS;AAAA,wBAC+F,KAAKG,KADpG;AAAA,UACCH,UADD,eACCA,UADD;AAAA,UACaE,iBADb,eACaA,iBADb;AAAA,UACgCS,QADhC,eACgCA,QADhC;AAAA,UAC0CQ,WAD1C,eAC0CA,WAD1C;AAAA,UACuDT,cADvD,eACuDA,cADvD;AAAA,UACuEH,mBADvE,eACuEA,mBADvE;AAAA,UAECV,UAFD,GAE6F,IAF7F,CAECA,UAFD;AAAA,UAEaI,eAFb,GAE6F,IAF7F,CAEaA,eAFb;AAAA,UAE8BI,mBAF9B,GAE6F,IAF7F,CAE8BA,mBAF9B;AAAA,UAEmDI,aAFnD,GAE6F,IAF7F,CAEmDA,aAFnD;AAAA,UAEkEL,sBAFlE,GAE6F,IAF7F,CAEkEA,sBAFlE;AAGP,UAAMuC,iBAAiB,GAAGxB,WAAW,GAAGT,cAAH,GAAoBC,QAAzD;AACA,aACE;AAAK,QAAA,SAAS,EAAC,gBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE;AAAK,QAAA,SAAS,EAAC,wBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE;AAAK,QAAA,SAAS,EAAC,sBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE;AACE,QAAA,SAAS,gCAAyBX,UAAU,KAAK,KAAf,IAAwB,aAAjD,CADX;AAEE,QAAA,OAAO,EAAE;AAAA,iBAAMH,UAAU,CAAC,KAAD,CAAhB;AAAA,SAFX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qCADF,EAOE;AACE,QAAA,SAAS,gCAAyBG,UAAU,KAAK,SAAf,IAA4B,aAArD,CADX;AAEE,QAAA,OAAO,EAAE;AAAA,iBAAMH,UAAU,CAAC,SAAD,CAAhB;AAAA,SAFX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qCAPF,CADF,EAeE;AAAK,QAAA,SAAS,EAAC,6BAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE;AAAK,QAAA,SAAS,EAAC,qCAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE;AACE,QAAA,IAAI,EAAC,MADP;AAEE,QAAA,WAAW,EAAC,gEAFd;AAGE,QAAA,KAAK,EAAEsB,WAHT;AAIE,QAAA,QAAQ,EAAEV,aAJZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QADF,EAOE;AAAK,QAAA,GAAG,EAAEmC,UAAV;AAAsB,QAAA,GAAG,EAAC,EAA1B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAPF,CADF,EAUE,oBAAC,YAAD;AACE,QAAA,eAAe,EAAE3C,eADnB;AAEE,QAAA,iBAAiB,EAAEC,iBAFrB;AAGE,QAAA,mBAAmB,EAAEK,mBAHvB;AAIE,QAAA,mBAAmB,EAAEF,mBAJvB;AAKE,QAAA,sBAAsB,EAAED,sBAL1B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAVF,CAfF,CADF,EAoCE;AAAK,QAAA,SAAS,EAAC,sBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACGuC,iBAAiB,CAACb,MAAlB,GAA2B,CAA3B,GACCa,iBAAiB,CAACE,GAAlB,CAAsB,UAAChC,OAAD,EAAa;AACjC,eAAO,oBAAC,aAAD;AAAe,UAAA,GAAG,EAAEA,OAAO,CAACiC,EAA5B;AAAgC,UAAA,OAAO,EAAEjC,OAAzC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,UAAP;AACD,OAFD,CADD,GAIC;AAAK,QAAA,SAAS,EAAC,mCAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qEALJ,CApCF,CADF;AA+CD;;;;EApL+BjC,S;;SAAbI,I","sourcesContent":["import React, { Component } from \"react\";\nimport ChallengeWork from \"../ChallengeWork\";\nimport DateDropDown from \"./DateDropDown\";\nimport * as request from \"../../../../Common/Util/HTTPRequest\";\nimport searchIcon from \"../../../../Image/challenge-search-icon.svg\";\nimport \"./index.scss\";\n\nexport default class View extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      currentTab: \"new\",\n      projects: [],\n      filterProjects: [],\n      isClickedDropdown: false,\n      searchValue: \"\",\n      currentDropdownMenu: \"2022-01\"\n    }\n  }\n\n  componentDidMount() {\n    this.initProjects();\n    window.addEventListener(\"scroll\", this.onWindowScroll);\n  }\n\n  componentWillUnmount() {\n    window.removeEventListener(\"scroll\", this.onWindowScroll);\n  }\n\n  componentDidUpdate(prevProps, prevState) {\n    if(prevState.currentTab !== this.state.currentTab) {\n      this.didUpdateCurrentTab();\n    }\n  }\n\n  didUpdateCurrentTab() {\n    this.initProjects();\n  }\n\n  async initProjects() {\n    this.isAllProjectsLoaded = false;\n    const projects = await this.loadProjects({\n      offset: 0,\n      limit: 20,\n      date: this.state.currentDropdownMenu\n    });\n    this.setState({ projects });\n  }\n\n  async updateProjects(date) {\n    this.isAllProjectsLoaded = false;\n    const projects = await this.loadProjects({\n      offset: 0,\n      limit: 20,\n      date\n    });\n    this.setState({ projects });\n  }\n\n  async loadMoreProjects() {\n    const projects = await this.loadProjects({ \n      offset: this.state.projects.length,\n      limit: 20,\n      date: this.state.currentDropdownMenu\n    });\n    this.setState(prevState => ({ \n      projects: [].concat(prevState.projects, projects)\n    }));\n  }\n\n  async loadProjects(options) {\n    if(this.isLoadingProjects) {\n      return;\n    }\n    this.isLoadingProjects = true;\n    const projects = await request\n      .getCreateChallenge({\n        offset: options.offset,\n        limit: options.limit,\n        order: this.order,\n        date: options.date\n      })\n      .then(res => res.json())\n      .finally(() => {\n        this.isLoadingProjects = false;\n      })\n\n    if(projects.length < options.limit) {\n      this.isAllProjectsLoaded = true;\n    }\n\n    return projects.projects.rows;\n  }\n  get order() {\n    const tabToOrder = {\n      new: \"createdAt\",\n      popular: \"likeCount\"\n    }\n    return tabToOrder[this.state.currentTab];\n  }\n\n  onWindowScroll = e => {\n    const target = document.documentElement;\n    if(\n      target.scrollTop >= target.scrollHeight - target.clientHeight - 100\n      && !this.isAllProjectsLoaded\n      && !this.isLoadingProjects\n    ) {\n      this.loadMoreProjects();\n    }\n  }\n\n  onClickTab = (tab) => {\n    this.setState({ currentTab : tab })\n  }\n\n  onClickDropdown = () => {\n    this.setState({ isClickedDropdown: !this.state.isClickedDropdown })\n  }\n\n  onClickDropDownOutside = () => {\n    this.setState({ isClickedDropdown: false })\n  }\n\n  onClickDropdownList = (date) => {\n    this.setState({ currentDropdownMenu : date });\n    this.updateProjects(date);\n  }\n\n  onChangeInput = (e) => {\n    const filterProjects = this.state.projects.filter((project) => (\n      project.published.name.includes(e.target.value) || project.published.user.name.includes(e.target.value)\n    ))\n    this.setState({ searchValue: e.target.value, filterProjects });\n  }\n\n  render() {\n    const { currentTab, isClickedDropdown, projects, searchValue, filterProjects, currentDropdownMenu } = this.state;\n    const { onClickTab, onClickDropdown, onClickDropdownList, onChangeInput, onClickDropDownOutside } = this;\n    const challengeProjects = searchValue ? filterProjects : projects;\n    return(\n      <div className=\"challenge-work\">\n        <div className=\"challenge-work__header\">\n          <div className=\"challenge-work__tabs\">\n            <div \n              className={`challenge-work__tab ${currentTab === \"new\" && \"tab--active\"}`}\n              onClick={() => onClickTab(\"new\")}\n            >\n              신규 작품\n            </div>\n            <div \n              className={`challenge-work__tab ${currentTab === \"popular\" && \"tab--active\"}`}\n              onClick={() => onClickTab(\"popular\")}\n            >\n              인기 작품\n            </div>\n          </div>\n          <div className=\"challenge_work__search-wrap\">\n            <div className=\"challenge_work__search-wrap__search\">\n              <input\n                type=\"text\"\n                placeholder=\"검색어를 입력해주세요.\" \n                value={searchValue}\n                onChange={onChangeInput}\n              />\n              <img src={searchIcon} alt=\"\" />\n            </div>\n            <DateDropDown \n              onClickDropdown={onClickDropdown}\n              isClickedDropdown={isClickedDropdown}\n              currentDropdownMenu={currentDropdownMenu}\n              onClickDropdownList={onClickDropdownList}\n              onClickDropDownOutside={onClickDropDownOutside}\n            />\n          </div>\n        </div>\n      \n        <div className=\"challenge-work__list\">\n          {challengeProjects.length > 0 ? \n            challengeProjects.map((project) => {\n              return <ChallengeWork key={project.id} project={project}/>\n            }) : \n            <div className=\"challenge-work__list__placeholder\">참여 작품이 없습니다.</div>\n          }\n        </div>\n      </div>\n    )\n  }\n}"]},"metadata":{},"sourceType":"module"}