{"ast":null,"code":"import _regeneratorRuntime from \"/Users/jimmy/Documents/Wizschool/wizlab_web2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/jimmy/Documents/Wizschool/wizlab_web2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"/Users/jimmy/Documents/Wizschool/wizlab_web2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/jimmy/Documents/Wizschool/wizlab_web2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _assertThisInitialized from \"/Users/jimmy/Documents/Wizschool/wizlab_web2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";\nimport _inherits from \"/Users/jimmy/Documents/Wizschool/wizlab_web2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _possibleConstructorReturn from \"/Users/jimmy/Documents/Wizschool/wizlab_web2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/jimmy/Documents/Wizschool/wizlab_web2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nvar _jsxFileName = \"/Users/jimmy/Documents/Wizschool/wizlab_web2/src/Page/Builder/Component/Tutorial/Container.js\";\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\n\nimport React, { Component } from \"react\";\nimport { injectIntl } from \"react-intl\";\nimport { withRouter } from \"react-router-dom\";\nimport { connect } from \"react-redux\";\nimport * as previewActions from \"../../Store/Reducer/preview\";\nimport * as userInfoActions from \"../../../../Common/Store/Reducer/UserInfo\";\nimport { VideoClassStageType as StageType, VideoClassConditionType as ConditionType, VideoClassEgoType as EgoType } from \"../../../../Common/Util/Constant\";\nimport RndWrapper from \"../../utils/RndWrapper\";\nimport View from \"./View\";\nimport * as request from \"../../../../Common/Util/HTTPRequest\";\nimport {\n/*PopUp, */\nshowPopUp } from \"../../../../Common/Component/PopUp\";\nimport { getColorTheme } from \"../../utils/colorThemeUtil\";\nimport { checkConditions } from \"./ConditionChecker.js\";\nimport wizLiveBannerImg from \"../../../../Image/wizlive_banner03.png\"; // import * as TrackingUtil from \"../../../../Common/Util/TrackingUtil\";\n\nvar Container = /*#__PURE__*/function (_Component) {\n  _inherits(Container, _Component);\n\n  var _super = _createSuper(Container);\n\n  function Container(props) {\n    var _this;\n\n    _classCallCheck(this, Container);\n\n    _this = _super.call(this, props);\n\n    _this.nextStage = function () {\n      var nextNum = _this.videoclass.currentStageNum + 1;\n\n      if (nextNum < _this.stageCount) {\n        _this.videoclass.currentStageNum = nextNum;\n\n        _this.props.setIsPlaying(false);\n\n        var nextStage = _this.videoclass.stages[nextNum];\n\n        _this.setState({\n          stage: nextStage\n        }, /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n          var _this$props, email, currentTutorial, level;\n\n          return _regeneratorRuntime.wrap(function _callee$(_context) {\n            while (1) {\n              switch (_context.prev = _context.next) {\n                case 0:\n                  // reset ego\n                  _this.egoSay(); // setup video\n\n\n                  if (nextStage.type === StageType.VIDEO) {\n                    setTimeout(function () {\n                      // this.videoRef.webkitRequestFullscreen();\n                      if (_this.videoRef) _this.videoRef.play();\n                    }, 500);\n                  } else {\n                    _this.videoRef = null;\n                  } // my tutorial\n\n\n                  if (nextStage.type === StageType.END) {\n                    _this$props = _this.props, email = _this$props.email, currentTutorial = _this$props.currentTutorial;\n                    level = currentTutorial.tutorial.level;\n\n                    if (!currentTutorial.isComplete) {\n                      request.updateTutorialItem({\n                        email: email,\n                        level: level\n                      }).then(function (res) {\n                        return res.json();\n                      }).then(function (item) {\n                        if (item && level !== 10) {\n                          request.createTutorialItem({\n                            email: email,\n                            level: level + 1\n                          });\n                        }\n                      });\n                    }\n\n                    if (level === 10) {// TrackingUtil.kakaoPixelEvent(\"tutorial\");\n                      // const { formatMessage } = this.props.intl;\n                      // setTimeout(() => {\n                      //   if (!isMarketingAgreement) {\n                      //     showPopUp(\n                      //       <PopUp.TwoButton\n                      //         title={formatMessage({\n                      //           id: \"ID_EVENT_EVENT1_TUTORIAL_TITLE\"\n                      //         })}\n                      //         subtitle={formatMessage({\n                      //           id: \"ID_EVENT_EVENT1_TUTORIAL_SUBTITLE\"\n                      //         })}\n                      //         cancelButtonName={formatMessage({\n                      //           id: \"ID_EVENT_EVENT1_TUTORIAL_CANCEL\"\n                      //         })}\n                      //         cancelAction={() => {\n                      //           showPopUp(\n                      //             <PopUp.OneButton\n                      //               title={formatMessage({\n                      //                 id: \"ID_EVENT_EVENT1_TUTORIAL_CANCEL_TITLE\"\n                      //               })}\n                      //               subtitle={formatMessage({\n                      //                 id: \"ID_EVENT_EVENT1_TUTORIAL_CANCEL_SUBTITLE\"\n                      //               })}\n                      //               buttonName={formatMessage({\n                      //                 id: \"ID_EVENT_EVENT1_TUTORIAL_CANCEL_CONFIRM\"\n                      //               })}\n                      //             />,\n                      //             {\n                      //               dismissButton: false,\n                      //               darkmode: getColorTheme() === \"darkMode\"\n                      //             }\n                      //           );\n                      //         }}\n                      //         confirmButtonName={formatMessage({\n                      //           id: \"ID_EVENT_EVENT1_TUTORIAL_CONFIRM\"\n                      //         })}\n                      //         confirmAction={() => {\n                      //           request\n                      //             .updateUserInfo({ email, isMarketingAgreement: true })\n                      //             .then(res => res.json())\n                      //             .then(json => {\n                      //               if (json.success) {\n                      //                 this.props.updateUserInfo({\n                      //                   isMarketingAgreement: true\n                      //                 });\n                      //                 showPopUp(\n                      //                   <PopUp.OneButton\n                      //                     title={formatMessage({\n                      //                       id: \"ID_EVENT_EVENT1_TUTORIAL_CONFIRM_TITLE\"\n                      //                     })}\n                      //                     subtitle={formatMessage({\n                      //                       id:\n                      //                         \"ID_EVENT_EVENT1_TUTORIAL_CONFIRM_SUBTITLE\"\n                      //                     })}\n                      //                     buttonName={formatMessage({\n                      //                       id: \"ID_EVENT_EVENT1_TUTORIAL_CONFIRM_CONFIRM\"\n                      //                     })}\n                      //                     buttonAction={this.showWizLivePopup}\n                      //                   />,\n                      //                   {\n                      //                     dismissButton: false,\n                      //                     darkmode: getColorTheme() === \"darkMode\"\n                      //                   }\n                      //                 );\n                      //               }\n                      //             });\n                      //         }}\n                      //       />,\n                      //       {\n                      //         dismissButton: false,\n                      //         darkmode: getColorTheme() === \"darkMode\"\n                      //       }\n                      //     );\n                      //   } else {\n                      //     showPopUp(\n                      //       <PopUp.OneButton\n                      //         title={formatMessage({\n                      //           id: \"ID_EVENT_EVENT1_TUTORIAL_CONFIRM_TITLE\"\n                      //         })}\n                      //         subtitle={formatMessage({\n                      //           id: \"ID_EVENT_EVENT1_TUTORIAL_CONFIRM_SUBTITLE\"\n                      //         })}\n                      //         buttonName={formatMessage({\n                      //           id: \"ID_EVENT_EVENT1_TUTORIAL_CONFIRM_CONFIRM\"\n                      //         })}\n                      //         buttonAction={this.showWizLivePopup}\n                      //       />,\n                      //       {\n                      //         dismissButton: false,\n                      //         darkmode: getColorTheme() === \"darkMode\"\n                      //       }\n                      //     );\n                      //   }\n                      // }, 1000);\n                    }\n                  }\n\n                case 3:\n                case \"end\":\n                  return _context.stop();\n              }\n            }\n          }, _callee);\n        })));\n      }\n    };\n\n    _this.showWizLivePopup = function () {\n      showPopUp( /*#__PURE__*/React.createElement(\"a\", {\n        href: \"https://wizlive.com/?trial=4\",\n        target: \"_blank\",\n        rel: \"noopener noreferrer\",\n        __self: _assertThisInitialized(_this),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 210,\n          columnNumber: 7\n        }\n      }, /*#__PURE__*/React.createElement(\"img\", {\n        src: wizLiveBannerImg,\n        alt: \"wizlive\",\n        __self: _assertThisInitialized(_this),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 215,\n          columnNumber: 9\n        }\n      })), {\n        dismissButton: false,\n        darkmode: getColorTheme() === \"darkMode\",\n        defaultPadding: false,\n        dismissOverlay: true\n      });\n    };\n\n    _this.prevStage = function () {\n      var prevNum = _this.videoclass.currentStageNum - 1;\n      if (_this.videoRef) _this.videoRef = null;\n\n      if (prevNum >= 0) {\n        _this.videoclass.currentStageNum = prevNum;\n        var prevStage = _this.videoclass.stages[prevNum];\n\n        _this.setState({\n          stage: prevStage\n        }, function () {\n          _this.egoSay();\n        });\n      }\n    };\n\n    _this.setVideoRef = function (element) {\n      if (!element) return;\n      if (_this.videoRef) _this.videoRef.pause();\n      _this.videoRef = element;\n      _this.videoRef.disablePictureInPicture = true;\n      _this.videoRef.onended = _this.videoOnended;\n    };\n\n    _this.videoOnended = function (e) {\n      _this.nextStage();\n    };\n\n    _this.egoSay = function (messages) {\n      var timeout = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 5000;\n\n      if (messages) {\n        _this.setState({\n          isEgoSaying: true,\n          egoMessages: messages\n        });\n\n        if (_this.egoSayTimer) clearTimeout(_this.egoSayTimer);\n        _this.egoSayTimer = setTimeout(function () {\n          _this.setState({\n            isEgoSaying: false,\n            egoMessages: []\n          });\n        }, timeout);\n      } else {\n        _this.setState({\n          isEgoSaying: false\n        }, function () {\n          setTimeout(function () {\n            _this.setState({\n              egoMessages: []\n            });\n          }, 200);\n        });\n      }\n    };\n\n    _this.onClickEgo = function () {\n      var ego = _this.state.stage.ego;\n      if (ego) _this.egoSay(ego);\n    };\n\n    _this.onClickEgoBubble = function () {\n      if (_this.egoSayTimer) clearTimeout(_this.egoSayTimer);\n\n      _this.egoSay();\n    };\n\n    _this.onClickPrev = function () {\n      _this.prevStage();\n    };\n\n    _this.onClickNext = function () {\n      // this.nextStage();\n      // return;\n      checkConditions(_this.videoclass, _this.props.state, function () {\n        _this.nextStage();\n      }, function (condition) {\n        var message;\n\n        switch (condition.type) {\n          case ConditionType.SPRITE_EXIST:\n            message = \"\".concat(condition.spriteId, \" \\uC2A4\\uD504\\uB77C\\uC774\\uD2B8\\uB97C \\uCD94\\uAC00\\uD574\\uC918!\");\n            break;\n\n          case ConditionType.CODE_EXIST:\n            message = \"\\uCF54\\uB4DC\\uAC00 \\uC798 \\uC791\\uC131\\uB418\\uC5C8\\uB294\\uC9C0 \\uD55C \\uBC88 \\uB354 \\uD655\\uC778\\uD574\\uBCFC\\uAE4C?\\n\".concat(condition.spriteId, \" \\uC2A4\\uD504\\uB77C\\uC774\\uD2B8\\uC5D0 \\uCF54\\uB4DC\\uB97C \\uC785\\uB825\\uD574\\uC57C\\uD574!\");\n            break;\n\n          case ConditionType.SCENE_FIRST:\n            message = \"\".concat(condition.sceneId, \"\\uAC00 \\uCCAB \\uBC88\\uC9F8\\n\\uC7A5\\uBA74\\uC774 \\uB418\\uAC8C \\uD574\\uC57C\\uD574!\");\n            break;\n\n          case ConditionType.SCENE_SELECTED:\n            message = \"\".concat(condition.sceneId, \"\\uB97C\\n\\uD074\\uB9AD\\uD574\\uC11C \\uC120\\uD0DD\\uD574\\uBCF4\\uC790!\");\n            break;\n\n          case ConditionType.PLAY_ONCE:\n            message = \"\\uD55C \\uBC88 \\uC2E4\\uD589\\uD574\\uBCF4\\uC790!\";\n            break;\n\n          case ConditionType.SPRITE_SELECTED:\n            message = \"\".concat(condition.spriteId, \"\\uC2A4\\uD504\\uB77C\\uC774\\uD2B8\\uB97C\\n\\uD074\\uB9AD\\uD574\\uC11C \\uC120\\uD0DD\\uD574\\uBCF4\\uC790!\");\n            break;\n\n          case ConditionType.PUBLISH_PROJECT:\n            message = \"\\uC624\\uB978\\uCABD \\uC704\\uC5D0 \\uD37C\\uBE14\\uB9AC\\uC2F1\\uD558\\uAE30\\uB97C \\uD074\\uB9AD\\uD574\\uC11C \\uD37C\\uBE14\\uB9AC\\uC2F1\\uC744 \\uD574\\uBCF4\\uC790!\";\n            break;\n\n          default:\n            message = \"문제가 생겼어!\\n관리자에게 문의해야해..!\";\n            break;\n        }\n\n        _this.egoSay([{\n          type: \"TEXT\",\n          data: message\n        }]);\n      });\n    };\n\n    _this.onClickHint = function () {\n      var hint = _this.state.stage.hint;\n      if (hint) _this.egoSay(hint);\n    };\n\n    _this.onClickAnsw = function () {\n      var answer = _this.state.stage.answer;\n      if (answer) _this.egoSay(answer, 30000);\n    };\n\n    _this.onClickChangeLevel = function () {\n      var level = _this.props.currentTutorial.tutorial.level;\n\n      if (level !== 10) {\n        _this.props.history.replace({\n          pathname: \"/tutorial/\".concat(level + 1)\n        });\n\n        window.location.reload();\n      }\n    };\n\n    _this.videoclass = _this.props.videoclass;\n    _this.stageCount = _this.videoclass.stages.length;\n    _this.videoRef = null;\n    _this.egoSayTimer = null;\n    _this.state = {\n      stage: _this.videoclass.stages[_this.videoclass.currentStageNum],\n      isEgoSaying: false,\n      egoMessages: []\n    };\n    return _this;\n  }\n\n  _createClass(Container, [{\n    key: \"shouldComponentUpdate\",\n    value: function shouldComponentUpdate(nextProps, nextState) {\n      if (nextProps.isPlaying) {\n        this.videoclass.stages[this.videoclass.currentStageNum].didPlay = true;\n      }\n\n      if (nextProps.isPublished) {\n        this.videoclass.stages[this.videoclass.currentStageNum].didPublish = true;\n      }\n\n      return true;\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate(prevProps, prevState) {\n      var _this2 = this;\n\n      if (prevProps.isPlaying && !this.props.isPlaying) {\n        this.egoSay();\n      } else if (!prevProps.isPlaying && this.props.isPlaying) {\n        checkConditions(this.videoclass, this.props.state, function () {\n          _this2.egoSay([{\n            type: EgoType.TEXT,\n            data: \"좋았어! 결과를 확인해보고 다음 단계로 넘어가자.\"\n          }]);\n        }, function (condition) {\n          _this2.egoSay([{\n            type: EgoType.TEXT,\n            data: \"제대로 작동하는지 한 번 확인해볼까?\"\n          }]);\n        });\n      }\n    } // stage control\n\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$props2 = this.props,\n          zIndex = _this$props2.zIndex,\n          handleChangeZIndex = _this$props2.handleChangeZIndex;\n      var _this$state = this.state,\n          stage = _this$state.stage,\n          isEgoSaying = _this$state.isEgoSaying,\n          egoMessages = _this$state.egoMessages;\n      var setVideoRef = this.setVideoRef,\n          onClickPrev = this.onClickPrev,\n          onClickOverlay = this.onClickOverlay,\n          onClickHint = this.onClickHint,\n          onClickAnsw = this.onClickAnsw,\n          onClickNext = this.onClickNext,\n          onClickEgo = this.onClickEgo,\n          onClickEgoBubble = this.onClickEgoBubble,\n          onClickChangeLevel = this.onClickChangeLevel;\n      var isStart = this.videoclass.currentStageNum === 0;\n      var isEnd = this.videoclass.currentStageNum === this.stageCount - 1;\n      var level = this.props.currentTutorial.tutorial.level;\n      var title = this.videoclass.title;\n      return /*#__PURE__*/React.createElement(RndWrapper, {\n        id: \"tutorial\",\n        style: {\n          zIndex: zIndex\n        },\n        defaultWidth: 550,\n        defaultHeight: 550 * 9 / 16 + 35,\n        defaultX: document.body.clientWidth - 630,\n        defaultY: 16,\n        minWidth: 550,\n        minHeight: 550 * 9 / 16 + 35,\n        lockAspectRatio: 16 / 9,\n        lockAspectRatioExtraHeight: 35,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 363,\n          columnNumber: 7\n        }\n      }, /*#__PURE__*/React.createElement(View, {\n        isFullscreen: stage.type !== StageType.CODE,\n        title: title,\n        stage: stage,\n        isStart: isStart,\n        isEnd: isEnd,\n        isEgoSaying: isEgoSaying,\n        egoMessages: egoMessages,\n        setVideoRef: setVideoRef,\n        level: level,\n        onClickPrev: onClickPrev,\n        onClickOverlay: onClickOverlay,\n        onClickHint: onClickHint,\n        onClickAnsw: onClickAnsw,\n        onClickNext: onClickNext,\n        onClickEgo: onClickEgo,\n        onClickEgoBubble: onClickEgoBubble,\n        onClickChangeLevel: onClickChangeLevel,\n        handleChangeZIndex: handleChangeZIndex,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 375,\n          columnNumber: 9\n        }\n      }));\n    }\n  }]);\n\n  return Container;\n}(Component);\n\nexport default connect(function (state) {\n  return {\n    state: state,\n    email: state.userinfo.email,\n    isMarketingAgreement: state.userinfo.isMarketingAgreement,\n    videoclass: state.project.videoclass,\n    isPlaying: state.preview.isPlaying,\n    isPublished: state.interaction.isPublished\n  };\n}, {\n  updateUserInfo: userInfoActions.updateUserInfo,\n  setIsPlaying: previewActions.setIsPlaying\n})(withRouter(injectIntl(Container)));","map":{"version":3,"sources":["/Users/jimmy/Documents/Wizschool/wizlab_web2/src/Page/Builder/Component/Tutorial/Container.js"],"names":["React","Component","injectIntl","withRouter","connect","previewActions","userInfoActions","VideoClassStageType","StageType","VideoClassConditionType","ConditionType","VideoClassEgoType","EgoType","RndWrapper","View","request","showPopUp","getColorTheme","checkConditions","wizLiveBannerImg","Container","props","nextStage","nextNum","videoclass","currentStageNum","stageCount","setIsPlaying","stages","setState","stage","egoSay","type","VIDEO","setTimeout","videoRef","play","END","email","currentTutorial","level","tutorial","isComplete","updateTutorialItem","then","res","json","item","createTutorialItem","showWizLivePopup","dismissButton","darkmode","defaultPadding","dismissOverlay","prevStage","prevNum","setVideoRef","element","pause","disablePictureInPicture","onended","videoOnended","e","messages","timeout","isEgoSaying","egoMessages","egoSayTimer","clearTimeout","onClickEgo","ego","state","onClickEgoBubble","onClickPrev","onClickNext","condition","message","SPRITE_EXIST","spriteId","CODE_EXIST","SCENE_FIRST","sceneId","SCENE_SELECTED","PLAY_ONCE","SPRITE_SELECTED","PUBLISH_PROJECT","data","onClickHint","hint","onClickAnsw","answer","onClickChangeLevel","history","replace","pathname","window","location","reload","length","nextProps","nextState","isPlaying","didPlay","isPublished","didPublish","prevProps","prevState","TEXT","zIndex","handleChangeZIndex","onClickOverlay","isStart","isEnd","title","document","body","clientWidth","CODE","userinfo","isMarketingAgreement","project","preview","interaction","updateUserInfo"],"mappings":";;;;;;;;;;;;;;AAAA,OAAOA,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC;AACA,SAASC,UAAT,QAA2B,YAA3B;AACA,SAASC,UAAT,QAA2B,kBAA3B;AACA,SAASC,OAAT,QAAwB,aAAxB;AACA,OAAO,KAAKC,cAAZ,MAAgC,6BAAhC;AACA,OAAO,KAAKC,eAAZ,MAAiC,2CAAjC;AACA,SACEC,mBAAmB,IAAIC,SADzB,EAEEC,uBAAuB,IAAIC,aAF7B,EAGEC,iBAAiB,IAAIC,OAHvB,QAIO,kCAJP;AAKA,OAAOC,UAAP,MAAuB,wBAAvB;AACA,OAAOC,IAAP,MAAiB,QAAjB;AACA,OAAO,KAAKC,OAAZ,MAAyB,qCAAzB;AACA;AAAS;AAAYC,SAArB,QAAsC,oCAAtC;AACA,SAASC,aAAT,QAA8B,4BAA9B;AACA,SAASC,eAAT,QAAgC,uBAAhC;AACA,OAAOC,gBAAP,MAA6B,wCAA7B,C,CACA;;IAEMC,S;;;;;AACJ,qBAAYC,KAAZ,EAAmB;AAAA;;AAAA;;AACjB,8BAAMA,KAAN;;AADiB,UAiDnBC,SAjDmB,GAiDP,YAAM;AAChB,UAAMC,OAAO,GAAG,MAAKC,UAAL,CAAgBC,eAAhB,GAAkC,CAAlD;;AACA,UAAIF,OAAO,GAAG,MAAKG,UAAnB,EAA+B;AAC7B,cAAKF,UAAL,CAAgBC,eAAhB,GAAkCF,OAAlC;;AACA,cAAKF,KAAL,CAAWM,YAAX,CAAwB,KAAxB;;AACA,YAAML,SAAS,GAAG,MAAKE,UAAL,CAAgBI,MAAhB,CAAuBL,OAAvB,CAAlB;;AACA,cAAKM,QAAL,CAAc;AAAEC,UAAAA,KAAK,EAAER;AAAT,SAAd,wEAAoC;AAAA;;AAAA;AAAA;AAAA;AAAA;AAClC;AACA,wBAAKS,MAAL,GAFkC,CAGlC;;;AACA,sBAAIT,SAAS,CAACU,IAAV,KAAmBxB,SAAS,CAACyB,KAAjC,EAAwC;AACtCC,oBAAAA,UAAU,CAAC,YAAM;AACf;AACA,0BAAI,MAAKC,QAAT,EAAmB,MAAKA,QAAL,CAAcC,IAAd;AACpB,qBAHS,EAGP,GAHO,CAAV;AAID,mBALD,MAKO;AACL,0BAAKD,QAAL,GAAgB,IAAhB;AACD,mBAXiC,CAYlC;;;AACA,sBAAIb,SAAS,CAACU,IAAV,KAAmBxB,SAAS,CAAC6B,GAAjC,EAAsC;AAAA,kCAIhC,MAAKhB,KAJ2B,EAElCiB,KAFkC,eAElCA,KAFkC,EAGRC,eAHQ,eAGRA,eAHQ;AAK9BC,oBAAAA,KAL8B,GAKtBD,eAAe,CAACE,QAAhB,CAAyBD,KALH;;AAMpC,wBAAI,CAACD,eAAe,CAACG,UAArB,EAAiC;AAC/B3B,sBAAAA,OAAO,CACJ4B,kBADH,CACsB;AAAEL,wBAAAA,KAAK,EAALA,KAAF;AAASE,wBAAAA,KAAK,EAALA;AAAT,uBADtB,EAEGI,IAFH,CAEQ,UAAAC,GAAG;AAAA,+BAAIA,GAAG,CAACC,IAAJ,EAAJ;AAAA,uBAFX,EAGGF,IAHH,CAGQ,UAAAG,IAAI,EAAI;AACZ,4BAAIA,IAAI,IAAIP,KAAK,KAAK,EAAtB,EAA0B;AACxBzB,0BAAAA,OAAO,CAACiC,kBAAR,CAA2B;AAAEV,4BAAAA,KAAK,EAALA,KAAF;AAASE,4BAAAA,KAAK,EAAEA,KAAK,GAAG;AAAxB,2BAA3B;AACD;AACF,uBAPH;AAQD;;AACD,wBAAIA,KAAK,KAAK,EAAd,EAAkB,CAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACD;AACF;;AA9HiC;AAAA;AAAA;AAAA;AAAA;AAAA;A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","sourcesContent":["import React, { Component } from \"react\";\nimport { injectIntl } from \"react-intl\";\nimport { withRouter } from \"react-router-dom\";\nimport { connect } from \"react-redux\";\nimport * as previewActions from \"../../Store/Reducer/preview\";\nimport * as userInfoActions from \"../../../../Common/Store/Reducer/UserInfo\";\nimport {\n  VideoClassStageType as StageType,\n  VideoClassConditionType as ConditionType,\n  VideoClassEgoType as EgoType\n} from \"../../../../Common/Util/Constant\";\nimport RndWrapper from \"../../utils/RndWrapper\";\nimport View from \"./View\";\nimport * as request from \"../../../../Common/Util/HTTPRequest\";\nimport { /*PopUp, */ showPopUp } from \"../../../../Common/Component/PopUp\";\nimport { getColorTheme } from \"../../utils/colorThemeUtil\";\nimport { checkConditions } from \"./ConditionChecker.js\";\nimport wizLiveBannerImg from \"../../../../Image/wizlive_banner03.png\";\n// import * as TrackingUtil from \"../../../../Common/Util/TrackingUtil\";\n\nclass Container extends Component {\n  constructor(props) {\n    super(props);\n    this.videoclass = this.props.videoclass;\n    this.stageCount = this.videoclass.stages.length;\n    this.videoRef = null;\n    this.egoSayTimer = null;\n    this.state = {\n      stage: this.videoclass.stages[this.videoclass.currentStageNum],\n      isEgoSaying: false,\n      egoMessages: []\n    };\n  }\n  shouldComponentUpdate(nextProps, nextState) {\n    if (nextProps.isPlaying) {\n      this.videoclass.stages[this.videoclass.currentStageNum].didPlay = true;\n    }\n    if (nextProps.isPublished) {\n      this.videoclass.stages[this.videoclass.currentStageNum].didPublish = true;\n    }\n    return true;\n  }\n  componentDidUpdate(prevProps, prevState) {\n    if (prevProps.isPlaying && !this.props.isPlaying) {\n      this.egoSay();\n    } else if (!prevProps.isPlaying && this.props.isPlaying) {\n      checkConditions(\n        this.videoclass,\n        this.props.state,\n        () => {\n          this.egoSay([\n            {\n              type: EgoType.TEXT,\n              data: \"좋았어! 결과를 확인해보고 다음 단계로 넘어가자.\"\n            }\n          ]);\n        },\n        condition => {\n          this.egoSay([\n            {\n              type: EgoType.TEXT,\n              data: \"제대로 작동하는지 한 번 확인해볼까?\"\n            }\n          ]);\n        }\n      );\n    }\n  }\n\n  // stage control\n  nextStage = () => {\n    const nextNum = this.videoclass.currentStageNum + 1;\n    if (nextNum < this.stageCount) {\n      this.videoclass.currentStageNum = nextNum;\n      this.props.setIsPlaying(false);\n      const nextStage = this.videoclass.stages[nextNum];\n      this.setState({ stage: nextStage }, async () => {\n        // reset ego\n        this.egoSay();\n        // setup video\n        if (nextStage.type === StageType.VIDEO) {\n          setTimeout(() => {\n            // this.videoRef.webkitRequestFullscreen();\n            if (this.videoRef) this.videoRef.play();\n          }, 500);\n        } else {\n          this.videoRef = null;\n        }\n        // my tutorial\n        if (nextStage.type === StageType.END) {\n          const {\n            email,\n            /*isMarketingAgreement,*/ currentTutorial\n          } = this.props;\n          const level = currentTutorial.tutorial.level;\n          if (!currentTutorial.isComplete) {\n            request\n              .updateTutorialItem({ email, level })\n              .then(res => res.json())\n              .then(item => {\n                if (item && level !== 10) {\n                  request.createTutorialItem({ email, level: level + 1 });\n                }\n              });\n          }\n          if (level === 10) {\n            // TrackingUtil.kakaoPixelEvent(\"tutorial\");\n            // const { formatMessage } = this.props.intl;\n            // setTimeout(() => {\n            //   if (!isMarketingAgreement) {\n            //     showPopUp(\n            //       <PopUp.TwoButton\n            //         title={formatMessage({\n            //           id: \"ID_EVENT_EVENT1_TUTORIAL_TITLE\"\n            //         })}\n            //         subtitle={formatMessage({\n            //           id: \"ID_EVENT_EVENT1_TUTORIAL_SUBTITLE\"\n            //         })}\n            //         cancelButtonName={formatMessage({\n            //           id: \"ID_EVENT_EVENT1_TUTORIAL_CANCEL\"\n            //         })}\n            //         cancelAction={() => {\n            //           showPopUp(\n            //             <PopUp.OneButton\n            //               title={formatMessage({\n            //                 id: \"ID_EVENT_EVENT1_TUTORIAL_CANCEL_TITLE\"\n            //               })}\n            //               subtitle={formatMessage({\n            //                 id: \"ID_EVENT_EVENT1_TUTORIAL_CANCEL_SUBTITLE\"\n            //               })}\n            //               buttonName={formatMessage({\n            //                 id: \"ID_EVENT_EVENT1_TUTORIAL_CANCEL_CONFIRM\"\n            //               })}\n            //             />,\n            //             {\n            //               dismissButton: false,\n            //               darkmode: getColorTheme() === \"darkMode\"\n            //             }\n            //           );\n            //         }}\n            //         confirmButtonName={formatMessage({\n            //           id: \"ID_EVENT_EVENT1_TUTORIAL_CONFIRM\"\n            //         })}\n            //         confirmAction={() => {\n            //           request\n            //             .updateUserInfo({ email, isMarketingAgreement: true })\n            //             .then(res => res.json())\n            //             .then(json => {\n            //               if (json.success) {\n            //                 this.props.updateUserInfo({\n            //                   isMarketingAgreement: true\n            //                 });\n            //                 showPopUp(\n            //                   <PopUp.OneButton\n            //                     title={formatMessage({\n            //                       id: \"ID_EVENT_EVENT1_TUTORIAL_CONFIRM_TITLE\"\n            //                     })}\n            //                     subtitle={formatMessage({\n            //                       id:\n            //                         \"ID_EVENT_EVENT1_TUTORIAL_CONFIRM_SUBTITLE\"\n            //                     })}\n            //                     buttonName={formatMessage({\n            //                       id: \"ID_EVENT_EVENT1_TUTORIAL_CONFIRM_CONFIRM\"\n            //                     })}\n            //                     buttonAction={this.showWizLivePopup}\n            //                   />,\n            //                   {\n            //                     dismissButton: false,\n            //                     darkmode: getColorTheme() === \"darkMode\"\n            //                   }\n            //                 );\n            //               }\n            //             });\n            //         }}\n            //       />,\n            //       {\n            //         dismissButton: false,\n            //         darkmode: getColorTheme() === \"darkMode\"\n            //       }\n            //     );\n            //   } else {\n            //     showPopUp(\n            //       <PopUp.OneButton\n            //         title={formatMessage({\n            //           id: \"ID_EVENT_EVENT1_TUTORIAL_CONFIRM_TITLE\"\n            //         })}\n            //         subtitle={formatMessage({\n            //           id: \"ID_EVENT_EVENT1_TUTORIAL_CONFIRM_SUBTITLE\"\n            //         })}\n            //         buttonName={formatMessage({\n            //           id: \"ID_EVENT_EVENT1_TUTORIAL_CONFIRM_CONFIRM\"\n            //         })}\n            //         buttonAction={this.showWizLivePopup}\n            //       />,\n            //       {\n            //         dismissButton: false,\n            //         darkmode: getColorTheme() === \"darkMode\"\n            //       }\n            //     );\n            //   }\n            // }, 1000);\n          }\n        }\n      });\n    }\n  };\n\n  showWizLivePopup = () => {\n    showPopUp(\n      <a\n        href=\"https://wizlive.com/?trial=4\"\n        target=\"_blank\"\n        rel=\"noopener noreferrer\"\n      >\n        <img src={wizLiveBannerImg} alt=\"wizlive\" />\n      </a>,\n      {\n        dismissButton: false,\n        darkmode: getColorTheme() === \"darkMode\",\n        defaultPadding: false,\n        dismissOverlay: true\n      }\n    );\n  };\n\n  prevStage = () => {\n    const prevNum = this.videoclass.currentStageNum - 1;\n    if (this.videoRef) this.videoRef = null;\n    if (prevNum >= 0) {\n      this.videoclass.currentStageNum = prevNum;\n      const prevStage = this.videoclass.stages[prevNum];\n      this.setState({ stage: prevStage }, () => {\n        this.egoSay();\n      });\n    }\n  };\n\n  // video control\n  setVideoRef = element => {\n    if (!element) return;\n    if (this.videoRef) this.videoRef.pause();\n    this.videoRef = element;\n    this.videoRef.disablePictureInPicture = true;\n    this.videoRef.onended = this.videoOnended;\n  };\n  videoOnended = e => {\n    this.nextStage();\n  };\n\n  // ego control\n  egoSay = (messages, timeout = 5000) => {\n    if (messages) {\n      this.setState({ isEgoSaying: true, egoMessages: messages });\n      if (this.egoSayTimer) clearTimeout(this.egoSayTimer);\n      this.egoSayTimer = setTimeout(() => {\n        this.setState({ isEgoSaying: false, egoMessages: [] });\n      }, timeout);\n    } else {\n      this.setState({ isEgoSaying: false }, () => {\n        setTimeout(() => {\n          this.setState({ egoMessages: [] });\n        }, 200);\n      });\n    }\n  };\n  onClickEgo = () => {\n    const ego = this.state.stage.ego;\n    if (ego) this.egoSay(ego);\n  };\n  onClickEgoBubble = () => {\n    if (this.egoSayTimer) clearTimeout(this.egoSayTimer);\n    this.egoSay();\n  };\n\n  // event control\n  onClickPrev = () => {\n    this.prevStage();\n  };\n  onClickNext = () => {\n    // this.nextStage();\n    // return;\n    checkConditions(\n      this.videoclass,\n      this.props.state,\n      () => {\n        this.nextStage();\n      },\n      condition => {\n        let message;\n        switch (condition.type) {\n          case ConditionType.SPRITE_EXIST:\n            message = `${condition.spriteId} 스프라이트를 추가해줘!`;\n            break;\n          case ConditionType.CODE_EXIST:\n            message = `코드가 잘 작성되었는지 한 번 더 확인해볼까?\\n${\n              condition.spriteId\n            } 스프라이트에 코드를 입력해야해!`;\n            break;\n          case ConditionType.SCENE_FIRST:\n            message = `${condition.sceneId}가 첫 번째\\n장면이 되게 해야해!`;\n            break;\n          case ConditionType.SCENE_SELECTED:\n            message = `${condition.sceneId}를\\n클릭해서 선택해보자!`;\n            break;\n          case ConditionType.PLAY_ONCE:\n            message = `한 번 실행해보자!`;\n            break;\n          case ConditionType.SPRITE_SELECTED:\n            message = `${condition.spriteId}스프라이트를\\n클릭해서 선택해보자!`;\n            break;\n          case ConditionType.PUBLISH_PROJECT:\n            message = `오른쪽 위에 퍼블리싱하기를 클릭해서 퍼블리싱을 해보자!`;\n            break;\n          default:\n            message = \"문제가 생겼어!\\n관리자에게 문의해야해..!\";\n            break;\n        }\n        this.egoSay([\n          {\n            type: \"TEXT\",\n            data: message\n          }\n        ]);\n      }\n    );\n  };\n  onClickHint = () => {\n    const hint = this.state.stage.hint;\n    if (hint) this.egoSay(hint);\n  };\n  onClickAnsw = () => {\n    const answer = this.state.stage.answer;\n    if (answer) this.egoSay(answer, 30000);\n  };\n  onClickChangeLevel = () => {\n    const level = this.props.currentTutorial.tutorial.level;\n    if (level !== 10) {\n      this.props.history.replace({ pathname: `/tutorial/${level + 1}` });\n      window.location.reload();\n    }\n  };\n\n  render() {\n    const { zIndex, handleChangeZIndex } = this.props;\n    const { stage, isEgoSaying, egoMessages } = this.state;\n    const {\n      setVideoRef,\n      onClickPrev,\n      onClickOverlay,\n      onClickHint,\n      onClickAnsw,\n      onClickNext,\n      onClickEgo,\n      onClickEgoBubble,\n      onClickChangeLevel\n    } = this;\n\n    const isStart = this.videoclass.currentStageNum === 0;\n    const isEnd = this.videoclass.currentStageNum === this.stageCount - 1;\n    const level = this.props.currentTutorial.tutorial.level;\n    const title = this.videoclass.title;\n    return (\n      <RndWrapper\n        id=\"tutorial\"\n        style={{ zIndex }}\n        defaultWidth={550}\n        defaultHeight={(550 * 9) / 16 + 35}\n        defaultX={document.body.clientWidth - 630}\n        defaultY={16}\n        minWidth={550}\n        minHeight={(550 * 9) / 16 + 35}\n        lockAspectRatio={16 / 9}\n        lockAspectRatioExtraHeight={35}\n      >\n        <View\n          isFullscreen={stage.type !== StageType.CODE}\n          title={title}\n          stage={stage}\n          isStart={isStart}\n          isEnd={isEnd}\n          isEgoSaying={isEgoSaying}\n          egoMessages={egoMessages}\n          setVideoRef={setVideoRef}\n          level={level}\n          onClickPrev={onClickPrev}\n          onClickOverlay={onClickOverlay}\n          onClickHint={onClickHint}\n          onClickAnsw={onClickAnsw}\n          onClickNext={onClickNext}\n          onClickEgo={onClickEgo}\n          onClickEgoBubble={onClickEgoBubble}\n          onClickChangeLevel={onClickChangeLevel}\n          handleChangeZIndex={handleChangeZIndex}\n        />\n      </RndWrapper>\n    );\n  }\n}\n\nexport default connect(\n  state => ({\n    state: state,\n    email: state.userinfo.email,\n    isMarketingAgreement: state.userinfo.isMarketingAgreement,\n    videoclass: state.project.videoclass,\n    isPlaying: state.preview.isPlaying,\n    isPublished: state.interaction.isPublished\n  }),\n  {\n    updateUserInfo: userInfoActions.updateUserInfo,\n    setIsPlaying: previewActions.setIsPlaying\n  }\n)(withRouter(injectIntl(Container)));\n"]},"metadata":{},"sourceType":"module"}