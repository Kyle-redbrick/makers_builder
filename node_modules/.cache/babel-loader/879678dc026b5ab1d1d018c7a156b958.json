{"ast":null,"code":"import _regeneratorRuntime from \"/Users/jimmy/Documents/Wizschool/astroboy/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/jimmy/Documents/Wizschool/astroboy/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"/Users/jimmy/Documents/Wizschool/astroboy/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/jimmy/Documents/Wizschool/astroboy/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _inherits from \"/Users/jimmy/Documents/Wizschool/astroboy/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _possibleConstructorReturn from \"/Users/jimmy/Documents/Wizschool/astroboy/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/jimmy/Documents/Wizschool/astroboy/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nvar _jsxFileName = \"/Users/jimmy/Documents/Wizschool/astroboy/src/Page/Event/OCP2/Review/Container.js\";\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\n\nimport React, { Component } from \"react\";\nimport { connect } from \"react-redux\";\nimport * as request from \"../../../../Common/Util/HTTPRequest\";\nimport View from \"./View\";\nimport { OCPGame } from \"../../../../Common/Util/Constant\";\nimport PopUp, { showPopUp } from \"../../../../Common/Component/PopUp\";\nimport SignIn from \"../../../../Common/Component/SignIn\";\n\nvar Container = /*#__PURE__*/function (_Component) {\n  _inherits(Container, _Component);\n\n  var _super = _createSuper(Container);\n\n  function Container(props) {\n    var _this;\n\n    _classCallCheck(this, Container);\n\n    _this = _super.call(this, props);\n\n    _this.componentDidUpdate = function (prevProps, prevState) {\n      if (_this.props.userinfo.email !== prevProps.userinfo.email) _this.getMyOcp();\n    };\n\n    _this.getMyOcp = /*#__PURE__*/function () {\n      var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(gameInfoCallback) {\n        var email, res, myOcpInfo;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                email = _this.props.userinfo.email;\n\n                if (!(email || _this.getGuestInfo())) {\n                  _context.next = 11;\n                  break;\n                }\n\n                _context.next = 4;\n                return request.getMyOcp2(email ? {\n                  email: email\n                } : {\n                  guestId: _this.getGuestInfo().id\n                });\n\n              case 4:\n                res = _context.sent;\n                _context.next = 7;\n                return res.json();\n\n              case 7:\n                myOcpInfo = _context.sent;\n\n                if (myOcpInfo) {\n                  _this.setGameInfo(myOcpInfo, gameInfoCallback);\n                }\n\n                _context.next = 12;\n                break;\n\n              case 11:\n                _this.setState({\n                  gameInfo: OCPGame\n                });\n\n              case 12:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee);\n      }));\n\n      return function (_x) {\n        return _ref.apply(this, arguments);\n      };\n    }();\n\n    _this.getOCPCommentsByEmail = function () {\n      var email = _this.props.userinfo.email;\n      if (!email) return;\n      request.getOCPCommentsByEmail({\n        email: email\n      }).then(function (res) {\n        return res.json();\n      }).then(function (json) {\n        if (json.success) {\n          _this.setCommentInfoEachMission(json.comments);\n        }\n      }).catch(function (e) {\n        return console.error(e);\n      });\n    };\n\n    _this.setGameInfo = function (myOcpInfo, callback) {\n      // OCPGame 데이터를 보존하기 위해\n      var gameInfo = JSON.parse(JSON.stringify(OCPGame));\n      myOcpInfo.forEach(function (myOcp) {\n        var game = gameInfo[myOcp.type];\n        var mission = game.itemInfo[myOcp.grade];\n        mission[\"level\"] = myOcp.level;\n      });\n\n      _this.setState({\n        gameInfo: gameInfo\n      }, function () {\n        _this.getOCPCommentsByEmail();\n\n        if (callback) callback();\n      });\n    };\n\n    _this.setCommentInfoEachMission = function (comments) {\n      var gameInfo = JSON.parse(JSON.stringify(_this.state.gameInfo));\n\n      for (var i = 0; i < comments.length; i++) {\n        var comment = comments[i];\n        gameInfo[comment.type].itemInfo[comment.grade][\"isComment\"] = true;\n      }\n\n      _this.setState({\n        gameInfo: gameInfo\n      });\n    };\n\n    _this.getGuestInfo = function () {\n      return localStorage.getItem(\"ocpId\") && JSON.parse(localStorage.getItem(\"ocpId\"));\n    };\n\n    _this.onClickTry = function (gameKey, gradeKey) {\n      if (!_this.props.userinfo.email) {\n        showPopUp(React.createElement(PopUp.TwoButton, {\n          confirmAction: function confirmAction() {\n            showPopUp(React.createElement(SignIn, {\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 103\n              },\n              __self: this\n            }), {\n              darkmode: true,\n              dismissOverlay: true,\n              mobileFullScreen: true,\n              scrollable: true\n            });\n          },\n          title: \"\\uB85C\\uADF8\\uC778 \\uD6C4 \\uCC38\\uC5EC\\uD560 \\uC218 \\uC788\\uC2B5\\uB2C8\\uB2E4\",\n          confirmButtonName: \"\\uB85C\\uADF8\\uC778\",\n          cancelButtonName: \"\\uCDE8\\uC18C\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 101\n          },\n          __self: this\n        }), {\n          darkmode: true,\n          dismissOverlay: true,\n          mobileFullScreen: true,\n          scrollable: true\n        });\n        return;\n      }\n\n      window.open(\"/codingparty?type=\".concat(gameKey, \"&grade=\").concat(gradeKey));\n    };\n\n    _this.guest = localStorage.getItem(\"ocpId\") && JSON.parse(localStorage.getItem(\"ocpId\"));\n    _this.state = {\n      gameInfo: OCPGame\n    };\n    return _this;\n  }\n\n  _createClass(Container, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.getMyOcp();\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var gameInfo = this.state.gameInfo;\n      return React.createElement(View, {\n        onClickTry: this.onClickTry,\n        gameInfo: gameInfo,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 128\n        },\n        __self: this\n      });\n    }\n  }]);\n\n  return Container;\n}(Component);\n\nexport default connect(function (state) {\n  return {\n    userinfo: state.userinfo\n  };\n}, {})(Container);","map":{"version":3,"sources":["/Users/jimmy/Documents/Wizschool/astroboy/src/Page/Event/OCP2/Review/Container.js"],"names":["React","Component","connect","request","View","OCPGame","PopUp","showPopUp","SignIn","Container","props","componentDidUpdate","prevProps","prevState","userinfo","email","getMyOcp","gameInfoCallback","getGuestInfo","getMyOcp2","guestId","id","res","json","myOcpInfo","setGameInfo","setState","gameInfo","getOCPCommentsByEmail","then","success","setCommentInfoEachMission","comments","catch","e","console","error","callback","JSON","parse","stringify","forEach","myOcp","game","type","mission","itemInfo","grade","level","state","i","length","comment","localStorage","getItem","onClickTry","gameKey","gradeKey","darkmode","dismissOverlay","mobileFullScreen","scrollable","window","open","guest"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport { connect } from \"react-redux\";\nimport * as request from \"../../../../Common/Util/HTTPRequest\";\nimport View from \"./View\";\nimport { OCPGame } from \"../../../../Common/Util/Constant\";\nimport PopUp, { showPopUp } from \"../../../../Common/Component/PopUp\";\nimport SignIn from \"../../../../Common/Component/SignIn\";\n\nclass Container extends Component {\n  constructor(props) {\n    super(props);\n\n    this.guest =\n      localStorage.getItem(\"ocpId\") &&\n      JSON.parse(localStorage.getItem(\"ocpId\"));\n\n    this.state = {\n      gameInfo: OCPGame\n    };\n  }\n\n  componentDidMount() {\n    this.getMyOcp();\n  }\n\n  componentDidUpdate = (prevProps, prevState) => {\n    if (this.props.userinfo.email !== prevProps.userinfo.email) this.getMyOcp();\n  };\n\n  getMyOcp = async gameInfoCallback => {\n    const email = this.props.userinfo.email;\n    if (email || this.getGuestInfo()) {\n      let res = await request.getMyOcp2(\n        email ? { email } : { guestId: this.getGuestInfo().id }\n      );\n      let myOcpInfo = await res.json();\n      if (myOcpInfo) {\n        this.setGameInfo(myOcpInfo, gameInfoCallback);\n      }\n    } else {\n      this.setState({\n        gameInfo: OCPGame\n      });\n    }\n  };\n\n  getOCPCommentsByEmail = () => {\n    const { email } = this.props.userinfo;\n    if (!email) return;\n    request\n      .getOCPCommentsByEmail({ email })\n      .then(res => res.json())\n      .then(json => {\n        if (json.success) {\n          this.setCommentInfoEachMission(json.comments);\n        }\n      })\n      .catch(e => console.error(e));\n  };\n\n  /** Setting Methods */\n  setGameInfo = (myOcpInfo, callback) => {\n    // OCPGame 데이터를 보존하기 위해\n    const gameInfo = JSON.parse(JSON.stringify(OCPGame));\n    myOcpInfo.forEach(myOcp => {\n      const game = gameInfo[myOcp.type];\n      const mission = game.itemInfo[myOcp.grade];\n      mission[\"level\"] = myOcp.level;\n    });\n    this.setState(\n      {\n        gameInfo\n      },\n      () => {\n        this.getOCPCommentsByEmail();\n        if (callback) callback();\n      }\n    );\n  };\n\n  setCommentInfoEachMission = comments => {\n    const gameInfo = JSON.parse(JSON.stringify(this.state.gameInfo));\n    for (let i = 0; i < comments.length; i++) {\n      const comment = comments[i];\n      gameInfo[comment.type].itemInfo[comment.grade][\"isComment\"] = true;\n    }\n    this.setState({\n      gameInfo\n    });\n  };\n\n  getGuestInfo = () => {\n    return (\n      localStorage.getItem(\"ocpId\") && JSON.parse(localStorage.getItem(\"ocpId\"))\n    );\n  };\n\n  onClickTry = (gameKey, gradeKey) => {\n    if (!this.props.userinfo.email) {\n      showPopUp(\n        <PopUp.TwoButton\n          confirmAction={() => {\n            showPopUp(<SignIn />, {\n              darkmode: true,\n              dismissOverlay: true,\n              mobileFullScreen: true,\n              scrollable: true\n            });\n          }}\n          title=\"로그인 후 참여할 수 있습니다\"\n          confirmButtonName=\"로그인\"\n          cancelButtonName=\"취소\"\n        />,\n        {\n          darkmode: true,\n          dismissOverlay: true,\n          mobileFullScreen: true,\n          scrollable: true\n        }\n      );\n      return;\n    }\n    window.open(`/codingparty?type=${gameKey}&grade=${gradeKey}`);\n  };\n\n  render() {\n    const { gameInfo } = this.state;\n    return <View onClickTry={this.onClickTry} gameInfo={gameInfo} />;\n  }\n}\nexport default connect(\n  state => ({\n    userinfo: state.userinfo\n  }),\n  {}\n)(Container);\n"]},"metadata":{},"sourceType":"module"}