{"ast":null,"code":"import _regeneratorRuntime from \"/Users/jimmy/Documents/Wizschool/wizlab_web2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/jimmy/Documents/Wizschool/wizlab_web2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _slicedToArray from \"/Users/jimmy/Documents/Wizschool/wizlab_web2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nimport _objectWithoutProperties from \"/Users/jimmy/Documents/Wizschool/wizlab_web2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties\";\nimport _taggedTemplateLiteral from \"/Users/jimmy/Documents/Wizschool/wizlab_web2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";\n\nvar _templateObject,\n    _templateObject2,\n    _templateObject3,\n    _templateObject4,\n    _templateObject5,\n    _this = this,\n    _jsxFileName = \"/Users/jimmy/Documents/Wizschool/wizlab_web2/src/Page/CourseDetail/Components/CommentItem.js\";\n\nimport React, { useCallback, useEffect, useState } from \"react\";\nimport { connect } from \"react-redux\";\nimport styled from \"@emotion/styled\";\nimport CommentChildItem from \"./CommentChildItem\";\nimport CommentDetail from \"./CommentDetail\";\nimport CommentMore from \"./CommentMore\";\nimport CommentWrite from \"./CommentWrite\";\nimport { deleteComment, postComment\n/*putComment,*/\n, reportComment, getCommentsOnComment } from \"../api\";\nimport { Comment } from \"../../../models\";\nvar Self = styled.div(_templateObject || (_templateObject = _taggedTemplateLiteral([\"\\n  margin: 0 auto;\\n\\n  @media screen and (max-width:1169px) {\\n    width: 88.33%;\\n  }\\n\"])));\nvar Image = styled.div(_templateObject2 || (_templateObject2 = _taggedTemplateLiteral([\"\\n  width: 45px;\\n  height: 45px;\\n  margin-right: 15px;\\n  border-radius: 50%;\\n  background-image: url(\", \");\\n  background-size: cover;\\n  background-repeat: no-repeat;\\n  background-position: center;\\n\"])), function (props) {\n  return props.image;\n});\nvar Comments = styled.div(_templateObject3 || (_templateObject3 = _taggedTemplateLiteral([\"\"])));\nvar StyledComment = styled.div(_templateObject4 || (_templateObject4 = _taggedTemplateLiteral([\"\\n  display: flex;\\n  align-items: flex-start;\\n  padding-top: 16px;\\n  position: relative;\\n\\n  @media screen and (max-width : 1169px) {\\n    padding-top: 0;\\n    padding-bottom: 16px;\\n  }\\n\"])));\nvar CommentBody = styled.div(_templateObject5 || (_templateObject5 = _taggedTemplateLiteral([\"\\n  flex: 1;\\n\"])));\n\nvar CommentItem = function CommentItem(_ref) {\n  var lectureId = _ref.lectureId,\n      item = _ref.item,\n      onAfterSubmit = _ref.onAfterSubmit,\n      currentIdOnComment = _ref.currentIdOnComment,\n      currentIdOnMore = _ref.currentIdOnMore,\n      handleChangeComment = _ref.handleChangeComment,\n      handleChangeMore = _ref.handleChangeMore,\n      onAppearCommentWrite = _ref.onAppearCommentWrite,\n      onDisappearCommentWrite = _ref.onDisappearCommentWrite,\n      props = _objectWithoutProperties(_ref, [\"lectureId\", \"item\", \"onAfterSubmit\", \"currentIdOnComment\", \"currentIdOnMore\", \"handleChangeComment\", \"handleChangeMore\", \"onAppearCommentWrite\", \"onDisappearCommentWrite\"]);\n\n  var _useState = useState(false),\n      _useState2 = _slicedToArray(_useState, 2),\n      writeMode = _useState2[0],\n      setWriteMode = _useState2[1];\n\n  var _useState3 = useState([]),\n      _useState4 = _slicedToArray(_useState3, 2),\n      comments = _useState4[0],\n      setComments = _useState4[1];\n\n  useEffect(function () {\n    fetchCommentsOnComment();\n  }, []);\n  useEffect(function () {\n    if (currentIdOnComment !== item.id) {\n      setWriteMode(false);\n    }\n  }, [currentIdOnComment]);\n  var fetchCommentsOnComment = useCallback(function () {\n    getCommentsOnComment({\n      commentId: item.id\n    }).then(function (_ref2) {\n      var count = _ref2.count,\n          rows = _ref2.rows;\n      setComments(rows.map(function (c) {\n        return new Comment(c);\n      }));\n    });\n  }, [getCommentsOnComment, setComments]);\n  var showWriteComponent = useCallback(function () {\n    setWriteMode(true);\n    handleChangeComment(item.id);\n  }, []);\n  var hideWriteComponent = useCallback(function () {\n    setWriteMode(false);\n  }, []);\n  var handleCreateComment = useCallback( /*#__PURE__*/function () {\n    var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(text) {\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.prev = 0;\n              _context.next = 3;\n              return postComment({\n                email: props.email,\n                lectureId: lectureId,\n                message: text,\n                parentCommentId: item.id\n              });\n\n            case 3:\n              onAfterSubmit();\n              fetchCommentsOnComment();\n              _context.next = 10;\n              break;\n\n            case 7:\n              _context.prev = 7;\n              _context.t0 = _context[\"catch\"](0);\n              window.alert(_context.t0.message);\n\n            case 10:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[0, 7]]);\n    }));\n\n    return function (_x) {\n      return _ref3.apply(this, arguments);\n    };\n  }(), [postComment]);\n  var handleEditComment = useCallback( /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n    return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, _callee2);\n  })));\n  var handleDeleteComment = useCallback( /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3() {\n    return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n      while (1) {\n        switch (_context3.prev = _context3.next) {\n          case 0:\n            _context3.prev = 0;\n            _context3.next = 3;\n            return deleteComment({\n              commentId: item.id\n            });\n\n          case 3:\n            onAfterSubmit();\n            fetchCommentsOnComment();\n            _context3.next = 10;\n            break;\n\n          case 7:\n            _context3.prev = 7;\n            _context3.t0 = _context3[\"catch\"](0);\n            window.alert(_context3.t0.message);\n\n          case 10:\n          case \"end\":\n            return _context3.stop();\n        }\n      }\n    }, _callee3, null, [[0, 7]]);\n  })), [deleteComment]);\n  var handleReportComment = useCallback( /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee4() {\n    return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n      while (1) {\n        switch (_context4.prev = _context4.next) {\n          case 0:\n            _context4.prev = 0;\n            _context4.next = 3;\n            return reportComment({\n              commentId: item.id,\n              email: props.email\n            });\n\n          case 3:\n            onAfterSubmit();\n            fetchCommentsOnComment();\n            _context4.next = 10;\n            break;\n\n          case 7:\n            _context4.prev = 7;\n            _context4.t0 = _context4[\"catch\"](0);\n            window.alert(_context4.t0.message);\n\n          case 10:\n          case \"end\":\n            return _context4.stop();\n        }\n      }\n    }, _callee4, null, [[0, 7]]);\n  })), [reportComment]);\n  var onAfterSubmitOnChild = useCallback(function () {\n    onAfterSubmit();\n    fetchCommentsOnComment();\n  }, []);\n  return /*#__PURE__*/React.createElement(Self, Object.assign({}, props, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 156,\n      columnNumber: 5\n    }\n  }), /*#__PURE__*/React.createElement(StyledComment, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 157,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(Image, {\n    image: item.user.icon,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 158,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(CommentBody, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 159,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(CommentDetail, {\n    item: item,\n    showWriteComponent: showWriteComponent,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 160,\n      columnNumber: 11\n    }\n  }), /*#__PURE__*/React.createElement(CommentWrite, {\n    commentId: item.id,\n    isChild: true,\n    onSubmit: handleCreateComment,\n    writeMode: writeMode,\n    hideCommentWrite: hideWriteComponent,\n    onAppear: onAppearCommentWrite,\n    onDisappear: onDisappearCommentWrite,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 161,\n      columnNumber: 11\n    }\n  }), /*#__PURE__*/React.createElement(Comments, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 170,\n      columnNumber: 11\n    }\n  }, comments.map(function (reply) {\n    return /*#__PURE__*/React.createElement(CommentChildItem, {\n      key: reply.id,\n      lectureId: lectureId,\n      parents: item,\n      item: reply,\n      onAfterSubmit: onAfterSubmitOnChild,\n      currentIdOnComment: currentIdOnComment,\n      currentIdOnMore: currentIdOnMore,\n      handleChangeComment: handleChangeComment,\n      handleChangeMore: handleChangeMore,\n      onAppearCommentWrite: onAppearCommentWrite,\n      onDisappearCommentWrite: onDisappearCommentWrite,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 172,\n        columnNumber: 15\n      }\n    });\n  }))), /*#__PURE__*/React.createElement(CommentMore, {\n    item: item,\n    editComment: handleEditComment,\n    deleteComment: handleDeleteComment,\n    reportComment: handleReportComment,\n    currentIdOnMore: currentIdOnMore,\n    handleChangeMore: handleChangeMore,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 188,\n      columnNumber: 9\n    }\n  })));\n};\n\nexport default connect(function (state) {\n  return {\n    email: state.userinfo.email\n  };\n}, {})(CommentItem);","map":{"version":3,"sources":["/Users/jimmy/Documents/Wizschool/wizlab_web2/src/Page/CourseDetail/Components/CommentItem.js"],"names":["React","useCallback","useEffect","useState","connect","styled","CommentChildItem","CommentDetail","CommentMore","CommentWrite","deleteComment","postComment","reportComment","getCommentsOnComment","Comment","Self","div","Image","props","image","Comments","StyledComment","CommentBody","CommentItem","lectureId","item","onAfterSubmit","currentIdOnComment","currentIdOnMore","handleChangeComment","handleChangeMore","onAppearCommentWrite","onDisappearCommentWrite","writeMode","setWriteMode","comments","setComments","fetchCommentsOnComment","id","commentId","then","count","rows","map","c","showWriteComponent","hideWriteComponent","handleCreateComment","text","email","message","parentCommentId","window","alert","handleEditComment","handleDeleteComment","handleReportComment","onAfterSubmitOnChild","user","icon","reply","state","userinfo"],"mappings":"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","sourcesContent":["import React, { useCallback, useEffect, useState } from \"react\";\nimport { connect } from \"react-redux\";\nimport styled from \"@emotion/styled\";\n\nimport CommentChildItem from \"./CommentChildItem\";\nimport CommentDetail from \"./CommentDetail\";\nimport CommentMore from \"./CommentMore\";\nimport CommentWrite from \"./CommentWrite\";\nimport { deleteComment, postComment, /*putComment,*/ reportComment, getCommentsOnComment } from \"../api\";\nimport { Comment } from \"../../../models\";\n\nconst Self = styled.div`\n  margin: 0 auto;\n\n  @media screen and (max-width:1169px) {\n    width: 88.33%;\n  }\n`;\n\nconst Image = styled.div`\n  width: 45px;\n  height: 45px;\n  margin-right: 15px;\n  border-radius: 50%;\n  background-image: url(${(props) => props.image});\n  background-size: cover;\n  background-repeat: no-repeat;\n  background-position: center;\n`;\n\nconst Comments = styled.div``;\n\nconst StyledComment = styled.div`\n  display: flex;\n  align-items: flex-start;\n  padding-top: 16px;\n  position: relative;\n\n  @media screen and (max-width : 1169px) {\n    padding-top: 0;\n    padding-bottom: 16px;\n  }\n`;\n\nconst CommentBody = styled.div`\n  flex: 1;\n`;\n\nconst CommentItem = ({\n  lectureId,\n  item,\n  onAfterSubmit,\n  currentIdOnComment,\n  currentIdOnMore,\n  handleChangeComment,\n  handleChangeMore,\n  onAppearCommentWrite,\n  onDisappearCommentWrite,\n  ...props\n}) => {\n  const [writeMode, setWriteMode] = useState(false);\n  const [comments, setComments] = useState([]);\n\n  useEffect(\n    () => {\n      fetchCommentsOnComment();\n    },\n    []\n  );\n\n  useEffect(\n    () => {\n      if (currentIdOnComment !== item.id) {\n        setWriteMode(false);\n      }\n    },\n    [currentIdOnComment]\n  );\n\n  const fetchCommentsOnComment = useCallback(\n    () => {\n      getCommentsOnComment({ commentId: item.id }).then(({ count, rows }) => {\n        setComments(rows.map((c) => new Comment(c)));\n      });\n    },\n    [getCommentsOnComment, setComments]\n  );\n\n  const showWriteComponent = useCallback(() => {\n    setWriteMode(true);\n    handleChangeComment(item.id);\n  }, []);\n\n  const hideWriteComponent = useCallback(() => {\n    setWriteMode(false);\n  }, []);\n\n  const handleCreateComment = useCallback(\n    async (text) => {\n      try {\n        await postComment({\n          email: props.email,\n          lectureId,\n          message: text,\n          parentCommentId: item.id,\n        });\n\n        onAfterSubmit();\n        fetchCommentsOnComment();\n      } catch (e) {\n        window.alert(e.message);\n      }\n    },\n    [postComment]\n  );\n\n  const handleEditComment = useCallback(async () => {\n    // await putComment();\n  });\n\n  const handleDeleteComment = useCallback(\n    async () => {\n      try {\n        await deleteComment({ commentId: item.id });\n        onAfterSubmit();\n        fetchCommentsOnComment();\n      } catch (e) {\n        window.alert(e.message);\n      }\n    },\n    [deleteComment]\n  );\n\n  const handleReportComment = useCallback(\n    async () => {\n      try {\n        await reportComment({\n          commentId: item.id,\n          email: props.email,\n        });\n        onAfterSubmit();\n        fetchCommentsOnComment();\n      } catch (e) {\n        window.alert(e.message);\n      }\n    },\n    [reportComment]\n  );\n\n  const onAfterSubmitOnChild = useCallback(() => {\n    onAfterSubmit();\n    fetchCommentsOnComment();\n  }, []);\n\n  return (\n    <Self {...props}>\n      <StyledComment>\n        <Image image={item.user.icon} />\n        <CommentBody>\n          <CommentDetail item={item} showWriteComponent={showWriteComponent} />\n          <CommentWrite\n            commentId={item.id}\n            isChild={true}\n            onSubmit={handleCreateComment}\n            writeMode={writeMode}\n            hideCommentWrite={hideWriteComponent}\n            onAppear={onAppearCommentWrite}\n            onDisappear={onDisappearCommentWrite}\n          />\n          <Comments>\n            {comments.map((reply) => (\n              <CommentChildItem\n                key={reply.id}\n                lectureId={lectureId}\n                parents={item}\n                item={reply}\n                onAfterSubmit={onAfterSubmitOnChild}\n                currentIdOnComment={currentIdOnComment}\n                currentIdOnMore={currentIdOnMore}\n                handleChangeComment={handleChangeComment}\n                handleChangeMore={handleChangeMore}\n                onAppearCommentWrite={onAppearCommentWrite}\n                onDisappearCommentWrite={onDisappearCommentWrite}\n              />\n            ))}\n          </Comments>\n        </CommentBody>\n        <CommentMore\n          item={item}\n          editComment={handleEditComment}\n          deleteComment={handleDeleteComment}\n          reportComment={handleReportComment}\n          currentIdOnMore={currentIdOnMore}\n          handleChangeMore={handleChangeMore}\n        />\n      </StyledComment>\n    </Self>\n  );\n};\n\nexport default connect(\n  (state) => ({\n    email: state.userinfo.email,\n  }),\n  {}\n)(CommentItem);\n"]},"metadata":{},"sourceType":"module"}