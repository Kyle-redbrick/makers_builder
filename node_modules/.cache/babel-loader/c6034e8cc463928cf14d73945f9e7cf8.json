{"ast":null,"code":"import _regeneratorRuntime from \"/Users/jimmy/Documents/Wizschool/astroboy/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/jimmy/Documents/Wizschool/astroboy/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"/Users/jimmy/Documents/Wizschool/astroboy/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/jimmy/Documents/Wizschool/astroboy/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _inherits from \"/Users/jimmy/Documents/Wizschool/astroboy/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _possibleConstructorReturn from \"/Users/jimmy/Documents/Wizschool/astroboy/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/jimmy/Documents/Wizschool/astroboy/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nvar _jsxFileName = \"/Users/jimmy/Documents/Wizschool/astroboy/src/Page/Builder/Component/Home/Component/NewProjectPopup/Container.js\";\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\n\nimport React, { Component } from \"react\";\nimport { injectIntl } from \"react-intl\";\nimport View from \"./View\";\nimport generatePID from \"../../../../../../Common/Util/PIDGenerator\";\nimport * as request from \"../../../../../../Common/Util/HTTPRequest\";\nimport { PAGETYPE } from \"../../../../../../Common/Util/Constant\";\n\nvar Container = /*#__PURE__*/function (_Component) {\n  _inherits(Container, _Component);\n\n  var _super = _createSuper(Container);\n\n  function Container(props) {\n    var _this;\n\n    _classCallCheck(this, Container);\n\n    _this = _super.call(this, props);\n\n    _this.componentDidMount = function () {\n      _this.setState({\n        projectName: _this.props.intl.formatMessage({\n          id: \"ID_TIP_LAYOUT_NEW_PROJECT_FORMAT\"\n        }, {\n          randomChar: String.fromCharCode(Math.floor(Math.random() * Math.floor(48)) + 48)\n        })\n      });\n    };\n\n    _this.onChangeProjectName = function (e) {\n      _this.setState({\n        projectName: e.target.value\n      });\n    };\n\n    _this.onClickEditorFormat = function (type) {\n      _this.setState({\n        editorFormat: type\n      });\n    };\n\n    _this.onClickMake2DProject = function () {\n      _this.createNewProject();\n    };\n\n    _this.createNewProject = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      var type, res, template, emptyTemplate, pageURL;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              type = _this.props.gameDimension === \"3D\" ? \"js3d\" : _this.state.editorFormat === \"text\" ? \"js\" : \"wizlabOOBC\";\n              _context.next = 3;\n              return request.getTemplateProjectsByType({\n                type: type\n              });\n\n            case 3:\n              res = _context.sent;\n              _context.next = 6;\n              return res.json();\n\n            case 6:\n              template = _context.sent;\n\n              if (template) {\n                _context.next = 9;\n                break;\n              }\n\n              return _context.abrupt(\"return\");\n\n            case 9:\n              emptyTemplate = template.filter(function (item) {\n                return item.description === \"empty\";\n              })[0];\n\n              if (emptyTemplate) {\n                _context.next = 12;\n                break;\n              }\n\n              return _context.abrupt(\"return\");\n\n            case 12:\n              if (_this.props.email) {\n                _this.createNewProjectFromServer(emptyTemplate.id);\n              } else {\n                pageURL = \"/\".concat(_this.props.gameDimension === \"3D\" ? PAGETYPE.BUILDER3D : PAGETYPE.BUILDER, \"?t=\").concat(emptyTemplate.id);\n                window.history.replaceState({}, \"\", pageURL);\n                window.location.reload();\n              }\n\n            case 13:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    _this.createNewProjectFromServer = /*#__PURE__*/function () {\n      var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(templateId) {\n        var projectName, params, response, project, pageURL;\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                projectName = _this.state.projectName;\n                params = {\n                  pId: generatePID(_this.props.email),\n                  email: _this.props.email,\n                  name: projectName,\n                  templateId: templateId\n                };\n                _context2.prev = 2;\n                _context2.next = 5;\n                return request.postDevelopingProject(params);\n\n              case 5:\n                response = _context2.sent;\n                _context2.next = 8;\n                return response.json();\n\n              case 8:\n                project = _context2.sent;\n\n                if (project) {\n                  pageURL = \"/\".concat(_this.props.gameDimension === \"3D\" ? PAGETYPE.BUILDER3D : PAGETYPE.BUILDER, \"/\").concat(project.pId);\n                  window.history.replaceState({}, \"\", pageURL);\n                  window.location.reload();\n                }\n\n                _context2.next = 15;\n                break;\n\n              case 12:\n                _context2.prev = 12;\n                _context2.t0 = _context2[\"catch\"](2);\n                console.error(_context2.t0);\n\n              case 15:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, null, [[2, 12]]);\n      }));\n\n      return function (_x) {\n        return _ref2.apply(this, arguments);\n      };\n    }();\n\n    _this.state = {\n      editorFormat: \"text\",\n      projectName: \"\"\n    };\n    return _this;\n  }\n\n  _createClass(Container, [{\n    key: \"render\",\n    value: function render() {\n      var _this$state = this.state,\n          editorFormat = _this$state.editorFormat,\n          projectName = _this$state.projectName;\n      var onChangeProjectName = this.onChangeProjectName,\n          onClickEditorFormat = this.onClickEditorFormat,\n          onClickMake2DProject = this.onClickMake2DProject;\n      var gameDimension = this.props.gameDimension;\n      return React.createElement(View, {\n        editorFormat: editorFormat,\n        projectName: projectName,\n        onChangeProjectName: onChangeProjectName,\n        onClickEditorFormat: onClickEditorFormat,\n        onClickMake2DProject: onClickMake2DProject,\n        gameDimension: gameDimension,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 102\n        },\n        __self: this\n      });\n    }\n  }]);\n\n  return Container;\n}(Component);\n\nexport default injectIntl(Container);","map":{"version":3,"sources":["/Users/jimmy/Documents/Wizschool/astroboy/src/Page/Builder/Component/Home/Component/NewProjectPopup/Container.js"],"names":["React","Component","injectIntl","View","generatePID","request","PAGETYPE","Container","props","componentDidMount","setState","projectName","intl","formatMessage","id","randomChar","String","fromCharCode","Math","floor","random","onChangeProjectName","e","target","value","onClickEditorFormat","type","editorFormat","onClickMake2DProject","createNewProject","gameDimension","state","getTemplateProjectsByType","res","json","template","emptyTemplate","filter","item","description","email","createNewProjectFromServer","pageURL","BUILDER3D","BUILDER","window","history","replaceState","location","reload","templateId","params","pId","name","postDevelopingProject","response","project","console","error"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport { injectIntl } from \"react-intl\";\nimport View from \"./View\";\nimport generatePID from \"../../../../../../Common/Util/PIDGenerator\";\nimport * as request from \"../../../../../../Common/Util/HTTPRequest\";\nimport { PAGETYPE } from \"../../../../../../Common/Util/Constant\";\n\nclass Container extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      editorFormat: \"text\",\n      projectName: \"\"\n    };\n  }\n  componentDidMount = () => {\n    this.setState({\n      projectName: this.props.intl.formatMessage(\n        { id: \"ID_TIP_LAYOUT_NEW_PROJECT_FORMAT\" },\n        {\n          randomChar: String.fromCharCode(\n            Math.floor(Math.random() * Math.floor(48)) + 48\n          )\n        }\n      )\n    });\n  };\n  onChangeProjectName = e => {\n    this.setState({ projectName: e.target.value });\n  };\n\n  onClickEditorFormat = type => {\n    this.setState({ editorFormat: type });\n  };\n  onClickMake2DProject = () => {\n    this.createNewProject();\n  };\n\n  createNewProject = async () => {\n    let type =\n      this.props.gameDimension === \"3D\"\n        ? \"js3d\"\n        : this.state.editorFormat === \"text\"\n        ? \"js\"\n        : \"wizlabOOBC\";\n\n    let res = await request.getTemplateProjectsByType({ type });\n    let template = await res.json();\n    if (!template) return;\n    let emptyTemplate = template.filter(\n      item => item.description === \"empty\"\n    )[0];\n    if (!emptyTemplate) return;\n    if (this.props.email) {\n      this.createNewProjectFromServer(emptyTemplate.id);\n    } else {\n      let pageURL = `/${\n        this.props.gameDimension === \"3D\"\n          ? PAGETYPE.BUILDER3D\n          : PAGETYPE.BUILDER\n      }?t=${emptyTemplate.id}`;\n      window.history.replaceState({}, \"\", pageURL);\n      window.location.reload();\n    }\n  };\n\n  createNewProjectFromServer = async templateId => {\n    const { projectName } = this.state;\n    let params = {\n      pId: generatePID(this.props.email),\n      email: this.props.email,\n      name: projectName,\n      templateId\n    };\n    try {\n      const response = await request.postDevelopingProject(params);\n      const project = await response.json();\n      if (project) {\n        let pageURL = `/${\n          this.props.gameDimension === \"3D\"\n            ? PAGETYPE.BUILDER3D\n            : PAGETYPE.BUILDER\n        }/${project.pId}`;\n\n        window.history.replaceState({}, \"\", pageURL);\n        window.location.reload();\n      }\n    } catch (e) {\n      console.error(e);\n    }\n  };\n\n  render() {\n    const { editorFormat, projectName } = this.state;\n    const {\n      onChangeProjectName,\n      onClickEditorFormat,\n      onClickMake2DProject\n    } = this;\n    const { gameDimension } = this.props;\n    return (\n      <View\n        editorFormat={editorFormat}\n        projectName={projectName}\n        onChangeProjectName={onChangeProjectName}\n        onClickEditorFormat={onClickEditorFormat}\n        onClickMake2DProject={onClickMake2DProject}\n        gameDimension={gameDimension}\n      />\n    );\n  }\n}\nexport default injectIntl(Container);\n"]},"metadata":{},"sourceType":"module"}