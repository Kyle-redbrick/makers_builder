{"ast":null,"code":"import _toConsumableArray from \"/Users/jimmy/Documents/Wizschool/wizlab_web2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _classCallCheck from \"/Users/jimmy/Documents/Wizschool/wizlab_web2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/jimmy/Documents/Wizschool/wizlab_web2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _assertThisInitialized from \"/Users/jimmy/Documents/Wizschool/wizlab_web2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";\nimport _inherits from \"/Users/jimmy/Documents/Wizschool/wizlab_web2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _possibleConstructorReturn from \"/Users/jimmy/Documents/Wizschool/wizlab_web2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/jimmy/Documents/Wizschool/wizlab_web2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nvar _jsxFileName = \"/Users/jimmy/Documents/Wizschool/wizlab_web2/src/Page/Builder/Component/SpriteBox/Container.js\";\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\n\nimport React, { Component } from \"react\";\nimport { connect } from \"react-redux\";\nimport * as sceneActions from \"../../Store/Reducer/scene\";\nimport * as webrtcActions from \"../../Store/Reducer/webrtc\";\nimport AssetLibrary from \"../../utils/assetLibrary\";\nimport ComponentTemplate from \"../../utils/ComponentTemplate\";\nimport DrawingEditor from \"./Component/DrawingEditor\";\nimport TextEditor from \"./Component/TextEditor\";\nimport CustomSprite from \"./Component/CustomSprite\";\nimport { showPopUp } from \"../../../../Common/Component/PopUp\";\nimport store from \"../../Store\";\nimport RndWrapper from \"../../utils/RndWrapper\";\nimport View from \"./View\";\n\nvar Container = /*#__PURE__*/function (_Component) {\n  _inherits(Container, _Component);\n\n  var _super = _createSuper(Container);\n\n  function Container(props) {\n    var _this;\n\n    _classCallCheck(this, Container);\n\n    _this = _super.call(this, props);\n\n    _this.setDefaultLayout = function () {// const width = 500;\n      // const height = 450;\n      // const minWidth = width;\n      // const minHeight = height;\n      // const x = document.body.clientWidth - width - 300;\n      // const y = document.body.clientHeight - height - height;\n      // this.setState({ width, height, minHeight, minWidth, x, y });\n    };\n\n    _this.setCurrentCategory = function (category, subcate) {\n      if (!subcate) subcate = category;\n\n      _this.props.setLog({\n        selectedSprite: category === subcate ? \"\".concat(category, \"(\\uC804\\uCCB4)\") : \"\".concat(category, \"(\").concat(subcate, \")\")\n      });\n\n      _this.setState({\n        assets: [],\n        currentCategory: category,\n        currentSubCategory: subcate\n      }, function () {\n        _this.loadAssets(subcate);\n      });\n    };\n\n    _this.loadAssets = function (subcate) {\n      if (subcate) {\n        AssetLibrary.loadAssetsByCategory(subcate, function (assets) {\n          _this.setState({\n            assets: assets\n          });\n        });\n      }\n    };\n\n    _this.countUpSameName = function (defaultName, nameArray) {\n      var max = nameArray.reduce(function (max, id) {\n        var name = id.replace(/\\(\\d+\\)$/, \"\");\n        var num;\n\n        if (defaultName === name) {\n          num = id.replace(defaultName, \"\").replace(/\\(|\\)/g, \"\");\n          num = !!num ? Number(num) : 1;\n          return Math.max(max, num);\n        } else {\n          return max;\n        }\n      }, 0);\n\n      if (max > 0) {\n        return \"\".concat(defaultName, \"(\").concat(max + 1, \")\");\n      } else {\n        return defaultName;\n      }\n    };\n\n    _this.setSpriteInfo = function (item) {\n      var type = AssetLibrary.getAsset(item.assetId).type;\n      var assetId = item.assetId;\n      var asset = AssetLibrary.getAsset(assetId);\n      var defaultName = asset.defaultName;\n      var name = defaultName;\n      var subtype = AssetLibrary.getAsset(item.assetId).subtype;\n      /** templateCode depend on asset.subtype */\n      // 스프라이트 박스의 컴포넌트 탭의\n      // 스프라이트들의 subtype에 의존해서 템플릿 코드를 넣어주고 있다.\n\n      var templateCode;\n\n      if (asset.type === \"component\") {\n        templateCode = ComponentTemplate[asset.subtype];\n      }\n\n      var code = templateCode ? templateCode : \"\";\n      return {\n        name: name,\n        assetId: assetId,\n        type: type,\n        code: code,\n        subtype: subtype\n      };\n    };\n\n    _this.reduceBasket = function (assets) {\n      return assets.reduce(function (acc, cur) {\n        if (cur.subtype === \"camera\") {\n          var checkCamera = false;\n\n          for (var i = 0; i < _this.props.spriteIds.length; i++) {\n            if (_this.props.sprites[_this.props.spriteIds[i]].preview.subtype === \"camera\") {\n              checkCamera = true;\n              break;\n            }\n          }\n\n          if (!checkCamera) {\n            acc.spriteInfos.push(_this.setSpriteInfo(cur));\n          }\n        } else if (cur.subtype === \"joystick\") {\n          acc.spriteInfos.push(_this.setSpriteInfo(cur));\n        } else {\n          acc.spriteInfos.push(_this.setSpriteInfo(cur));\n        }\n\n        return acc;\n      }, {\n        spriteInfos: [],\n        soundInfos: []\n      });\n    };\n\n    _this.checkSameNames = function (infos) {\n      var makeDefaultName = function makeDefaultName(assetId) {\n        return assetId.replace(/_v\\d+$/, \"\");\n      };\n\n      var newSpriteIds = _toConsumableArray(_this.props.spriteIds);\n\n      return infos.map(function (info) {\n        var defaultName = makeDefaultName(info.assetId);\n\n        var name = _this.countUpSameName(defaultName, newSpriteIds);\n\n        newSpriteIds.push(name);\n        info.name = name;\n        return info;\n      });\n    };\n\n    _this.handleSelectAsset = function (assetId) {\n      _this.setState({\n        selectedAssetId: assetId\n      });\n    };\n\n    _this.handleAddAsset = function (asset) {\n      _this.setState({\n        selectedAssetId: undefined\n      }, function () {\n        var selectedSceneId = _this.props.selectedSceneId;\n        var assetId = asset.assetId,\n            type = asset.type,\n            subtype = asset.subtype,\n            spriteAnimations = asset.spriteAnimations;\n\n        var _this$reduceBasket = _this.reduceBasket([{\n          assetId: assetId,\n          type: type,\n          subtype: subtype,\n          spriteAnimations: spriteAnimations\n        }]),\n            spriteInfos = _this$reduceBasket.spriteInfos;\n\n        if (spriteInfos.length !== 0) {\n          spriteInfos = _this.checkSameNames(spriteInfos);\n\n          _this.props.addSprites(selectedSceneId, spriteInfos);\n        }\n      });\n    };\n\n    _this.handleOpenDrawing = function () {\n      showPopUp( /*#__PURE__*/React.createElement(DrawingEditor, {\n        AssetLibrary: AssetLibrary,\n        countUpSameName: _this.countUpSameName,\n        __self: _assertThisInitialized(_this),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 178,\n          columnNumber: 7\n        }\n      }), {\n        store: store,\n        defaultPadding: false,\n        dismissOverlay: false,\n        dismissButton: false\n      });\n    };\n\n    _this.handleOpenTextbox = function () {\n      showPopUp( /*#__PURE__*/React.createElement(TextEditor, {\n        countUpSameName: _this.countUpSameName,\n        __self: _assertThisInitialized(_this),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 192,\n          columnNumber: 15\n        }\n      }), {\n        store: store,\n        defaultPadding: false\n      });\n    };\n\n    _this.handleOpenCustomSprite = function () {\n      showPopUp( /*#__PURE__*/React.createElement(CustomSprite, {\n        countUpSameName: _this.countUpSameName,\n        __self: _assertThisInitialized(_this),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 200,\n          columnNumber: 7\n        }\n      }), {\n        store: store,\n        defaultPadding: false,\n        dismissOverlay: false,\n        dismissButton: false,\n        scrollable: true\n      });\n    };\n\n    _this.countUpSameName = function (defaultName) {\n      var nameArray = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : _this.props.spriteIds;\n      var max = nameArray.reduce(function (max, id) {\n        var name = id.replace(/\\(\\d+\\)$/, \"\");\n        var num;\n\n        if (defaultName === name) {\n          num = id.replace(defaultName, \"\").replace(/\\(|\\)/g, \"\");\n          num = !!num ? Number(num) : 1;\n          return Math.max(max, num);\n        } else {\n          return max;\n        }\n      }, 0);\n\n      if (max > 0) {\n        return \"\".concat(defaultName, \"(\").concat(max + 1, \")\");\n      } else {\n        return defaultName;\n      }\n    };\n\n    _this.handleOnChange = function (e) {\n      _this.setState({\n        inputValue: e.target.value\n      });\n    };\n\n    _this.handleShowAnimation = function (e, asset) {\n      var xPosition = e.clientX;\n      var yPosition = e.clientY;\n\n      _this.setState({\n        timeFunction: setInterval(function () {\n          _this.setState({\n            checkTime: _this.state.checkTime + 1\n          });\n\n          if (_this.state.checkTime > 2) return clearInterval(_this.state.timeFunction);\n\n          if (_this.state.checkTime === 2) {\n            _this.setState({\n              hoverAsset: asset.spriteAnimations ? asset : false\n            });\n\n            if (document.querySelector(\".SpriteBox_Animation\")) {\n              document.querySelector(\".SpriteBox_Animation\").style.left = xPosition - 320 + \"px\";\n              document.querySelector(\".SpriteBox_Animation\").style.top = yPosition - 150 + \"px\";\n            }\n          }\n        }, 1000)\n      });\n    };\n\n    _this.handleHideAnimation = function () {\n      clearInterval(_this.state.timeFunction);\n\n      _this.setState({\n        checkTime: 0 // hoverAsset: null\n\n      });\n    };\n\n    _this.handleAnimationHide = function () {\n      _this.setState({\n        hoverAsset: null\n      });\n    };\n\n    _this.state = {\n      isCategoryLoaded: false,\n      currentCategory: undefined,\n      currentSubCategory: undefined,\n      assets: [],\n      selectedAssetId: undefined,\n      inputValue: \"\",\n      hoverAsset: false,\n      checkTime: 0,\n      timeFunction: null\n    };\n    return _this;\n  }\n\n  _createClass(Container, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this2 = this;\n\n      // this.setDefaultLayout();\n      AssetLibrary.loadCategories(function () {\n        _this2.setState({\n          isCategoryLoaded: true,\n          currentCategory: AssetLibrary.categories[0].name,\n          currentSubCategory: AssetLibrary.categories[0].name\n        }, function () {\n          _this2.loadAssets(_this2.state.currentSubCategory);\n        });\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$state = this.state,\n          isCategoryLoaded = _this$state.isCategoryLoaded,\n          currentCategory = _this$state.currentCategory,\n          currentSubCategory = _this$state.currentSubCategory,\n          assets = _this$state.assets,\n          selectedAssetId = _this$state.selectedAssetId,\n          inputValue = _this$state.inputValue,\n          hoverAsset = _this$state.hoverAsset;\n      var setCurrentCategory = this.setCurrentCategory,\n          handleSelectAsset = this.handleSelectAsset,\n          handleAddAsset = this.handleAddAsset,\n          handleOpenDrawing = this.handleOpenDrawing,\n          handleOpenTextbox = this.handleOpenTextbox,\n          handleOpenCustomSprite = this.handleOpenCustomSprite,\n          handleOpenCustomSound = this.handleOpenCustomSound,\n          handleOnChange = this.handleOnChange,\n          handleShowAnimation = this.handleShowAnimation,\n          handleHideAnimation = this.handleHideAnimation,\n          handleAnimationHide = this.handleAnimationHide;\n      var _this$props = this.props,\n          handleSelectTab = _this$props.handleSelectTab,\n          handleChangeZIndex = _this$props.handleChangeZIndex,\n          zIndex = _this$props.zIndex,\n          isOn = _this$props.isOn,\n          email = _this$props.email;\n\n      if (!isCategoryLoaded || !isOn) {\n        return /*#__PURE__*/React.createElement(\"div\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 308,\n            columnNumber: 14\n          }\n        });\n      }\n\n      var filteredAssets = assets.filter(function (asset) {\n        return AssetLibrary.getAsset(asset.assetId).defaultName.includes(inputValue);\n      });\n      return /*#__PURE__*/React.createElement(RndWrapper, {\n        id: \"spriteBox\",\n        style: {\n          zIndex: zIndex\n        },\n        defaultWidth: 600,\n        defaultHeight: 450,\n        defaultX: 180,\n        defaultY: document.body.clientHeight - 550,\n        minWidth: 380,\n        minHeight: 260,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 316,\n          columnNumber: 7\n        }\n      }, /*#__PURE__*/React.createElement(View, {\n        currentCategory: currentCategory,\n        currentSubCategory: currentSubCategory,\n        assets: filteredAssets,\n        setCurrentCategory: setCurrentCategory,\n        selectedAssetId: selectedAssetId,\n        handleSelectAsset: handleSelectAsset,\n        handleAddAsset: handleAddAsset,\n        handleOpenDrawing: handleOpenDrawing,\n        handleOpenTextbox: handleOpenTextbox,\n        handleOpenCustomSprite: handleOpenCustomSprite,\n        handleOpenCustomSound: handleOpenCustomSound,\n        handleSelectTab: handleSelectTab,\n        handleChangeZIndex: handleChangeZIndex,\n        inputValue: inputValue,\n        handleOnChange: handleOnChange,\n        email: email,\n        handleShowAnimation: handleShowAnimation,\n        handleHideAnimation: handleHideAnimation,\n        handleAnimationHide: handleAnimationHide,\n        hoverAsset: hoverAsset,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 326,\n          columnNumber: 9\n        }\n      }));\n    }\n  }]);\n\n  return Container;\n}(Component);\n\nexport default connect(function (state) {\n  return {\n    email: state.userinfo.email,\n    selectedSceneId: state.interaction.selected.scene,\n    spriteIds: state.scene.scenes[state.interaction.selected.scene].spriteIds,\n    sprites: state.scene.scenes[state.interaction.selected.scene].sprites\n  };\n}, {\n  addSprites: sceneActions.addSprites,\n  setLog: webrtcActions.setLog\n})(Container);","map":{"version":3,"sources":["/Users/jimmy/Documents/Wizschool/wizlab_web2/src/Page/Builder/Component/SpriteBox/Container.js"],"names":["React","Component","connect","sceneActions","webrtcActions","AssetLibrary","ComponentTemplate","DrawingEditor","TextEditor","CustomSprite","showPopUp","store","RndWrapper","View","Container","props","setDefaultLayout","setCurrentCategory","category","subcate","setLog","selectedSprite","setState","assets","currentCategory","currentSubCategory","loadAssets","loadAssetsByCategory","countUpSameName","defaultName","nameArray","max","reduce","id","name","replace","num","Number","Math","setSpriteInfo","item","type","getAsset","assetId","asset","subtype","templateCode","code","reduceBasket","acc","cur","checkCamera","i","spriteIds","length","sprites","preview","spriteInfos","push","soundInfos","checkSameNames","infos","makeDefaultName","newSpriteIds","map","info","handleSelectAsset","selectedAssetId","handleAddAsset","undefined","selectedSceneId","spriteAnimations","addSprites","handleOpenDrawing","defaultPadding","dismissOverlay","dismissButton","handleOpenTextbox","handleOpenCustomSprite","scrollable","handleOnChange","e","inputValue","target","value","handleShowAnimation","xPosition","clientX","yPosition","clientY","timeFunction","setInterval","checkTime","state","clearInterval","hoverAsset","document","querySelector","style","left","top","handleHideAnimation","handleAnimationHide","isCategoryLoaded","loadCategories","categories","handleOpenCustomSound","handleSelectTab","handleChangeZIndex","zIndex","isOn","email","filteredAssets","filter","includes","body","clientHeight","userinfo","interaction","selected","scene","scenes"],"mappings":";;;;;;;;;;;;;AAAA,OAAOA,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC;AACA,SAASC,OAAT,QAAwB,aAAxB;AACA,OAAO,KAAKC,YAAZ,MAA8B,2BAA9B;AACA,OAAO,KAAKC,aAAZ,MAA+B,4BAA/B;AACA,OAAOC,YAAP,MAAyB,0BAAzB;AACA,OAAOC,iBAAP,MAA8B,+BAA9B;AACA,OAAOC,aAAP,MAA0B,2BAA1B;AACA,OAAOC,UAAP,MAAuB,wBAAvB;AACA,OAAOC,YAAP,MAAyB,0BAAzB;AACA,SAASC,SAAT,QAA0B,oCAA1B;AACA,OAAOC,KAAP,MAAkB,aAAlB;AACA,OAAOC,UAAP,MAAuB,wBAAvB;AACA,OAAOC,IAAP,MAAiB,QAAjB;;IAEMC,S;;;;;AACJ,qBAAYC,KAAZ,EAAmB;AAAA;;AAAA;;AACjB,8BAAMA,KAAN;;AADiB,UA+BnBC,gBA/BmB,GA+BA,YAAM,CACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACD,KAvCkB;;AAAA,UAyCnBC,kBAzCmB,GAyCE,UAACC,QAAD,EAAWC,OAAX,EAAuB;AAC1C,UAAI,CAACA,OAAL,EAAcA,OAAO,GAAGD,QAAV;;AACd,YAAKH,KAAL,CAAWK,MAAX,CAAkB;AAChBC,QAAAA,cAAc,EACZH,QAAQ,KAAKC,OAAb,aAA0BD,QAA1B,gCAA8CA,QAA9C,cAA0DC,OAA1D;AAFc,OAAlB;;AAIA,YAAKG,QAAL,CACE;AAAEC,QAAAA,MAAM,EAAE,EAAV;AAAcC,QAAAA,eAAe,EAAEN,QAA/B;AAAyCO,QAAAA,kBAAkB,EAAEN;AAA7D,OADF,EAEE,YAAM;AACJ,cAAKO,UAAL,CAAgBP,OAAhB;AACD,OAJH;AAMD,KArDkB;;AAAA,UAuDnBO,UAvDmB,GAuDN,UAAAP,OAAO,EAAI;AACtB,UAAIA,OAAJ,EAAa;AACXd,QAAAA,YAAY,CAACsB,oBAAb,CAAkCR,OAAlC,EAA2C,UAAAI,MAAM,EAAI;AACnD,gBAAKD,QAAL,CAAc;AAAEC,YAAAA,MAAM,EAANA;AAAF,WAAd;AACD,SAFD;AAGD;AACF,KA7DkB;;AAAA,UA+DnBK,eA/DmB,GA+DD,UAACC,WAAD,EAAcC,SAAd,EAA4B;AAC5C,UAAIC,GAAG,GAAGD,SAAS,CAACE,MAAV,CAAiB,UAACD,GAAD,EAAME,EAAN,EAAa;AACtC,YAAIC,IAAI,GAAGD,EAAE,CAACE,OAAH,CAAW,UAAX,EAAuB,EAAvB,CAAX;AACA,YAAIC,GAAJ;;AACA,YAAIP,WAAW,KAAKK,IAApB,EAA0B;AACxBE,UAAAA,GAAG,GAAGH,EAAE,CAACE,OAAH,CAAWN,WAAX,EAAwB,EAAxB,EAA4BM,OAA5B,CAAoC,QAApC,EAA8C,EAA9C,CAAN;AACAC,UAAAA,GAAG,GAAG,CAAC,CAACA,GAAF,GAAQC,MAAM,CAACD,GAAD,CAAd,GAAsB,CAA5B;AACA,iBAAOE,IAAI,CAACP,GAAL,CAASA,GAAT,EAAcK,GAAd,CAAP;AACD,SAJD,MAIO;AACL,iBAAOL,GAAP;AACD;AACF,OAVS,EAUP,CAVO,CAAV;;AAWA,UAAIA,GAAG,GAAG,CAAV,EAAa;AACX,yBAAUF,WAAV,cAAyBE,GAAG,GAAG,CAA/B;AACD,OAFD,MAEO;AACL,eAAOF,WAAP;AACD;AACF,KAhFkB;;AAAA,UAkFnBU,aAlFmB,GAkFH,UAAAC,IAAI,EAAI;AACtB,UAAMC,IAAI,GAAGpC,YAAY,CAACqC,QAAb,CAAsBF,IAAI,CAACG,OAA3B,EAAoCF,IAAjD;AACA,UAAME,OAAO,GAAGH,IAAI,CAACG,OAArB;AACA,UAAMC,KAAK,GAAGvC,YAAY,CAACqC,QAAb,CAAsBC,OAAtB,CAAd;AACA,UAAMd,WAAW,GAAGe,KAAK,CAACf,WAA1B;AACA,UAAMK,IAAI,GAAGL,WAAb;AACA,UAAMgB,OAAO,GAAGxC,YAAY,CAACqC,QAAb,CAAsBF,IAAI,CAACG,OAA3B,EAAoCE,OAApD;AAEA;AACA;AACA;;AACA,UAAIC,YAAJ;;AACA,UAAIF,KAAK,CAACH,IAAN,KAAe,WAAnB,EAAgC;AAC9BK,QAAAA,YAAY,GAAGxC,iBAAiB,CAACsC,KAAK,CAACC,OAAP,CAAhC;AACD;;AACD,UAAME,IAAI,GAAGD,YAAY,GAAGA,YAAH,GAAkB,EAA3C;AACA,aAAO;AAAEZ,QAAAA,IAAI,EAAJA,IAAF;AAAQS,QAAAA,OAAO,EAAPA,OAAR;AAAiBF,QAAAA,IAAI,EAAJA,IAAjB;AAAuBM,QAAAA,IAAI,EAAJA,IAAvB;AAA6BF,QAAAA,OAAO,EAAPA;AAA7B,OAAP;AACD,KAnGkB;;AAAA,UAqGnBG,YArGmB,GAqGJ,UAAAzB,MAAM,EAAI;AACvB,aAAOA,MAAM,CAACS,MAAP,CACL,UAACiB,GAAD,EAAMC,GAAN,EAAc;AACZ,YAAIA,GAAG,CAACL,OAAJ,KAAgB,QAApB,EAA8B;AAC5B,cAAIM,WAAW,GAAG,KAAlB;;AACA,eAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,MAAKrC,KAAL,CAAWsC,SAAX,CAAqBC,MAAzC,EAAiDF,CAAC,EAAlD,EAAsD;AACpD,gBACE,MAAKrC,KAAL,CAAWwC,OAAX,CAAmB,MAAKxC,KAAL,CAAWsC,SAAX,CAAqBD,CAArB,CAAnB,EAA4CI,OAA5C,CAAoDX,OAApD,KACA,QAFF,EAGE;AACAM,cAAAA,WAAW,GAAG,IAAd;AACA;AACD;AACF;;AACD,cAAI,CAACA,WAAL,EAAkB;AAChBF,YAAAA,GAAG,CAACQ,WAAJ,CAAgBC,IAAhB,CAAqB,MAAKnB,aAAL,CAAmBW,GAAnB,CAArB;AACD;AACF,SAdD,MAcO,IAAIA,GAAG,CAACL,OAAJ,KAAgB,UAApB,EAAgC;AACrCI,UAAAA,GAAG,CAACQ,WAAJ,CAAgBC,IAAhB,CAAqB,MAAKnB,aAAL,CAAmBW,GAAnB,CAArB;AACD,SAFM,MAEA;AACLD,UAAAA,GAAG,CAACQ,WAAJ,CAAgBC,IAAhB,CAAqB,MAAKnB,aAAL,CAAmBW,GAAnB,CAArB;AACD;;AAED,eAAOD,GAAP;AACD,OAvBI,EAwBL;AAAEQ,QAAAA,WAAW,EAAE,EAAf;AAAmBE,QAAAA,UAAU,EAAE;AAA/B,OAxBK,CAAP;AA0BD,KAhIkB;;AAAA,UAkInBC,cAlImB,GAkIF,UAAAC,KAAK,EAAI;AACxB,UAAMC,eAAe,GAAG,SAAlBA,eAAkB,CAAAnB,OAAO;AAAA,eAAIA,OAAO,CAACR,OAAR,CAAgB,QAAhB,EAA0B,EAA1B,CAAJ;AAAA,OAA/B;;AACA,UAAM4B,YAAY,sBAAO,MAAKhD,KAAL,CAAWsC,SAAlB,CAAlB;;AACA,aAAOQ,KAAK,CAACG,GAAN,CAAU,UAAAC,IAAI,EAAI;AACvB,YAAMpC,WAAW,GAAGiC,eAAe,CAACG,IAAI,CAACtB,OAAN,CAAnC;;AACA,YAAMT,IAAI,GAAG,MAAKN,eAAL,CAAqBC,WAArB,EAAkCkC,YAAlC,CAAb;;AACAA,QAAAA,YAAY,CAACL,IAAb,CAAkBxB,IAAlB;AACA+B,QAAAA,IAAI,CAAC/B,IAAL,GAAYA,IAAZ;AACA,eAAO+B,IAAP;AACD,OANM,CAAP;AAOD,KA5IkB;;AAAA,UA8InBC,iBA9ImB,GA8IC,UAAAvB,OAAO,EAAI;AAC7B,YAAKrB,QAAL,CAAc;AAAE6C,QAAAA,eAAe,EAAExB;AAAnB,OAAd;AACD,KAhJkB;;AAAA,UAkJnByB,cAlJmB,GAkJF,UAAAxB,KAAK,EAAI;AACxB,YAAKtB,QAAL,CAAc;AAAE6C,QAAAA,eAAe,EAAEE;AAAnB,OAAd,EAA8C,YAAM;AAAA,YAC1CC,eAD0C,GACtB,MAAKvD,KADiB,CAC1CuD,eAD0C;AAAA,YAE1C3B,OAF0C,GAEGC,KAFH,CAE1CD,OAF0C;AAAA,YAEjCF,IAFiC,GAEGG,KAFH,CAEjCH,IAFiC;AAAA,YAE3BI,OAF2B,GAEGD,KAFH,CAE3BC,OAF2B;AAAA,YAElB0B,gBAFkB,GAEG3B,KAFH,CAElB2B,gBAFkB;;AAAA,iCAG5B,MAAKvB,YAAL,CAAkB,CACtC;AAAEL,UAAAA,OAAO,EAAPA,OAAF;AAAWF,UAAAA,IAAI,EAAJA,IAAX;AAAiBI,UAAAA,OAAO,EAAPA,OAAjB;AAA0B0B,UAAAA,gBAAgB,EAAhBA;AAA1B,SADsC,CAAlB,CAH4B;AAAA,YAG5Cd,WAH4C,sBAG5CA,WAH4C;;AAMlD,YAAIA,WAAW,CAACH,MAAZ,KAAuB,CAA3B,EAA8B;AAC5BG,UAAAA,WAAW,GAAG,MAAKG,cAAL,CAAoBH,WAApB,CAAd;;AACA,gBAAK1C,KAAL,CAAWyD,UAAX,CAAsBF,eAAtB,EAAuCb,WAAvC;AACD;AACF,OAVD;AAWD,KA9JkB;;AAAA,UAgKnBgB,iBAhKmB,GAgKC,YAAM;AACxB/D,MAAAA,SAAS,eACP,oBAAC,aAAD;AACE,QAAA,YAAY,EAAEL,YADhB;AAEE,QAAA,eAAe,EAAE,MAAKuB,eAFxB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QADO,EAKP;AACEjB,QAAAA,KAAK,EAALA,KADF;AAEE+D,QAAAA,cAAc,EAAE,KAFlB;AAGEC,QAAAA,cAAc,EAAE,KAHlB;AAIEC,QAAAA,aAAa,EAAE;AAJjB,OALO,CAAT;AAYD,KA7KkB;;AAAA,UA+KnBC,iBA/KmB,GA+KC,YAAM;AACxBnE,MAAAA,SAAS,eAAC,oBAAC,UAAD;AAAY,QAAA,eAAe,EAAE,MAAKkB,eAAlC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAAD,EAAwD;AAC/DjB,QAAAA,KAAK,EAALA,KAD+D;AAE/D+D,QAAAA,cAAc,EAAE;AAF+C,OAAxD,CAAT;AAID,KApLkB;;AAAA,UAsLnBI,sBAtLmB,GAsLM,YAAM;AAC7BpE,MAAAA,SAAS,eACP,oBAAC,YAAD;AACE,QAAA,eAAe,EAAE,MAAKkB,eADxB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QADO,EAIP;AACEjB,QAAAA,KAAK,EAALA,KADF;AAEE+D,QAAAA,cAAc,EAAE,KAFlB;AAGEC,QAAAA,cAAc,EAAE,KAHlB;AAIEC,QAAAA,aAAa,EAAE,KAJjB;AAKEG,QAAAA,UAAU,EAAE;AALd,OAJO,CAAT;AAYD,KAnMkB;;AAAA,UAqMnBnD,eArMmB,GAqMD,UAACC,WAAD,EAAmD;AAAA,UAArCC,SAAqC,uEAAzB,MAAKf,KAAL,CAAWsC,SAAc;AACnE,UAAItB,GAAG,GAAGD,SAAS,CAACE,MAAV,CAAiB,UAACD,GAAD,EAAME,EAAN,EAAa;AACtC,YAAIC,IAAI,GAAGD,EAAE,CAACE,OAAH,CAAW,UAAX,EAAuB,EAAvB,CAAX;AACA,YAAIC,GAAJ;;AACA,YAAIP,WAAW,KAAKK,IAApB,EAA0B;AACxBE,UAAAA,GAAG,GAAGH,EAAE,CAACE,OAAH,CAAWN,WAAX,EAAwB,EAAxB,EAA4BM,OAA5B,CAAoC,QAApC,EAA8C,EAA9C,CAAN;AACAC,UAAAA,GAAG,GAAG,CAAC,CAACA,GAAF,GAAQC,MAAM,CAACD,GAAD,CAAd,GAAsB,CAA5B;AACA,iBAAOE,IAAI,CAACP,GAAL,CAASA,GAAT,EAAcK,GAAd,CAAP;AACD,SAJD,MAIO;AACL,iBAAOL,GAAP;AACD;AACF,OAVS,EAUP,CAVO,CAAV;;AAWA,UAAIA,GAAG,GAAG,CAAV,EAAa;AACX,yBAAUF,WAAV,cAAyBE,GAAG,GAAG,CAA/B;AACD,OAFD,MAEO;AACL,eAAOF,WAAP;AACD;AACF,KAtNkB;;AAAA,UAwNnBmD,cAxNmB,GAwNF,UAAAC,CAAC,EAAI;AACpB,YAAK3D,QAAL,CAAc;AAAE4D,QAAAA,UAAU,EAAED,CAAC,CAACE,MAAF,CAASC;AAAvB,OAAd;AACD,KA1NkB;;AAAA,UA4NnBC,mBA5NmB,GA4NG,UAACJ,CAAD,EAAIrC,KAAJ,EAAc;AAClC,UAAI0C,SAAS,GAAGL,CAAC,CAACM,OAAlB;AACA,UAAIC,SAAS,GAAGP,CAAC,CAACQ,OAAlB;;AAEA,YAAKnE,QAAL,CAAc;AACZoE,QAAAA,YAAY,EAAEC,WAAW,CAAC,YAAM;AAC9B,gBAAKrE,QAAL,CAAc;AAAEsE,YAAAA,SAAS,EAAE,MAAKC,KAAL,CAAWD,SAAX,GAAuB;AAApC,WAAd;;AAEA,cAAI,MAAKC,KAAL,CAAWD,SAAX,GAAuB,CAA3B,EACE,OAAOE,aAAa,CAAC,MAAKD,KAAL,CAAWH,YAAZ,CAApB;;AAEF,cAAI,MAAKG,KAAL,CAAWD,SAAX,KAAyB,CAA7B,EAAgC;AAC9B,kBAAKtE,QAAL,CAAc;AACZyE,cAAAA,UAAU,EAAEnD,KAAK,CAAC2B,gBAAN,GAAyB3B,KAAzB,GAAiC;AADjC,aAAd;;AAGA,gBAAIoD,QAAQ,CAACC,aAAT,CAAuB,sBAAvB,CAAJ,EAAoD;AAClDD,cAAAA,QAAQ,CAACC,aAAT,CAAuB,sBAAvB,EAA+CC,KAA/C,CAAqDC,IAArD,GACEb,SAAS,GAAG,GAAZ,GAAkB,IADpB;AAEAU,cAAAA,QAAQ,CAACC,aAAT,CAAuB,sBAAvB,EAA+CC,KAA/C,CAAqDE,GAArD,GACEZ,SAAS,GAAG,GAAZ,GAAkB,IADpB;AAED;AACF;AACF,SAjBwB,EAiBtB,IAjBsB;AADb,OAAd;AAoBD,KApPkB;;AAAA,UAsPnBa,mBAtPmB,GAsPG,YAAM;AAC1BP,MAAAA,aAAa,CAAC,MAAKD,KAAL,CAAWH,YAAZ,CAAb;;AACA,YAAKpE,QAAL,CAAc;AACZsE,QAAAA,SAAS,EAAE,CADC,CAEZ;;AAFY,OAAd;AAID,KA5PkB;;AAAA,UA8PnBU,mBA9PmB,GA8PG,YAAM;AAC1B,YAAKhF,QAAL,CAAc;AACZyE,QAAAA,UAAU,EAAE;AADA,OAAd;AAGD,KAlQkB;;AAEjB,UAAKF,KAAL,GAAa;AACXU,MAAAA,gBAAgB,EAAE,KADP;AAEX/E,MAAAA,eAAe,EAAE6C,SAFN;AAGX5C,MAAAA,kBAAkB,EAAE4C,SAHT;AAIX9C,MAAAA,MAAM,EAAE,EAJG;AAKX4C,MAAAA,eAAe,EAAEE,SALN;AAMXa,MAAAA,UAAU,EAAE,EAND;AAOXa,MAAAA,UAAU,EAAE,KAPD;AAQXH,MAAAA,SAAS,EAAE,CARA;AASXF,MAAAA,YAAY,EAAE;AATH,KAAb;AAFiB;AAalB;;;;WAED,6BAAoB;AAAA;;AAClB;AACArF,MAAAA,YAAY,CAACmG,cAAb,CAA4B,YAAM;AAChC,QAAA,MAAI,CAAClF,QAAL,CACE;AACEiF,UAAAA,gBAAgB,EAAE,IADpB;AAEE/E,UAAAA,eAAe,EAAEnB,YAAY,CAACoG,UAAb,CAAwB,CAAxB,EAA2BvE,IAF9C;AAGET,UAAAA,kBAAkB,EAAEpB,YAAY,CAACoG,UAAb,CAAwB,CAAxB,EAA2BvE;AAHjD,SADF,EAME,YAAM;AACJ,UAAA,MAAI,CAACR,UAAL,CAAgB,MAAI,CAACmE,KAAL,CAAWpE,kBAA3B;AACD,SARH;AAUD,OAXD;AAYD;;;WAuOD,kBAAS;AAAA,wBASH,KAAKoE,KATF;AAAA,UAELU,gBAFK,eAELA,gBAFK;AAAA,UAGL/E,eAHK,eAGLA,eAHK;AAAA,UAILC,kBAJK,eAILA,kBAJK;AAAA,UAKLF,MALK,eAKLA,MALK;AAAA,UAML4C,eANK,eAMLA,eANK;AAAA,UAOLe,UAPK,eAOLA,UAPK;AAAA,UAQLa,UARK,eAQLA,UARK;AAAA,UAWL9E,kBAXK,GAsBH,IAtBG,CAWLA,kBAXK;AAAA,UAYLiD,iBAZK,GAsBH,IAtBG,CAYLA,iBAZK;AAAA,UAaLE,cAbK,GAsBH,IAtBG,CAaLA,cAbK;AAAA,UAcLK,iBAdK,GAsBH,IAtBG,CAcLA,iBAdK;AAAA,UAeLI,iBAfK,GAsBH,IAtBG,CAeLA,iBAfK;AAAA,UAgBLC,sBAhBK,GAsBH,IAtBG,CAgBLA,sBAhBK;AAAA,UAiBL4B,qBAjBK,GAsBH,IAtBG,CAiBLA,qBAjBK;AAAA,UAkBL1B,cAlBK,GAsBH,IAtBG,CAkBLA,cAlBK;AAAA,UAmBLK,mBAnBK,GAsBH,IAtBG,CAmBLA,mBAnBK;AAAA,UAoBLgB,mBApBK,GAsBH,IAtBG,CAoBLA,mBApBK;AAAA,UAqBLC,mBArBK,GAsBH,IAtBG,CAqBLA,mBArBK;AAAA,wBA6BH,KAAKvF,KA7BF;AAAA,UAwBL4F,eAxBK,eAwBLA,eAxBK;AAAA,UAyBLC,kBAzBK,eAyBLA,kBAzBK;AAAA,UA0BLC,MA1BK,eA0BLA,MA1BK;AAAA,UA2BLC,IA3BK,eA2BLA,IA3BK;AAAA,UA4BLC,KA5BK,eA4BLA,KA5BK;;AA+BP,UAAI,CAACR,gBAAD,IAAqB,CAACO,IAA1B,EAAgC;AAC9B,4BAAO;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,UAAP;AACD;;AACD,UAAME,cAAc,GAAGzF,MAAM,CAAC0F,MAAP,CAAc,UAAArE,KAAK,EAAI;AAC5C,eAAOvC,YAAY,CAACqC,QAAb,CAAsBE,KAAK,CAACD,OAA5B,EAAqCd,WAArC,CAAiDqF,QAAjD,CACLhC,UADK,CAAP;AAGD,OAJsB,CAAvB;AAKA,0BACE,oBAAC,UAAD;AACE,QAAA,EAAE,EAAC,WADL;AAEE,QAAA,KAAK,EAAE;AAAE2B,UAAAA,MAAM,EAANA;AAAF,SAFT;AAGE,QAAA,YAAY,EAAE,GAHhB;AAIE,QAAA,aAAa,EAAE,GAJjB;AAKE,QAAA,QAAQ,EAAE,GALZ;AAME,QAAA,QAAQ,EAAEb,QAAQ,CAACmB,IAAT,CAAcC,YAAd,GAA6B,GANzC;AAOE,QAAA,QAAQ,EAAE,GAPZ;AAQE,QAAA,SAAS,EAAE,GARb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBAUE,oBAAC,IAAD;AACE,QAAA,eAAe,EAAE5F,eADnB;AAEE,QAAA,kBAAkB,EAAEC,kBAFtB;AAGE,QAAA,MAAM,EAAEuF,cAHV;AAIE,QAAA,kBAAkB,EAAE/F,kBAJtB;AAKE,QAAA,eAAe,EAAEkD,eALnB;AAME,QAAA,iBAAiB,EAAED,iBANrB;AAOE,QAAA,cAAc,EAAEE,cAPlB;AAQE,QAAA,iBAAiB,EAAEK,iBARrB;AASE,QAAA,iBAAiB,EAAEI,iBATrB;AAUE,QAAA,sBAAsB,EAAEC,sBAV1B;AAWE,QAAA,qBAAqB,EAAE4B,qBAXzB;AAYE,QAAA,eAAe,EAAEC,eAZnB;AAaE,QAAA,kBAAkB,EAAEC,kBAbtB;AAcE,QAAA,UAAU,EAAE1B,UAdd;AAeE,QAAA,cAAc,EAAEF,cAflB;AAgBE,QAAA,KAAK,EAAE+B,KAhBT;AAiBE,QAAA,mBAAmB,EAAE1B,mBAjBvB;AAkBE,QAAA,mBAAmB,EAAEgB,mBAlBvB;AAmBE,QAAA,mBAAmB,EAAEC,mBAnBvB;AAoBE,QAAA,UAAU,EAAEP,UApBd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAVF,CADF;AAmCD;;;;EA/UqB9F,S;;AAkVxB,eAAeC,OAAO,CACpB,UAAA2F,KAAK;AAAA,SAAK;AACRkB,IAAAA,KAAK,EAAElB,KAAK,CAACwB,QAAN,CAAeN,KADd;AAERzC,IAAAA,eAAe,EAAEuB,KAAK,CAACyB,WAAN,CAAkBC,QAAlB,CAA2BC,KAFpC;AAGRnE,IAAAA,SAAS,EAAEwC,KAAK,CAAC2B,KAAN,CAAYC,MAAZ,CAAmB5B,KAAK,CAACyB,WAAN,CAAkBC,QAAlB,CAA2BC,KAA9C,EAAqDnE,SAHxD;AAIRE,IAAAA,OAAO,EAAEsC,KAAK,CAAC2B,KAAN,CAAYC,MAAZ,CAAmB5B,KAAK,CAACyB,WAAN,CAAkBC,QAAlB,CAA2BC,KAA9C,EAAqDjE;AAJtD,GAAL;AAAA,CADe,EAOpB;AACEiB,EAAAA,UAAU,EAAErE,YAAY,CAACqE,UAD3B;AAEEpD,EAAAA,MAAM,EAAEhB,aAAa,CAACgB;AAFxB,CAPoB,CAAP,CAWbN,SAXa,CAAf","sourcesContent":["import React, { Component } from \"react\";\nimport { connect } from \"react-redux\";\nimport * as sceneActions from \"../../Store/Reducer/scene\";\nimport * as webrtcActions from \"../../Store/Reducer/webrtc\";\nimport AssetLibrary from \"../../utils/assetLibrary\";\nimport ComponentTemplate from \"../../utils/ComponentTemplate\";\nimport DrawingEditor from \"./Component/DrawingEditor\";\nimport TextEditor from \"./Component/TextEditor\";\nimport CustomSprite from \"./Component/CustomSprite\";\nimport { showPopUp } from \"../../../../Common/Component/PopUp\";\nimport store from \"../../Store\";\nimport RndWrapper from \"../../utils/RndWrapper\";\nimport View from \"./View\";\n\nclass Container extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      isCategoryLoaded: false,\n      currentCategory: undefined,\n      currentSubCategory: undefined,\n      assets: [],\n      selectedAssetId: undefined,\n      inputValue: \"\",\n      hoverAsset: false,\n      checkTime: 0,\n      timeFunction: null\n    };\n  }\n\n  componentDidMount() {\n    // this.setDefaultLayout();\n    AssetLibrary.loadCategories(() => {\n      this.setState(\n        {\n          isCategoryLoaded: true,\n          currentCategory: AssetLibrary.categories[0].name,\n          currentSubCategory: AssetLibrary.categories[0].name\n        },\n        () => {\n          this.loadAssets(this.state.currentSubCategory);\n        }\n      );\n    });\n  }\n\n  setDefaultLayout = () => {\n    // const width = 500;\n    // const height = 450;\n    // const minWidth = width;\n    // const minHeight = height;\n    // const x = document.body.clientWidth - width - 300;\n    // const y = document.body.clientHeight - height - height;\n    // this.setState({ width, height, minHeight, minWidth, x, y });\n  };\n\n  setCurrentCategory = (category, subcate) => {\n    if (!subcate) subcate = category;\n    this.props.setLog({\n      selectedSprite:\n        category === subcate ? `${category}(전체)` : `${category}(${subcate})`\n    });\n    this.setState(\n      { assets: [], currentCategory: category, currentSubCategory: subcate },\n      () => {\n        this.loadAssets(subcate);\n      }\n    );\n  };\n\n  loadAssets = subcate => {\n    if (subcate) {\n      AssetLibrary.loadAssetsByCategory(subcate, assets => {\n        this.setState({ assets });\n      });\n    }\n  };\n\n  countUpSameName = (defaultName, nameArray) => {\n    let max = nameArray.reduce((max, id) => {\n      let name = id.replace(/\\(\\d+\\)$/, \"\");\n      let num;\n      if (defaultName === name) {\n        num = id.replace(defaultName, \"\").replace(/\\(|\\)/g, \"\");\n        num = !!num ? Number(num) : 1;\n        return Math.max(max, num);\n      } else {\n        return max;\n      }\n    }, 0);\n    if (max > 0) {\n      return `${defaultName}(${max + 1})`;\n    } else {\n      return defaultName;\n    }\n  };\n\n  setSpriteInfo = item => {\n    const type = AssetLibrary.getAsset(item.assetId).type;\n    const assetId = item.assetId;\n    const asset = AssetLibrary.getAsset(assetId);\n    const defaultName = asset.defaultName;\n    const name = defaultName;\n    const subtype = AssetLibrary.getAsset(item.assetId).subtype;\n\n    /** templateCode depend on asset.subtype */\n    // 스프라이트 박스의 컴포넌트 탭의\n    // 스프라이트들의 subtype에 의존해서 템플릿 코드를 넣어주고 있다.\n    let templateCode;\n    if (asset.type === \"component\") {\n      templateCode = ComponentTemplate[asset.subtype];\n    }\n    const code = templateCode ? templateCode : \"\";\n    return { name, assetId, type, code, subtype };\n  };\n\n  reduceBasket = assets => {\n    return assets.reduce(\n      (acc, cur) => {\n        if (cur.subtype === \"camera\") {\n          let checkCamera = false;\n          for (var i = 0; i < this.props.spriteIds.length; i++) {\n            if (\n              this.props.sprites[this.props.spriteIds[i]].preview.subtype ===\n              \"camera\"\n            ) {\n              checkCamera = true;\n              break;\n            }\n          }\n          if (!checkCamera) {\n            acc.spriteInfos.push(this.setSpriteInfo(cur));\n          }\n        } else if (cur.subtype === \"joystick\") {\n          acc.spriteInfos.push(this.setSpriteInfo(cur));\n        } else {\n          acc.spriteInfos.push(this.setSpriteInfo(cur));\n        }\n\n        return acc;\n      },\n      { spriteInfos: [], soundInfos: [] }\n    );\n  };\n\n  checkSameNames = infos => {\n    const makeDefaultName = assetId => assetId.replace(/_v\\d+$/, \"\");\n    const newSpriteIds = [...this.props.spriteIds];\n    return infos.map(info => {\n      const defaultName = makeDefaultName(info.assetId);\n      const name = this.countUpSameName(defaultName, newSpriteIds);\n      newSpriteIds.push(name);\n      info.name = name;\n      return info;\n    });\n  };\n\n  handleSelectAsset = assetId => {\n    this.setState({ selectedAssetId: assetId });\n  };\n\n  handleAddAsset = asset => {\n    this.setState({ selectedAssetId: undefined }, () => {\n      const { selectedSceneId } = this.props;\n      const { assetId, type, subtype, spriteAnimations } = asset;\n      let { spriteInfos } = this.reduceBasket([\n        { assetId, type, subtype, spriteAnimations }\n      ]);\n      if (spriteInfos.length !== 0) {\n        spriteInfos = this.checkSameNames(spriteInfos);\n        this.props.addSprites(selectedSceneId, spriteInfos);\n      }\n    });\n  };\n\n  handleOpenDrawing = () => {\n    showPopUp(\n      <DrawingEditor\n        AssetLibrary={AssetLibrary}\n        countUpSameName={this.countUpSameName}\n      />,\n      {\n        store,\n        defaultPadding: false,\n        dismissOverlay: false,\n        dismissButton: false\n      }\n    );\n  };\n  \n  handleOpenTextbox = () => {\n    showPopUp(<TextEditor countUpSameName={this.countUpSameName} />, {\n      store,\n      defaultPadding: false\n    });\n  };\n  \n  handleOpenCustomSprite = () => {\n    showPopUp(\n      <CustomSprite\n        countUpSameName={this.countUpSameName}\n      />,\n      {\n        store,\n        defaultPadding: false,\n        dismissOverlay: false,\n        dismissButton: false,\n        scrollable: true\n      }\n    );\n  }\n\n  countUpSameName = (defaultName, nameArray = this.props.spriteIds) => {\n    let max = nameArray.reduce((max, id) => {\n      let name = id.replace(/\\(\\d+\\)$/, \"\");\n      let num;\n      if (defaultName === name) {\n        num = id.replace(defaultName, \"\").replace(/\\(|\\)/g, \"\");\n        num = !!num ? Number(num) : 1;\n        return Math.max(max, num);\n      } else {\n        return max;\n      }\n    }, 0);\n    if (max > 0) {\n      return `${defaultName}(${max + 1})`;\n    } else {\n      return defaultName;\n    }\n  };\n\n  handleOnChange = e => {\n    this.setState({ inputValue: e.target.value });\n  };\n\n  handleShowAnimation = (e, asset) => {\n    let xPosition = e.clientX;\n    let yPosition = e.clientY;\n\n    this.setState({\n      timeFunction: setInterval(() => {\n        this.setState({ checkTime: this.state.checkTime + 1 });\n\n        if (this.state.checkTime > 2)\n          return clearInterval(this.state.timeFunction);\n\n        if (this.state.checkTime === 2) {\n          this.setState({\n            hoverAsset: asset.spriteAnimations ? asset : false\n          });\n          if (document.querySelector(\".SpriteBox_Animation\")) {\n            document.querySelector(\".SpriteBox_Animation\").style.left =\n              xPosition - 320 + \"px\";\n            document.querySelector(\".SpriteBox_Animation\").style.top =\n              yPosition - 150 + \"px\";\n          }\n        }\n      }, 1000)\n    });\n  };\n\n  handleHideAnimation = () => {\n    clearInterval(this.state.timeFunction);\n    this.setState({\n      checkTime: 0\n      // hoverAsset: null\n    });\n  };\n\n  handleAnimationHide = () => {\n    this.setState({\n      hoverAsset: null\n    });\n  };\n\n  render() {\n    const {\n      isCategoryLoaded,\n      currentCategory,\n      currentSubCategory,\n      assets,\n      selectedAssetId,\n      inputValue,\n      hoverAsset\n    } = this.state;\n    const {\n      setCurrentCategory,\n      handleSelectAsset,\n      handleAddAsset,\n      handleOpenDrawing,\n      handleOpenTextbox,\n      handleOpenCustomSprite,\n      handleOpenCustomSound,\n      handleOnChange,\n      handleShowAnimation,\n      handleHideAnimation,\n      handleAnimationHide\n    } = this;\n    const {\n      handleSelectTab,\n      handleChangeZIndex,\n      zIndex,\n      isOn,\n      email\n    } = this.props;\n\n    if (!isCategoryLoaded || !isOn) {\n      return <div />;\n    }\n    const filteredAssets = assets.filter(asset => {\n      return AssetLibrary.getAsset(asset.assetId).defaultName.includes(\n        inputValue\n      );\n    });\n    return (\n      <RndWrapper\n        id=\"spriteBox\"\n        style={{ zIndex }}\n        defaultWidth={600}\n        defaultHeight={450}\n        defaultX={180}\n        defaultY={document.body.clientHeight - 550}\n        minWidth={380}\n        minHeight={260}\n      >\n        <View\n          currentCategory={currentCategory}\n          currentSubCategory={currentSubCategory}\n          assets={filteredAssets}\n          setCurrentCategory={setCurrentCategory}\n          selectedAssetId={selectedAssetId}\n          handleSelectAsset={handleSelectAsset}\n          handleAddAsset={handleAddAsset}\n          handleOpenDrawing={handleOpenDrawing}\n          handleOpenTextbox={handleOpenTextbox}\n          handleOpenCustomSprite={handleOpenCustomSprite}\n          handleOpenCustomSound={handleOpenCustomSound}\n          handleSelectTab={handleSelectTab}\n          handleChangeZIndex={handleChangeZIndex}\n          inputValue={inputValue}\n          handleOnChange={handleOnChange}\n          email={email}\n          handleShowAnimation={handleShowAnimation}\n          handleHideAnimation={handleHideAnimation}\n          handleAnimationHide={handleAnimationHide}\n          hoverAsset={hoverAsset}\n        />\n      </RndWrapper>\n    );\n  }\n}\n\nexport default connect(\n  state => ({\n    email: state.userinfo.email,\n    selectedSceneId: state.interaction.selected.scene,\n    spriteIds: state.scene.scenes[state.interaction.selected.scene].spriteIds,\n    sprites: state.scene.scenes[state.interaction.selected.scene].sprites\n  }),\n  {\n    addSprites: sceneActions.addSprites,\n    setLog: webrtcActions.setLog\n  }\n)(Container);\n"]},"metadata":{},"sourceType":"module"}