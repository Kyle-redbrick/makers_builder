{"ast":null,"code":"import _regeneratorRuntime from \"/Users/jimmy/Documents/Wizschool/wizlab_web2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/jimmy/Documents/Wizschool/wizlab_web2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"/Users/jimmy/Documents/Wizschool/wizlab_web2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/jimmy/Documents/Wizschool/wizlab_web2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _assertThisInitialized from \"/Users/jimmy/Documents/Wizschool/wizlab_web2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";\nimport _inherits from \"/Users/jimmy/Documents/Wizschool/wizlab_web2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _possibleConstructorReturn from \"/Users/jimmy/Documents/Wizschool/wizlab_web2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/jimmy/Documents/Wizschool/wizlab_web2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nvar _jsxFileName = \"/Users/jimmy/Documents/Wizschool/wizlab_web2/src/Page/Home/Container.js\";\n\nfunction _createForOfIteratorHelper(o, allowArrayLike) { var it = typeof Symbol !== \"undefined\" && o[Symbol.iterator] || o[\"@@iterator\"]; if (!it) { if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") { if (it) o = it; var i = 0; var F = function F() {}; return { s: F, n: function n() { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }, e: function e(_e) { throw _e; }, f: F }; } throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); } var normalCompletion = true, didErr = false, err; return { s: function s() { it = it.call(o); }, n: function n() { var step = it.next(); normalCompletion = step.done; return step; }, e: function e(_e2) { didErr = true; err = _e2; }, f: function f() { try { if (!normalCompletion && it.return != null) it.return(); } finally { if (didErr) throw err; } } }; }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\n\nimport React, { Component } from \"react\";\nimport { connect } from \"react-redux\";\nimport View from \"./View\";\nimport * as request from \"../../Common/Util/HTTPRequest\";\nimport { withRouter } from \"react-router-dom\";\nimport { injectIntl } from \"react-intl\";\nimport { PAGETYPE } from \"../../Common/Util/Constant\";\nimport generatePID from \"../../Common/Util/PIDGenerator\";\nimport PopUp, { showPopUp } from \"../../Common/Component/PopUp\"; // import * as TrackingUtil from \"../../Common/Util/TrackingUtil\";\n\nimport { detectIE } from \"../../Common/Util/detectBrowser\";\nimport SignIn from \"../../Common/Component/SignIn\";\n\nvar Container = /*#__PURE__*/function (_Component) {\n  _inherits(Container, _Component);\n\n  var _super = _createSuper(Container);\n\n  function Container(_props) {\n    var _this;\n\n    _classCallCheck(this, Container);\n\n    _this = _super.call(this, _props);\n\n    _this.handleWindowResize = function () {\n      if (window.innerWidth < 1080 && !_this.state.isMobile) {\n        _this.setState({\n          isMobile: true\n        });\n      }\n\n      if (window.innerWidth >= 1080 && _this.state.isMobile) {\n        _this.setState({\n          isMobile: false\n        });\n      }\n    };\n\n    _this.handleSubscribe = function (e, index, email, subscribe) {\n      if (_this.lastLikeTime) {\n        if (new Date().getTime() - _this.lastLikeTime < 1200) {\n          _this.lastLikeTime = new Date().getTime();\n          showPopUp( /*#__PURE__*/React.createElement(PopUp.OneButton, {\n            title: _this.props.intl.formatMessage({\n              id: \"ID_POPUP_WARNING_REPEAT_CLICK_TITLE\"\n            }),\n            buttonName: _this.props.intl.formatMessage({\n              id: \"ID_POPUP_WARNING_REPEAT_CLICK_BTN\"\n            }),\n            __self: _assertThisInitialized(_this),\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 88,\n              columnNumber: 11\n            }\n          }), {\n            darkmode: true\n          });\n          return;\n        }\n      }\n\n      _this.lastLikeTime = new Date().getTime();\n\n      if (!_this.props.email) {\n        showPopUp( /*#__PURE__*/React.createElement(SignIn, {\n          __self: _assertThisInitialized(_this),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 104,\n            columnNumber: 17\n          }\n        }), {\n          darkmode: true,\n          mobileFullscreen: true\n        });\n        return;\n      }\n\n      e.target.classList.toggle(\"click\");\n      var params = {\n        creatorEmail: email,\n        email: _this.props.email\n      };\n\n      if (subscribe) {\n        request.addSubscribe(params).then(function (res) {\n          return res.json();\n        }).then(function (json) {\n          if (json) {\n            var target = _this.state.rankUsers;\n            target[index].subscribe = true;\n            target[index].subscribeCount = _this.state.rankUsers[index].subscribeCount + 1;\n\n            _this.setState({\n              rankUsers: target\n            });\n          } else {\n            showPopUp( /*#__PURE__*/React.createElement(PopUp.OneButton, {\n              title: _this.props.intl.formatMessage({\n                id: \"ID_POPUP_WARNING_REPEAT_CLICK_TITLE\"\n              }),\n              buttonName: _this.props.intl.formatMessage({\n                id: \"ID_POPUP_WARNING_REPEAT_CLICK_BTN\"\n              }),\n              __self: _assertThisInitialized(_this),\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 125,\n                columnNumber: 15\n              }\n            }), {\n              darkmode: true\n            });\n          }\n        });\n      } else {\n        request.removeSubscribe(params).then(function (res) {\n          return res.json();\n        }).then(function (json) {\n          if (json.success) {\n            var target = _this.state.rankUsers;\n            target[index].subscribe = false;\n            target[index].subscribeCount = _this.state.rankUsers[index].subscribeCount - 1;\n\n            _this.setState({\n              rankUsers: target\n            });\n          } else {\n            showPopUp( /*#__PURE__*/React.createElement(PopUp.OneButton, {\n              title: _this.props.intl.formatMessage({\n                id: \"ID_POPUP_WARNING_REPEAT_CLICK_TITLE\"\n              }),\n              buttonName: _this.props.intl.formatMessage({\n                id: \"ID_POPUP_WARNING_REPEAT_CLICK_BTN\"\n              }),\n              __self: _assertThisInitialized(_this),\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 150,\n                columnNumber: 15\n              }\n            }), {\n              darkmode: true\n            });\n          }\n        });\n      }\n    };\n\n    _this.getMyProjects = function (props) {\n      if (!_this.props.email) return;\n      var currentPage = props.currentPage,\n          keyword = props.keyword;\n      var pageOffset = Math.ceil((currentPage - 1) * _this.pageSize);\n      var limit = _this.pageSize;\n      keyword = encodeURIComponent(keyword);\n      var params = {\n        email: _this.props.email,\n        offset: pageOffset,\n        limit: limit,\n        keyword: keyword\n      };\n      request.getDevelopingProjects(params).then(function (res) {\n        return res.json();\n      }).then(function (result) {\n        var count = result.count,\n            rows = result.rows;\n\n        _this.setState(function (prev) {\n          return {\n            myprojects: currentPage === 1 ? rows : prev.myprojects.concat(rows),\n            myprojectCnt: count\n          };\n        });\n      }).catch(function (err) {\n        return console.error(err);\n      });\n    };\n\n    _this.loadTemplateByHome = function () {\n      if (_this.templateId && _this.state.templateProjects.length > 0) {\n        _this.state.templateProjects.forEach(function (element) {\n          if (element.id === Number(_this.templateId)) {\n            _this.createNewProject(element);\n\n            localStorage.removeItem(\"templateId\");\n            return;\n          }\n        });\n      }\n    };\n\n    _this.getWizlabEvents = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      var wizEvent;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return request.getWizlabEvents().then(function (res) {\n                return res.json();\n              }).catch(function (e) {\n                return console.error(e);\n              });\n\n            case 2:\n              wizEvent = _context.sent;\n\n              _this.setState({\n                wizEvent: wizEvent.events\n              });\n\n            case 4:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n    _this.getrecommendedGames = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n      var wizappInfo;\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.next = 2;\n              return request.getEditorRecommends({\n                limit: 4\n              }).then(function (res) {\n                return res.json();\n              }).catch(function (e) {\n                return console.error(e);\n              });\n\n            case 2:\n              wizappInfo = _context2.sent;\n\n              _this.setState({\n                recommendedGames: wizappInfo\n              });\n\n            case 4:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }));\n    _this.getWeeklyProjectsByType = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3() {\n      var weeklyProjects;\n      return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              _context3.next = 2;\n              return request.getWeeklyProjectsByType({\n                type: _this.state.weeklyTabType,\n                limit: 10\n              }).then(function (res) {\n                return res.json();\n              }).catch(function (e) {\n                return console.error(e);\n              });\n\n            case 2:\n              weeklyProjects = _context3.sent;\n\n              _this.setState({\n                weeklyProjects: weeklyProjects\n              });\n\n            case 4:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3);\n    }));\n    _this.getRankingByType = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee4() {\n      var rankUsers, _iterator, _step, _loop;\n\n      return _regeneratorRuntime.wrap(function _callee4$(_context5) {\n        while (1) {\n          switch (_context5.prev = _context5.next) {\n            case 0:\n              _context5.next = 2;\n              return request.getRankingByType({\n                type: _this.state.rankTabType\n              }).then(function (res) {\n                return res.json();\n              }).catch(function (e) {\n                return console.error(e);\n              });\n\n            case 2:\n              rankUsers = _context5.sent;\n              _iterator = _createForOfIteratorHelper(rankUsers);\n              _context5.prev = 4;\n              _loop = /*#__PURE__*/_regeneratorRuntime.mark(function _loop() {\n                var item;\n                return _regeneratorRuntime.wrap(function _loop$(_context4) {\n                  while (1) {\n                    switch (_context4.prev = _context4.next) {\n                      case 0:\n                        item = _step.value;\n\n                        if (!_this.props.email) {\n                          _context4.next = 6;\n                          break;\n                        }\n\n                        _context4.next = 4;\n                        return request.isSubscribe({\n                          email: _this.props.email,\n                          creatorEmail: item.email\n                        }).then(function (res) {\n                          return res.json();\n                        }).then(function (json) {\n                          item.subscribe = json.isSubscribe;\n                        });\n\n                      case 4:\n                        _context4.next = 7;\n                        break;\n\n                      case 6:\n                        item.subscribe = false;\n\n                      case 7:\n                      case \"end\":\n                        return _context4.stop();\n                    }\n                  }\n                }, _loop);\n              });\n\n              _iterator.s();\n\n            case 7:\n              if ((_step = _iterator.n()).done) {\n                _context5.next = 11;\n                break;\n              }\n\n              return _context5.delegateYield(_loop(), \"t0\", 9);\n\n            case 9:\n              _context5.next = 7;\n              break;\n\n            case 11:\n              _context5.next = 16;\n              break;\n\n            case 13:\n              _context5.prev = 13;\n              _context5.t1 = _context5[\"catch\"](4);\n\n              _iterator.e(_context5.t1);\n\n            case 16:\n              _context5.prev = 16;\n\n              _iterator.f();\n\n              return _context5.finish(16);\n\n            case 19:\n              _this.setState({\n                rankUsers: rankUsers\n              });\n\n            case 20:\n            case \"end\":\n              return _context5.stop();\n          }\n        }\n      }, _callee4, null, [[4, 13, 16, 19]]);\n    }));\n\n    _this.onClickLink = function (id) {\n      window.location = \"/userpage/\".concat(id);\n    };\n\n    _this.getCreator = function (creatorEmail) {\n      request.isSubscribe({\n        email: _this.props.email,\n        creatorEmail: creatorEmail\n      }).then(function (res) {\n        return res.json();\n      }).catch(function (e) {\n        return console.error(e);\n      });\n    };\n\n    _this.handleWeeklyProjectTab = function (tabType) {\n      _this.setState({\n        weeklyTabType: tabType\n      }, function () {\n        _this.getWeeklyProjectsByType();\n      });\n    };\n\n    _this.handleCreatorRankTab = function (tabType) {\n      _this.setState({\n        rankTabType: tabType\n      }, function () {\n        _this.getRankingByType();\n      });\n    };\n\n    _this.handleClickCodeBtn = function (target) {\n      target.classList.add(\"click\");\n    };\n\n    _this.onClickCreate = function (templateId) {\n      localStorage.setItem(\"templateId\", templateId);\n      window.open(\"/builder\");\n    };\n\n    _this.createNewProject = function (template) {\n      var email = _this.props.email;\n\n      if (email) {\n        // const isEmptyTemplete = template.order === 0;\n        var pageURL = \"/\".concat(PAGETYPE.BUILDER, \"/\").concat(generatePID(email));\n\n        if (template.id) {\n          pageURL += \"/\".concat(template.id);\n        }\n\n        _this.props.history.replace({\n          pathname: pageURL\n        });\n\n        window.location.reload();\n      } else {\n        var _pageURL = \"/\".concat(PAGETYPE.BUILDER, \"?t=\").concat(template.id);\n\n        _this.props.history.replace({\n          pathname: _pageURL\n        });\n\n        window.location.reload();\n      }\n    };\n\n    _this.onScroll = function (e) {\n      if (!_this.wasPlayed && window.pageYOffset > 350) {\n        var videoRef = _this.state.videoRef;\n\n        if (videoRef) {\n          var playPromise = videoRef.play();\n          playPromise.then(function () {\n            _this.wasPlayed = true;\n          }).catch(function () {\n            console.error(\"play\");\n          });\n        }\n      }\n    };\n\n    _this.setVideoRef = function (ref) {\n      _this.setState({\n        videoRef: ref\n      });\n    };\n\n    _this.handleClickBanner = function (url, isLogin) {\n      if (isLogin) {\n        if (_this.props.email) {\n          if (url.includes(\"http\")) {\n            window.open(url);\n          } else {\n            _this.props.history.push(url);\n          }\n        } else {\n          showPopUp( /*#__PURE__*/React.createElement(SignIn, {\n            __self: _assertThisInitialized(_this),\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 348,\n              columnNumber: 19\n            }\n          }), {\n            darkmode: true,\n            mobileFullscreen: true\n          });\n        }\n      } else {\n        if (url.includes(\"https\")) {\n          window.open(url);\n        } else {\n          _this.props.history.push(url);\n        }\n      }\n    };\n\n    if (window.location.hash) {\n      _props.history.replace(window.location.hash.replace(\"#\", \"\"));\n    }\n\n    _this.isIE = detectIE();\n    _this.wasPlayed = false;\n    _this.state = {\n      // popUsers: undefined,\n      // videoRef: undefined,\n      wizEvent: [],\n      recommendedGames: [],\n      rankUsers: [],\n      weeklyProjects: [],\n      templateProjects: [],\n      isSubscribed: undefined,\n      weeklyTabType: \"like\",\n      rankTabType: \"likeCount\",\n      isMobile: window.innerWidth < 1080\n    };\n    _this.pageSize = 50;\n    return _this;\n  }\n\n  _createClass(Container, [{\n    key: \"componentDidMount\",\n    value: function () {\n      var _componentDidMount = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee5() {\n        var _this2 = this;\n\n        return _regeneratorRuntime.wrap(function _callee5$(_context6) {\n          while (1) {\n            switch (_context6.prev = _context6.next) {\n              case 0:\n                _context6.next = 2;\n                return this.getWizlabEvents();\n\n              case 2:\n                _context6.next = 4;\n                return this.getrecommendedGames();\n\n              case 4:\n                _context6.next = 6;\n                return this.getRankingByType();\n\n              case 6:\n                _context6.next = 8;\n                return this.getWeeklyProjectsByType();\n\n              case 8:\n                window.addEventListener(\"resize\", this.handleWindowResize);\n                this.handleWindowResize();\n\n                if (!this.isIE) {\n                  window.addEventListener(\"scroll\", this.onScroll);\n                }\n\n                this.getMyProjects({\n                  currentPage: 1,\n                  keyword: \"\"\n                });\n                request.getTemplateProjects().then(function (res) {\n                  return res.json();\n                }).then(function (json) {\n                  _this2.setState({\n                    templateProjects: json\n                  }, function () {\n                    _this2.loadTemplateByHome();\n                  });\n                }).catch(function (e) {\n                  console.error(e);\n                });\n\n              case 13:\n              case \"end\":\n                return _context6.stop();\n            }\n          }\n        }, _callee5, this);\n      }));\n\n      function componentDidMount() {\n        return _componentDidMount.apply(this, arguments);\n      }\n\n      return componentDidMount;\n    }()\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      window.addEventListener(\"resize\", this.handleWindowResize);\n\n      if (!this.isIE) {\n        window.removeEventListener(\"scroll\", this.onScroll);\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$state = this.state,\n          wizEvent = _this$state.wizEvent,\n          recommendedGames = _this$state.recommendedGames,\n          weeklyProjects = _this$state.weeklyProjects,\n          rankUsers = _this$state.rankUsers,\n          templateProjects = _this$state.templateProjects,\n          weeklyTabType = _this$state.weeklyTabType,\n          rankTabType = _this$state.rankTabType,\n          isMobile = _this$state.isMobile;\n      var onClickCreate = this.onClickCreate,\n          setVideoRef = this.setVideoRef,\n          handleClickCodeBtn = this.handleClickCodeBtn,\n          onPressBestGame = this.onPressBestGame,\n          handleSubscribe = this.handleSubscribe,\n          createNewProject = this.createNewProject,\n          onClickLink = this.onClickLink,\n          handleWeeklyProjectTab = this.handleWeeklyProjectTab,\n          handleCreatorRankTab = this.handleCreatorRankTab,\n          handleClickBanner = this.handleClickBanner;\n      return /*#__PURE__*/React.createElement(View, {\n        isMobile: isMobile,\n        wizEvent: wizEvent,\n        recommendedGames: recommendedGames,\n        weeklyProjects: weeklyProjects,\n        rankUsers: rankUsers,\n        templateProjects: templateProjects,\n        intl: this.props.intl,\n        onClickCreate: onClickCreate,\n        onPressBestGame: onPressBestGame,\n        setVideoRef: setVideoRef,\n        handleClickCodeBtn: handleClickCodeBtn,\n        handleSubscribe: handleSubscribe,\n        createNewProject: createNewProject,\n        weeklyTabType: weeklyTabType,\n        rankTabType: rankTabType,\n        onClickLink: onClickLink,\n        handleCreatorRankTab: handleCreatorRankTab,\n        handleWeeklyProjectTab: handleWeeklyProjectTab,\n        handleClickBanner: handleClickBanner,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 383,\n          columnNumber: 7\n        }\n      });\n    }\n  }]);\n\n  return Container;\n}(Component);\n\nexport default connect(function (state) {\n  return {\n    email: state.userinfo.email\n  };\n}, {})(injectIntl(withRouter(Container)));","map":{"version":3,"sources":["/Users/jimmy/Documents/Wizschool/wizlab_web2/src/Page/Home/Container.js"],"names":["React","Component","connect","View","request","withRouter","injectIntl","PAGETYPE","generatePID","PopUp","showPopUp","detectIE","SignIn","Container","props","handleWindowResize","window","innerWidth","state","isMobile","setState","handleSubscribe","e","index","email","subscribe","lastLikeTime","Date","getTime","intl","formatMessage","id","darkmode","mobileFullscreen","target","classList","toggle","params","creatorEmail","addSubscribe","then","res","json","rankUsers","subscribeCount","removeSubscribe","success","getMyProjects","currentPage","keyword","pageOffset","Math","ceil","pageSize","limit","encodeURIComponent","offset","getDevelopingProjects","result","count","rows","prev","myprojects","concat","myprojectCnt","catch","err","console","error","loadTemplateByHome","templateId","templateProjects","length","forEach","element","Number","createNewProject","localStorage","removeItem","getWizlabEvents","wizEvent","events","getrecommendedGames","getEditorRecommends","wizappInfo","recommendedGames","getWeeklyProjectsByType","type","weeklyTabType","weeklyProjects","getRankingByType","rankTabType","item","isSubscribe","onClickLink","location","getCreator","handleWeeklyProjectTab","tabType","handleCreatorRankTab","handleClickCodeBtn","add","onClickCreate","setItem","open","template","pageURL","BUILDER","history","replace","pathname","reload","onScroll","wasPlayed","pageYOffset","videoRef","playPromise","play","setVideoRef","ref","handleClickBanner","url","isLogin","includes","push","hash","isIE","isSubscribed","undefined","addEventListener","getTemplateProjects","removeEventListener","onPressBestGame","userinfo"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport { connect } from \"react-redux\";\nimport View from \"./View\";\nimport * as request from \"../../Common/Util/HTTPRequest\";\nimport { withRouter } from \"react-router-dom\";\nimport { injectIntl } from \"react-intl\";\nimport { PAGETYPE } from \"../../Common/Util/Constant\";\nimport generatePID from \"../../Common/Util/PIDGenerator\";\nimport PopUp, { showPopUp } from \"../../Common/Component/PopUp\";\n// import * as TrackingUtil from \"../../Common/Util/TrackingUtil\";\nimport { detectIE } from \"../../Common/Util/detectBrowser\";\nimport SignIn from \"../../Common/Component/SignIn\";\n\nclass Container extends Component {\n  constructor(props) {\n    super(props);\n\n    if (window.location.hash) {\n      props.history.replace(window.location.hash.replace(\"#\", \"\"));\n    }\n\n    this.isIE = detectIE();\n    this.wasPlayed = false;\n    this.state = {\n      // popUsers: undefined,\n      // videoRef: undefined,\n      wizEvent: [],\n      recommendedGames: [],\n      rankUsers: [],\n      weeklyProjects: [],\n      templateProjects: [],\n      isSubscribed: undefined,\n      weeklyTabType: \"like\",\n      rankTabType: \"likeCount\",\n      isMobile: window.innerWidth < 1080\n    };\n    this.pageSize = 50;\n  }\n\n  async componentDidMount() {\n    // TrackingUtil.sendPageEvent(\"/home\", this.props.email);\n    await this.getWizlabEvents();\n    await this.getrecommendedGames();\n    await this.getRankingByType();\n    await this.getWeeklyProjectsByType();\n    window.addEventListener(\"resize\", this.handleWindowResize);\n    this.handleWindowResize();\n\n    if (!this.isIE) {\n      window.addEventListener(\"scroll\", this.onScroll);\n    }\n\n    this.getMyProjects({ currentPage: 1, keyword: \"\" });\n    request\n      .getTemplateProjects()\n      .then(res => res.json())\n      .then(json => {\n        this.setState({ templateProjects: json }, () => {\n          this.loadTemplateByHome();\n        });\n      })\n      .catch(e => {\n        console.error(e);\n      });\n  }\n\n  componentWillUnmount() {\n    window.addEventListener(\"resize\", this.handleWindowResize);\n    if (!this.isIE) {\n      window.removeEventListener(\"scroll\", this.onScroll);\n    }\n  }\n\n  handleWindowResize = () => {\n    if (window.innerWidth < 1080 && !this.state.isMobile) {\n      this.setState({ isMobile: true });\n    }\n    if (window.innerWidth >= 1080 && this.state.isMobile) {\n      this.setState({ isMobile: false });\n    }\n  };\n\n  handleSubscribe = (e, index, email, subscribe) => {\n    if (this.lastLikeTime) {\n      if (new Date().getTime() - this.lastLikeTime < 1200) {\n        this.lastLikeTime = new Date().getTime();\n        showPopUp(\n          <PopUp.OneButton\n            title={this.props.intl.formatMessage({\n              id: \"ID_POPUP_WARNING_REPEAT_CLICK_TITLE\"\n            })}\n            buttonName={this.props.intl.formatMessage({\n              id: \"ID_POPUP_WARNING_REPEAT_CLICK_BTN\"\n            })}\n          />,\n          { darkmode: true }\n        );\n        return;\n      }\n    }\n    this.lastLikeTime = new Date().getTime();\n\n    if (!this.props.email) {\n      showPopUp(<SignIn />, {\n        darkmode: true,\n        mobileFullscreen: true\n      });\n      return;\n    }\n    e.target.classList.toggle(\"click\");\n    const params = { creatorEmail: email, email: this.props.email };\n    if (subscribe) {\n      request\n        .addSubscribe(params)\n        .then(res => res.json())\n        .then(json => {\n          if (json) {\n            let target = this.state.rankUsers;\n            target[index].subscribe = true;\n            target[index].subscribeCount =\n              this.state.rankUsers[index].subscribeCount + 1;\n            this.setState({ rankUsers: target });\n          } else {\n            showPopUp(\n              <PopUp.OneButton\n                title={this.props.intl.formatMessage({\n                  id: \"ID_POPUP_WARNING_REPEAT_CLICK_TITLE\"\n                })}\n                buttonName={this.props.intl.formatMessage({\n                  id: \"ID_POPUP_WARNING_REPEAT_CLICK_BTN\"\n                })}\n              />,\n              { darkmode: true }\n            );\n          }\n        });\n    } else {\n      request\n        .removeSubscribe(params)\n        .then(res => res.json())\n        .then(json => {\n          if (json.success) {\n            let target = this.state.rankUsers;\n            target[index].subscribe = false;\n            target[index].subscribeCount =\n              this.state.rankUsers[index].subscribeCount - 1;\n            this.setState({ rankUsers: target });\n          } else {\n            showPopUp(\n              <PopUp.OneButton\n                title={this.props.intl.formatMessage({\n                  id: \"ID_POPUP_WARNING_REPEAT_CLICK_TITLE\"\n                })}\n                buttonName={this.props.intl.formatMessage({\n                  id: \"ID_POPUP_WARNING_REPEAT_CLICK_BTN\"\n                })}\n              />,\n              { darkmode: true }\n            );\n          }\n        });\n    }\n  };\n\n  getMyProjects = props => {\n    if (!this.props.email) return;\n    let { currentPage, keyword } = props;\n    let pageOffset = Math.ceil((currentPage - 1) * this.pageSize);\n    let limit = this.pageSize;\n    keyword = encodeURIComponent(keyword);\n\n    let params = {\n      email: this.props.email,\n      offset: pageOffset,\n      limit: limit,\n      keyword: keyword\n    };\n\n    request\n      .getDevelopingProjects(params)\n      .then(res => res.json())\n      .then(result => {\n        const { count, rows } = result;\n        this.setState(prev => {\n          return {\n            myprojects: currentPage === 1 ? rows : prev.myprojects.concat(rows),\n            myprojectCnt: count\n          };\n        });\n      })\n      .catch(err => console.error(err));\n  };\n\n  loadTemplateByHome = () => {\n    if (this.templateId && this.state.templateProjects.length > 0) {\n      this.state.templateProjects.forEach(element => {\n        if (element.id === Number(this.templateId)) {\n          this.createNewProject(element);\n          localStorage.removeItem(\"templateId\");\n          return;\n        }\n      });\n    }\n  };\n\n  getWizlabEvents = async () => {\n    const wizEvent = await request\n      .getWizlabEvents()\n      .then(res => res.json())\n      .catch(e => console.error(e));\n\n    this.setState({ wizEvent: wizEvent.events });\n  };\n\n  getrecommendedGames = async () => {\n    const wizappInfo = await request\n      .getEditorRecommends({ limit: 4 })\n      .then(res => res.json())\n      .catch(e => console.error(e));\n\n    this.setState({\n      recommendedGames: wizappInfo\n    });\n  };\n\n  getWeeklyProjectsByType = async () => {\n    const weeklyProjects = await request\n      .getWeeklyProjectsByType({ type: this.state.weeklyTabType, limit: 10 })\n      .then(res => res.json())\n      .catch(e => console.error(e));\n\n    this.setState({ weeklyProjects });\n  };\n\n  getRankingByType = async () => {\n    const rankUsers = await request\n      .getRankingByType({\n        type: this.state.rankTabType\n      })\n      .then(res => res.json())\n      .catch(e => console.error(e));\n\n    for (const item of rankUsers) {\n      if (this.props.email) {\n        await request\n          .isSubscribe({\n            email: this.props.email,\n            creatorEmail: item.email\n          })\n          .then(res => res.json())\n          .then(json => {\n            item.subscribe = json.isSubscribe;\n          });\n      } else {\n        item.subscribe = false;\n      }\n    }\n    this.setState({ rankUsers });\n  };\n\n  onClickLink = id => {\n    window.location = `/userpage/${id}`;\n  };\n\n  getCreator = creatorEmail => {\n    request\n      .isSubscribe({\n        email: this.props.email,\n        creatorEmail: creatorEmail\n      })\n      .then(res => res.json())\n      .catch(e => console.error(e));\n  };\n\n  handleWeeklyProjectTab = tabType => {\n    this.setState({ weeklyTabType: tabType }, () => {\n      this.getWeeklyProjectsByType();\n    });\n  };\n\n  handleCreatorRankTab = tabType => {\n    this.setState({ rankTabType: tabType }, () => {\n      this.getRankingByType();\n    });\n  };\n\n  handleClickCodeBtn = target => {\n    target.classList.add(\"click\");\n  };\n\n  onClickCreate = templateId => {\n    localStorage.setItem(\"templateId\", templateId);\n    window.open(\"/builder\");\n  };\n\n  createNewProject = template => {\n    const { email } = this.props;\n    if (email) {\n      // const isEmptyTemplete = template.order === 0;\n\n      let pageURL = `/${PAGETYPE.BUILDER}/${generatePID(email)}`;\n      if (template.id) {\n        pageURL += `/${template.id}`;\n      }\n\n      this.props.history.replace({\n        pathname: pageURL\n      });\n      window.location.reload();\n    } else {\n      let pageURL = `/${PAGETYPE.BUILDER}?t=${template.id}`;\n      this.props.history.replace({\n        pathname: pageURL\n      });\n      window.location.reload();\n    }\n  };\n\n  onScroll = e => {\n    if (!this.wasPlayed && window.pageYOffset > 350) {\n      const { videoRef } = this.state;\n      if (videoRef) {\n        const playPromise = videoRef.play();\n        playPromise\n          .then(() => {\n            this.wasPlayed = true;\n          })\n          .catch(() => {\n            console.error(\"play\");\n          });\n      }\n    }\n  };\n\n  setVideoRef = ref => {\n    this.setState({ videoRef: ref });\n  };\n\n  handleClickBanner = (url, isLogin) => {\n    if (isLogin) {\n      if (this.props.email) {\n        if (url.includes(\"http\")) {\n          window.open(url);\n        } else {\n          this.props.history.push(url);\n        }\n      } else {\n        showPopUp(<SignIn />, { darkmode: true, mobileFullscreen: true });\n      }\n    } else {\n      if (url.includes(\"https\")) {\n        window.open(url);\n      } else {\n        this.props.history.push(url);\n      }\n    }\n  };\n\n  render() {\n    const {\n      wizEvent,\n      recommendedGames,\n      weeklyProjects,\n      rankUsers,\n      templateProjects,\n      weeklyTabType,\n      rankTabType,\n      isMobile\n    } = this.state;\n    const {\n      onClickCreate,\n      setVideoRef,\n      handleClickCodeBtn,\n      onPressBestGame,\n      handleSubscribe,\n      createNewProject,\n      onClickLink,\n      handleWeeklyProjectTab,\n      handleCreatorRankTab,\n      handleClickBanner\n    } = this;\n    return (\n      <View\n        isMobile={isMobile}\n        wizEvent={wizEvent}\n        recommendedGames={recommendedGames}\n        weeklyProjects={weeklyProjects}\n        rankUsers={rankUsers}\n        templateProjects={templateProjects}\n        intl={this.props.intl}\n        onClickCreate={onClickCreate}\n        onPressBestGame={onPressBestGame}\n        setVideoRef={setVideoRef}\n        handleClickCodeBtn={handleClickCodeBtn}\n        handleSubscribe={handleSubscribe}\n        createNewProject={createNewProject}\n        weeklyTabType={weeklyTabType}\n        rankTabType={rankTabType}\n        onClickLink={onClickLink}\n        handleCreatorRankTab={handleCreatorRankTab}\n        handleWeeklyProjectTab={handleWeeklyProjectTab}\n        handleClickBanner={handleClickBanner}\n      />\n    );\n  }\n}\n\nexport default connect(\n  state => ({\n    email: state.userinfo.email\n  }),\n  {}\n)(injectIntl(withRouter(Container)));\n"]},"metadata":{},"sourceType":"module"}