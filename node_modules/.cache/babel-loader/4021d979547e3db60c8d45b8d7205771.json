{"ast":null,"code":"import _regeneratorRuntime from \"/Users/jimmy/Documents/Wizschool/wizlab_web2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/jimmy/Documents/Wizschool/wizlab_web2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"/Users/jimmy/Documents/Wizschool/wizlab_web2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/jimmy/Documents/Wizschool/wizlab_web2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/jimmy/Documents/Wizschool/wizlab_web2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/jimmy/Documents/Wizschool/wizlab_web2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/jimmy/Documents/Wizschool/wizlab_web2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/Users/jimmy/Documents/Wizschool/wizlab_web2/src/Page/Builder/Component/Home/Container.js\";\nimport React, { Component } from \"react\";\nimport { connect } from \"react-redux\";\nimport { injectIntl } from \"react-intl\";\nimport { withRouter } from \"react-router-dom\";\nimport * as request from \"../../../../Common/Util/HTTPRequest\";\nimport PopUp, { showPopUp } from \"../../../../Common/Component/PopUp\";\nimport PublishPopup from \"../../../../Common/Component/Publish\";\nimport generatePID from \"../../../../Common/Util/PIDGenerator\";\nimport View from \"./View\";\nimport homeOnIcon from \"../../../../Image/icon-home-pressed.svg\";\nimport homeOffIcon from \"../../../../Image/icon-home-default.svg\";\nimport createOnIcon from \"../../../../Image/icon-create-pressed.svg\";\nimport createOffIcon from \"../../../../Image/icon-create-default.svg\";\nimport openOnIcon from \"../../../../Image/icon-open-pressed.svg\";\nimport openOffIcon from \"../../../../Image/icon-open-default.svg\";\nimport publishingOnIcon from \"../../../../Image/icon-publishing-pressed.svg\";\nimport publishingOffIcon from \"../../../../Image/icon-publishing-default.svg\";\n\nvar Container =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(Container, _Component);\n\n  function Container(props) {\n    var _this;\n\n    _classCallCheck(this, Container);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(Container).call(this, props));\n\n    _this.onClickPage = function (pageId) {\n      _this.resetSelectProject();\n\n      _this.setCurrentPage(pageId);\n    };\n\n    _this.setCurrentPage = function (pageId) {\n      _this.setState({\n        currentPageId: pageId\n      });\n    };\n\n    _this.resetSelectProject = function () {\n      _this.setState({\n        selectProject: {}\n      });\n    };\n\n    _this.handleEdit = function (pId, name, callback) {\n      _this.resetSelectProject();\n\n      showPopUp(React.createElement(PopUp.OneInput, {\n        titleId: \"ID_PROJECT_POPUP_EDIT_TITLE\",\n        defaultInput: name,\n        buttonNameId: \"ID_PROJECT_POPUP_EDIT_OK\",\n        buttonAction: function buttonAction(newVal) {\n          _this.editProject(pId, newVal, callback);\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 77\n        },\n        __self: this\n      }), {\n        dismissOverlay: true\n      });\n    };\n\n    _this.editProject = function (pId, newName, callback) {\n      _this.resetSelectProject();\n\n      request.updateDevelopingProject({\n        pId: pId,\n        name: newName\n      }).then(function (res) {\n        return res.json;\n      }).then(function (json) {\n        callback(pId, newName); // this.getMyProjects({\n        //   currentPage: this.state.currentPage,\n        //   keyword: this.state.keyword\n        // });\n      }).catch(function (e) {\n        return console.error(e);\n      });\n    };\n\n    _this.onClickProjectEdit = function (published) {\n      showPopUp(React.createElement(PublishPopup, {\n        pId: published.pId,\n        isDeveloping: false,\n        publishCallback: _this.updateItemInfo,\n        isBuilder: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 104\n        },\n        __self: this\n      }), {\n        defaultPadding: false,\n        scrollable: true\n      });\n    };\n\n    _this.onClickDetailBtn = function (pId, type) {\n      if (_this.state.selectProject.pId === pId) {\n        _this.resetSelectProject();\n      } else {\n        _this.setState({\n          selectProject: {\n            pId: pId,\n            type: type\n          }\n        });\n      }\n    };\n\n    _this.handleDelete =\n    /*#__PURE__*/\n    function () {\n      var _ref = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee(pId, callback) {\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.next = 2;\n                return request.deleteDevelopingProject({\n                  pId: pId,\n                  email: _this.props.email\n                });\n\n              case 2:\n                // let result = await res.json();\n                request.deleteDevelopingProject({\n                  pId: pId,\n                  email: _this.props.email\n                }).then(function (res) {\n                  return res.json();\n                }).then(function () {\n                  callback();\n                }).catch(function (e) {\n                  console.error(e);\n                });\n\n              case 3:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      return function (_x, _x2) {\n        return _ref.apply(this, arguments);\n      };\n    }();\n\n    _this.handleCopy =\n    /*#__PURE__*/\n    function () {\n      var _ref2 = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee2(pId, callback) {\n        var res, project, param;\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                _context2.next = 2;\n                return request.getDevelopingProject({\n                  pId: pId\n                });\n\n              case 2:\n                res = _context2.sent;\n                _context2.next = 5;\n                return res.json();\n\n              case 5:\n                project = _context2.sent;\n\n                if (project) {\n                  param = {\n                    pId: generatePID(_this.props.email),\n                    email: project.email,\n                    icon: project.icon,\n                    name: \"\".concat(project.name, \" copy\"),\n                    state: project.state,\n                    url: project.url,\n                    useCustomIcon: project.useCustomIcon\n                  };\n                  request.copyDevelopingProject({\n                    param: param\n                  }).then(function (res) {\n                    return res.json();\n                  }).then(function () {\n                    callback();\n                  }).catch(function (e) {\n                    return console.error(e);\n                  });\n                }\n\n              case 7:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n\n      return function (_x3, _x4) {\n        return _ref2.apply(this, arguments);\n      };\n    }();\n\n    _this.state = {\n      currentPageId: props.email ? \"main\" : \"makingNew\",\n      selectProject: {}\n    };\n\n    if (props.email) {\n      _this.pageList = [{\n        title: \"Home\",\n        id: \"main\",\n        onImg: homeOnIcon,\n        offImg: homeOffIcon\n      }, {\n        title: \"Making New\",\n        id: \"makingNew\",\n        onImg: createOnIcon,\n        offImg: createOffIcon\n      }, {\n        title: \"Open\",\n        id: \"myProject\",\n        onImg: openOnIcon,\n        offImg: openOffIcon\n      }, {\n        title: \"Published Apps\",\n        id: \"myPublished\",\n        onImg: publishingOnIcon,\n        offImg: publishingOffIcon\n      }];\n    } else {\n      _this.pageList = [{\n        title: \"Making New\",\n        id: \"makingNew\",\n        onImg: createOnIcon,\n        offImg: createOffIcon\n      }];\n    }\n\n    return _this;\n  }\n\n  _createClass(Container, [{\n    key: \"render\",\n    value: function render() {\n      var _this$props = this.props,\n          canClose = _this$props.canClose,\n          closeProjectPopup = _this$props.closeProjectPopup;\n      var pageList = this.pageList,\n          onClickPage = this.onClickPage,\n          setCurrentPage = this.setCurrentPage,\n          handleEdit = this.handleEdit,\n          onClickProjectEdit = this.onClickProjectEdit,\n          onClickDetailBtn = this.onClickDetailBtn,\n          resetSelectProject = this.resetSelectProject,\n          handleDelete = this.handleDelete,\n          handleCopy = this.handleCopy;\n      var _this$state = this.state,\n          currentPageId = _this$state.currentPageId,\n          selectProject = _this$state.selectProject;\n      return React.createElement(View, {\n        pageList: pageList,\n        onClickPage: onClickPage,\n        currentPageId: currentPageId,\n        setCurrentPage: setCurrentPage,\n        canClose: canClose,\n        closeProjectPopup: closeProjectPopup,\n        handleEdit: handleEdit,\n        handleDelete: handleDelete,\n        handleCopy: handleCopy,\n        onClickProjectEdit: onClickProjectEdit,\n        resetSelectProject: resetSelectProject,\n        onClickDetailBtn: onClickDetailBtn,\n        selectProject: selectProject,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 176\n        },\n        __self: this\n      });\n    }\n  }]);\n\n  return Container;\n}(Component);\n\nexport default connect(function (state) {\n  return {\n    email: state.userinfo.email,\n    userId: state.userinfo.id\n  };\n}, {})(injectIntl(withRouter(Container)));","map":{"version":3,"sources":["/Users/jimmy/Documents/Wizschool/wizlab_web2/src/Page/Builder/Component/Home/Container.js"],"names":["React","Component","connect","injectIntl","withRouter","request","PopUp","showPopUp","PublishPopup","generatePID","View","Container","props","onClickPage","pageId","resetSelectProject","setCurrentPage","setState","currentPageId","selectProject","handleEdit","pId","name","callback","newVal","editProject","dismissOverlay","newName","updateDevelopingProject","then","res","json","catch","e","console","error","onClickProjectEdit","published","updateItemInfo","defaultPadding","scrollable","onClickDetailBtn","type","state","handleDelete","deleteDevelopingProject","email","handleCopy","getDevelopingProject","project","param","icon","url","useCustomIcon","copyDevelopingProject","pageList","title","id","onImg","homeOnIcon","offImg","homeOffIcon","createOnIcon","createOffIcon","openOnIcon","openOffIcon","publishingOnIcon","publishingOffIcon","canClose","closeProjectPopup","userinfo","userId"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport { connect } from \"react-redux\";\nimport { injectIntl } from \"react-intl\";\nimport { withRouter } from \"react-router-dom\";\nimport * as request from \"../../../../Common/Util/HTTPRequest\";\nimport PopUp, { showPopUp } from \"../../../../Common/Component/PopUp\";\nimport PublishPopup from \"../../../../Common/Component/Publish\";\nimport generatePID from \"../../../../Common/Util/PIDGenerator\";\n\nimport View from \"./View\";\n\nimport homeOnIcon from \"../../../../Image/icon-home-pressed.svg\";\nimport homeOffIcon from \"../../../../Image/icon-home-default.svg\";\nimport createOnIcon from \"../../../../Image/icon-create-pressed.svg\";\nimport createOffIcon from \"../../../../Image/icon-create-default.svg\";\nimport openOnIcon from \"../../../../Image/icon-open-pressed.svg\";\nimport openOffIcon from \"../../../../Image/icon-open-default.svg\";\nimport publishingOnIcon from \"../../../../Image/icon-publishing-pressed.svg\";\nimport publishingOffIcon from \"../../../../Image/icon-publishing-default.svg\";\n\nclass Container extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      currentPageId: props.email ? \"main\" : \"makingNew\",\n      selectProject: {}\n    };\n    if (props.email) {\n      this.pageList = [\n        { title: \"Home\", id: \"main\", onImg: homeOnIcon, offImg: homeOffIcon },\n        {\n          title: \"Making New\",\n          id: \"makingNew\",\n          onImg: createOnIcon,\n          offImg: createOffIcon\n        },\n        {\n          title: \"Open\",\n          id: \"myProject\",\n          onImg: openOnIcon,\n          offImg: openOffIcon\n        },\n        {\n          title: \"Published Apps\",\n          id: \"myPublished\",\n          onImg: publishingOnIcon,\n          offImg: publishingOffIcon\n        }\n      ];\n    } else {\n      this.pageList = [\n        {\n          title: \"Making New\",\n          id: \"makingNew\",\n          onImg: createOnIcon,\n          offImg: createOffIcon\n        }\n      ];\n    }\n  }\n  onClickPage = pageId => {\n    this.resetSelectProject();\n    this.setCurrentPage(pageId);\n  };\n\n  setCurrentPage = pageId => {\n    this.setState({ currentPageId: pageId });\n  };\n\n  resetSelectProject = () => {\n    this.setState({ selectProject: {} });\n  };\n\n  handleEdit = (pId, name, callback) => {\n    this.resetSelectProject();\n    showPopUp(\n      <PopUp.OneInput\n        titleId=\"ID_PROJECT_POPUP_EDIT_TITLE\"\n        defaultInput={name}\n        buttonNameId=\"ID_PROJECT_POPUP_EDIT_OK\"\n        buttonAction={newVal => {\n          this.editProject(pId, newVal, callback);\n        }}\n      />,\n      { dismissOverlay: true }\n    );\n  };\n  editProject = (pId, newName, callback) => {\n    this.resetSelectProject();\n    request\n      .updateDevelopingProject({ pId, name: newName })\n      .then(res => res.json)\n      .then(json => {\n        callback(pId, newName);\n        // this.getMyProjects({\n        //   currentPage: this.state.currentPage,\n        //   keyword: this.state.keyword\n        // });\n      })\n      .catch(e => console.error(e));\n  };\n  onClickProjectEdit = published => {\n    showPopUp(\n      <PublishPopup\n        pId={published.pId}\n        isDeveloping={false}\n        publishCallback={this.updateItemInfo}\n        isBuilder={true}\n      />,\n      { defaultPadding: false, scrollable: true }\n    );\n  };\n  onClickDetailBtn = (pId, type) => {\n    if (this.state.selectProject.pId === pId) {\n      this.resetSelectProject();\n    } else {\n      this.setState({ selectProject: { pId, type } });\n    }\n  };\n\n  handleDelete = async (pId, callback) => {\n    await request.deleteDevelopingProject({\n      pId,\n      email: this.props.email\n    });\n    // let result = await res.json();\n    request\n      .deleteDevelopingProject({ pId, email: this.props.email })\n      .then(res => res.json())\n      .then(() => {\n        callback();\n      })\n      .catch(e => {\n        console.error(e);\n      });\n  };\n  handleCopy = async (pId, callback) => {\n    const res = await request.getDevelopingProject({ pId });\n    const project = await res.json();\n    if (project) {\n      const param = {\n        pId: generatePID(this.props.email),\n        email: project.email,\n        icon: project.icon,\n        name: `${project.name} copy`,\n        state: project.state,\n        url: project.url,\n        useCustomIcon: project.useCustomIcon\n      };\n\n      request\n        .copyDevelopingProject({ param })\n        .then(res => res.json())\n        .then(() => {\n          callback();\n        })\n        .catch(e => console.error(e));\n    }\n  };\n\n  render() {\n    const { canClose, closeProjectPopup } = this.props;\n    const {\n      pageList,\n      onClickPage,\n      setCurrentPage,\n      handleEdit,\n      onClickProjectEdit,\n      onClickDetailBtn,\n      resetSelectProject,\n      handleDelete,\n      handleCopy\n    } = this;\n    const { currentPageId, selectProject } = this.state;\n    return (\n      <View\n        pageList={pageList}\n        onClickPage={onClickPage}\n        currentPageId={currentPageId}\n        setCurrentPage={setCurrentPage}\n        canClose={canClose}\n        closeProjectPopup={closeProjectPopup}\n        handleEdit={handleEdit}\n        handleDelete={handleDelete}\n        handleCopy={handleCopy}\n        onClickProjectEdit={onClickProjectEdit}\n        resetSelectProject={resetSelectProject}\n        onClickDetailBtn={onClickDetailBtn}\n        selectProject={selectProject}\n      />\n    );\n  }\n}\nexport default connect(\n  state => ({ email: state.userinfo.email, userId: state.userinfo.id }),\n  {}\n)(injectIntl(withRouter(Container)));\n"]},"metadata":{},"sourceType":"module"}