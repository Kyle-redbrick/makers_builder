{"ast":null,"code":"import _objectSpread from \"/Users/jimmy/Documents/Wizschool/astroboy/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nimport _regeneratorRuntime from \"/Users/jimmy/Documents/Wizschool/astroboy/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/jimmy/Documents/Wizschool/astroboy/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"/Users/jimmy/Documents/Wizschool/astroboy/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/jimmy/Documents/Wizschool/astroboy/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _inherits from \"/Users/jimmy/Documents/Wizschool/astroboy/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _possibleConstructorReturn from \"/Users/jimmy/Documents/Wizschool/astroboy/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/jimmy/Documents/Wizschool/astroboy/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nvar _jsxFileName = \"/Users/jimmy/Documents/Wizschool/astroboy/src/Page/Builder/Component/Home/Component/MyPublished/Container.js\";\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\n\nimport React, { Component } from \"react\";\nimport { injectIntl } from \"react-intl\";\nimport { withRouter } from \"react-router-dom\";\nimport { connect } from \"react-redux\";\nimport { showPopUp } from \"../../../../../../Common/Component/PopUp\";\nimport { PAGETYPE } from \"../../../../../../Common/Util/Constant\";\nimport * as request from \"../../../../../../Common/Util/HTTPRequest\";\nimport View from \"./View\";\nimport PublishPopup from \"../../../../../../Common/Component/Publish\";\n\nvar Container = /*#__PURE__*/function (_Component) {\n  _inherits(Container, _Component);\n\n  var _super = _createSuper(Container);\n\n  function Container(props) {\n    var _this;\n\n    _classCallCheck(this, Container);\n\n    _this = _super.call(this, props);\n\n    _this.componentDidMount = function () {\n      if (!_this.props.email) return;\n    };\n\n    _this.fetchMyPublisheds = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      var _this$state, currentPage, dataType, keyword, pageOffset, params, res, myPublisheds;\n\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _this$state = _this.state, currentPage = _this$state.currentPage, dataType = _this$state.dataType, keyword = _this$state.keyword;\n              pageOffset = Math.ceil((currentPage - 1) * _this.pageSize);\n              params = {\n                type: dataType,\n                email: _this.props.email,\n                offset: pageOffset,\n                limit: _this.isFirstFetchData ? 60 : _this.pageSize,\n                keyword: keyword\n              };\n              _context.prev = 3;\n              _context.next = 6;\n              return request.getPublishedProjectsByType(params);\n\n            case 6:\n              res = _context.sent;\n              _context.next = 9;\n              return res.json();\n\n            case 9:\n              myPublisheds = _context.sent;\n              return _context.abrupt(\"return\", myPublisheds.rows.map(function (p) {\n                p.type = p.project.type;\n                return p;\n              }));\n\n            case 13:\n              _context.prev = 13;\n              _context.t0 = _context[\"catch\"](3);\n              console.log(_context.t0);\n              return _context.abrupt(\"return\", []);\n\n            case 17:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[3, 13]]);\n    }));\n\n    _this.isFirstFetchData = function () {\n      var currentPage = _this.state.currentPage;\n      return currentPage === 1;\n    };\n\n    _this.onClickShowProject = function (pId) {\n      if (!pId) return;\n\n      _this.props.history.push(\"?pId=\".concat(pId));\n    };\n\n    _this.onClickProject = function (pId, type) {\n      if (!pId) return;\n\n      _this.props.history.replace({\n        pathname: \"/\".concat(type === \"js3d\" ? PAGETYPE.BUILDER3D : PAGETYPE.BUILDER, \"/\").concat(pId)\n      });\n\n      type !== \"js3d\" && window.location.reload();\n    };\n\n    _this.handleOnScroll = function () {\n      var container = _this.projectsRef.current;\n\n      if (container.offsetHeight + container.scrollTop >= container.scrollHeight) {\n        _this.setState(function (prev) {\n          return {\n            currentPage: prev.currentPage + 1\n          };\n        }, /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n          var data;\n          return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n            while (1) {\n              switch (_context2.prev = _context2.next) {\n                case 0:\n                  _context2.next = 2;\n                  return _this.fetchMyPublisheds();\n\n                case 2:\n                  data = _context2.sent;\n\n                  _this.setState(function (prev) {\n                    return {\n                      myPublisheds: prev.myPublisheds.concat(data)\n                    };\n                  });\n\n                case 4:\n                case \"end\":\n                  return _context2.stop();\n              }\n            }\n          }, _callee2);\n        })));\n      }\n    };\n\n    _this.handleProjectLive = /*#__PURE__*/function () {\n      var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3(published) {\n        return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                published.live = !published.live;\n\n                if (!published.tags) {\n                  published.tags = [];\n                }\n\n                _context3.prev = 2;\n                _context3.next = 5;\n                return request.postPublishedProject(published);\n\n              case 5:\n                _this.updateItemInfo(published);\n\n                _context3.next = 11;\n                break;\n\n              case 8:\n                _context3.prev = 8;\n                _context3.t0 = _context3[\"catch\"](2);\n                console.error(_context3.t0);\n\n              case 11:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, null, [[2, 8]]);\n      }));\n\n      return function (_x) {\n        return _ref3.apply(this, arguments);\n      };\n    }();\n\n    _this.onClickProjectEdit = function (published) {\n      showPopUp(React.createElement(PublishPopup, {\n        pId: published.pId,\n        isDeveloping: false,\n        publishCallback: _this.updateItemInfo,\n        isBuilder: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 103\n        },\n        __self: this\n      }), {\n        defaultPadding: false,\n        scrollable: true\n      });\n    };\n\n    _this.updateItemInfo = function (params) {\n      _this.setState(function (state) {\n        return {\n          myPublisheds: state.myPublisheds.map(function (item) {\n            if (item.pId === params.pId) {\n              return _objectSpread({}, item, params);\n            } else {\n              return item;\n            }\n          })\n        };\n      });\n    };\n\n    _this.setFilteringData = function () {\n      var filteredType = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n      var keyword = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : \"\";\n\n      _this.setState({\n        currentPage: 1,\n        dataType: filteredType,\n        keyword: keyword\n      }, /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee4() {\n        var data;\n        return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                _context4.next = 2;\n                return _this.fetchMyPublisheds();\n\n              case 2:\n                data = _context4.sent;\n\n                _this.setState({\n                  myPublisheds: data\n                });\n\n              case 4:\n              case \"end\":\n                return _context4.stop();\n            }\n          }\n        }, _callee4);\n      })));\n    };\n\n    _this.state = {\n      dataType: [],\n      keyword: \"\",\n      myPublisheds: [],\n      currentPage: 1\n    };\n    _this.pageSize = 10;\n    _this.projectsRef = React.createRef();\n    return _this;\n  }\n\n  _createClass(Container, [{\n    key: \"render\",\n    value: function render() {\n      var _this$props = this.props,\n          onClickProjectEdit = _this$props.onClickProjectEdit,\n          onClickDetailBtn = _this$props.onClickDetailBtn,\n          selectProject = _this$props.selectProject;\n      var onClickProject = this.onClickProject,\n          onClickShowProject = this.onClickShowProject,\n          handleOnScroll = this.handleOnScroll,\n          projectsRef = this.projectsRef,\n          handleProjectLive = this.handleProjectLive,\n          setFilteringData = this.setFilteringData;\n      var myPublisheds = this.state.myPublisheds;\n      return React.createElement(View, {\n        myPublisheds: myPublisheds,\n        setFilteringData: setFilteringData,\n        onClickProject: onClickProject,\n        onClickShowProject: onClickShowProject,\n        handleOnScroll: handleOnScroll,\n        projectsRef: projectsRef,\n        handleProjectLive: handleProjectLive,\n        onClickProjectEdit: onClickProjectEdit,\n        onClickDetailBtn: onClickDetailBtn,\n        selectProject: selectProject,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 149\n        },\n        __self: this\n      });\n    }\n  }]);\n\n  return Container;\n}(Component);\n\nexport default connect(function (state) {\n  return {\n    email: state.userinfo.email\n  };\n}, {})(injectIntl(withRouter(Container)));","map":{"version":3,"sources":["/Users/jimmy/Documents/Wizschool/astroboy/src/Page/Builder/Component/Home/Component/MyPublished/Container.js"],"names":["React","Component","injectIntl","withRouter","connect","showPopUp","PAGETYPE","request","View","PublishPopup","Container","props","componentDidMount","email","fetchMyPublisheds","state","currentPage","dataType","keyword","pageOffset","Math","ceil","pageSize","params","type","offset","limit","isFirstFetchData","getPublishedProjectsByType","res","json","myPublisheds","rows","map","p","project","console","log","onClickShowProject","pId","history","push","onClickProject","replace","pathname","BUILDER3D","BUILDER","window","location","reload","handleOnScroll","container","projectsRef","current","offsetHeight","scrollTop","scrollHeight","setState","prev","data","concat","handleProjectLive","published","live","tags","postPublishedProject","updateItemInfo","error","onClickProjectEdit","defaultPadding","scrollable","item","setFilteringData","filteredType","createRef","onClickDetailBtn","selectProject","userinfo"],"mappings":";;;;;;;;;;;;;;AAAA,OAAOA,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC;AACA,SAASC,UAAT,QAA2B,YAA3B;AACA,SAASC,UAAT,QAA2B,kBAA3B;AACA,SAASC,OAAT,QAAwB,aAAxB;AACA,SAASC,SAAT,QAA0B,0CAA1B;AACA,SAASC,QAAT,QAAyB,wCAAzB;AACA,OAAO,KAAKC,OAAZ,MAAyB,2CAAzB;AACA,OAAOC,IAAP,MAAiB,QAAjB;AACA,OAAOC,YAAP,MAAyB,4CAAzB;;IAEMC,S;;;;;AACJ,qBAAYC,KAAZ,EAAmB;AAAA;;AAAA;;AACjB,8BAAMA,KAAN;;AADiB,UAYnBC,iBAZmB,GAYC,YAAM;AACxB,UAAI,CAAC,MAAKD,KAAL,CAAWE,KAAhB,EAAuB;AACxB,KAdkB;;AAAA,UAenBC,iBAfmB,yEAeC;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA,4BACuB,MAAKC,KAD5B,EACZC,WADY,eACZA,WADY,EACCC,QADD,eACCA,QADD,EACWC,OADX,eACWA,OADX;AAEdC,cAAAA,UAFc,GAEDC,IAAI,CAACC,IAAL,CAAU,CAACL,WAAW,GAAG,CAAf,IAAoB,MAAKM,QAAnC,CAFC;AAIdC,cAAAA,MAJc,GAIL;AACXC,gBAAAA,IAAI,EAAEP,QADK;AAEXJ,gBAAAA,KAAK,EAAE,MAAKF,KAAL,CAAWE,KAFP;AAGXY,gBAAAA,MAAM,EAAEN,UAHG;AAIXO,gBAAAA,KAAK,EAAE,MAAKC,gBAAL,GAAwB,EAAxB,GAA6B,MAAKL,QAJ9B;AAKXJ,gBAAAA,OAAO,EAAPA;AALW,eAJK;AAAA;AAAA;AAAA,qBAYAX,OAAO,CAACqB,0BAAR,CAAmCL,MAAnC,CAZA;;AAAA;AAYZM,cAAAA,GAZY;AAAA;AAAA,qBAaSA,GAAG,CAACC,IAAJ,EAbT;;AAAA;AAaZC,cAAAA,YAbY;AAAA,+CAcTA,YAAY,CAACC,IAAb,CAAkBC,GAAlB,CAAsB,UAAAC,CAAC,EAAI;AAChCA,gBAAAA,CAAC,CAACV,IAAF,GAASU,CAAC,CAACC,OAAF,CAAUX,IAAnB;AACA,uBAAOU,CAAP;AACD,eAHM,CAdS;;AAAA;AAAA;AAAA;AAmBhBE,cAAAA,OAAO,CAACC,GAAR;AAnBgB,+CAoBT,EApBS;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAfD;;AAAA,UAuCnBV,gBAvCmB,GAuCA,YAAM;AAAA,UACjBX,WADiB,GACD,MAAKD,KADJ,CACjBC,WADiB;AAEvB,aAAOA,WAAW,KAAK,CAAvB;AACD,KA1CkB;;AAAA,UA2CnBsB,kBA3CmB,GA2CE,UAAAC,GAAG,EAAI;AAC1B,UAAI,CAACA,GAAL,EAAU;;AACV,YAAK5B,KAAL,CAAW6B,OAAX,CAAmBC,IAAnB,gBAAgCF,GAAhC;AACD,KA9CkB;;AAAA,UA+CnBG,cA/CmB,GA+CF,UAACH,GAAD,EAAMf,IAAN,EAAe;AAC9B,UAAI,CAACe,GAAL,EAAU;;AACV,YAAK5B,KAAL,CAAW6B,OAAX,CAAmBG,OAAnB,CAA2B;AACzBC,QAAAA,QAAQ,aACNpB,IAAI,KAAK,MAAT,GAAkBlB,QAAQ,CAACuC,SAA3B,GAAuCvC,QAAQ,CAACwC,OAD1C,cAEJP,GAFI;AADiB,OAA3B;;AAKAf,MAAAA,IAAI,KAAK,MAAT,IAAmBuB,MAAM,CAACC,QAAP,CAAgBC,MAAhB,EAAnB;AACD,KAvDkB;;AAAA,UAyDnBC,cAzDmB,GAyDF,YAAM;AACrB,UAAMC,SAAS,GAAG,MAAKC,WAAL,CAAiBC,OAAnC;;AACA,UACEF,SAAS,CAACG,YAAV,GAAyBH,SAAS,CAACI,SAAnC,IACAJ,SAAS,CAACK,YAFZ,EAGE;AACA,cAAKC,QAAL,CACE,UAAAC,IAAI;AAAA,iBAAK;AACP1C,YAAAA,WAAW,EAAE0C,IAAI,CAAC1C,WAAL,GAAmB;AADzB,WAAL;AAAA,SADN,wEAIE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,yBACmB,MAAKF,iBAAL,EADnB;;AAAA;AACM6C,kBAAAA,IADN;;AAEE,wBAAKF,QAAL,CAAc,UAAAC,IAAI;AAAA,2BAAK;AACrB3B,sBAAAA,YAAY,EAAE2B,IAAI,CAAC3B,YAAL,CAAkB6B,MAAlB,CAAyBD,IAAzB;AADO,qBAAL;AAAA,mBAAlB;;AAFF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAJF;AAWD;AACF,KA3EkB;;AAAA,UA4EnBE,iBA5EmB;AAAA,2EA4EC,kBAAMC,SAAN;AAAA;AAAA;AAAA;AAAA;AAClBA,gBAAAA,SAAS,CAACC,IAAV,GAAiB,CAACD,SAAS,CAACC,IAA5B;;AACA,oBAAI,CAACD,SAAS,CAACE,IAAf,EAAqB;AACnBF,kBAAAA,SAAS,CAACE,IAAV,GAAiB,EAAjB;AACD;;AAJiB;AAAA;AAAA,uBAMVzD,OAAO,CAAC0D,oBAAR,CAA6BH,SAA7B,CANU;;AAAA;AAOhB,sBAAKI,cAAL,CAAoBJ,SAApB;;AAPgB;AAAA;;AAAA;AAAA;AAAA;AAShB1B,gBAAAA,OAAO,CAAC+B,KAAR;;AATgB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OA5ED;;AAAA;AAAA;AAAA;AAAA;;AAAA,UAyFnBC,kBAzFmB,GAyFE,UAAAN,SAAS,EAAI;AAChCzD,MAAAA,SAAS,CACP,oBAAC,YAAD;AACE,QAAA,GAAG,EAAEyD,SAAS,CAACvB,GADjB;AAEE,QAAA,YAAY,EAAE,KAFhB;AAGE,QAAA,eAAe,EAAE,MAAK2B,cAHxB;AAIE,QAAA,SAAS,EAAE,IAJb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QADO,EAOP;AAAEG,QAAAA,cAAc,EAAE,KAAlB;AAAyBC,QAAAA,UAAU,EAAE;AAArC,OAPO,CAAT;AASD,KAnGkB;;AAAA,UAoGnBJ,cApGmB,GAoGF,UAAA3C,MAAM,EAAI;AACzB,YAAKkC,QAAL,CAAc,UAAA1C,KAAK;AAAA,eAAK;AACtBgB,UAAAA,YAAY,EAAEhB,KAAK,CAACgB,YAAN,CAAmBE,GAAnB,CAAuB,UAAAsC,IAAI,EAAI;AAC3C,gBAAIA,IAAI,CAAChC,GAAL,KAAahB,MAAM,CAACgB,GAAxB,EAA6B;AAC3B,uCACKgC,IADL,EAEKhD,MAFL;AAID,aALD,MAKO;AACL,qBAAOgD,IAAP;AACD;AACF,WATa;AADQ,SAAL;AAAA,OAAnB;AAYD,KAjHkB;;AAAA,UAoHnBC,gBApHmB,GAoHA,YAAqC;AAAA,UAApCC,YAAoC,uEAArB,EAAqB;AAAA,UAAjBvD,OAAiB,uEAAP,EAAO;;AACtD,YAAKuC,QAAL,CACE;AAAEzC,QAAAA,WAAW,EAAE,CAAf;AAAkBC,QAAAA,QAAQ,EAAEwD,YAA5B;AAA0CvD,QAAAA,OAAO,EAAPA;AAA1C,OADF,wEAEE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uBACmB,MAAKJ,iBAAL,EADnB;;AAAA;AACM6C,gBAAAA,IADN;;AAEE,sBAAKF,QAAL,CAAc;AAAE1B,kBAAAA,YAAY,EAAE4B;AAAhB,iBAAd;;AAFF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAFF;AAOD,KA5HkB;;AAEjB,UAAK5C,KAAL,GAAa;AACXE,MAAAA,QAAQ,EAAE,EADC;AAEXC,MAAAA,OAAO,EAAE,EAFE;AAGXa,MAAAA,YAAY,EAAE,EAHH;AAIXf,MAAAA,WAAW,EAAE;AAJF,KAAb;AAMA,UAAKM,QAAL,GAAgB,EAAhB;AACA,UAAK8B,WAAL,GAAmBpD,KAAK,CAAC0E,SAAN,EAAnB;AATiB;AAUlB;;;;WAmHD,kBAAS;AAAA,wBACyD,KAAK/D,KAD9D;AAAA,UACCyD,kBADD,eACCA,kBADD;AAAA,UACqBO,gBADrB,eACqBA,gBADrB;AAAA,UACuCC,aADvC,eACuCA,aADvC;AAAA,UAGLlC,cAHK,GASH,IATG,CAGLA,cAHK;AAAA,UAILJ,kBAJK,GASH,IATG,CAILA,kBAJK;AAAA,UAKLY,cALK,GASH,IATG,CAKLA,cALK;AAAA,UAMLE,WANK,GASH,IATG,CAMLA,WANK;AAAA,UAOLS,iBAPK,GASH,IATG,CAOLA,iBAPK;AAAA,UAQLW,gBARK,GASH,IATG,CAQLA,gBARK;AAAA,UAUCzC,YAVD,GAUkB,KAAKhB,KAVvB,CAUCgB,YAVD;AAWP,aACE,oBAAC,IAAD;AACE,QAAA,YAAY,EAAEA,YADhB;AAEE,QAAA,gBAAgB,EAAEyC,gBAFpB;AAGE,QAAA,cAAc,EAAE9B,cAHlB;AAIE,QAAA,kBAAkB,EAAEJ,kBAJtB;AAKE,QAAA,cAAc,EAAEY,cALlB;AAME,QAAA,WAAW,EAAEE,WANf;AAOE,QAAA,iBAAiB,EAAES,iBAPrB;AAQE,QAAA,kBAAkB,EAAEO,kBARtB;AASE,QAAA,gBAAgB,EAAEO,gBATpB;AAUE,QAAA,aAAa,EAAEC,aAVjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QADF;AAcD;;;;EAvJqB3E,S;;AAyJxB,eAAeG,OAAO,CACpB,UAAAW,KAAK;AAAA,SAAK;AAAEF,IAAAA,KAAK,EAAEE,KAAK,CAAC8D,QAAN,CAAehE;AAAxB,GAAL;AAAA,CADe,EAEpB,EAFoB,CAAP,CAGbX,UAAU,CAACC,UAAU,CAACO,SAAD,CAAX,CAHG,CAAf","sourcesContent":["import React, { Component } from \"react\";\nimport { injectIntl } from \"react-intl\";\nimport { withRouter } from \"react-router-dom\";\nimport { connect } from \"react-redux\";\nimport { showPopUp } from \"../../../../../../Common/Component/PopUp\";\nimport { PAGETYPE } from \"../../../../../../Common/Util/Constant\";\nimport * as request from \"../../../../../../Common/Util/HTTPRequest\";\nimport View from \"./View\";\nimport PublishPopup from \"../../../../../../Common/Component/Publish\";\n\nclass Container extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      dataType: [],\n      keyword: \"\",\n      myPublisheds: [],\n      currentPage: 1\n    };\n    this.pageSize = 10;\n    this.projectsRef = React.createRef();\n  }\n\n  componentDidMount = () => {\n    if (!this.props.email) return;\n  };\n  fetchMyPublisheds = async () => {\n    let { currentPage, dataType, keyword } = this.state;\n    let pageOffset = Math.ceil((currentPage - 1) * this.pageSize);\n\n    let params = {\n      type: dataType,\n      email: this.props.email,\n      offset: pageOffset,\n      limit: this.isFirstFetchData ? 60 : this.pageSize,\n      keyword\n    };\n    try {\n      let res = await request.getPublishedProjectsByType(params);\n      let myPublisheds = await res.json();\n      return myPublisheds.rows.map(p => {\n        p.type = p.project.type;\n        return p;\n      });\n    } catch (error) {\n      console.log(error);\n      return [];\n    }\n  };\n\n  isFirstFetchData = () => {\n    let { currentPage } = this.state;\n    return currentPage === 1;\n  };\n  onClickShowProject = pId => {\n    if (!pId) return;\n    this.props.history.push(`?pId=${pId}`);\n  };\n  onClickProject = (pId, type) => {\n    if (!pId) return;\n    this.props.history.replace({\n      pathname: `/${\n        type === \"js3d\" ? PAGETYPE.BUILDER3D : PAGETYPE.BUILDER\n      }/${pId}`\n    });\n    type !== \"js3d\" && window.location.reload();\n  };\n  //TODO : have to refactoring\n  handleOnScroll = () => {\n    const container = this.projectsRef.current;\n    if (\n      container.offsetHeight + container.scrollTop >=\n      container.scrollHeight\n    ) {\n      this.setState(\n        prev => ({\n          currentPage: prev.currentPage + 1\n        }),\n        async () => {\n          let data = await this.fetchMyPublisheds();\n          this.setState(prev => ({\n            myPublisheds: prev.myPublisheds.concat(data)\n          }));\n        }\n      );\n    }\n  };\n  handleProjectLive = async published => {\n    published.live = !published.live;\n    if (!published.tags) {\n      published.tags = [];\n    }\n    try {\n      await request.postPublishedProject(published);\n      this.updateItemInfo(published);\n    } catch (e) {\n      console.error(e);\n    }\n  };\n\n  onClickProjectEdit = published => {\n    showPopUp(\n      <PublishPopup\n        pId={published.pId}\n        isDeveloping={false}\n        publishCallback={this.updateItemInfo}\n        isBuilder={true}\n      />,\n      { defaultPadding: false, scrollable: true }\n    );\n  };\n  updateItemInfo = params => {\n    this.setState(state => ({\n      myPublisheds: state.myPublisheds.map(item => {\n        if (item.pId === params.pId) {\n          return {\n            ...item,\n            ...params\n          };\n        } else {\n          return item;\n        }\n      })\n    }));\n  };\n\n  //TODO : have to refactoring\n  setFilteringData = (filteredType = [], keyword = \"\") => {\n    this.setState(\n      { currentPage: 1, dataType: filteredType, keyword },\n      async () => {\n        let data = await this.fetchMyPublisheds();\n        this.setState({ myPublisheds: data });\n      }\n    );\n  };\n  render() {\n    const { onClickProjectEdit, onClickDetailBtn, selectProject } = this.props;\n    const {\n      onClickProject,\n      onClickShowProject,\n      handleOnScroll,\n      projectsRef,\n      handleProjectLive,\n      setFilteringData\n    } = this;\n    const { myPublisheds } = this.state;\n    return (\n      <View\n        myPublisheds={myPublisheds}\n        setFilteringData={setFilteringData}\n        onClickProject={onClickProject}\n        onClickShowProject={onClickShowProject}\n        handleOnScroll={handleOnScroll}\n        projectsRef={projectsRef}\n        handleProjectLive={handleProjectLive}\n        onClickProjectEdit={onClickProjectEdit}\n        onClickDetailBtn={onClickDetailBtn}\n        selectProject={selectProject}\n      />\n    );\n  }\n}\nexport default connect(\n  state => ({ email: state.userinfo.email }),\n  {}\n)(injectIntl(withRouter(Container)));\n"]},"metadata":{},"sourceType":"module"}