{"ast":null,"code":"import _toConsumableArray from \"/Users/jimmy/Documents/Wizschool/wizlab_web2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _classCallCheck from \"/Users/jimmy/Documents/Wizschool/wizlab_web2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/jimmy/Documents/Wizschool/wizlab_web2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _inherits from \"/Users/jimmy/Documents/Wizschool/wizlab_web2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _possibleConstructorReturn from \"/Users/jimmy/Documents/Wizschool/wizlab_web2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/jimmy/Documents/Wizschool/wizlab_web2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nvar _jsxFileName = \"/Users/jimmy/Documents/Wizschool/wizlab_web2/src/Common/Component/Layout/Notification/Container.js\";\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\n\nimport React, { Component } from \"react\";\nimport { connect } from \"react-redux\";\nimport { withRouter } from \"react-router-dom\";\nimport * as request from \"../../../../Common/Util/HTTPRequest\"; // import * as TrackingUtil from \"../../../../Common/Util/TrackingUtil\";\n\nimport * as userInfoAction from \"../../../../Common/Store/Reducer/UserInfo\";\nimport View from \"./View\";\n\nvar Container = /*#__PURE__*/function (_Component) {\n  _inherits(Container, _Component);\n\n  var _super = _createSuper(Container);\n\n  function Container(props) {\n    var _this;\n\n    _classCallCheck(this, Container);\n\n    _this = _super.call(this, props);\n\n    _this.getData = function () {\n      var email = _this.props.email;\n      var limit = 20;\n      var offset = _this.state.notifications.length;\n      var params = {\n        email: email,\n        limit: limit,\n        offset: offset\n      };\n      request.getNotifications(params).then(function (response) {\n        return response.json();\n      }).then(function (json) {\n        var isListEnded = json.length === 0 || json.length % limit !== 0;\n\n        _this.setState(function (state) {\n          return {\n            notifications: [].concat(_toConsumableArray(state.notifications), _toConsumableArray(json)),\n            isListEnded: isListEnded\n          };\n        });\n      });\n    };\n\n    _this.handleOnClickMore = function () {\n      _this.getData();\n    };\n\n    _this.handleOnClickItem = function (noti) {\n      var link = undefined;\n      var isBlank = false;\n      var type = noti.type,\n          targetProjectPID = noti.targetProjectPID,\n          targetCommunityID = noti.targetCommunityID,\n          targetLectureID = noti.targetLectureID,\n          targetUser = noti.targetUser,\n          page = noti.link;\n\n      switch (type) {\n        //go to wizapp\n        case \"publishedComment\":\n        case \"publishedReply\":\n        case \"like\":\n        case \"playCount\":\n        case \"newApp\":\n          link = \"?pId=\".concat(targetProjectPID);\n          break;\n        //go to community\n\n        case \"articleComment\":\n        case \"articleReply\":\n          link = \"/community/detail/\".concat(targetCommunityID);\n          break;\n\n        case \"subscribe\":\n          link = \"/userpage/\".concat(targetUser.id);\n          break;\n\n        case \"notice\":\n        case \"custom\":\n          if (noti.link) {\n            link = noti.link;\n            isBlank = true;\n          }\n\n          break;\n        //dreamclass 대댓글 \n\n        case \"commentReply\":\n          link = \"/course/\".concat(targetLectureID);\n          break;\n\n        case \"socialReply\":\n          link = \"/social/\".concat(page);\n          break;\n\n        default:\n          break;\n      }\n\n      if (link) {\n        if (isBlank) {\n          window.open(link, \"_blank\");\n        } else {\n          try {\n            var currentLink = _this.props.location.pathname.split(\"/\")[1];\n\n            var newLink = link.split(\"/\")[1];\n\n            _this.props.history.push(link);\n\n            if (currentLink === newLink) {\n              window.location.reload();\n            }\n          } catch (e) {\n            console.error(e);\n          }\n        }\n      }\n\n      _this.onClickNotification();\n    };\n\n    _this.onClickNotification = function () {\n      if (_this.props.onClickNotification) {\n        _this.props.onClickNotification();\n      } else {\n        _this.props.history.goBack();\n      }\n    };\n\n    _this.state = {\n      notifications: [],\n      isListEnded: false\n    };\n    return _this;\n  }\n\n  _createClass(Container, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      // TrackingUtil.sendPageEvent(\"notification\", this.props.email);\n      this.getData();\n      request.updateUserInfo({\n        email: this.props.email,\n        badge: 0\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      if (!this.props.email) {\n        window.location.href = \"/\";\n        return React.createElement(\"div\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 114\n          },\n          __self: this\n        });\n      }\n\n      var _this$state = this.state,\n          notifications = _this$state.notifications,\n          isListEnded = _this$state.isListEnded;\n      var onClickNotification = this.onClickNotification;\n      return React.createElement(View, {\n        notifications: notifications,\n        handleOnClickMore: this.handleOnClickMore,\n        handleOnClickItem: this.handleOnClickItem,\n        onClickNotification: onClickNotification,\n        isListEnded: isListEnded,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 121\n        },\n        __self: this\n      });\n    }\n  }]);\n\n  return Container;\n}(Component);\n\nexport default connect(function (state) {\n  return {\n    email: state.userinfo.email\n  };\n}, {\n  updateUserInfo: userInfoAction.updateUserInfo\n})(withRouter(Container));","map":{"version":3,"sources":["/Users/jimmy/Documents/Wizschool/wizlab_web2/src/Common/Component/Layout/Notification/Container.js"],"names":["React","Component","connect","withRouter","request","userInfoAction","View","Container","props","getData","email","limit","offset","state","notifications","length","params","getNotifications","then","response","json","isListEnded","setState","handleOnClickMore","handleOnClickItem","noti","link","undefined","isBlank","type","targetProjectPID","targetCommunityID","targetLectureID","targetUser","page","id","window","open","currentLink","location","pathname","split","newLink","history","push","reload","e","console","error","onClickNotification","goBack","updateUserInfo","badge","href","userinfo"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport { connect } from \"react-redux\";\nimport { withRouter } from \"react-router-dom\";\nimport * as request from \"../../../../Common/Util/HTTPRequest\";\n// import * as TrackingUtil from \"../../../../Common/Util/TrackingUtil\";\nimport * as userInfoAction from \"../../../../Common/Store/Reducer/UserInfo\";\nimport View from \"./View\";\n\nclass Container extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      notifications: [],\n      isListEnded: false\n    };\n  }\n\n  componentDidMount() {\n    // TrackingUtil.sendPageEvent(\"notification\", this.props.email);\n    this.getData();\n    request.updateUserInfo({ email: this.props.email, badge: 0});\n  }\n\n  getData = () => {\n    const { email } = this.props;\n    const limit = 20;\n    const offset = this.state.notifications.length;\n    const params = { email, limit, offset };\n    request\n      .getNotifications(params)\n      .then(response => response.json())\n      .then(json => {\n        const isListEnded = json.length === 0 || json.length % limit !== 0;\n        this.setState(state => ({\n          notifications: [...state.notifications, ...json],\n          isListEnded: isListEnded\n        }));\n      });\n  };\n\n  handleOnClickMore = () => {\n    this.getData();\n  };\n\n  handleOnClickItem = noti => {\n    let link = undefined;\n    let isBlank = false;\n    const { type, targetProjectPID, targetCommunityID, targetLectureID, targetUser, link:page } = noti;\n    \n    switch (type) {\n      //go to wizapp\n      case \"publishedComment\":\n      case \"publishedReply\":\n      case \"like\": \n      case \"playCount\":\n      case \"newApp\":\n        link = `?pId=${targetProjectPID}`;\n        break;\n      //go to community\n      case \"articleComment\":\n      case \"articleReply\":\n        link = `/community/detail/${targetCommunityID}`;\n        break;\n      case \"subscribe\":\n        link = `/userpage/${targetUser.id}`;\n        break;\n      case \"notice\":\n      case \"custom\":\n        if (noti.link) {\n          link = noti.link;\n          isBlank = true;\n        }\n        break;\n        //dreamclass 대댓글 \n      case \"commentReply\":\n        link = `/course/${targetLectureID}`\n        break;\n      case \"socialReply\":\n        link = `/social/${page}`\n        break;\n      default:\n        break;\n    }\n    if (link) {\n      if (isBlank) {\n        window.open(link, \"_blank\");\n      } else {\n        try {\n          const currentLink = this.props.location.pathname.split(\"/\")[1];\n          const newLink = link.split(\"/\")[1];\n          this.props.history.push(link);\n          if (currentLink === newLink) {\n            window.location.reload();\n          }\n        } catch (e) {\n          console.error(e);\n        }\n      }\n    }\n    this.onClickNotification();\n  };\n\n  onClickNotification = () => {\n    if (this.props.onClickNotification) {\n      this.props.onClickNotification();\n    } else {\n      this.props.history.goBack();\n    }\n  };\n\n  render() {\n    if (!this.props.email) {\n      window.location.href = \"/\";\n      return <div />;\n    }\n\n    const { notifications, isListEnded } = this.state;\n    const { onClickNotification } = this;\n\n    return (\n      <View\n        notifications={notifications}\n        handleOnClickMore={this.handleOnClickMore}\n        handleOnClickItem={this.handleOnClickItem}\n        onClickNotification={onClickNotification}\n        isListEnded={isListEnded}\n      />\n    );\n  }\n}\n\nexport default connect(\n  state => ({ email: state.userinfo.email }),\n  { updateUserInfo: userInfoAction.updateUserInfo }\n)(withRouter(Container));\n"]},"metadata":{},"sourceType":"module"}