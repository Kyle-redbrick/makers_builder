{"ast":null,"code":"import _classCallCheck from \"/Users/jimmy/Documents/Wizschool/wizlab_web2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/jimmy/Documents/Wizschool/wizlab_web2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _inherits from \"/Users/jimmy/Documents/Wizschool/wizlab_web2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _possibleConstructorReturn from \"/Users/jimmy/Documents/Wizschool/wizlab_web2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/jimmy/Documents/Wizschool/wizlab_web2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nvar _jsxFileName = \"/Users/jimmy/Documents/Wizschool/wizlab_web2/src/Page/Builder/Component/DreamBuilder/WizMateManager/index.js\";\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\n\nimport React, { Component, createRef } from \"react\";\nimport { connect } from \"react-redux\";\nimport { injectIntl } from \"react-intl\";\nimport WizMate from \"../../../../../Common/Component/WizMate\";\nimport Condition from \"../ConditionChecker/condition\";\nimport \"./index.scss\";\nvar LOCATION = {\n  EDITOR: \"onEditor\",\n  GAME: \"onGame\",\n  PLAY_BUTTON: \"onPlayButton\"\n};\n\nvar WizMateManager = /*#__PURE__*/function (_Component) {\n  _inherits(WizMateManager, _Component);\n\n  var _super = _createSuper(WizMateManager);\n\n  function WizMateManager(props) {\n    var _this;\n\n    _classCallCheck(this, WizMateManager);\n\n    _this = _super.call(this, props);\n    _this.wizmateRef = createRef();\n    _this.state = {\n      location: LOCATION.EDITOR\n    };\n    return _this;\n  }\n\n  _createClass(WizMateManager, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.moveTo(LOCATION.EDITOR);\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate(prevProps) {\n      if (prevProps.isPlaying !== this.props.isPlaying) {\n        if (this.props.isPlaying) {\n          this.didStartPlaying();\n        } else {\n          this.didStopPlaying();\n        }\n      }\n\n      if (prevProps.isCodeConditionsClear !== this.props.isCodeConditionsClear) {\n        if (this.props.isCodeConditionsClear) {\n          this.didClearCodeConditions();\n        }\n      }\n    }\n  }, {\n    key: \"didStartPlaying\",\n    value: function didStartPlaying() {\n      this.moveTo(LOCATION.GAME);\n\n      if (!this.props.isCodeConditionsClear) {\n        this.didStartPlayingWithoutCodeClear();\n      }\n    }\n  }, {\n    key: \"didStartPlayingWithoutCodeClear\",\n    value: function didStartPlayingWithoutCodeClear() {\n      var _this2 = this;\n\n      setTimeout(function () {\n        _this2.error(_this2.props.intl.formatMessage({\n          id: \"ID_DREAM_BUILDER_WIZMATEMANAGER_CODE_ALERT\"\n        }));\n      }, 1000);\n    }\n  }, {\n    key: \"didStopPlaying\",\n    value: function didStopPlaying() {\n      this.moveTo(LOCATION.EDITOR);\n    }\n  }, {\n    key: \"didClearCodeConditions\",\n    value: function didClearCodeConditions() {\n      if (this.codeConditionExists && !this.props.isConditionsClear) {\n        this.speak(this.props.intl.formatMessage({\n          id: \"ID_DREAM_BUILDER_WIZMATEMANAGER_CODE_PLAY\"\n        }));\n      }\n    }\n  }, {\n    key: \"moveTo\",\n    value: function moveTo(location) {\n      this.setState({\n        location: location\n      });\n    }\n  }, {\n    key: \"speak\",\n    value: function speak(message, duration) {\n      if (this.wizmateRef.current) {\n        this.wizmateRef.current.speak(message, duration);\n      }\n    }\n  }, {\n    key: \"warn\",\n    value: function warn(message, duration) {\n      if (this.wizmateRef.current) {\n        this.wizmateRef.current.warn(message, duration);\n      }\n    }\n  }, {\n    key: \"error\",\n    value: function error(message, duration) {\n      if (this.wizmateRef.current) {\n        this.wizmateRef.current.error(message, duration);\n      }\n    }\n  }, {\n    key: \"stop\",\n    value: function stop(message, duration) {\n      if (this.wizmateRef.current) {\n        this.wizmateRef.current.stop(message, duration);\n      }\n    }\n  }, {\n    key: \"codeConditionExists\",\n    get: function get() {\n      return !!this.conditions.find(function (condition) {\n        return condition.isCodeType;\n      });\n    }\n  }, {\n    key: \"conditions\",\n    get: function get() {\n      var rawConditions = this.props.mission && this.props.mission.conditions || [];\n      return rawConditions.map(function (rawCondition) {\n        return Condition.create(rawCondition);\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      return /*#__PURE__*/React.createElement(\"div\", {\n        className: \"dream_wizmate dream_wizmate-\".concat(this.state.location),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 93,\n          columnNumber: 7\n        }\n      }, /*#__PURE__*/React.createElement(WizMate, {\n        ref: this.wizmateRef,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 94,\n          columnNumber: 9\n        }\n      }));\n    }\n  }]);\n\n  return WizMateManager;\n}(Component);\n\nexport default connect(function (state) {\n  return {\n    mission: state.dream.currentMission,\n    isPlaying: state.preview.isPlaying,\n    isConditionsClear: state.dream.isConditionsClear,\n    isCodeConditionsClear: state.dream.isCodeConditionsClear\n  };\n})(injectIntl(WizMateManager));","map":{"version":3,"sources":["/Users/jimmy/Documents/Wizschool/wizlab_web2/src/Page/Builder/Component/DreamBuilder/WizMateManager/index.js"],"names":["React","Component","createRef","connect","injectIntl","WizMate","Condition","LOCATION","EDITOR","GAME","PLAY_BUTTON","WizMateManager","props","wizmateRef","state","location","moveTo","prevProps","isPlaying","didStartPlaying","didStopPlaying","isCodeConditionsClear","didClearCodeConditions","didStartPlayingWithoutCodeClear","setTimeout","error","intl","formatMessage","id","codeConditionExists","isConditionsClear","speak","setState","message","duration","current","warn","stop","conditions","find","condition","isCodeType","rawConditions","mission","map","rawCondition","create","dream","currentMission","preview"],"mappings":"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","sourcesContent":["import React, { Component, createRef } from \"react\";\nimport { connect } from \"react-redux\";\nimport { injectIntl } from \"react-intl\";\nimport WizMate from \"../../../../../Common/Component/WizMate\";\nimport Condition from \"../ConditionChecker/condition\";\nimport \"./index.scss\"\n\nconst LOCATION = {\n  EDITOR: \"onEditor\",\n  GAME: \"onGame\",\n  PLAY_BUTTON: \"onPlayButton\"\n}\n\nclass WizMateManager extends Component {\n  constructor(props) {\n    super(props);\n    this.wizmateRef = createRef();\n    this.state = { location: LOCATION.EDITOR };\n  }\n  componentDidMount() {\n    this.moveTo(LOCATION.EDITOR);\n  }\n  componentDidUpdate(prevProps) {\n    if(prevProps.isPlaying !== this.props.isPlaying) {\n      if(this.props.isPlaying) {\n        this.didStartPlaying();\n      } else {\n        this.didStopPlaying();\n      }\n    }\n    if(prevProps.isCodeConditionsClear !== this.props.isCodeConditionsClear) {\n      if(this.props.isCodeConditionsClear) {\n        this.didClearCodeConditions();\n      }\n    }\n  }\n  didStartPlaying() {\n    this.moveTo(LOCATION.GAME);\n    if(!this.props.isCodeConditionsClear) {\n      this.didStartPlayingWithoutCodeClear();\n    }\n  }\n  didStartPlayingWithoutCodeClear() {\n    setTimeout(() => {\n      this.error(this.props.intl.formatMessage({ id: \"ID_DREAM_BUILDER_WIZMATEMANAGER_CODE_ALERT\" })\n      );\n    }, 1000);\n  }\n  didStopPlaying() {\n    this.moveTo(LOCATION.EDITOR);\n  }\n  didClearCodeConditions() {\n    if(this.codeConditionExists && !this.props.isConditionsClear) {\n      this.speak(this.props.intl.formatMessage({ id: \"ID_DREAM_BUILDER_WIZMATEMANAGER_CODE_PLAY\" }));\n    }\n  }\n\n  moveTo(location) {\n    this.setState({ location });\n  }\n  \n  speak(message, duration) {\n    if(this.wizmateRef.current) {\n      this.wizmateRef.current.speak(message, duration);\n    }\n  }\n  warn(message, duration) {\n    if(this.wizmateRef.current) {\n      this.wizmateRef.current.warn(message, duration);\n    }\n  }\n  error(message, duration) {\n    if(this.wizmateRef.current) {\n      this.wizmateRef.current.error(message, duration);\n    }\n  }\n  stop(message, duration) {\n    if(this.wizmateRef.current) {\n      this.wizmateRef.current.stop(message, duration);\n    }\n  }\n\n  get codeConditionExists() {\n    return !!this.conditions.find(condition => condition.isCodeType);\n  }\n  get conditions() {\n    const rawConditions = (this.props.mission && this.props.mission.conditions) || [];\n    return rawConditions.map(rawCondition => Condition.create(rawCondition));\n  }\n\n  render() {\n    return (\n      <div className={`dream_wizmate dream_wizmate-${this.state.location}`}>\n        <WizMate ref={this.wizmateRef} />\n      </div>\n    );\n  }\n}\n\nexport default connect(\n  state => ({\n    mission: state.dream.currentMission,\n    isPlaying: state.preview.isPlaying,\n    isConditionsClear: state.dream.isConditionsClear,\n    isCodeConditionsClear: state.dream.isCodeConditionsClear\n  })\n)(injectIntl(WizMateManager));\n"]},"metadata":{},"sourceType":"module"}