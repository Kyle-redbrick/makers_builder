{"ast":null,"code":"import _objectSpread from \"/Users/jimmy/Documents/Wizschool/astroboy/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nimport _slicedToArray from \"/Users/jimmy/Documents/Wizschool/astroboy/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"/Users/jimmy/Documents/Wizschool/astroboy/src/Page/DreamEditor/Editor/ProjectEditor/index.js\";\nimport React, { useEffect, useState } from \"react\";\nimport * as request from \"../../../../Common/Util/HTTPRequest\";\nimport TemplateEditor from \"../TemplateEditor\";\nimport Field from \"../Field\";\nimport \"./index.scss\";\n\nfunction ProjectEditor(props) {\n  var projectId = props.projectId;\n\n  var _useState = useState(null),\n      _useState2 = _slicedToArray(_useState, 2),\n      project = _useState2[0],\n      setProject = _useState2[1];\n\n  useEffect(function () {\n    request.getDreamProject(projectId).then(function (res) {\n      return res.json();\n    }).then(function (project) {\n      project.tags = project.tags ? project.tags.map(function (tag) {\n        return tag.tag;\n      }) : [];\n      setProject(project);\n    });\n  }, [projectId]);\n  var courseType;\n\n  try {\n    courseType = project.lecture.course.type;\n  } catch (_unused) {}\n\n  var _useState3 = useState(\"\"),\n      _useState4 = _slicedToArray(_useState3, 2),\n      title = _useState4[0],\n      setTitle = _useState4[1];\n\n  var _useState5 = useState(\"\"),\n      _useState6 = _slicedToArray(_useState5, 2),\n      introduction = _useState6[0],\n      setIntroduction = _useState6[1];\n\n  var _useState7 = useState(0),\n      _useState8 = _slicedToArray(_useState7, 2),\n      number = _useState8[0],\n      setNumber = _useState8[1];\n\n  var _useState9 = useState(\"\"),\n      _useState10 = _slicedToArray(_useState9, 2),\n      defaultTemplate = _useState10[0],\n      setDefaultTemplate = _useState10[1];\n\n  var _useState11 = useState(\"\"),\n      _useState12 = _slicedToArray(_useState11, 2),\n      template = _useState12[0],\n      setTemplate = _useState12[1];\n\n  var _useState13 = useState(0),\n      _useState14 = _slicedToArray(_useState13, 2),\n      totalMissionNum = _useState14[0],\n      setTotalMissionNum = _useState14[1];\n\n  var _useState15 = useState(\"\"),\n      _useState16 = _slicedToArray(_useState15, 2),\n      sampleGameURL = _useState16[0],\n      setSampleGameURL = _useState16[1];\n\n  var _useState17 = useState(\"\"),\n      _useState18 = _slicedToArray(_useState17, 2),\n      thumbnailURL = _useState18[0],\n      setThumbnailURL = _useState18[1];\n\n  var _useState19 = useState([]),\n      _useState20 = _slicedToArray(_useState19, 2),\n      tags = _useState20[0],\n      setTags = _useState20[1];\n\n  var _useState21 = useState(\"\"),\n      _useState22 = _slicedToArray(_useState21, 2),\n      apiCommands = _useState22[0],\n      setAPICommands = _useState22[1];\n\n  var _useState23 = useState(\"\"),\n      _useState24 = _slicedToArray(_useState23, 2),\n      programmingConcepts = _useState24[0],\n      setProgrammingConcepts = _useState24[1];\n\n  var _useState25 = useState(false),\n      _useState26 = _slicedToArray(_useState25, 2),\n      isHidden = _useState26[0],\n      setIsHidden = _useState26[1];\n\n  var _useState27 = useState(false),\n      _useState28 = _slicedToArray(_useState27, 2),\n      isLive = _useState28[0],\n      setIsLive = _useState28[1];\n\n  useEffect(function () {\n    if (project) {\n      setNumber(project.number || 0);\n      setTotalMissionNum(project.totalMissionNum || 0);\n      setIsHidden(project.isHidden || false);\n      setIsLive(project.isLive || false);\n      setTitle(project.localized[0] ? project.localized[0].title : \"\");\n      setIntroduction(project.localized[0] ? project.localized[0].introduction : \"\");\n      setDefaultTemplate(project.localized[0] ? project.localized[0].template : \"\");\n      setTemplate(project.localized[0] ? project.localized[0].template : \"\");\n      setSampleGameURL(project.localized[0] ? project.localized[0].sampleGameURL : \"\");\n      setThumbnailURL(project.localized[0] ? project.localized[0].thumbnailURL : \"\");\n      setAPICommands(project.tags.filter(function (tag) {\n        return tag.type === \"apiCommand\";\n      }).map(function (tag) {\n        return tag.name;\n      }).join(\",\") || \"\");\n      setProgrammingConcepts(project.tags.filter(function (tag) {\n        return tag.type === \"programmingConcept\";\n      }).map(function (tag) {\n        return tag.name;\n      }).join(\",\") || \"\");\n    }\n  }, [project]);\n  useEffect(function () {\n    var tags = [];\n    apiCommands.split(\",\").map(function (apiCommand) {\n      return apiCommand.trim();\n    }).filter(function (apiCommand) {\n      return !!apiCommand;\n    }).forEach(function (apiCommand) {\n      tags.push({\n        type: \"apiCommand\",\n        name: apiCommand\n      });\n    });\n    programmingConcepts.split(\",\").map(function (programmingConcept) {\n      return programmingConcept.trim();\n    }).filter(function (programmingConcept) {\n      return !!programmingConcept;\n    }).forEach(function (programmingConcept) {\n      tags.push({\n        type: \"programmingConcept\",\n        name: programmingConcept\n      });\n    });\n    setTags(tags);\n  }, [apiCommands, programmingConcepts]);\n\n  var onClickSave = function onClickSave() {\n    var updateValues = getUpdatedValues();\n    request.updateDreamProject(projectId, updateValues).then(function (res) {\n      return res.json();\n    }).then(function (json) {\n      if (json.success) {\n        setProject(_objectSpread({}, project, updateValues, {\n          localized: [project.localized[0] ? _objectSpread({}, project.localized[0], updateValues.localized) : updateValues.localized]\n        }));\n        alert(\"저장되었습니다 :)\");\n      } else {\n        throw json;\n      }\n    }).catch(function (err) {\n      console.error(err);\n      alert(JSON.stringify(err));\n    });\n  };\n\n  var getUpdatedValues = function getUpdatedValues() {\n    var updatedValues = {\n      localized: getUpdateLocalizedValues()\n    };\n    var values = {\n      number: parseInt(number),\n      totalMissionNum: totalMissionNum,\n      tags: tags,\n      isHidden: isHidden,\n      isLive: isLive\n    };\n\n    for (var key in values) {\n      if (isUpdated(key, values[key])) {\n        updatedValues[key] = values[key];\n      }\n    }\n\n    return updatedValues;\n  };\n\n  var getUpdateLocalizedValues = function getUpdateLocalizedValues() {\n    var origin = project.localized[0];\n    var values = {\n      title: title,\n      introduction: introduction,\n      sampleGameURL: sampleGameURL,\n      thumbnailURL: thumbnailURL\n    };\n\n    if (courseType !== \"python\") {\n      values.template = template;\n    }\n\n    if (origin) {\n      var updateValues = {};\n\n      for (var key in values) {\n        if (values[key] !== project.localized[0][key]) {\n          updateValues[key] = values[key];\n        }\n      }\n\n      return updateValues;\n    } else {\n      return values;\n    }\n  };\n\n  var isUpdated = function isUpdated(key, value) {\n    var _ret = function () {\n      switch (key) {\n        case \"tags\":\n          var prevTags = project[key];\n          var nextTags = value;\n\n          if (prevTags.length !== nextTags.length) {\n            return {\n              v: true\n            };\n          }\n\n          var isTagEqual = function isTagEqual(a, b) {\n            return a.type === b.type && a.name === b.name;\n          };\n\n          var _iteratorNormalCompletion = true;\n          var _didIteratorError = false;\n          var _iteratorError = undefined;\n\n          try {\n            var _loop = function _loop() {\n              var nextTag = _step.value;\n\n              if (prevTags.find(function (prevTag) {\n                return isTagEqual(prevTag, nextTag);\n              })) {\n                return \"continue\";\n              } else {\n                return {\n                  v: {\n                    v: true\n                  }\n                };\n              }\n            };\n\n            for (var _iterator = nextTags[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n              var _ret2 = _loop();\n\n              switch (_ret2) {\n                case \"continue\":\n                  continue;\n\n                default:\n                  if (typeof _ret2 === \"object\") return _ret2.v;\n              }\n            }\n          } catch (err) {\n            _didIteratorError = true;\n            _iteratorError = err;\n          } finally {\n            try {\n              if (!_iteratorNormalCompletion && _iterator.return != null) {\n                _iterator.return();\n              }\n            } finally {\n              if (_didIteratorError) {\n                throw _iteratorError;\n              }\n            }\n          }\n\n          return {\n            v: false\n          };\n\n        default:\n          return {\n            v: value !== project[key]\n          };\n      }\n    }();\n\n    if (typeof _ret === \"object\") return _ret.v;\n  };\n\n  return React.createElement(\"div\", {\n    className: \"dreamEditor_editor dreamEditor_editor-project\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 221\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"dreamEditor_editor_header\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 222\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"dreamEditor_editor_title\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 223\n    },\n    __self: this\n  }, \"\\uD504\\uB85C\\uC81D\\uD2B8 \\uC218\\uC815\\uD558\\uAE30\"), React.createElement(\"button\", {\n    className: \"dreamEditor_editor_saveBtn\",\n    onClick: onClickSave,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 224\n    },\n    __self: this\n  }, \"\\uC800\\uC7A5\\uD558\\uAE30\")), React.createElement(\"div\", {\n    className: \"dreamEditor_editor_fields\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 228\n    },\n    __self: this\n  }, React.createElement(Field.Input, {\n    id: \"title\",\n    title: \"\\uD504\\uB85C\\uC81D\\uD2B8 \\uC81C\\uBAA9\",\n    value: title,\n    onChange: setTitle,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 229\n    },\n    __self: this\n  }), React.createElement(Field.Textarea, {\n    id: \"introduction\",\n    title: \"\\uD504\\uB85C\\uC81D\\uD2B8 \\uC18C\\uAC1C\",\n    value: introduction,\n    onChange: setIntroduction,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 235\n    },\n    __self: this\n  }), React.createElement(Field.File, {\n    id: \"thumbnailURL\",\n    title: \"\\uC378\\uB124\\uC77C \\uC774\\uBBF8\\uC9C0\",\n    value: thumbnailURL,\n    onChange: setThumbnailURL,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 241\n    },\n    __self: this\n  }), React.createElement(Field.Input, {\n    id: \"number\",\n    type: \"number\",\n    title: \"\\uD504\\uB85C\\uC81D\\uD2B8 \\uC21C\\uC11C\",\n    value: number,\n    onChange: setNumber,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 247\n    },\n    __self: this\n  }), React.createElement(Field.Input, {\n    id: \"programmingConcepts\",\n    title: \"\\uD559\\uC2B5\\uAC1C\\uB150\",\n    value: programmingConcepts,\n    onChange: setProgrammingConcepts,\n    comment: \"\\uBC18\\uB4DC\\uC2DC `,`\\uB85C \\uAD6C\\uBD84\\uD574\\uC8FC\\uC138\\uC694. \\uC608) \\uC21C\\uCC28\\uAD6C\\uC870,\\uC774\\uBCA4\\uD2B8\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 254\n    },\n    __self: this\n  }), React.createElement(Field.Input, {\n    id: \"apiCommands\",\n    title: \"\\uC8FC\\uC694 \\uBA85\\uB839\\uC5B4\",\n    value: apiCommands,\n    onChange: setAPICommands,\n    comment: \"\\uBC18\\uB4DC\\uC2DC `,`\\uB85C \\uAD6C\\uBD84\\uD574\\uC8FC\\uC138\\uC694. \\uC608) playAnimation,say\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 261\n    },\n    __self: this\n  }), React.createElement(Field.Input, {\n    id: \"title\",\n    title: \"\\uC0D8\\uD50C\\uAC8C\\uC784 \\uC8FC\\uC18C\",\n    value: sampleGameURL,\n    onChange: setSampleGameURL,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 268\n    },\n    __self: this\n  }), React.createElement(Field.OnOff, {\n    id: \"isHidden\",\n    title: \"\\uCF58\\uD150\\uCE20 \\uACF5\\uAC1C\",\n    value: !isHidden,\n    onChange: function onChange(value) {\n      setIsHidden(!value);\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 274\n    },\n    __self: this\n  }), React.createElement(Field.OnOff, {\n    id: \"isLive\",\n    title: \"\\uCF58\\uD150\\uCE20 \\uC774\\uC6A9\\uAC00\\uB2A5\",\n    value: isLive,\n    onChange: setIsLive,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 282\n    },\n    __self: this\n  }), courseType !== \"python\" && React.createElement(\"div\", {\n    className: \"dreamEditor_editor_field dreamEditor_editor_field-template\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 289\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"dreamEditor_editor_field_title\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 290\n    },\n    __self: this\n  }, \"\\uD15C\\uD50C\\uB9BF\"), React.createElement(\"div\", {\n    className: \"dreamEditor_editor_field_body\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 291\n    },\n    __self: this\n  }, React.createElement(TemplateEditor, {\n    defaultTemplate: defaultTemplate,\n    onChangeTotalMissionNum: setTotalMissionNum,\n    onChangeTemplate: setTemplate,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 292\n    },\n    __self: this\n  })))));\n}\n\nexport default ProjectEditor;","map":{"version":3,"sources":["/Users/jimmy/Documents/Wizschool/astroboy/src/Page/DreamEditor/Editor/ProjectEditor/index.js"],"names":["React","useEffect","useState","request","TemplateEditor","Field","ProjectEditor","props","projectId","project","setProject","getDreamProject","then","res","json","tags","map","tag","courseType","lecture","course","type","title","setTitle","introduction","setIntroduction","number","setNumber","defaultTemplate","setDefaultTemplate","template","setTemplate","totalMissionNum","setTotalMissionNum","sampleGameURL","setSampleGameURL","thumbnailURL","setThumbnailURL","setTags","apiCommands","setAPICommands","programmingConcepts","setProgrammingConcepts","isHidden","setIsHidden","isLive","setIsLive","localized","filter","name","join","split","apiCommand","trim","forEach","push","programmingConcept","onClickSave","updateValues","getUpdatedValues","updateDreamProject","success","alert","catch","err","console","error","JSON","stringify","updatedValues","getUpdateLocalizedValues","values","parseInt","key","isUpdated","origin","value","prevTags","nextTags","length","isTagEqual","a","b","nextTag","find","prevTag"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport * as request from \"../../../../Common/Util/HTTPRequest\";\nimport TemplateEditor from \"../TemplateEditor\";\nimport Field from \"../Field\";\nimport \"./index.scss\";\n\nfunction ProjectEditor(props) {\n  const { projectId } = props;\n  const [project, setProject] = useState(null);\n  useEffect(\n    () => {\n      request\n        .getDreamProject(projectId)\n        .then(res => res.json())\n        .then(project => {\n          project.tags = project.tags ? project.tags.map(tag => tag.tag) : [];\n          setProject(project);\n        });\n    },\n    [projectId]\n  );\n\n  let courseType;\n  try {\n    courseType = project.lecture.course.type;\n  } catch {}\n\n  const [title, setTitle] = useState(\"\");\n  const [introduction, setIntroduction] = useState(\"\");\n  const [number, setNumber] = useState(0);\n  const [defaultTemplate, setDefaultTemplate] = useState(\"\");\n  const [template, setTemplate] = useState(\"\");\n  const [totalMissionNum, setTotalMissionNum] = useState(0);\n  const [sampleGameURL, setSampleGameURL] = useState(\"\");\n  const [thumbnailURL, setThumbnailURL] = useState(\"\");\n  const [tags, setTags] = useState([]);\n  const [apiCommands, setAPICommands] = useState(\"\");\n  const [programmingConcepts, setProgrammingConcepts] = useState(\"\");\n  const [isHidden, setIsHidden] = useState(false);\n  const [isLive, setIsLive] = useState(false);\n  useEffect(\n    () => {\n      if (project) {\n        setNumber(project.number || 0);\n        setTotalMissionNum(project.totalMissionNum || 0);\n        setIsHidden(project.isHidden || false);\n        setIsLive(project.isLive || false);\n        \n        setTitle(\n          project.localized[0]\n          ? project.localized[0].title\n          : \"\"\n        );\n        setIntroduction(\n          project.localized[0]\n          ? project.localized[0].introduction\n          : \"\"\n        );\n        setDefaultTemplate(\n          project.localized[0]\n          ? project.localized[0].template\n          : \"\"\n        );\n        setTemplate(\n          project.localized[0]\n          ? project.localized[0].template\n          : \"\"\n        );\n        setSampleGameURL(\n          project.localized[0]\n          ? project.localized[0].sampleGameURL\n          : \"\"\n        );\n        setThumbnailURL(\n          project.localized[0]\n          ? project.localized[0].thumbnailURL\n          : \"\"\n        );\n        \n        setAPICommands(\n          project.tags\n            .filter(tag => tag.type === \"apiCommand\")\n            .map(tag => tag.name)\n            .join(\",\") || \"\"\n        );\n        setProgrammingConcepts(\n          project.tags\n            .filter(tag => tag.type === \"programmingConcept\")\n            .map(tag => tag.name)\n            .join(\",\") || \"\"\n        );\n      }\n    },\n    [project]\n  );\n  useEffect(\n    () => {\n      const tags = [];\n\n      apiCommands\n        .split(\",\")\n        .map(apiCommand => apiCommand.trim())\n        .filter(apiCommand => !!apiCommand)\n        .forEach(apiCommand => {\n          tags.push({ type: \"apiCommand\", name: apiCommand });\n        });\n\n      programmingConcepts\n        .split(\",\")\n        .map(programmingConcept => programmingConcept.trim())\n        .filter(programmingConcept => !!programmingConcept)\n        .forEach(programmingConcept => {\n          tags.push({\n            type: \"programmingConcept\",\n            name: programmingConcept\n          });\n        });\n\n      setTags(tags);\n    },\n    [apiCommands, programmingConcepts]\n  );\n\n  const onClickSave = () => {\n    const updateValues = getUpdatedValues();\n    request\n      .updateDreamProject(projectId, updateValues)\n      .then(res => res.json())\n      .then(json => {\n        if (json.success) {\n          setProject({\n            ...project,\n            ...updateValues,\n            localized: [\n              project.localized[0]\n              ? { ...project.localized[0], ...updateValues.localized }\n              : updateValues.localized\n            ]\n          });\n          alert(\"저장되었습니다 :)\");\n        } else {\n          throw json;\n        }\n      })\n      .catch(err => {\n        console.error(err);\n        alert(JSON.stringify(err));\n      });\n  };\n  const getUpdatedValues = () => {\n    const updatedValues = {\n      localized: getUpdateLocalizedValues()\n    };\n    \n    const values = {\n      number: parseInt(number),\n      totalMissionNum,\n      tags,\n      isHidden,\n      isLive\n    };\n    \n    for (let key in values) {\n      if (isUpdated(key, values[key])) {\n        updatedValues[key] = values[key];\n      }\n    }\n    return updatedValues;\n  };\n  const getUpdateLocalizedValues = () => {\n    const origin = project.localized[0]\n\n    const values = {\n      title,\n      introduction,\n      sampleGameURL,\n      thumbnailURL,\n    };\n    if(courseType !== \"python\") {\n      values.template = template;\n    }\n\n    if(origin) {\n      const updateValues = {};\n      for (let key in values) {\n        if (values[key] !== project.localized[0][key]) {\n          updateValues[key] = values[key];\n        }\n      }\n      return updateValues;\n    } else {\n      return values;\n    }\n  }\n  const isUpdated = (key, value) => {\n    switch (key) {\n      case \"tags\":\n        const prevTags = project[key];\n        const nextTags = value;\n\n        if (prevTags.length !== nextTags.length) {\n          return true;\n        }\n\n        const isTagEqual = (a, b) => a.type === b.type && a.name === b.name;\n        for (let nextTag of nextTags) {\n          if (prevTags.find(prevTag => isTagEqual(prevTag, nextTag))) {\n            continue;\n          } else {\n            return true;\n          }\n        }\n\n        return false;\n      default:\n        return value !== project[key];\n    }\n  };\n\n  return (\n    <div className=\"dreamEditor_editor dreamEditor_editor-project\">\n      <div className=\"dreamEditor_editor_header\">\n        <div className=\"dreamEditor_editor_title\">프로젝트 수정하기</div>\n        <button className=\"dreamEditor_editor_saveBtn\" onClick={onClickSave}>\n          저장하기\n        </button>\n      </div>\n      <div className=\"dreamEditor_editor_fields\">\n        <Field.Input\n          id=\"title\"\n          title=\"프로젝트 제목\"\n          value={title}\n          onChange={setTitle}\n        />\n        <Field.Textarea\n          id=\"introduction\"\n          title=\"프로젝트 소개\"\n          value={introduction}\n          onChange={setIntroduction}\n        />\n        <Field.File\n          id=\"thumbnailURL\"\n          title=\"썸네일 이미지\"\n          value={thumbnailURL}\n          onChange={setThumbnailURL}\n        />\n        <Field.Input\n          id=\"number\"\n          type=\"number\"\n          title=\"프로젝트 순서\"\n          value={number}\n          onChange={setNumber}\n        />\n        <Field.Input\n          id=\"programmingConcepts\"\n          title=\"학습개념\"\n          value={programmingConcepts}\n          onChange={setProgrammingConcepts}\n          comment={`반드시 \\`,\\`로 구분해주세요. 예) 순차구조,이벤트`}\n        />\n        <Field.Input\n          id=\"apiCommands\"\n          title=\"주요 명령어\"\n          value={apiCommands}\n          onChange={setAPICommands}\n          comment={`반드시 \\`,\\`로 구분해주세요. 예) playAnimation,say`}\n        />\n        <Field.Input\n          id=\"title\"\n          title=\"샘플게임 주소\"\n          value={sampleGameURL}\n          onChange={setSampleGameURL}\n        />\n        <Field.OnOff\n          id=\"isHidden\"\n          title=\"콘텐츠 공개\"\n          value={!isHidden}\n          onChange={value => {\n            setIsHidden(!value);\n          }}\n        />\n        <Field.OnOff\n          id=\"isLive\"\n          title=\"콘텐츠 이용가능\"\n          value={isLive}\n          onChange={setIsLive}\n        />\n        {courseType !== \"python\" && (\n          <div className=\"dreamEditor_editor_field dreamEditor_editor_field-template\">\n            <div className=\"dreamEditor_editor_field_title\">템플릿</div>\n            <div className=\"dreamEditor_editor_field_body\">\n              <TemplateEditor\n                defaultTemplate={defaultTemplate}\n                onChangeTotalMissionNum={setTotalMissionNum}\n                onChangeTemplate={setTemplate}\n              />\n            </div>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\nexport default ProjectEditor;\n"]},"metadata":{},"sourceType":"module"}