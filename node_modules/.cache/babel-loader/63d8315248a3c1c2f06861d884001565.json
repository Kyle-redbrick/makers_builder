{"ast":null,"code":"import _regeneratorRuntime from \"/Users/jimmy/Documents/Wizschool/wizlab_web2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/jimmy/Documents/Wizschool/wizlab_web2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"/Users/jimmy/Documents/Wizschool/wizlab_web2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/jimmy/Documents/Wizschool/wizlab_web2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _inherits from \"/Users/jimmy/Documents/Wizschool/wizlab_web2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _possibleConstructorReturn from \"/Users/jimmy/Documents/Wizschool/wizlab_web2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/jimmy/Documents/Wizschool/wizlab_web2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nvar _jsxFileName = \"/Users/jimmy/Documents/Wizschool/wizlab_web2/src/Page/PaymentResult/Container.js\";\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\n\nimport React, { Component } from \"react\";\nimport { connect } from \"react-redux\";\nimport { withRouter } from \"react-router-dom\";\nimport { injectIntl } from \"react-intl\";\nimport * as userInfoActions from \"../../Common/Store/Reducer/UserInfo\";\nimport * as request from \"../../Common/Util/HTTPRequest\";\nimport View from \"./View\";\n\nvar Container = /*#__PURE__*/function (_Component) {\n  _inherits(Container, _Component);\n\n  var _super = _createSuper(Container);\n\n  function Container(props) {\n    var _this;\n\n    _classCallCheck(this, Container);\n\n    _this = _super.call(this, props);\n\n    _this.componentDidMount = function () {\n      if (!_this.props.email) {\n        _this.props.history.push(\"/\");\n\n        return;\n      }\n\n      _this.fetchTicketHistory();\n    };\n\n    _this.componentDidUpdate = function (prevProps) {\n      if (_this.props.email && !prevProps.email) {\n        _this.onLogin();\n      }\n\n      if (!_this.props.email) {\n        _this.onLogout();\n      }\n    };\n\n    _this.onLogin = function () {\n      _this.fetchTicketHistory();\n    };\n\n    _this.onLogout = function () {\n      _this.props.history.push(\"/\");\n    };\n\n    _this.fetchTicketHistory = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      var res, fetchedData, compare;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              compare = function _compare(a, b) {\n                if (a.createdAt < b.createdAt) {\n                  return 1;\n                }\n\n                if (a.createdAt > b.createdAt) {\n                  return -1;\n                }\n\n                return 0;\n              };\n\n              _context.next = 3;\n              return request.apkHistory({\n                userId: _this.props.userinfo.id\n              });\n\n            case 3:\n              res = _context.sent;\n              _context.next = 6;\n              return res.json();\n\n            case 6:\n              fetchedData = _context.sent;\n\n              if (fetchedData) {\n                _context.next = 9;\n                break;\n              }\n\n              return _context.abrupt(\"return\");\n\n            case 9:\n              fetchedData.sort(compare);\n\n              _this.setState({\n                ticketHistories: fetchedData\n              });\n\n            case 11:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    _this.onClickBuyTicket = function () {\n      _this.props.history.push(\"/payment\");\n    };\n\n    _this.onClickMyApkPage = function () {\n      _this.props.history.push(\"/myapk\");\n    };\n\n    _this.state = {\n      ticketHistories: []\n    };\n    return _this;\n  }\n\n  _createClass(Container, [{\n    key: \"render\",\n    value: function render() {\n      var onClickBuyTicket = this.onClickBuyTicket,\n          onClickMyApkPage = this.onClickMyApkPage;\n      var ticketHistories = this.state.ticketHistories;\n      return /*#__PURE__*/React.createElement(View, {\n        apkTicket: this.props.userinfo.apkTicket,\n        onClickBuyTicket: onClickBuyTicket,\n        ticketHistories: ticketHistories,\n        intl: this.props.intl,\n        onClickMyApkPage: onClickMyApkPage,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 73,\n          columnNumber: 7\n        }\n      });\n    }\n  }]);\n\n  return Container;\n}(Component);\n\nexport default connect(function (state) {\n  return {\n    email: state.userinfo.email,\n    userinfo: state.userinfo\n  };\n}, {\n  updateUserInfo: userInfoActions.updateUserInfo\n})(injectIntl(withRouter(Container)));","map":{"version":3,"sources":["/Users/jimmy/Documents/Wizschool/wizlab_web2/src/Page/PaymentResult/Container.js"],"names":["React","Component","connect","withRouter","injectIntl","userInfoActions","request","View","Container","props","componentDidMount","email","history","push","fetchTicketHistory","componentDidUpdate","prevProps","onLogin","onLogout","compare","a","b","createdAt","apkHistory","userId","userinfo","id","res","json","fetchedData","sort","setState","ticketHistories","onClickBuyTicket","onClickMyApkPage","state","apkTicket","intl","updateUserInfo"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport { connect } from \"react-redux\";\nimport { withRouter } from \"react-router-dom\";\nimport { injectIntl } from \"react-intl\";\nimport * as userInfoActions from \"../../Common/Store/Reducer/UserInfo\";\nimport * as request from \"../../Common/Util/HTTPRequest\";\nimport View from \"./View\";\n\nclass Container extends Component {\n  constructor(props) {\n    super(props);\n\n    this.state = { ticketHistories: [] };\n  }\n  componentDidMount = () => {\n    if (!this.props.email) {\n      this.props.history.push(\"/\");\n      return;\n    }\n    this.fetchTicketHistory();\n  };\n\n  componentDidUpdate = prevProps => {\n    if (this.props.email && !prevProps.email) {\n      this.onLogin();\n    }\n    if (!this.props.email) {\n      this.onLogout();\n    }\n  };\n  onLogin = () => {\n    this.fetchTicketHistory();\n  };\n\n  onLogout = () => {\n    this.props.history.push(\"/\");\n  };\n\n  fetchTicketHistory = async () => {\n    let res = await request.apkHistory({ userId: this.props.userinfo.id });\n    let fetchedData = await res.json();\n    if (!fetchedData) {\n      return;\n    }\n\n    function compare(a, b) {\n      if (a.createdAt < b.createdAt) {\n        return 1;\n      }\n      if (a.createdAt > b.createdAt) {\n        return -1;\n      }\n      return 0;\n    }\n\n    fetchedData.sort(compare);\n\n    this.setState({\n      ticketHistories: fetchedData\n    });\n  };\n  onClickBuyTicket = () => {\n    this.props.history.push(\"/payment\");\n  };\n\n  onClickMyApkPage = () => {\n    this.props.history.push(\"/myapk\");\n  };\n  render() {\n    const { onClickBuyTicket, onClickMyApkPage } = this;\n    const { ticketHistories } = this.state;\n    return (\n      <View\n        apkTicket={this.props.userinfo.apkTicket}\n        onClickBuyTicket={onClickBuyTicket}\n        ticketHistories={ticketHistories}\n        intl={this.props.intl}\n        onClickMyApkPage={onClickMyApkPage}\n      />\n    );\n  }\n}\n\nexport default connect(\n  state => ({ email: state.userinfo.email, userinfo: state.userinfo }),\n  {\n    updateUserInfo: userInfoActions.updateUserInfo\n  }\n)(injectIntl(withRouter(Container)));\n"]},"metadata":{},"sourceType":"module"}