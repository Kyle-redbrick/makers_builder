{"ast":null,"code":"import _defineProperty from \"/Users/jimmy/Documents/Wizschool/wizlab_web2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _classCallCheck from \"/Users/jimmy/Documents/Wizschool/wizlab_web2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/jimmy/Documents/Wizschool/wizlab_web2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/jimmy/Documents/Wizschool/wizlab_web2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/jimmy/Documents/Wizschool/wizlab_web2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/jimmy/Documents/Wizschool/wizlab_web2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/Users/jimmy/Documents/Wizschool/wizlab_web2/src/Page/Builder/Component/Live/Component/FreeTrialSurveyPopup/Container.js\";\nimport React, { Component } from \"react\";\nimport { connect } from \"react-redux\";\nimport { injectIntl } from \"react-intl\";\nimport * as request from \"../../../../../../Common/Util/HTTPRequest\";\nimport { showFreeTrialSubmitPopup } from \"../../../../../../Common/Util/AlertManager\";\nimport View from \"./View\";\nimport PopUp, { showPopUp } from \"../../../../../../Common/Component/PopUp\";\n\nvar Container =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(Container, _Component);\n\n  function Container(props) {\n    var _this;\n\n    _classCallCheck(this, Container);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(Container).call(this, props));\n\n    _this.isSurveyEnabled = function () {\n      var _this$state = _this.state,\n          lectureLevel = _this$state.lectureLevel,\n          lectureInterest = _this$state.lectureInterest,\n          lectureSpeed = _this$state.lectureSpeed;\n      return lectureLevel > 0 && lectureInterest > 0 && lectureSpeed > 0;\n    };\n\n    _this.handleChange = function (event) {\n      var name = event.target.name;\n      var value = parseInt(event.target.value);\n\n      switch (name) {\n        case \"level\":\n          _this.setState({\n            lectureLevel: value\n          });\n\n          break;\n\n        case \"interest\":\n          _this.setState({\n            lectureInterest: value\n          });\n\n          break;\n\n        case \"speed\":\n          _this.setState({\n            lectureSpeed: value\n          });\n\n          break;\n\n        default:\n      }\n    };\n\n    _this.handleChangeSurveyAdmin1 = function (message) {\n      _this.setState({\n        surveyAdminMessage1: message\n      });\n    };\n\n    _this.handleChangeSurveyAdmin2 = function (message) {\n      _this.setState({\n        surveyAdminMessage2: message\n      });\n    };\n\n    _this.getLectureLevel = function () {\n      var lectureLevel = _this.state.lectureLevel;\n      var formatMessage = _this.props.intl.formatMessage;\n\n      switch (lectureLevel) {\n        case 0:\n          return null;\n\n        case 1:\n          return formatMessage({\n            id: \"ID_FREE_TRIAL_SURVEY_STEP1_LEVEL_ITEM1\"\n          });\n\n        case 2:\n          return formatMessage({\n            id: \"ID_FREE_TRIAL_SURVEY_STEP1_LEVEL_ITEM2\"\n          });\n\n        case 3:\n          return formatMessage({\n            id: \"ID_FREE_TRIAL_SURVEY_STEP1_LEVEL_ITEM3\"\n          });\n\n        default:\n      }\n    };\n\n    _this.getLectureInterest = function () {\n      var lectureInterest = _this.state.lectureInterest;\n      var formatMessage = _this.props.intl.formatMessage;\n\n      switch (lectureInterest) {\n        case 0:\n          return null;\n\n        case 1:\n          return formatMessage({\n            id: \"ID_FREE_TRIAL_SURVEY_STEP1_INTEREST_ITEM1\"\n          });\n\n        case 2:\n          return formatMessage({\n            id: \"ID_FREE_TRIAL_SURVEY_STEP1_INTEREST_ITEM2\"\n          });\n\n        case 3:\n          return formatMessage({\n            id: \"ID_FREE_TRIAL_SURVEY_STEP1_INTEREST_ITEM3\"\n          });\n\n        default:\n      }\n    };\n\n    _this.getLectureSpeed = function () {\n      var lectureSpeed = _this.state.lectureSpeed;\n      var formatMessage = _this.props.intl.formatMessage;\n\n      switch (lectureSpeed) {\n        case 0:\n          return null;\n\n        case 1:\n          return formatMessage({\n            id: \"ID_FREE_TRIAL_SURVEY_STEP1_SPEED_ITEM1\"\n          });\n\n        case 2:\n          return formatMessage({\n            id: \"ID_FREE_TRIAL_SURVEY_STEP1_SPEED_ITEM2\"\n          });\n\n        case 3:\n          return formatMessage({\n            id: \"ID_FREE_TRIAL_SURVEY_STEP1_SPEED_ITEM3\"\n          });\n\n        default:\n      }\n    };\n\n    _this.handleSubmitSurvey = function () {\n      var _values;\n\n      if (!_this.isSurveyEnabled()) {\n        return;\n      }\n\n      var _this$state2 = _this.state,\n          surveyAdminMessage1 = _this$state2.surveyAdminMessage1,\n          surveyAdminMessage2 = _this$state2.surveyAdminMessage2;\n      var formatMessage = _this.props.intl.formatMessage;\n      var reservationId = _this.props.reservationId;\n      var level = formatMessage({\n        id: \"ID_FREE_TRIAL_SURVEY_STEP1_LEVEL\"\n      });\n      var interest = formatMessage({\n        id: \"ID_FREE_TRIAL_SURVEY_STEP1_INTEREST\"\n      });\n      var speed = formatMessage({\n        id: \"ID_FREE_TRIAL_SURVEY_STEP1_SPEED\"\n      });\n      var input1 = formatMessage({\n        id: \"ID_FREE_TRIAL_SURVEY_STEP1_INPUT1\"\n      });\n      var input2 = formatMessage({\n        id: \"ID_FREE_TRIAL_SURVEY_STEP1_INPUT2\"\n      });\n      var values = (_values = {}, _defineProperty(_values, level, _this.getLectureLevel()), _defineProperty(_values, interest, _this.getLectureInterest()), _defineProperty(_values, speed, _this.getLectureSpeed()), _defineProperty(_values, input1, surveyAdminMessage1), _defineProperty(_values, input2, surveyAdminMessage2), _values);\n      request.postSurvey({\n        email: _this.props.email,\n        values: JSON.stringify(values),\n        reservationId: reservationId\n      });\n\n      _this.setState({\n        step: 2\n      });\n    };\n\n    _this.handleChangeScore = function (score) {\n      _this.setState({\n        score: score\n      });\n    };\n\n    _this.handleChangeFeedbackTutor = function (message) {\n      _this.setState({\n        feedbackTutorMessage: message\n      });\n    };\n\n    _this.handleChangeFeedbackAdmin = function (message) {\n      _this.setState({\n        feedbackAdminMessage: message\n      });\n    };\n\n    _this.isFeedbackEnabled = function () {\n      var _this$state3 = _this.state,\n          score = _this$state3.score,\n          feedbackTutorMessage = _this$state3.feedbackTutorMessage;\n      return score > 0 && feedbackTutorMessage.length > 0;\n    };\n\n    _this.handleSubmitFeedback = function () {\n      if (!_this.isFeedbackEnabled()) {\n        return;\n      }\n\n      var _this$state4 = _this.state,\n          score = _this$state4.score,\n          feedbackTutorMessage = _this$state4.feedbackTutorMessage,\n          feedbackAdminMessage = _this$state4.feedbackAdminMessage;\n      var _this$props = _this.props,\n          reservationId = _this$props.reservationId,\n          tutorEmail = _this$props.tutorEmail,\n          isFreeTrial = _this$props.isFreeTrial; // const { formatMessage } = this.props.intl;\n\n      var params = {\n        rating: {\n          score: score,\n          comment: feedbackTutorMessage\n        },\n        id: reservationId,\n        tutor: tutorEmail,\n        adminMessage: feedbackAdminMessage\n      };\n\n      _this.props.handleFreeTrialSurvey(false);\n\n      request.postFeedbackFromStudentWizLive(params).then(function () {\n        if (isFreeTrial) {\n          showFreeTrialSubmitPopup();\n        } else {\n          showPopUp(React.createElement(PopUp.OneButton, {\n            intl: _this.props.intl,\n            titleId: \"ID_FREE_TRIAL_SURVEY_SUBMIT_TITLE\",\n            subtitleId: \"ID_FEEDBACK_SUBMIT_DESCRIPTION\",\n            buttonNameId: \"ID_BUILDER_LIVE_ACCESS_OK\",\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 201\n            },\n            __self: this\n          }));\n        }\n      }).catch(function (err) {\n        console.error(err);\n      });\n    };\n\n    var _isFreeTrial = _this.props.isFreeTrial;\n    _this.state = {\n      step: _isFreeTrial ? 1 : 2,\n      lectureLevel: 0,\n      lectureInterest: 0,\n      lectureSpeed: 0,\n      surveyAdminMessage1: \"\",\n      surveyAdminMessage2: \"\",\n      score: 0,\n      feedbackTutorMessage: \"\",\n      feedbackAdminMessage: \"\"\n    };\n    return _this;\n  }\n\n  _createClass(Container, [{\n    key: \"render\",\n    value: function render() {\n      var _this$state5 = this.state,\n          step = _this$state5.step,\n          lectureLevel = _this$state5.lectureLevel,\n          lectureInterest = _this$state5.lectureInterest,\n          lectureSpeed = _this$state5.lectureSpeed,\n          score = _this$state5.score;\n      var handleChange = this.handleChange,\n          handleChangeSurveyAdmin1 = this.handleChangeSurveyAdmin1,\n          handleChangeSurveyAdmin2 = this.handleChangeSurveyAdmin2,\n          handleSubmitSurvey = this.handleSubmitSurvey,\n          handleChangeScore = this.handleChangeScore,\n          handleChangeFeedbackTutor = this.handleChangeFeedbackTutor,\n          handleChangeFeedbackAdmin = this.handleChangeFeedbackAdmin,\n          handleSubmitFeedback = this.handleSubmitFeedback;\n      var isFreeTrial = this.props.isFreeTrial;\n      var isSurveyEnabled = this.isSurveyEnabled();\n      var isFeedbackEnabled = this.isFeedbackEnabled();\n      return React.createElement(View // Survey\n      , {\n        step: step,\n        lectureLevel: lectureLevel,\n        lectureInterest: lectureInterest,\n        lectureSpeed: lectureSpeed,\n        surveySubmitEnabled: isSurveyEnabled,\n        handleChangeSurveyAdmin1: handleChangeSurveyAdmin1,\n        handleChangeSurveyAdmin2: handleChangeSurveyAdmin2,\n        isSurveyEnabled: isSurveyEnabled // Feedback\n        ,\n        score: score,\n        handleChange: handleChange,\n        handleSubmitSurvey: handleSubmitSurvey,\n        handleSubmitFeedback: handleSubmitFeedback,\n        handleChangeScore: handleChangeScore,\n        handleChangeFeedbackTutor: handleChangeFeedbackTutor,\n        handleChangeFeedbackAdmin: handleChangeFeedbackAdmin,\n        isFeedbackEnabled: isFeedbackEnabled,\n        isFreeTrial: isFreeTrial,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 237\n        },\n        __self: this\n      });\n    }\n  }]);\n\n  return Container;\n}(Component);\n\nexport default connect(function (state) {\n  return {\n    email: state.userinfo.email\n  };\n}, {})(injectIntl(Container));","map":{"version":3,"sources":["/Users/jimmy/Documents/Wizschool/wizlab_web2/src/Page/Builder/Component/Live/Component/FreeTrialSurveyPopup/Container.js"],"names":["React","Component","connect","injectIntl","request","showFreeTrialSubmitPopup","View","PopUp","showPopUp","Container","props","isSurveyEnabled","state","lectureLevel","lectureInterest","lectureSpeed","handleChange","event","name","target","value","parseInt","setState","handleChangeSurveyAdmin1","message","surveyAdminMessage1","handleChangeSurveyAdmin2","surveyAdminMessage2","getLectureLevel","formatMessage","intl","id","getLectureInterest","getLectureSpeed","handleSubmitSurvey","reservationId","level","interest","speed","input1","input2","values","postSurvey","email","JSON","stringify","step","handleChangeScore","score","handleChangeFeedbackTutor","feedbackTutorMessage","handleChangeFeedbackAdmin","feedbackAdminMessage","isFeedbackEnabled","length","handleSubmitFeedback","tutorEmail","isFreeTrial","params","rating","comment","tutor","adminMessage","handleFreeTrialSurvey","postFeedbackFromStudentWizLive","then","catch","err","console","error","userinfo"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport { connect } from \"react-redux\";\nimport { injectIntl } from \"react-intl\";\nimport * as request from \"../../../../../../Common/Util/HTTPRequest\";\nimport { showFreeTrialSubmitPopup } from \"../../../../../../Common/Util/AlertManager\";\n\nimport View from \"./View\";\nimport PopUp, { showPopUp } from \"../../../../../../Common/Component/PopUp\";\n\nclass Container extends Component {\n  constructor(props) {\n    super(props);\n    const { isFreeTrial } = this.props;\n    this.state = {\n      step: isFreeTrial ? 1 : 2,\n      lectureLevel: 0,\n      lectureInterest: 0,\n      lectureSpeed: 0,\n      surveyAdminMessage1: \"\",\n      surveyAdminMessage2: \"\",\n      score: 0,\n      feedbackTutorMessage: \"\",\n      feedbackAdminMessage: \"\"\n    };\n  }\n\n  isSurveyEnabled = () => {\n    const { lectureLevel, lectureInterest, lectureSpeed } = this.state;\n    return lectureLevel > 0 && lectureInterest > 0 && lectureSpeed > 0;\n  };\n\n  handleChange = event => {\n    const name = event.target.name;\n    const value = parseInt(event.target.value);\n    switch (name) {\n      case \"level\":\n        this.setState({ lectureLevel: value });\n        break;\n      case \"interest\":\n        this.setState({ lectureInterest: value });\n        break;\n      case \"speed\":\n        this.setState({ lectureSpeed: value });\n        break;\n      default:\n    }\n  };\n\n  handleChangeSurveyAdmin1 = message => {\n    this.setState({ surveyAdminMessage1: message });\n  };\n\n  handleChangeSurveyAdmin2 = message => {\n    this.setState({ surveyAdminMessage2: message });\n  };\n\n  getLectureLevel = () => {\n    const { lectureLevel } = this.state;\n    const { formatMessage } = this.props.intl;\n    switch (lectureLevel) {\n      case 0:\n        return null;\n      case 1:\n        return formatMessage({\n          id: \"ID_FREE_TRIAL_SURVEY_STEP1_LEVEL_ITEM1\"\n        });\n      case 2:\n        return formatMessage({\n          id: \"ID_FREE_TRIAL_SURVEY_STEP1_LEVEL_ITEM2\"\n        });\n      case 3:\n        return formatMessage({\n          id: \"ID_FREE_TRIAL_SURVEY_STEP1_LEVEL_ITEM3\"\n        });\n      default:\n    }\n  };\n\n  getLectureInterest = () => {\n    const { lectureInterest } = this.state;\n    const { formatMessage } = this.props.intl;\n    switch (lectureInterest) {\n      case 0:\n        return null;\n      case 1:\n        return formatMessage({\n          id: \"ID_FREE_TRIAL_SURVEY_STEP1_INTEREST_ITEM1\"\n        });\n      case 2:\n        return formatMessage({\n          id: \"ID_FREE_TRIAL_SURVEY_STEP1_INTEREST_ITEM2\"\n        });\n      case 3:\n        return formatMessage({\n          id: \"ID_FREE_TRIAL_SURVEY_STEP1_INTEREST_ITEM3\"\n        });\n      default:\n    }\n  };\n\n  getLectureSpeed = () => {\n    const { lectureSpeed } = this.state;\n    const { formatMessage } = this.props.intl;\n    switch (lectureSpeed) {\n      case 0:\n        return null;\n      case 1:\n        return formatMessage({\n          id: \"ID_FREE_TRIAL_SURVEY_STEP1_SPEED_ITEM1\"\n        });\n      case 2:\n        return formatMessage({\n          id: \"ID_FREE_TRIAL_SURVEY_STEP1_SPEED_ITEM2\"\n        });\n      case 3:\n        return formatMessage({\n          id: \"ID_FREE_TRIAL_SURVEY_STEP1_SPEED_ITEM3\"\n        });\n      default:\n    }\n  };\n\n  handleSubmitSurvey = () => {\n    if (!this.isSurveyEnabled()) {\n      return;\n    }\n    const { surveyAdminMessage1, surveyAdminMessage2 } = this.state;\n    const { formatMessage } = this.props.intl;\n    const { reservationId } = this.props;\n\n    const level = formatMessage({ id: \"ID_FREE_TRIAL_SURVEY_STEP1_LEVEL\" });\n    const interest = formatMessage({\n      id: \"ID_FREE_TRIAL_SURVEY_STEP1_INTEREST\"\n    });\n    const speed = formatMessage({ id: \"ID_FREE_TRIAL_SURVEY_STEP1_SPEED\" });\n    const input1 = formatMessage({\n      id: \"ID_FREE_TRIAL_SURVEY_STEP1_INPUT1\"\n    });\n    const input2 = formatMessage({\n      id: \"ID_FREE_TRIAL_SURVEY_STEP1_INPUT2\"\n    });\n\n    const values = {\n      [level]: this.getLectureLevel(),\n      [interest]: this.getLectureInterest(),\n      [speed]: this.getLectureSpeed(),\n      [input1]: surveyAdminMessage1,\n      [input2]: surveyAdminMessage2\n    };\n    request.postSurvey({\n      email: this.props.email,\n      values: JSON.stringify(values),\n      reservationId: reservationId\n    });\n\n    this.setState({ step: 2 });\n  };\n\n  /* Feedback */\n\n  handleChangeScore = score => {\n    this.setState({ score: score });\n  };\n\n  handleChangeFeedbackTutor = message => {\n    this.setState({ feedbackTutorMessage: message });\n  };\n\n  handleChangeFeedbackAdmin = message => {\n    this.setState({ feedbackAdminMessage: message });\n  };\n\n  isFeedbackEnabled = () => {\n    const { score, feedbackTutorMessage } = this.state;\n    return score > 0 && feedbackTutorMessage.length > 0;\n  };\n\n  handleSubmitFeedback = () => {\n    if (!this.isFeedbackEnabled()) {\n      return;\n    }\n    const { score, feedbackTutorMessage, feedbackAdminMessage } = this.state;\n    const { reservationId, tutorEmail, isFreeTrial } = this.props;\n    // const { formatMessage } = this.props.intl;\n    const params = {\n      rating: { score: score, comment: feedbackTutorMessage },\n      id: reservationId,\n      tutor: tutorEmail,\n      adminMessage: feedbackAdminMessage\n    };\n\n    this.props.handleFreeTrialSurvey(false);\n\n    request\n      .postFeedbackFromStudentWizLive(params)\n      .then(() => {\n        if (isFreeTrial) {\n          showFreeTrialSubmitPopup();\n        } else {\n          showPopUp(\n            <PopUp.OneButton\n              intl={this.props.intl}\n              titleId=\"ID_FREE_TRIAL_SURVEY_SUBMIT_TITLE\"\n              subtitleId=\"ID_FEEDBACK_SUBMIT_DESCRIPTION\"\n              buttonNameId=\"ID_BUILDER_LIVE_ACCESS_OK\"\n            />\n          );\n        }\n      })\n      .catch(err => {\n        console.error(err);\n      });\n  };\n\n  render() {\n    const {\n      step,\n      lectureLevel,\n      lectureInterest,\n      lectureSpeed,\n      score\n    } = this.state;\n    const {\n      handleChange,\n      handleChangeSurveyAdmin1,\n      handleChangeSurveyAdmin2,\n      handleSubmitSurvey,\n      handleChangeScore,\n      handleChangeFeedbackTutor,\n      handleChangeFeedbackAdmin,\n      handleSubmitFeedback\n    } = this;\n    const { isFreeTrial } = this.props;\n    const isSurveyEnabled = this.isSurveyEnabled();\n    const isFeedbackEnabled = this.isFeedbackEnabled();\n    return (\n      <View\n        // Survey\n        step={step}\n        lectureLevel={lectureLevel}\n        lectureInterest={lectureInterest}\n        lectureSpeed={lectureSpeed}\n        surveySubmitEnabled={isSurveyEnabled}\n        handleChangeSurveyAdmin1={handleChangeSurveyAdmin1}\n        handleChangeSurveyAdmin2={handleChangeSurveyAdmin2}\n        isSurveyEnabled={isSurveyEnabled}\n        // Feedback\n        score={score}\n        handleChange={handleChange}\n        handleSubmitSurvey={handleSubmitSurvey}\n        handleSubmitFeedback={handleSubmitFeedback}\n        handleChangeScore={handleChangeScore}\n        handleChangeFeedbackTutor={handleChangeFeedbackTutor}\n        handleChangeFeedbackAdmin={handleChangeFeedbackAdmin}\n        isFeedbackEnabled={isFeedbackEnabled}\n        isFreeTrial={isFreeTrial}\n      />\n    );\n  }\n}\nexport default connect(\n  state => ({\n    email: state.userinfo.email\n  }),\n  {}\n)(injectIntl(Container));\n"]},"metadata":{},"sourceType":"module"}