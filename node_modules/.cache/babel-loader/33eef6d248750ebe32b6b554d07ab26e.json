{"ast":null,"code":"import _toConsumableArray from \"/Users/jimmy/Documents/Wizschool/wizlab_web2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _objectSpread from \"/Users/jimmy/Documents/Wizschool/wizlab_web2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nimport _classCallCheck from \"/Users/jimmy/Documents/Wizschool/wizlab_web2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/jimmy/Documents/Wizschool/wizlab_web2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _inherits from \"/Users/jimmy/Documents/Wizschool/wizlab_web2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _possibleConstructorReturn from \"/Users/jimmy/Documents/Wizschool/wizlab_web2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/jimmy/Documents/Wizschool/wizlab_web2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nvar _jsxFileName = \"/Users/jimmy/Documents/Wizschool/wizlab_web2/src/Page/Social/Article/index.js\";\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\n\nimport React, { Component } from \"react\";\nimport { connect } from \"react-redux\";\nimport { injectIntl } from \"react-intl\";\nimport { withRouter } from \"react-router-dom\";\nimport * as request from \"../../../Common/Util/HTTPRequest\";\nimport PopUp, { showPopUp } from \"../../../Common/Component/PopUp\";\nimport DraftEditor from \"../../../Common/Component/DraftEditor\";\nimport DreamReport from \"../../../Common/Component/DreamReport\";\nimport SignIn from \"../../../Common/Component/SignIn\";\nimport Comment from \"../Comment\";\nimport Menus from \"../Util/Menus\";\nimport { dateFormatter } from \"../Util/DateFormatter\";\nimport \"./index.scss\";\nimport moreImg from \"../../../Image/social_more.svg\";\nimport likeImg from \"../../../Image/social_like.svg\";\nimport likeActiveImg from \"../../../Image/social_like-active.svg\";\nimport commentImg from \"../../../Image/social_comment.svg\";\nimport arrowDownImg from \"../../../Image/social_arrow-down.svg\";\nimport officialIcon from \"../../../Image/certification-mark.svg\";\n\nvar Article = /*#__PURE__*/function (_Component) {\n  _inherits(Article, _Component);\n\n  var _super = _createSuper(Article);\n\n  function Article(props) {\n    var _this;\n\n    _classCallCheck(this, Article);\n\n    _this = _super.call(this, props);\n\n    _this.setFolding = function () {\n      var id = _this.props.article.id;\n      var draftEditor = document.getElementById(\"article_contents-\".concat(id));\n\n      if (draftEditor) {\n        var height = draftEditor.offsetHeight;\n\n        if (height < 420) {\n          _this.setState({\n            fold: false\n          });\n        }\n      }\n    };\n\n    _this.onClickUser = function () {\n      var user = _this.props.article.user;\n      window.scrollTo(0, 0);\n\n      _this.props.history.push(\"/userpage/\".concat(user.id));\n    };\n\n    _this.onClickMore = function () {\n      var menus = [];\n      var _this$props = _this.props,\n          email = _this$props.email,\n          article = _this$props.article,\n          intl = _this$props.intl;\n      var formatMessage = intl.formatMessage;\n      var user = article.user; // const shareMenu = {\n      //   name: \"공유하기\",\n      //   onClick: this.onClickShare\n      // };\n      // menus.push(shareMenu);\n\n      if (user.email === email) {\n        var editMenu = {\n          name: formatMessage({\n            id: \"ID_SOCIAL_MORE_UPDATE\"\n          }),\n          onClick: _this.onClickUpdate\n        };\n        menus.push(editMenu);\n        var deleteMenu = {\n          name: formatMessage({\n            id: \"ID_SOCIAL_MORE_DELTE\"\n          }),\n          onClick: _this.onClickDelete\n        };\n        menus.push(deleteMenu);\n      }\n\n      var reportMenu = {\n        name: formatMessage({\n          id: \"ID_SOCIAL_MORE_REPORT\"\n        }),\n        onClick: _this.onClickReport\n      };\n      menus.push(reportMenu);\n      showPopUp(React.createElement(Menus, {\n        menus: menus,\n        cancelButtonName: formatMessage({\n          id: \"ID_SOCIAL_MORE_CANCEL\"\n        }),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 104\n        },\n        __self: this\n      }), {\n        dismissOverlay: true,\n        dismissButton: false,\n        defaultPadding: false,\n        darkmode: true\n      });\n    };\n\n    _this.onClickSubscribe = function () {\n      var user = _this.props.article.user;\n\n      _this.props.onClickSubscribe(user);\n    };\n\n    _this.onClickUpdate = function () {\n      var id = _this.props.article.id;\n\n      _this.props.history.push(\"/socialwrite/\".concat(id));\n    };\n\n    _this.onClickReport = function () {\n      if (_this.props.email) {\n        showPopUp(React.createElement(DreamReport, {\n          targetType: \"socialArticle\",\n          targetContentId: _this.props.article.id,\n          targetUserId: _this.props.article.user.id,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 127\n          },\n          __self: this\n        }), {\n          darkmode: true,\n          mobileFullscreen: false,\n          dismissButton: false\n        });\n      } else {\n        showPopUp(React.createElement(SignIn, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 139\n          },\n          __self: this\n        }), {\n          darkmode: true,\n          mobileFullscreen: true\n        });\n      }\n    };\n\n    _this.onClickShare = function () {// const menus = [\n      //   {\n      //     name: \"페이스북에 공유\",\n      //     onClick: () => {\n      //       console.log(\"facebook\");\n      //     }\n      //   },\n      //   {\n      //     name: \"트위터에 공유\",\n      //     onClick: () => {\n      //       console.log(\"twitter\");\n      //     }\n      //   },\n      //   {\n      //     name: \"이메일로 공유\",\n      //     onClick: () => {\n      //       console.log(\"email\");\n      //     }\n      //   },\n      //   {\n      //     name: \"링크 복사\",\n      //     onClick: () => {\n      //       console.log(\"link\");\n      //     }\n      //   }\n      // ];\n      // showPopUp(<Menus menus={menus} />, {\n      //   defaultPadding: false,\n      //   darkmode: true\n      // });\n    };\n\n    _this.onClickDelete = function () {\n      var formatMessage = _this.props.intl.formatMessage;\n      showPopUp(React.createElement(PopUp.TwoButton, {\n        title: formatMessage({\n          id: \"ID_SOCIAL_ARTICLE_DELETE_TITLE\"\n        }),\n        cancelButtonName: formatMessage({\n          id: \"ID_SOCIAL_ARTICLE_DELETE_CANCEL\"\n        }),\n        confirmButtonName: formatMessage({\n          id: \"ID_SOCIAL_ARTICLE_DELETE_CONFIRM\"\n        }),\n        confirmAction: function confirmAction() {\n          var article = _this.props.article;\n          request.deleteSocialArticle(article.id).then(function (res) {\n            return res.json();\n          }).then(function (json) {\n            if (json.success) {\n              _this.props.onClickDelete();\n\n              showPopUp(React.createElement(PopUp.OneButton, {\n                title: formatMessage({\n                  id: \"ID_SOCIAL_ARTICLE_DELETED_TITLE\"\n                }),\n                buttonName: formatMessage({\n                  id: \"ID_SOCIAL_ARTICLE_DELETED_CONFIRM\"\n                }),\n                __source: {\n                  fileName: _jsxFileName,\n                  lineNumber: 197\n                },\n                __self: this\n              }), {\n                dismissOverlay: true,\n                dismissButton: false,\n                darkmode: true\n              });\n            }\n          }).catch(function (err) {\n            console.error(err);\n          });\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 180\n        },\n        __self: this\n      }), {\n        dismissOverlay: true,\n        dismissButton: false,\n        darkmode: true\n      });\n    };\n\n    _this.setDraftEditorRef = function (draftEditor) {\n      if (draftEditor) _this.draftEditor = draftEditor;\n    };\n\n    _this.onClickContentsMore = function () {\n      _this.setState({\n        fold: false\n      });\n    };\n\n    _this.onClickLike = function () {\n      if (_this.lastLikeTime) {\n        if (new Date().getTime() - _this.lastLikeTime < 1200) {\n          _this.lastLikeTime = new Date().getTime();\n          showPopUp(React.createElement(PopUp.OneButton, {\n            title: _this.props.intl.formatMessage({\n              id: \"ID_POPUP_WARNING_REPEAT_CLICK_TITLE\"\n            }),\n            buttonName: _this.props.intl.formatMessage({\n              id: \"ID_POPUP_WARNING_REPEAT_CLICK_BTN\"\n            }),\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 240\n            },\n            __self: this\n          }), {\n            darkmode: true\n          });\n          return;\n        }\n      }\n\n      _this.lastLikeTime = new Date().getTime();\n      var _this$props2 = _this.props,\n          email = _this$props2.email,\n          article = _this$props2.article;\n\n      if (email) {\n        request.likeSocialArticle({\n          email: email,\n          articleId: article.id\n        }).then(function (res) {\n          return res.json();\n        }).then(function (json) {\n          var isLiked = json.isLiked;\n\n          _this.setState(function (prevState) {\n            return {\n              isLiked: isLiked,\n              likeCount: prevState.likeCount + (isLiked ? 1 : -1)\n            };\n          });\n        });\n      } else {\n        showPopUp(React.createElement(SignIn, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 268\n          },\n          __self: this\n        }), {\n          darkmode: true,\n          mobileFullscreen: true\n        });\n      }\n    };\n\n    _this.onAddNewComment = function (comment) {\n      _this.setState(function (prevState) {\n        return {\n          comments: [].concat(prevState.comments, _objectSpread({}, comment, {\n            contents: JSON.parse(comment.contents),\n            createdAt: dateFormatter(comment.createdAt)\n          })),\n          commentsMax: prevState.commentsMax + 1\n        };\n      });\n    };\n\n    _this.onClickNewReply = function (commentId) {\n      var comments = _toConsumableArray(_this.state.comments).map(function (comment) {\n        return _objectSpread({}, comment, {\n          showNewReply: comment.showNewReply ? false : comment.id === commentId\n        });\n      });\n\n      _this.setState({\n        comments: comments\n      });\n    };\n\n    _this.onClickSelectQuest = function (commentId) {\n      request.selectSocialQuest({\n        articleId: _this.props.article.id,\n        commentId: commentId\n      }).then(function (res) {\n        return res.json();\n      }).then(function (json) {\n        if (json.success) {\n          _this.setState({\n            questEnd: true\n          });\n        }\n      });\n    };\n\n    _this.onClickCommentsMore = function () {\n      var comments = _this.state.comments;\n      var commentsMax = _this.state.commentsMax + 5;\n      if (commentsMax > comments.length) commentsMax = comments.length;\n\n      _this.setState({\n        commentsMax: commentsMax\n      });\n    };\n\n    var _article = props.article;\n    var _isLiked = _article.isLiked,\n        likeCount = _article.likeCount,\n        questEnd = _article.questEnd;\n\n    var _comments = _article.comments.map(function (comment) {\n      var contents;\n\n      try {\n        contents = JSON.parse(comment.contents);\n      } catch (_unused) {}\n\n      return _objectSpread({}, comment, {\n        contents: contents,\n        createdAt: dateFormatter(comment.createdAt),\n        showNewReply: false\n      });\n    });\n\n    _this.state = {\n      fold: true,\n      isLiked: _isLiked,\n      likeCount: likeCount,\n      questEnd: questEnd,\n      comments: _comments,\n      commentsMax: 2\n    };\n    return _this;\n  }\n\n  _createClass(Article, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this2 = this;\n\n      this.draftEditor.setContents(this.props.article.contents);\n      setTimeout(function () {\n        _this2.setFolding();\n      }, 10);\n    } // util\n\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this3 = this;\n\n      var _this$props3 = this.props,\n          email = _this$props3.email,\n          article = _this$props3.article,\n          onClickTag = _this$props3.onClickTag,\n          intl = _this$props3.intl;\n      var formatMessage = intl.formatMessage;\n      var _this$state = this.state,\n          fold = _this$state.fold,\n          isLiked = _this$state.isLiked,\n          likeCount = _this$state.likeCount,\n          questEnd = _this$state.questEnd,\n          comments = _this$state.comments,\n          commentsMax = _this$state.commentsMax;\n      var id = article.id,\n          title = article.title,\n          user = article.user,\n          articleTags = article.articleTags,\n          questPoint = article.questPoint,\n          createdAt = article.createdAt;\n      var commentCount = comments.reduce(function (prev, comment) {\n        return prev + comment.childComments.length + 1;\n      }, 0);\n      return React.createElement(\"div\", {\n        className: \"article\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 327\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"article_header\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 329\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"article_user\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 330\n        },\n        __self: this\n      }, React.createElement(\"img\", {\n        className: \"article_user_img\",\n        src: user.icon,\n        alt: user.dreamLoginId ? user.dreamLoginId : user.name,\n        onClick: this.onClickUser,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 331\n        },\n        __self: this\n      }), React.createElement(\"div\", {\n        className: \"article_user_section\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 337\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"article_user_info\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 338\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"article_user_name\",\n        onClick: this.onClickUser,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 339\n        },\n        __self: this\n      }, user.dreamLoginId ? user.dreamLoginId : user.name), user.isOfficial && React.createElement(\"div\", {\n        className: \"article_user_official\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 343\n        },\n        __self: this\n      }, React.createElement(\"img\", {\n        className: \"article_user_official_img\",\n        src: officialIcon,\n        alt: user.dreamLoginId ? user.dreamLoginId : user.name,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 344\n        },\n        __self: this\n      })), email !== user.email && React.createElement(React.Fragment, null, React.createElement(\"div\", {\n        className: \"article_user_divider\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 354\n        },\n        __self: this\n      }), React.createElement(\"button\", {\n        className: \"article_user_subscribe \".concat(user.isSubscribed ? \"article_user_subscribe-active\" : \"\"),\n        onClick: this.onClickSubscribe,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 355\n        },\n        __self: this\n      }, user.isSubscribed ? formatMessage({\n        id: \"ID_SOCIAL_ARTICLE_SUBSCRIBED\"\n      }) : formatMessage({\n        id: \"ID_SOCIAL_ARTICLE_SUBSCRIBE\"\n      })))), React.createElement(\"div\", {\n        className: \"article_user_date\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 368\n        },\n        __self: this\n      }, createdAt))), React.createElement(\"img\", {\n        className: \"article_more\",\n        src: moreImg,\n        alt: \"more\",\n        onClick: this.onClickMore,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 371\n        },\n        __self: this\n      })), articleTags && articleTags.length > 0 && React.createElement(\"div\", {\n        className: \"article_tags\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 380\n        },\n        __self: this\n      }, articleTags.map(function (articleTag, index) {\n        return React.createElement(\"span\", {\n          className: \"article_tag\",\n          key: index,\n          onClick: function onClick() {\n            onClickTag(articleTag.tag.name);\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 382\n          },\n          __self: this\n        }, \"#\", articleTag.tag.name);\n      })), React.createElement(\"div\", {\n        className: \"article_title_wrapper\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 395\n        },\n        __self: this\n      }, title && title !== \"\" && React.createElement(\"div\", {\n        className: \"article_title\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 397\n        },\n        __self: this\n      }, title), questPoint > 0 && React.createElement(\"div\", {\n        className: \"article_quest \".concat(questEnd ? \"article_quest-end\" : \"\"),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 400\n        },\n        __self: this\n      }, questEnd ? formatMessage({\n        id: \"ID_SOCIAL_ARTICLE_QUEST_END\"\n      }) : formatMessage({\n        id: \"ID_SOCIAL_ARTICLE_QUEST\"\n      }, {\n        questPoint: questPoint\n      }))), React.createElement(\"div\", {\n        id: \"article_contents-\".concat(id),\n        className: \"article_contents \".concat(fold ? \"article_contents-fold\" : \"\"),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 413\n        },\n        __self: this\n      }, React.createElement(DraftEditor, {\n        ref: this.setDraftEditorRef,\n        readonly: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 417\n        },\n        __self: this\n      })), fold && React.createElement(\"div\", {\n        className: \"article_contents_more\",\n        onClick: this.onClickContentsMore,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 420\n        },\n        __self: this\n      }, React.createElement(\"img\", {\n        className: \"article_contents_more_img\",\n        src: arrowDownImg,\n        alt: \"arrowDown\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 424\n        },\n        __self: this\n      })), React.createElement(\"div\", {\n        className: \"article_reactions\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 432\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"article_reaction article_reaction-like\",\n        onClick: this.onClickLike,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 433\n        },\n        __self: this\n      }, React.createElement(\"img\", {\n        className: \"article_reaction_img\",\n        src: isLiked ? likeActiveImg : likeImg,\n        alt: \"like\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 437\n        },\n        __self: this\n      }), React.createElement(\"div\", {\n        className: \"article_reaction_count\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 442\n        },\n        __self: this\n      }, likeCount)), React.createElement(\"div\", {\n        className: \"article_reaction article_reaction-comment\",\n        onClick: this.onClickNewComment,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 444\n        },\n        __self: this\n      }, React.createElement(\"img\", {\n        className: \"article_reaction_img\",\n        src: commentImg,\n        alt: \"comment\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 448\n        },\n        __self: this\n      }), React.createElement(\"div\", {\n        className: \"article_reaction_count\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 453\n        },\n        __self: this\n      }, commentCount))), comments.length > 0 && React.createElement(\"div\", {\n        className: \"article_comments\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 472\n        },\n        __self: this\n      }, comments.length > commentsMax && React.createElement(\"div\", {\n        className: \"article_comments_more\",\n        onClick: this.onClickCommentsMore,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 474\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"article_comments_more_text\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 478\n        },\n        __self: this\n      }, formatMessage({\n        id: \"ID_SOCIAL_ARTICLE_COMMENTS_MORE\"\n      }))), comments.slice(comments.length - commentsMax > 0 ? comments.length - commentsMax : 0, comments.length).map(function (comment, index) {\n        return React.createElement(Comment, {\n          key: comment.id,\n          article: article,\n          comment: comment,\n          onClickNewReply: function onClickNewReply() {\n            _this3.onClickNewReply(comment.id);\n          },\n          onClickSelectQuest: _this3.onClickSelectQuest,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 491\n          },\n          __self: this\n        });\n      })), email && React.createElement(\"div\", {\n        className: \"article_newComment\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 504\n        },\n        __self: this\n      }, React.createElement(Comment, {\n        article: article,\n        onAddNewComment: this.onAddNewComment,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 505\n        },\n        __self: this\n      })));\n    }\n  }]);\n\n  return Article;\n}(Component);\n\nexport default connect(function (state) {\n  return {\n    email: state.userinfo.email\n  };\n})(withRouter(injectIntl(Article)));","map":{"version":3,"sources":["/Users/jimmy/Documents/Wizschool/wizlab_web2/src/Page/Social/Article/index.js"],"names":["React","Component","connect","injectIntl","withRouter","request","PopUp","showPopUp","DraftEditor","DreamReport","SignIn","Comment","Menus","dateFormatter","Article","props","setFolding","id","article","draftEditor","document","getElementById","height","offsetHeight","setState","fold","onClickUser","user","window","scrollTo","history","push","onClickMore","menus","email","intl","formatMessage","editMenu","name","onClick","onClickUpdate","deleteMenu","onClickDelete","reportMenu","onClickReport","dismissOverlay","dismissButton","defaultPadding","darkmode","onClickSubscribe","mobileFullscreen","onClickShare","deleteSocialArticle","then","res","json","success","catch","err","console","error","setDraftEditorRef","onClickContentsMore","onClickLike","lastLikeTime","Date","getTime","likeSocialArticle","articleId","isLiked","prevState","likeCount","onAddNewComment","comment","comments","concat","contents","JSON","parse","createdAt","commentsMax","onClickNewReply","commentId","state","map","showNewReply","onClickSelectQuest","selectSocialQuest","questEnd","onClickCommentsMore","length","setContents","setTimeout","onClickTag","title","articleTags","questPoint","commentCount","reduce","prev","childComments","icon","dreamLoginId","isOfficial","officialIcon","isSubscribed","moreImg","articleTag","index","tag","arrowDownImg","likeActiveImg","likeImg","onClickNewComment","commentImg","slice","userinfo"],"mappings":";;;;;;;;;;;;;AAAA,OAAOA,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC;AACA,SAASC,OAAT,QAAwB,aAAxB;AACA,SAASC,UAAT,QAA2B,YAA3B;AACA,SAASC,UAAT,QAA2B,kBAA3B;AACA,OAAO,KAAKC,OAAZ,MAAyB,kCAAzB;AACA,OAAOC,KAAP,IAAgBC,SAAhB,QAAiC,iCAAjC;AACA,OAAOC,WAAP,MAAwB,uCAAxB;AACA,OAAOC,WAAP,MAAwB,uCAAxB;AACA,OAAOC,MAAP,MAAmB,kCAAnB;AACA,OAAOC,OAAP,MAAoB,YAApB;AACA,OAAOC,KAAP,MAAkB,eAAlB;AACA,SAASC,aAAT,QAA8B,uBAA9B;AACA,OAAO,cAAP;;;;;;;;IASMC,O;;;;;AACJ,mBAAYC,KAAZ,EAAmB;AAAA;;AAAA;;AACjB,8BAAMA,KAAN;;AADiB,UAkCnBC,UAlCmB,GAkCN,YAAM;AAAA,UACTC,EADS,GACF,MAAKF,KAAL,CAAWG,OADT,CACTD,EADS;AAEjB,UAAME,WAAW,GAAGC,QAAQ,CAACC,cAAT,4BAA4CJ,EAA5C,EAApB;;AACA,UAAIE,WAAJ,EAAiB;AACf,YAAMG,MAAM,GAAGH,WAAW,CAACI,YAA3B;;AACA,YAAID,MAAM,GAAG,GAAb,EAAkB;AAChB,gBAAKE,QAAL,CAAc;AAAEC,YAAAA,IAAI,EAAE;AAAR,WAAd;AACD;AACF;AACF,KA3CkB;;AAAA,UA8CnBC,WA9CmB,GA8CL,YAAM;AAAA,UACVC,IADU,GACD,MAAKZ,KAAL,CAAWG,OADV,CACVS,IADU;AAElBC,MAAAA,MAAM,CAACC,QAAP,CAAgB,CAAhB,EAAmB,CAAnB;;AACA,YAAKd,KAAL,CAAWe,OAAX,CAAmBC,IAAnB,qBAAqCJ,IAAI,CAACV,EAA1C;AACD,KAlDkB;;AAAA,UAqDnBe,WArDmB,GAqDL,YAAM;AAClB,UAAMC,KAAK,GAAG,EAAd;AADkB,wBAEe,MAAKlB,KAFpB;AAAA,UAEVmB,KAFU,eAEVA,KAFU;AAAA,UAEHhB,OAFG,eAEHA,OAFG;AAAA,UAEMiB,IAFN,eAEMA,IAFN;AAAA,UAGVC,aAHU,GAGQD,IAHR,CAGVC,aAHU;AAAA,UAIVT,IAJU,GAIDT,OAJC,CAIVS,IAJU,EAKlB;AACA;AACA;AACA;AACA;;AACA,UAAIA,IAAI,CAACO,KAAL,KAAeA,KAAnB,EAA0B;AACxB,YAAMG,QAAQ,GAAG;AACfC,UAAAA,IAAI,EAAEF,aAAa,CAAC;AAAEnB,YAAAA,EAAE,EAAE;AAAN,WAAD,CADJ;AAEfsB,UAAAA,OAAO,EAAE,MAAKC;AAFC,SAAjB;AAIAP,QAAAA,KAAK,CAACF,IAAN,CAAWM,QAAX;AACA,YAAMI,UAAU,GAAG;AACjBH,UAAAA,IAAI,EAAEF,aAAa,CAAC;AAAEnB,YAAAA,EAAE,EAAE;AAAN,WAAD,CADF;AAEjBsB,UAAAA,OAAO,EAAE,MAAKG;AAFG,SAAnB;AAIAT,QAAAA,KAAK,CAACF,IAAN,CAAWU,UAAX;AACD;;AACD,UAAME,UAAU,GAAG;AACjBL,QAAAA,IAAI,EAAEF,aAAa,CAAC;AAAEnB,UAAAA,EAAE,EAAE;AAAN,SAAD,CADF;AAEjBsB,QAAAA,OAAO,EAAE,MAAKK;AAFG,OAAnB;AAIAX,MAAAA,KAAK,CAACF,IAAN,CAAWY,UAAX;AACApC,MAAAA,SAAS,CACP,oBAAC,KAAD;AACE,QAAA,KAAK,EAAE0B,KADT;AAEE,QAAA,gBAAgB,EAAEG,aAAa,CAAC;AAAEnB,UAAAA,EAAE,EAAE;AAAN,SAAD,CAFjC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QADO,EAKP;AACE4B,QAAAA,cAAc,EAAE,IADlB;AAEEC,QAAAA,aAAa,EAAE,KAFjB;AAGEC,QAAAA,cAAc,EAAE,KAHlB;AAIEC,QAAAA,QAAQ,EAAE;AAJZ,OALO,CAAT;AAYD,KA5FkB;;AAAA,UA6FnBC,gBA7FmB,GA6FA,YAAM;AAAA,UACftB,IADe,GACN,MAAKZ,KAAL,CAAWG,OADL,CACfS,IADe;;AAEvB,YAAKZ,KAAL,CAAWkC,gBAAX,CAA4BtB,IAA5B;AACD,KAhGkB;;AAAA,UAiGnBa,aAjGmB,GAiGH,YAAM;AAAA,UACZvB,EADY,GACL,MAAKF,KAAL,CAAWG,OADN,CACZD,EADY;;AAEpB,YAAKF,KAAL,CAAWe,OAAX,CAAmBC,IAAnB,wBAAwCd,EAAxC;AACD,KApGkB;;AAAA,UAqGnB2B,aArGmB,GAqGH,YAAM;AACpB,UAAI,MAAK7B,KAAL,CAAWmB,KAAf,EAAsB;AACpB3B,QAAAA,SAAS,CACP,oBAAC,WAAD;AACE,UAAA,UAAU,EAAC,eADb;AAEE,UAAA,eAAe,EAAE,MAAKQ,KAAL,CAAWG,OAAX,CAAmBD,EAFtC;AAGE,UAAA,YAAY,EAAE,MAAKF,KAAL,CAAWG,OAAX,CAAmBS,IAAnB,CAAwBV,EAHxC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,UADO,EAMP;AACE+B,UAAAA,QAAQ,EAAE,IADZ;AAEEE,UAAAA,gBAAgB,EAAE,KAFpB;AAGEJ,UAAAA,aAAa,EAAE;AAHjB,SANO,CAAT;AAYD,OAbD,MAaO;AACLvC,QAAAA,SAAS,CAAC,oBAAC,MAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,UAAD,EAAa;AACpByC,UAAAA,QAAQ,EAAE,IADU;AAEpBE,UAAAA,gBAAgB,EAAE;AAFE,SAAb,CAAT;AAID;AACF,KAzHkB;;AAAA,UA0HnBC,YA1HmB,GA0HJ,YAAM,CACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACD,KAzJkB;;AAAA,UA0JnBT,aA1JmB,GA0JH,YAAM;AAAA,UACZN,aADY,GACM,MAAKrB,KAAL,CAAWoB,IADjB,CACZC,aADY;AAEpB7B,MAAAA,SAAS,CACP,oBAAC,KAAD,CAAO,SAAP;AACE,QAAA,KAAK,EAAE6B,aAAa,CAAC;AAAEnB,UAAAA,EAAE,EAAE;AAAN,SAAD,CADtB;AAEE,QAAA,gBAAgB,EAAEmB,aAAa,CAAC;AAC9BnB,UAAAA,EAAE,EAAE;AAD0B,SAAD,CAFjC;AAKE,QAAA,iBAAiB,EAAEmB,aAAa,CAAC;AAC/BnB,UAAAA,EAAE,EAAE;AAD2B,SAAD,CALlC;AAQE,QAAA,aAAa,EAAE,yBAAM;AAAA,cACXC,OADW,GACC,MAAKH,KADN,CACXG,OADW;AAEnBb,UAAAA,OAAO,CACJ+C,mBADH,CACuBlC,OAAO,CAACD,EAD/B,EAEGoC,IAFH,CAEQ,UAAAC,GAAG;AAAA,mBAAIA,GAAG,CAACC,IAAJ,EAAJ;AAAA,WAFX,EAGGF,IAHH,CAGQ,UAAAE,IAAI,EAAI;AACZ,gBAAIA,IAAI,CAACC,OAAT,EAAkB;AAChB,oBAAKzC,KAAL,CAAW2B,aAAX;;AACAnC,cAAAA,SAAS,CACP,oBAAC,KAAD,CAAO,SAAP;AACE,gBAAA,KAAK,EAAE6B,aAAa,CAAC;AACnBnB,kBAAAA,EAAE,EAAE;AADe,iBAAD,CADtB;AAIE,gBAAA,UAAU,EAAEmB,aAAa,CAAC;AACxBnB,kBAAAA,EAAE,EAAE;AADoB,iBAAD,CAJ3B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBADO,EASP;AACE4B,gBAAAA,cAAc,EAAE,IADlB;AAEEC,gBAAAA,aAAa,EAAE,KAFjB;AAGEE,gBAAAA,QAAQ,EAAE;AAHZ,eATO,CAAT;AAeD;AACF,WAtBH,EAuBGS,KAvBH,CAuBS,UAAAC,GAAG,EAAI;AACZC,YAAAA,OAAO,CAACC,KAAR,CAAcF,GAAd;AACD,WAzBH;AA0BD,SApCH;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QADO,EAuCP;AACEb,QAAAA,cAAc,EAAE,IADlB;AAEEC,QAAAA,aAAa,EAAE,KAFjB;AAGEE,QAAAA,QAAQ,EAAE;AAHZ,OAvCO,CAAT;AA6CD,KAzMkB;;AAAA,UA4MnBa,iBA5MmB,GA4MC,UAAA1C,WAAW,EAAI;AACjC,UAAIA,WAAJ,EAAiB,MAAKA,WAAL,GAAmBA,WAAnB;AAClB,KA9MkB;;AAAA,UA+MnB2C,mBA/MmB,GA+MG,YAAM;AAC1B,YAAKtC,QAAL,CAAc;AAAEC,QAAAA,IAAI,EAAE;AAAR,OAAd;AACD,KAjNkB;;AAAA,UAoNnBsC,WApNmB,GAoNL,YAAM;AAClB,UAAI,MAAKC,YAAT,EAAuB;AACrB,YAAI,IAAIC,IAAJ,GAAWC,OAAX,KAAuB,MAAKF,YAA5B,GAA2C,IAA/C,EAAqD;AACnD,gBAAKA,YAAL,GAAoB,IAAIC,IAAJ,GAAWC,OAAX,EAApB;AACA3D,UAAAA,SAAS,CACP,oBAAC,KAAD,CAAO,SAAP;AACE,YAAA,KAAK,EAAE,MAAKQ,KAAL,CAAWoB,IAAX,CAAgBC,aAAhB,CAA8B;AACnCnB,cAAAA,EAAE,EAAE;AAD+B,aAA9B,CADT;AAIE,YAAA,UAAU,EAAE,MAAKF,KAAL,CAAWoB,IAAX,CAAgBC,aAAhB,CAA8B;AACxCnB,cAAAA,EAAE,EAAE;AADoC,aAA9B,CAJd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,YADO,EASP;AAAE+B,YAAAA,QAAQ,EAAE;AAAZ,WATO,CAAT;AAWA;AACD;AACF;;AACD,YAAKgB,YAAL,GAAoB,IAAIC,IAAJ,GAAWC,OAAX,EAApB;AAlBkB,yBAoBS,MAAKnD,KApBd;AAAA,UAoBVmB,KApBU,gBAoBVA,KApBU;AAAA,UAoBHhB,OApBG,gBAoBHA,OApBG;;AAqBlB,UAAIgB,KAAJ,EAAW;AACT7B,QAAAA,OAAO,CACJ8D,iBADH,CACqB;AAAEjC,UAAAA,KAAK,EAALA,KAAF;AAASkC,UAAAA,SAAS,EAAElD,OAAO,CAACD;AAA5B,SADrB,EAEGoC,IAFH,CAEQ,UAAAC,GAAG;AAAA,iBAAIA,GAAG,CAACC,IAAJ,EAAJ;AAAA,SAFX,EAGGF,IAHH,CAGQ,UAAAE,IAAI,EAAI;AAAA,cACJc,OADI,GACQd,IADR,CACJc,OADI;;AAEZ,gBAAK7C,QAAL,CAAc,UAAA8C,SAAS;AAAA,mBAAK;AAC1BD,cAAAA,OAAO,EAAPA,OAD0B;AAE1BE,cAAAA,SAAS,EAAED,SAAS,CAACC,SAAV,IAAuBF,OAAO,GAAG,CAAH,GAAO,CAAC,CAAtC;AAFe,aAAL;AAAA,WAAvB;AAID,SATH;AAUD,OAXD,MAWO;AACL9D,QAAAA,SAAS,CAAC,oBAAC,MAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,UAAD,EAAa;AAAEyC,UAAAA,QAAQ,EAAE,IAAZ;AAAkBE,UAAAA,gBAAgB,EAAE;AAApC,SAAb,CAAT;AACD;AACF,KAvPkB;;AAAA,UA0PnBsB,eA1PmB,GA0PD,UAAAC,OAAO,EAAI;AAC3B,YAAKjD,QAAL,CAAc,UAAA8C,SAAS;AAAA,eAAK;AAC1BI,UAAAA,QAAQ,EAAE,GAAGC,MAAH,CACRL,SAAS,CAACI,QADF,oBAGHD,OAHG;AAING,YAAAA,QAAQ,EAAEC,IAAI,CAACC,KAAL,CAAWL,OAAO,CAACG,QAAnB,CAJJ;AAKNG,YAAAA,SAAS,EAAElE,aAAa,CAAC4D,OAAO,CAACM,SAAT;AALlB,aADgB;AAS1BC,UAAAA,WAAW,EAAEV,SAAS,CAACU,WAAV,GAAwB;AATX,SAAL;AAAA,OAAvB;AAWD,KAtQkB;;AAAA,UAuQnBC,eAvQmB,GAuQD,UAAAC,SAAS,EAAI;AAC7B,UAAMR,QAAQ,GAAG,mBAAI,MAAKS,KAAL,CAAWT,QAAf,EAAyBU,GAAzB,CAA6B,UAAAX,OAAO;AAAA,iCAChDA,OADgD;AAEnDY,UAAAA,YAAY,EAAEZ,OAAO,CAACY,YAAR,GAAuB,KAAvB,GAA+BZ,OAAO,CAACxD,EAAR,KAAeiE;AAFT;AAAA,OAApC,CAAjB;;AAIA,YAAK1D,QAAL,CAAc;AAAEkD,QAAAA,QAAQ,EAARA;AAAF,OAAd;AACD,KA7QkB;;AAAA,UA8QnBY,kBA9QmB,GA8QE,UAAAJ,SAAS,EAAI;AAChC7E,MAAAA,OAAO,CACJkF,iBADH,CACqB;AAAEnB,QAAAA,SAAS,EAAE,MAAKrD,KAAL,CAAWG,OAAX,CAAmBD,EAAhC;AAAoCiE,QAAAA,SAAS,EAATA;AAApC,OADrB,EAEG7B,IAFH,CAEQ,UAAAC,GAAG;AAAA,eAAIA,GAAG,CAACC,IAAJ,EAAJ;AAAA,OAFX,EAGGF,IAHH,CAGQ,UAAAE,IAAI,EAAI;AACZ,YAAIA,IAAI,CAACC,OAAT,EAAkB;AAChB,gBAAKhC,QAAL,CAAc;AAAEgE,YAAAA,QAAQ,EAAE;AAAZ,WAAd;AACD;AACF,OAPH;AAQD,KAvRkB;;AAAA,UAwRnBC,mBAxRmB,GAwRG,YAAM;AAAA,UAClBf,QADkB,GACL,MAAKS,KADA,CAClBT,QADkB;AAE1B,UAAIM,WAAW,GAAG,MAAKG,KAAL,CAAWH,WAAX,GAAyB,CAA3C;AACA,UAAIA,WAAW,GAAGN,QAAQ,CAACgB,MAA3B,EAAmCV,WAAW,GAAGN,QAAQ,CAACgB,MAAvB;;AACnC,YAAKlE,QAAL,CAAc;AAAEwD,QAAAA,WAAW,EAAXA;AAAF,OAAd;AACD,KA7RkB;;AAAA,QAET9D,QAFS,GAEGH,KAFH,CAETG,OAFS;AAAA,QAGTmD,QAHS,GAGwBnD,QAHxB,CAGTmD,OAHS;AAAA,QAGAE,SAHA,GAGwBrD,QAHxB,CAGAqD,SAHA;AAAA,QAGWiB,QAHX,GAGwBtE,QAHxB,CAGWsE,QAHX;;AAIjB,QAAMd,SAAQ,GAAGxD,QAAO,CAACwD,QAAR,CAAiBU,GAAjB,CAAqB,UAAAX,OAAO,EAAI;AAC/C,UAAIG,QAAJ;;AACA,UAAI;AACFA,QAAAA,QAAQ,GAAGC,IAAI,CAACC,KAAL,CAAWL,OAAO,CAACG,QAAnB,CAAX;AACD,OAFD,CAEE,gBAAM,CAAE;;AACV,+BACKH,OADL;AAEEG,QAAAA,QAAQ,EAARA,QAFF;AAGEG,QAAAA,SAAS,EAAElE,aAAa,CAAC4D,OAAO,CAACM,SAAT,CAH1B;AAIEM,QAAAA,YAAY,EAAE;AAJhB;AAMD,KAXgB,CAAjB;;AAaA,UAAKF,KAAL,GAAa;AACX1D,MAAAA,IAAI,EAAE,IADK;AAEX4C,MAAAA,OAAO,EAAPA,QAFW;AAGXE,MAAAA,SAAS,EAATA,SAHW;AAIXiB,MAAAA,QAAQ,EAARA,QAJW;AAKXd,MAAAA,QAAQ,EAARA,SALW;AAMXM,MAAAA,WAAW,EAAE;AANF,KAAb;AAjBiB;AAyBlB;;;;WACD,6BAAoB;AAAA;;AAClB,WAAK7D,WAAL,CAAiBwE,WAAjB,CAA6B,KAAK5E,KAAL,CAAWG,OAAX,CAAmB0D,QAAhD;AACAgB,MAAAA,UAAU,CAAC,YAAM;AACf,QAAA,MAAI,CAAC5E,UAAL;AACD,OAFS,EAEP,EAFO,CAAV;AAGD,K,CAED;;;;WA8PA,kBAAS;AAAA;;AAAA,yBACsC,KAAKD,KAD3C;AAAA,UACCmB,KADD,gBACCA,KADD;AAAA,UACQhB,OADR,gBACQA,OADR;AAAA,UACiB2E,UADjB,gBACiBA,UADjB;AAAA,UAC6B1D,IAD7B,gBAC6BA,IAD7B;AAAA,UAECC,aAFD,GAEmBD,IAFnB,CAECC,aAFD;AAAA,wBAUH,KAAK+C,KAVF;AAAA,UAIL1D,IAJK,eAILA,IAJK;AAAA,UAKL4C,OALK,eAKLA,OALK;AAAA,UAMLE,SANK,eAMLA,SANK;AAAA,UAOLiB,QAPK,eAOLA,QAPK;AAAA,UAQLd,QARK,eAQLA,QARK;AAAA,UASLM,WATK,eASLA,WATK;AAAA,UAWC/D,EAXD,GAWyDC,OAXzD,CAWCD,EAXD;AAAA,UAWK6E,KAXL,GAWyD5E,OAXzD,CAWK4E,KAXL;AAAA,UAWYnE,IAXZ,GAWyDT,OAXzD,CAWYS,IAXZ;AAAA,UAWkBoE,WAXlB,GAWyD7E,OAXzD,CAWkB6E,WAXlB;AAAA,UAW+BC,UAX/B,GAWyD9E,OAXzD,CAW+B8E,UAX/B;AAAA,UAW2CjB,SAX3C,GAWyD7D,OAXzD,CAW2C6D,SAX3C;AAYP,UAAMkB,YAAY,GAAGvB,QAAQ,CAACwB,MAAT,CACnB,UAACC,IAAD,EAAO1B,OAAP;AAAA,eAAmB0B,IAAI,GAAG1B,OAAO,CAAC2B,aAAR,CAAsBV,MAA7B,GAAsC,CAAzD;AAAA,OADmB,EAEnB,CAFmB,CAArB;AAIA,aACE;AAAK,QAAA,SAAS,EAAC,SAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAEE;AAAK,QAAA,SAAS,EAAC,gBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE;AAAK,QAAA,SAAS,EAAC,cAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE;AACE,QAAA,SAAS,EAAC,kBADZ;AAEE,QAAA,GAAG,EAAE/D,IAAI,CAAC0E,IAFZ;AAGE,QAAA,GAAG,EAAE1E,IAAI,CAAC2E,YAAL,GAAoB3E,IAAI,CAAC2E,YAAzB,GAAwC3E,IAAI,CAACW,IAHpD;AAIE,QAAA,OAAO,EAAE,KAAKZ,WAJhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QADF,EAOE;AAAK,QAAA,SAAS,EAAC,sBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE;AAAK,QAAA,SAAS,EAAC,mBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE;AAAK,QAAA,SAAS,EAAC,mBAAf;AAAmC,QAAA,OAAO,EAAE,KAAKA,WAAjD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACGC,IAAI,CAAC2E,YAAL,GAAoB3E,IAAI,CAAC2E,YAAzB,GAAwC3E,IAAI,CAACW,IADhD,CADF,EAIGX,IAAI,CAAC4E,UAAL,IACC;AAAK,QAAA,SAAS,EAAC,uBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE;AACE,QAAA,SAAS,EAAC,2BADZ;AAEE,QAAA,GAAG,EAAEC,YAFP;AAGE,QAAA,GAAG,EAAE7E,IAAI,CAAC2E,YAAL,GAAoB3E,IAAI,CAAC2E,YAAzB,GAAwC3E,IAAI,CAACW,IAHpD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QADF,CALJ,EAcGJ,KAAK,KAAKP,IAAI,CAACO,KAAf,IACC,0CACE;AAAK,QAAA,SAAS,EAAC,sBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QADF,EAEE;AACE,QAAA,SAAS,mCACPP,IAAI,CAAC8E,YAAL,GAAoB,+BAApB,GAAsD,EAD/C,CADX;AAIE,QAAA,OAAO,EAAE,KAAKxD,gBAJhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAMGtB,IAAI,CAAC8E,YAAL,GACGrE,aAAa,CAAC;AAAEnB,QAAAA,EAAE,EAAE;AAAN,OAAD,CADhB,GAEGmB,aAAa,CAAC;AAAEnB,QAAAA,EAAE,EAAE;AAAN,OAAD,CARnB,CAFF,CAfJ,CADF,EA+BE;AAAK,QAAA,SAAS,EAAC,mBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAAoC8D,SAApC,CA/BF,CAPF,CADF,EA0CE;AACE,QAAA,SAAS,EAAC,cADZ;AAEE,QAAA,GAAG,EAAE2B,OAFP;AAGE,QAAA,GAAG,EAAC,MAHN;AAIE,QAAA,OAAO,EAAE,KAAK1E,WAJhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QA1CF,CAFF,EAoDG+D,WAAW,IAAIA,WAAW,CAACL,MAAZ,GAAqB,CAApC,IACC;AAAK,QAAA,SAAS,EAAC,cAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACGK,WAAW,CAACX,GAAZ,CAAgB,UAACuB,UAAD,EAAaC,KAAb;AAAA,eACf;AACE,UAAA,SAAS,EAAC,aADZ;AAEE,UAAA,GAAG,EAAEA,KAFP;AAGE,UAAA,OAAO,EAAE,mBAAM;AACbf,YAAAA,UAAU,CAACc,UAAU,CAACE,GAAX,CAAevE,IAAhB,CAAV;AACD,WALH;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBAOIqE,UAAU,CAACE,GAAX,CAAevE,IAPnB,CADe;AAAA,OAAhB,CADH,CArDJ,EAoEE;AAAK,QAAA,SAAS,EAAC,uBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACGwD,KAAK,IAAIA,KAAK,KAAK,EAAnB,IACC;AAAK,QAAA,SAAS,EAAC,eAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAAgCA,KAAhC,CAFJ,EAIGE,UAAU,GAAG,CAAb,IACC;AACE,QAAA,SAAS,0BAAmBR,QAAQ,GAAG,mBAAH,GAAyB,EAApD,CADX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAGGA,QAAQ,GACLpD,aAAa,CAAC;AAAEnB,QAAAA,EAAE,EAAE;AAAN,OAAD,CADR,GAELmB,aAAa,CACX;AAAEnB,QAAAA,EAAE,EAAE;AAAN,OADW,EAEX;AAAE+E,QAAAA,UAAU,EAAVA;AAAF,OAFW,CALnB,CALJ,CApEF,EAsFE;AACE,QAAA,EAAE,6BAAsB/E,EAAtB,CADJ;AAEE,QAAA,SAAS,6BAAsBQ,IAAI,GAAG,uBAAH,GAA6B,EAAvD,CAFX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAIE,oBAAC,WAAD;AAAa,QAAA,GAAG,EAAE,KAAKoC,iBAAvB;AAA0C,QAAA,QAAQ,EAAE,IAApD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAJF,CAtFF,EA4FGpC,IAAI,IACH;AACE,QAAA,SAAS,EAAC,uBADZ;AAEE,QAAA,OAAO,EAAE,KAAKqC,mBAFhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAIE;AACE,QAAA,SAAS,EAAC,2BADZ;AAEE,QAAA,GAAG,EAAEgD,YAFP;AAGE,QAAA,GAAG,EAAC,WAHN;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAJF,CA7FJ,EAyGE;AAAK,QAAA,SAAS,EAAC,mBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE;AACE,QAAA,SAAS,EAAC,wCADZ;AAEE,QAAA,OAAO,EAAE,KAAK/C,WAFhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAIE;AACE,QAAA,SAAS,EAAC,sBADZ;AAEE,QAAA,GAAG,EAAEM,OAAO,GAAG0C,aAAH,GAAmBC,OAFjC;AAGE,QAAA,GAAG,EAAC,MAHN;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAJF,EASE;AAAK,QAAA,SAAS,EAAC,wBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAAyCzC,SAAzC,CATF,CADF,EAYE;AACE,QAAA,SAAS,EAAC,2CADZ;AAEE,QAAA,OAAO,EAAE,KAAK0C,iBAFhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAIE;AACE,QAAA,SAAS,EAAC,sBADZ;AAEE,QAAA,GAAG,EAAEC,UAFP;AAGE,QAAA,GAAG,EAAC,SAHN;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAJF,EASE;AAAK,QAAA,SAAS,EAAC,wBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAAyCjB,YAAzC,CATF,CAZF,CAzGF,EAgJGvB,QAAQ,CAACgB,MAAT,GAAkB,CAAlB,IACC;AAAK,QAAA,SAAS,EAAC,kBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACGhB,QAAQ,CAACgB,MAAT,GAAkBV,WAAlB,IACC;AACE,QAAA,SAAS,EAAC,uBADZ;AAEE,QAAA,OAAO,EAAE,KAAKS,mBAFhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAIE;AAAK,QAAA,SAAS,EAAC,4BAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACGrD,aAAa,CAAC;AAAEnB,QAAAA,EAAE,EAAE;AAAN,OAAD,CADhB,CAJF,CAFJ,EAWGyD,QAAQ,CACNyC,KADF,CAEGzC,QAAQ,CAACgB,MAAT,GAAkBV,WAAlB,GAAgC,CAAhC,GACIN,QAAQ,CAACgB,MAAT,GAAkBV,WADtB,GAEI,CAJP,EAKGN,QAAQ,CAACgB,MALZ,EAOEN,GAPF,CAOM,UAACX,OAAD,EAAUmC,KAAV;AAAA,eACH,oBAAC,OAAD;AACE,UAAA,GAAG,EAAEnC,OAAO,CAACxD,EADf;AAEE,UAAA,OAAO,EAAEC,OAFX;AAGE,UAAA,OAAO,EAAEuD,OAHX;AAIE,UAAA,eAAe,EAAE,2BAAM;AACrB,YAAA,MAAI,CAACQ,eAAL,CAAqBR,OAAO,CAACxD,EAA7B;AACD,WANH;AAOE,UAAA,kBAAkB,EAAE,MAAI,CAACqE,kBAP3B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,UADG;AAAA,OAPN,CAXH,CAjJJ,EAgLGpD,KAAK,IACJ;AAAK,QAAA,SAAS,EAAC,oBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE,oBAAC,OAAD;AAAS,QAAA,OAAO,EAAEhB,OAAlB;AAA2B,QAAA,eAAe,EAAE,KAAKsD,eAAjD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QADF,CAjLJ,CADF;AAwLD;;;;EAxemBvE,S;;AA2etB,eAAeC,OAAO,CAAC,UAAAiF,KAAK;AAAA,SAAK;AAAEjD,IAAAA,KAAK,EAAEiD,KAAK,CAACiC,QAAN,CAAelF;AAAxB,GAAL;AAAA,CAAN,CAAP,CACb9B,UAAU,CAACD,UAAU,CAACW,OAAD,CAAX,CADG,CAAf","sourcesContent":["import React, { Component } from \"react\";\nimport { connect } from \"react-redux\";\nimport { injectIntl } from \"react-intl\";\nimport { withRouter } from \"react-router-dom\";\nimport * as request from \"../../../Common/Util/HTTPRequest\";\nimport PopUp, { showPopUp } from \"../../../Common/Component/PopUp\";\nimport DraftEditor from \"../../../Common/Component/DraftEditor\";\nimport DreamReport from \"../../../Common/Component/DreamReport\";\nimport SignIn from \"../../../Common/Component/SignIn\";\nimport Comment from \"../Comment\";\nimport Menus from \"../Util/Menus\";\nimport { dateFormatter } from \"../Util/DateFormatter\";\nimport \"./index.scss\";\n\nimport moreImg from \"../../../Image/social_more.svg\";\nimport likeImg from \"../../../Image/social_like.svg\";\nimport likeActiveImg from \"../../../Image/social_like-active.svg\";\nimport commentImg from \"../../../Image/social_comment.svg\";\nimport arrowDownImg from \"../../../Image/social_arrow-down.svg\";\nimport officialIcon from \"../../../Image/certification-mark.svg\";\n\nclass Article extends Component {\n  constructor(props) {\n    super(props);\n    const { article } = props;\n    const { isLiked, likeCount, questEnd } = article;\n    const comments = article.comments.map(comment => {\n      let contents;\n      try {\n        contents = JSON.parse(comment.contents);\n      } catch {}\n      return {\n        ...comment,\n        contents,\n        createdAt: dateFormatter(comment.createdAt),\n        showNewReply: false\n      };\n    });\n\n    this.state = {\n      fold: true,\n      isLiked,\n      likeCount,\n      questEnd,\n      comments,\n      commentsMax: 2\n    };\n  }\n  componentDidMount() {\n    this.draftEditor.setContents(this.props.article.contents);\n    setTimeout(() => {\n      this.setFolding();\n    }, 10);\n  }\n\n  // util\n  setFolding = () => {\n    const { id } = this.props.article;\n    const draftEditor = document.getElementById(`article_contents-${id}`);\n    if (draftEditor) {\n      const height = draftEditor.offsetHeight;\n      if (height < 420) {\n        this.setState({ fold: false });\n      }\n    }\n  };\n\n  // user\n  onClickUser = () => {\n    const { user } = this.props.article;\n    window.scrollTo(0, 0);\n    this.props.history.push(`/userpage/${user.id}`);\n  };\n\n  // more\n  onClickMore = () => {\n    const menus = [];\n    const { email, article, intl } = this.props;\n    const { formatMessage } = intl;\n    const { user } = article;\n    // const shareMenu = {\n    //   name: \"공유하기\",\n    //   onClick: this.onClickShare\n    // };\n    // menus.push(shareMenu);\n    if (user.email === email) {\n      const editMenu = {\n        name: formatMessage({ id: \"ID_SOCIAL_MORE_UPDATE\" }),\n        onClick: this.onClickUpdate\n      };\n      menus.push(editMenu);\n      const deleteMenu = {\n        name: formatMessage({ id: \"ID_SOCIAL_MORE_DELTE\" }),\n        onClick: this.onClickDelete\n      };\n      menus.push(deleteMenu);\n    }\n    const reportMenu = {\n      name: formatMessage({ id: \"ID_SOCIAL_MORE_REPORT\" }),\n      onClick: this.onClickReport\n    };\n    menus.push(reportMenu);\n    showPopUp(\n      <Menus\n        menus={menus}\n        cancelButtonName={formatMessage({ id: \"ID_SOCIAL_MORE_CANCEL\" })}\n      />,\n      {\n        dismissOverlay: true,\n        dismissButton: false,\n        defaultPadding: false,\n        darkmode: true\n      }\n    );\n  };\n  onClickSubscribe = () => {\n    const { user } = this.props.article;\n    this.props.onClickSubscribe(user);\n  };\n  onClickUpdate = () => {\n    const { id } = this.props.article;\n    this.props.history.push(`/socialwrite/${id}`);\n  };\n  onClickReport = () => {\n    if (this.props.email) {\n      showPopUp(\n        <DreamReport\n          targetType=\"socialArticle\"\n          targetContentId={this.props.article.id}\n          targetUserId={this.props.article.user.id}\n        />,\n        {\n          darkmode: true,\n          mobileFullscreen: false,\n          dismissButton: false\n        }\n      );\n    } else {\n      showPopUp(<SignIn />, {\n        darkmode: true,\n        mobileFullscreen: true\n      });\n    }\n  };\n  onClickShare = () => {\n    // const menus = [\n    //   {\n    //     name: \"페이스북에 공유\",\n    //     onClick: () => {\n    //       console.log(\"facebook\");\n    //     }\n    //   },\n    //   {\n    //     name: \"트위터에 공유\",\n    //     onClick: () => {\n    //       console.log(\"twitter\");\n    //     }\n    //   },\n    //   {\n    //     name: \"이메일로 공유\",\n    //     onClick: () => {\n    //       console.log(\"email\");\n    //     }\n    //   },\n    //   {\n    //     name: \"링크 복사\",\n    //     onClick: () => {\n    //       console.log(\"link\");\n    //     }\n    //   }\n    // ];\n    // showPopUp(<Menus menus={menus} />, {\n    //   defaultPadding: false,\n    //   darkmode: true\n    // });\n  };\n  onClickDelete = () => {\n    const { formatMessage } = this.props.intl;\n    showPopUp(\n      <PopUp.TwoButton\n        title={formatMessage({ id: \"ID_SOCIAL_ARTICLE_DELETE_TITLE\" })}\n        cancelButtonName={formatMessage({\n          id: \"ID_SOCIAL_ARTICLE_DELETE_CANCEL\"\n        })}\n        confirmButtonName={formatMessage({\n          id: \"ID_SOCIAL_ARTICLE_DELETE_CONFIRM\"\n        })}\n        confirmAction={() => {\n          const { article } = this.props;\n          request\n            .deleteSocialArticle(article.id)\n            .then(res => res.json())\n            .then(json => {\n              if (json.success) {\n                this.props.onClickDelete();\n                showPopUp(\n                  <PopUp.OneButton\n                    title={formatMessage({\n                      id: \"ID_SOCIAL_ARTICLE_DELETED_TITLE\"\n                    })}\n                    buttonName={formatMessage({\n                      id: \"ID_SOCIAL_ARTICLE_DELETED_CONFIRM\"\n                    })}\n                  />,\n                  {\n                    dismissOverlay: true,\n                    dismissButton: false,\n                    darkmode: true\n                  }\n                );\n              }\n            })\n            .catch(err => {\n              console.error(err);\n            });\n        }}\n      />,\n      {\n        dismissOverlay: true,\n        dismissButton: false,\n        darkmode: true\n      }\n    );\n  };\n\n  // contents\n  setDraftEditorRef = draftEditor => {\n    if (draftEditor) this.draftEditor = draftEditor;\n  };\n  onClickContentsMore = () => {\n    this.setState({ fold: false });\n  };\n\n  // reactions\n  onClickLike = () => {\n    if (this.lastLikeTime) {\n      if (new Date().getTime() - this.lastLikeTime < 1200) {\n        this.lastLikeTime = new Date().getTime();\n        showPopUp(\n          <PopUp.OneButton\n            title={this.props.intl.formatMessage({\n              id: \"ID_POPUP_WARNING_REPEAT_CLICK_TITLE\"\n            })}\n            buttonName={this.props.intl.formatMessage({\n              id: \"ID_POPUP_WARNING_REPEAT_CLICK_BTN\"\n            })}\n          />,\n          { darkmode: true }\n        );\n        return;\n      }\n    }\n    this.lastLikeTime = new Date().getTime();\n\n    const { email, article } = this.props;\n    if (email) {\n      request\n        .likeSocialArticle({ email, articleId: article.id })\n        .then(res => res.json())\n        .then(json => {\n          const { isLiked } = json;\n          this.setState(prevState => ({\n            isLiked,\n            likeCount: prevState.likeCount + (isLiked ? 1 : -1)\n          }));\n        });\n    } else {\n      showPopUp(<SignIn />, { darkmode: true, mobileFullscreen: true });\n    }\n  };\n\n  // comment\n  onAddNewComment = comment => {\n    this.setState(prevState => ({\n      comments: [].concat(\n        prevState.comments,\n        {\n          ...comment,\n          contents: JSON.parse(comment.contents),\n          createdAt: dateFormatter(comment.createdAt)\n        }\n      ),\n      commentsMax: prevState.commentsMax + 1\n    }));\n  };\n  onClickNewReply = commentId => {\n    const comments = [...this.state.comments].map(comment => ({\n      ...comment,\n      showNewReply: comment.showNewReply ? false : comment.id === commentId\n    }));\n    this.setState({ comments });\n  };\n  onClickSelectQuest = commentId => {\n    request\n      .selectSocialQuest({ articleId: this.props.article.id, commentId })\n      .then(res => res.json())\n      .then(json => {\n        if (json.success) {\n          this.setState({ questEnd: true });\n        }\n      });\n  };\n  onClickCommentsMore = () => {\n    const { comments } = this.state;\n    let commentsMax = this.state.commentsMax + 5;\n    if (commentsMax > comments.length) commentsMax = comments.length;\n    this.setState({ commentsMax });\n  };\n\n  render() {\n    const { email, article, onClickTag, intl } = this.props;\n    const { formatMessage } = intl;\n    const {\n      fold,\n      isLiked,\n      likeCount,\n      questEnd,\n      comments,\n      commentsMax\n    } = this.state;\n    const { id, title, user, articleTags, questPoint, createdAt } = article;\n    const commentCount = comments.reduce(\n      (prev, comment) => prev + comment.childComments.length + 1,\n      0\n    );\n    return (\n      <div className=\"article\">\n        {/* ===== 헤더 ============================== */}\n        <div className=\"article_header\">\n          <div className=\"article_user\">\n            <img\n              className=\"article_user_img\"\n              src={user.icon}\n              alt={user.dreamLoginId ? user.dreamLoginId : user.name}\n              onClick={this.onClickUser}\n            />\n            <div className=\"article_user_section\">\n              <div className=\"article_user_info\">\n                <div className=\"article_user_name\" onClick={this.onClickUser}>\n                  {user.dreamLoginId ? user.dreamLoginId : user.name}\n                </div>\n                {user.isOfficial && (\n                  <div className=\"article_user_official\">\n                    <img\n                      className=\"article_user_official_img\"\n                      src={officialIcon}\n                      alt={user.dreamLoginId ? user.dreamLoginId : user.name}\n                    />\n                  </div>\n                )}\n\n                {email !== user.email && (\n                  <>\n                    <div className=\"article_user_divider\" />\n                    <button\n                      className={`article_user_subscribe ${\n                        user.isSubscribed ? \"article_user_subscribe-active\" : \"\"\n                      }`}\n                      onClick={this.onClickSubscribe}\n                    >\n                      {user.isSubscribed\n                        ? formatMessage({ id: \"ID_SOCIAL_ARTICLE_SUBSCRIBED\" })\n                        : formatMessage({ id: \"ID_SOCIAL_ARTICLE_SUBSCRIBE\" })}\n                    </button>\n                  </>\n                )}\n              </div>\n              <div className=\"article_user_date\">{createdAt}</div>\n            </div>\n          </div>\n          <img\n            className=\"article_more\"\n            src={moreImg}\n            alt=\"more\"\n            onClick={this.onClickMore}\n          />\n        </div>\n        {/* ===== 태그 ============================== */}\n        {articleTags && articleTags.length > 0 && (\n          <div className=\"article_tags\">\n            {articleTags.map((articleTag, index) => (\n              <span\n                className=\"article_tag\"\n                key={index}\n                onClick={() => {\n                  onClickTag(articleTag.tag.name);\n                }}\n              >\n                #{articleTag.tag.name}\n              </span>\n            ))}\n          </div>\n        )}\n        {/* ===== 제목 + 퀘스트 ============================== */}\n        <div className=\"article_title_wrapper\">\n          {title && title !== \"\" && (\n            <div className=\"article_title\">{title}</div>\n          )}\n          {questPoint > 0 && (\n            <div\n              className={`article_quest ${questEnd ? \"article_quest-end\" : \"\"}`}\n            >\n              {questEnd\n                ? formatMessage({ id: \"ID_SOCIAL_ARTICLE_QUEST_END\" })\n                : formatMessage(\n                    { id: \"ID_SOCIAL_ARTICLE_QUEST\" },\n                    { questPoint }\n                  )}\n            </div>\n          )}\n        </div>\n        {/* ===== 콘텐츠 ============================== */}\n        <div\n          id={`article_contents-${id}`}\n          className={`article_contents ${fold ? \"article_contents-fold\" : \"\"}`}\n        >\n          <DraftEditor ref={this.setDraftEditorRef} readonly={true} />\n        </div>\n        {fold && (\n          <div\n            className=\"article_contents_more\"\n            onClick={this.onClickContentsMore}\n          >\n            <img\n              className=\"article_contents_more_img\"\n              src={arrowDownImg}\n              alt=\"arrowDown\"\n            />\n          </div>\n        )}\n        {/* ===== 액션 + 퀘스트(모바일) ============================== */}\n        <div className=\"article_reactions\">\n          <div\n            className=\"article_reaction article_reaction-like\"\n            onClick={this.onClickLike}\n          >\n            <img\n              className=\"article_reaction_img\"\n              src={isLiked ? likeActiveImg : likeImg}\n              alt=\"like\"\n            />\n            <div className=\"article_reaction_count\">{likeCount}</div>\n          </div>\n          <div\n            className=\"article_reaction article_reaction-comment\"\n            onClick={this.onClickNewComment}\n          >\n            <img\n              className=\"article_reaction_img\"\n              src={commentImg}\n              alt=\"comment\"\n            />\n            <div className=\"article_reaction_count\">{commentCount}</div>\n          </div>\n          {/* {questPoint > 0 && (\n            <div\n              className={`article_quest article_quest-mobile ${\n                questEnd ? \"article_quest-end\" : \"\"\n              }`}\n            >\n              {questEnd\n                ? formatMessage({ id: \"ID_SOCIAL_ARTICLE_QUEST_END\" })\n                : formatMessage(\n                    { id: \"ID_SOCIAL_ARTICLE_QUEST\" },\n                    { questPoint }\n                  )}\n            </div>\n          )} */}\n        </div>\n        {/* ===== 댓글 ============================== */}\n        {comments.length > 0 && (\n          <div className=\"article_comments\">\n            {comments.length > commentsMax && (\n              <div\n                className=\"article_comments_more\"\n                onClick={this.onClickCommentsMore}\n              >\n                <div className=\"article_comments_more_text\">\n                  {formatMessage({ id: \"ID_SOCIAL_ARTICLE_COMMENTS_MORE\" })}\n                </div>\n              </div>\n            )}\n            {comments\n              .slice(\n                comments.length - commentsMax > 0\n                  ? comments.length - commentsMax\n                  : 0,\n                comments.length\n              )\n              .map((comment, index) => (\n                <Comment\n                  key={comment.id}\n                  article={article}\n                  comment={comment}\n                  onClickNewReply={() => {\n                    this.onClickNewReply(comment.id);\n                  }}\n                  onClickSelectQuest={this.onClickSelectQuest}\n                />\n              ))}\n          </div>\n        )}\n        {email && (\n          <div className=\"article_newComment\">\n            <Comment article={article} onAddNewComment={this.onAddNewComment} />\n          </div>\n        )}\n      </div>\n    );\n  }\n}\n\nexport default connect(state => ({ email: state.userinfo.email }))(\n  withRouter(injectIntl(Article))\n);\n"]},"metadata":{},"sourceType":"module"}