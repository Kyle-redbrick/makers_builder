{"ast":null,"code":"import _objectSpread from \"/Users/jimmy/Documents/Wizschool/wizlab_web2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nimport _classCallCheck from \"/Users/jimmy/Documents/Wizschool/wizlab_web2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/jimmy/Documents/Wizschool/wizlab_web2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _inherits from \"/Users/jimmy/Documents/Wizschool/wizlab_web2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _possibleConstructorReturn from \"/Users/jimmy/Documents/Wizschool/wizlab_web2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/jimmy/Documents/Wizschool/wizlab_web2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nvar _jsxFileName = \"/Users/jimmy/Documents/Wizschool/wizlab_web2/src/Page/Builder/Component/JanusSocket/Container.js\";\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\n\nimport React, { Component } from \"react\";\nimport { connect } from \"react-redux\";\nimport io from \"socket.io-client\";\nimport { URL } from \"../../../../Common/Util/Constant\";\nimport stringify from \"json-stringify-safe\";\n\nvar Container = /*#__PURE__*/function (_Component) {\n  _inherits(Container, _Component);\n\n  var _super = _createSuper(Container);\n\n  function Container() {\n    var _this;\n\n    _classCallCheck(this, Container);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _super.call.apply(_super, [this].concat(args));\n    _this.socketTimer = undefined;\n    _this.lastSentState = undefined;\n    _this.SOCKET_INTERVAL = 2000;\n    _this.EVENT_CONNECT = \"connect\";\n    _this.EVENT_STATE = \"state\";\n\n    _this.setSocket = function () {\n      var options = {}; //options reference : https://socket.io/docs/client-api/#new-Manager-url-options\n\n      _this.socket = io(URL.JANUS_SOCKET_SERVER, options);\n\n      _this.socket.on(_this.EVENT_CONNECT, function () {});\n\n      _this.socketTimer = setInterval(function () {\n        var _this$props = _this.props,\n            reservationId = _this$props.reservationId,\n            scene = _this$props.scene,\n            interaction = _this$props.interaction,\n            preview = _this$props.preview;\n        var data = stringify({\n          scene: scene,\n          interaction: interaction,\n          preview: _objectSpread({}, preview, {\n            isPlaying: false\n          })\n        });\n\n        if (_this.lastSentState !== data) {\n          _this.lastSentState = data;\n\n          _this.socket.emit(_this.EVENT_STATE, {\n            reservationId: reservationId,\n            scene: scene,\n            interaction: interaction,\n            preview: _objectSpread({}, preview, {\n              isPlaying: false\n            })\n          });\n        } else {}\n      }, _this.SOCKET_INTERVAL);\n    };\n\n    return _this;\n  }\n\n  _createClass(Container, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.setSocket();\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      this.socket.disconnect();\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      return React.createElement(\"div\", {\n        style: {\n          display: \"none\"\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 47\n        },\n        __self: this\n      });\n    }\n  }]);\n\n  return Container;\n}(Component);\n\nexport default connect(function (state) {\n  return {\n    scene: state.scene,\n    interaction: _objectSpread({}, state.interaction, {\n      addSoundsTimeStamp: undefined\n    }),\n    preview: state.preview\n  };\n}, {})(Container);","map":{"version":3,"sources":["/Users/jimmy/Documents/Wizschool/wizlab_web2/src/Page/Builder/Component/JanusSocket/Container.js"],"names":["React","Component","connect","io","URL","stringify","Container","socketTimer","undefined","lastSentState","SOCKET_INTERVAL","EVENT_CONNECT","EVENT_STATE","setSocket","options","socket","JANUS_SOCKET_SERVER","on","setInterval","props","reservationId","scene","interaction","preview","data","isPlaying","emit","disconnect","display","state","addSoundsTimeStamp"],"mappings":";;;;;;;;;;;;AAAA,OAAOA,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC;AACA,SAASC,OAAT,QAAwB,aAAxB;AACA,OAAOC,EAAP,MAAe,kBAAf;AACA,SAASC,GAAT,QAAoB,kCAApB;AACA,OAAOC,SAAP,MAAsB,qBAAtB;;IAEMC,S;;;;;;;;;;;;;;;UACJC,W,GAAcC,S;UACdC,a,GAAgBD,S;UAChBE,e,GAAkB,I;UAClBC,a,GAAgB,S;UAChBC,W,GAAc,O;;UAUdC,S,GAAY,YAAM;AAChB,UAAMC,OAAO,GAAG,EAAhB,CADgB,CACI;;AACpB,YAAKC,MAAL,GAAcZ,EAAE,CAACC,GAAG,CAACY,mBAAL,EAA0BF,OAA1B,CAAhB;;AACA,YAAKC,MAAL,CAAYE,EAAZ,CAAe,MAAKN,aAApB,EAAmC,YAAM,CAAE,CAA3C;;AACA,YAAKJ,WAAL,GAAmBW,WAAW,CAAC,YAAM;AAAA,0BACoB,MAAKC,KADzB;AAAA,YAC3BC,aAD2B,eAC3BA,aAD2B;AAAA,YACZC,KADY,eACZA,KADY;AAAA,YACLC,WADK,eACLA,WADK;AAAA,YACQC,OADR,eACQA,OADR;AAEnC,YAAMC,IAAI,GAAGnB,SAAS,CAAC;AACrBgB,UAAAA,KAAK,EAALA,KADqB;AAErBC,UAAAA,WAAW,EAAXA,WAFqB;AAGrBC,UAAAA,OAAO,oBAAOA,OAAP;AAAgBE,YAAAA,SAAS,EAAE;AAA3B;AAHc,SAAD,CAAtB;;AAKA,YAAI,MAAKhB,aAAL,KAAuBe,IAA3B,EAAiC;AAC/B,gBAAKf,aAAL,GAAqBe,IAArB;;AACA,gBAAKT,MAAL,CAAYW,IAAZ,CAAiB,MAAKd,WAAtB,EAAmC;AACjCQ,YAAAA,aAAa,EAAbA,aADiC;AAEjCC,YAAAA,KAAK,EAALA,KAFiC;AAGjCC,YAAAA,WAAW,EAAXA,WAHiC;AAIjCC,YAAAA,OAAO,oBAAOA,OAAP;AAAgBE,cAAAA,SAAS,EAAE;AAA3B;AAJ0B,WAAnC;AAMD,SARD,MAQO,CACN;AACF,OAjB6B,EAiB3B,MAAKf,eAjBsB,CAA9B;AAkBD,K;;;;;;;WA9BD,6BAAoB;AAClB,WAAKG,SAAL;AACD;;;WAED,gCAAuB;AACrB,WAAKE,MAAL,CAAYY,UAAZ;AACD;;;WA0BD,kBAAS;AACP,aAAO;AAAK,QAAA,KAAK,EAAE;AAAEC,UAAAA,OAAO,EAAE;AAAX,SAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAAP;AACD;;;;EAzCqB3B,S;;AA4CxB,eAAeC,OAAO,CACpB,UAAA2B,KAAK,EAAI;AACP,SAAO;AACLR,IAAAA,KAAK,EAAEQ,KAAK,CAACR,KADR;AAELC,IAAAA,WAAW,oBAAOO,KAAK,CAACP,WAAb;AAA0BQ,MAAAA,kBAAkB,EAAEtB;AAA9C,MAFN;AAGLe,IAAAA,OAAO,EAAEM,KAAK,CAACN;AAHV,GAAP;AAKD,CAPmB,EAQpB,EARoB,CAAP,CASbjB,SATa,CAAf","sourcesContent":["import React, { Component } from \"react\";\nimport { connect } from \"react-redux\";\nimport io from \"socket.io-client\";\nimport { URL } from \"../../../../Common/Util/Constant\";\nimport stringify from \"json-stringify-safe\";\n\nclass Container extends Component {\n  socketTimer = undefined;\n  lastSentState = undefined;\n  SOCKET_INTERVAL = 2000;\n  EVENT_CONNECT = \"connect\";\n  EVENT_STATE = \"state\";\n\n  componentDidMount() {\n    this.setSocket();\n  }\n\n  componentWillUnmount() {\n    this.socket.disconnect();\n  }\n\n  setSocket = () => {\n    const options = {}; //options reference : https://socket.io/docs/client-api/#new-Manager-url-options\n    this.socket = io(URL.JANUS_SOCKET_SERVER, options);\n    this.socket.on(this.EVENT_CONNECT, () => {});\n    this.socketTimer = setInterval(() => {\n      const { reservationId, scene, interaction, preview } = this.props;\n      const data = stringify({\n        scene,\n        interaction,\n        preview: { ...preview, isPlaying: false }\n      });\n      if (this.lastSentState !== data) {\n        this.lastSentState = data;\n        this.socket.emit(this.EVENT_STATE, {\n          reservationId,\n          scene,\n          interaction,\n          preview: { ...preview, isPlaying: false }\n        });\n      } else {\n      }\n    }, this.SOCKET_INTERVAL);\n  };\n\n  render() {\n    return <div style={{ display: \"none\" }} />;\n  }\n}\n\nexport default connect(\n  state => {\n    return {\n      scene: state.scene,\n      interaction: { ...state.interaction, addSoundsTimeStamp: undefined },\n      preview: state.preview\n    };\n  },\n  {}\n)(Container);\n"]},"metadata":{},"sourceType":"module"}