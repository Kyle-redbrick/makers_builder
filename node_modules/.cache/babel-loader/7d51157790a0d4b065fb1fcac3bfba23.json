{"ast":null,"code":"import _regeneratorRuntime from \"/Users/jimmy/Documents/Wizschool/wizlab_web2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/jimmy/Documents/Wizschool/wizlab_web2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _slicedToArray from \"/Users/jimmy/Documents/Wizschool/wizlab_web2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"/Users/jimmy/Documents/Wizschool/wizlab_web2/src/Page/MyAPK/Components/APKEditPopup/index.js\";\nimport React, { useState, useEffect } from \"react\";\nimport \"./index.scss\";\nimport ReactDOM from \"react-dom\";\nimport * as request from \"../../../../Common/Util/HTTPRequest\";\nimport { URL } from \"../../../../Common/Util/Constant\";\nimport exclamationImg from \"../../../../Image/exclamation-mark.svg\";\n\nvar ApkEditPopup = function ApkEditPopup(props) {\n  var apk = props.apk;\n  var onClickEditPopupSubmit = props.onClickEditPopupSubmit;\n\n  var dismiss = function dismiss() {\n    var popup = document.getElementById(\"popup\");\n    if (!popup) return;\n    ReactDOM.render(null, popup);\n    document.body.classList.remove(\"body-unsrollable\");\n  };\n\n  var _useState = useState(apk.apkVersion.appName),\n      _useState2 = _slicedToArray(_useState, 2),\n      appName = _useState2[0],\n      setAppName = _useState2[1];\n\n  var _useState3 = useState(apk.apkVersion.appIcon),\n      _useState4 = _slicedToArray(_useState3, 2),\n      appIcon = _useState4[0],\n      setAppIcon = _useState4[1];\n\n  var _useState5 = useState(true),\n      _useState6 = _slicedToArray(_useState5, 2),\n      isValidAppName = _useState6[0],\n      setIsValidAppName = _useState6[1];\n\n  var _useState7 = useState(true),\n      _useState8 = _slicedToArray(_useState7, 2),\n      isValidAppIcon = _useState8[0],\n      setIsValidAppIcon = _useState8[1];\n\n  useEffect(function () {\n    checkIsValidAppName();\n  }, [appName]);\n  useEffect(function () {\n    checkIsValidAppIcon();\n  }, [appIcon]);\n\n  var checkIsValidAppName = function checkIsValidAppName() {\n    var emptyString = appName === \"\";\n    var whiteSpace = appName.length > 0 ? appName[0] === \" \" : false;\n    var isValidAppName = !emptyString && !whiteSpace;\n    setIsValidAppName(isValidAppName);\n  };\n\n  var onChangeInput =\n  /*#__PURE__*/\n  function () {\n    var _ref = _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee(e) {\n      var name, value, file, filename, url;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              name = e.target.name;\n              value = e.target.value;\n              _context.t0 = name;\n              _context.next = _context.t0 === \"appName\" ? 5 : _context.t0 === \"appIcon\" ? 7 : 16;\n              break;\n\n            case 5:\n              setAppName(value);\n              return _context.abrupt(\"break\", 17);\n\n            case 7:\n              file = e.target.files[0];\n\n              if (file) {\n                _context.next = 10;\n                break;\n              }\n\n              return _context.abrupt(\"return\");\n\n            case 10:\n              _context.next = 12;\n              return getUploadedImageName(file);\n\n            case 12:\n              filename = _context.sent;\n              url = URL.S3_WIZLABAPK + \"/\" + filename;\n              setAppIcon(url);\n              return _context.abrupt(\"break\", 17);\n\n            case 16:\n              return _context.abrupt(\"break\", 17);\n\n            case 17:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, this);\n    }));\n\n    return function onChangeInput(_x) {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  var checkIsValidAppIcon = function checkIsValidAppIcon() {\n    var emptyIcon = appIcon === undefined;\n    setIsValidAppIcon(!emptyIcon);\n  };\n\n  var getUploadedImageName =\n  /*#__PURE__*/\n  function () {\n    var _ref2 = _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee2(file) {\n      var uploadInfo;\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.next = 2;\n              return uploadImage(file);\n\n            case 2:\n              uploadInfo = _context2.sent;\n\n              if (!(!uploadInfo || !uploadInfo.success)) {\n                _context2.next = 5;\n                break;\n              }\n\n              return _context2.abrupt(\"return\");\n\n            case 5:\n              return _context2.abrupt(\"return\", uploadInfo.filename);\n\n            case 6:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2, this);\n    }));\n\n    return function getUploadedImageName(_x2) {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  var uploadImage =\n  /*#__PURE__*/\n  function () {\n    var _ref3 = _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee3(file) {\n      var data, json;\n      return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              data = new FormData();\n              data.append(\"file\", file);\n              _context3.next = 4;\n              return request.uploadWizlabAPKIcon(data).then(function (res) {\n                return res.json();\n              }).catch(function (e) {\n                console.error(e.message);\n                return undefined;\n              });\n\n            case 4:\n              json = _context3.sent;\n              return _context3.abrupt(\"return\", json);\n\n            case 6:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3, this);\n    }));\n\n    return function uploadImage(_x3) {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n\n  var onClickEdit =\n  /*#__PURE__*/\n  function () {\n    var _ref4 = _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee4() {\n      var updateInfo;\n      return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n        while (1) {\n          switch (_context4.prev = _context4.next) {\n            case 0:\n              if (!(isValidAppName && isValidAppIcon)) {\n                _context4.next = 8;\n                break;\n              }\n\n              _context4.next = 3;\n              return postUpdateAPK();\n\n            case 3:\n              updateInfo = _context4.sent;\n\n              if (!(!updateInfo || !updateInfo.success)) {\n                _context4.next = 6;\n                break;\n              }\n\n              return _context4.abrupt(\"return\");\n\n            case 6:\n              onClickEditPopupSubmit(apk);\n              dismiss();\n\n            case 8:\n            case \"end\":\n              return _context4.stop();\n          }\n        }\n      }, _callee4, this);\n    }));\n\n    return function onClickEdit() {\n      return _ref4.apply(this, arguments);\n    };\n  }();\n\n  var postUpdateAPK =\n  /*#__PURE__*/\n  function () {\n    var _ref5 = _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee5() {\n      var updateInfo;\n      return _regeneratorRuntime.wrap(function _callee5$(_context5) {\n        while (1) {\n          switch (_context5.prev = _context5.next) {\n            case 0:\n              _context5.next = 2;\n              return request.updateWizlabAPK({\n                appName: appName,\n                appIcon: appIcon,\n                packageName: apk.packageName\n              }).then(function (res) {\n                return res.json();\n              }).catch(function (e) {\n                console.error(e);\n                return undefined;\n              });\n\n            case 2:\n              updateInfo = _context5.sent;\n              return _context5.abrupt(\"return\", updateInfo);\n\n            case 4:\n            case \"end\":\n              return _context5.stop();\n          }\n        }\n      }, _callee5, this);\n    }));\n\n    return function postUpdateAPK() {\n      return _ref5.apply(this, arguments);\n    };\n  }();\n\n  return React.createElement(\"div\", {\n    className: \"ApkEditPopup\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 112\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"ApkEditPopup_inner\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 113\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"ApkEditPopup-title\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 114\n    },\n    __self: this\n  }, \"AAB \\uC138\\uBD80 \\uC815\\uBCF4\\uB97C \\uC785\\uB825\\uD574 \\uC8FC\\uC138\\uC694\"), React.createElement(\"div\", {\n    className: \"ApkEditPopup_ft-hint\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 115\n    },\n    __self: this\n  }, React.createElement(\"img\", {\n    src: exclamationImg,\n    className: \"hint__img\",\n    alt: \"hint\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 116\n    },\n    __self: this\n  }), \"\\u201CAAB \\uC218\\uC815\\u201D\\uC5D0\\uC11C\\uB294 \\uC571 \\uC774\\uB984\\uACFC \\uC544\\uC774\\uCF58 \\uBCC0\\uACBD\\uB9CC \\uAC00\\uB2A5\\uD569\\uB2C8\\uB2E4. \\uC571 \\uC5C5\\uB370\\uC774\\uD2B8\\uB294 \\uD504\\uB85C\\uC81D\\uD2B8 \\uD37C\\uBE14\\uB9AC\\uC2F1 \\uC2DC \\uC790\\uB3D9 \\uBC18\\uC601\\uB429\\uB2C8\\uB2E4.\"), React.createElement(\"div\", {\n    className: \"ApkEditPopup_appName\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 120\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"ApkEditPopup_appName-title\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 121\n    },\n    __self: this\n  }, \"\\uC571 \\uC774\\uB984\"), React.createElement(\"input\", {\n    className: \"ApkEditPopup_appName-input \".concat(!isValidAppName && \"ApkEditPopup-warning\"),\n    type: \"text\",\n    name: \"appName\",\n    placeholder: \"\".concat(apk.apkVersion.appName),\n    value: appName,\n    onChange: onChangeInput,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 122\n    },\n    __self: this\n  })), React.createElement(\"div\", {\n    className: \"ApkEditPopup_packageName\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 132\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"ApkEditPopup_packageName-title\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 133\n    },\n    __self: this\n  }, \"\\uBC88\\uB4E4 \\uC774\\uB984\"), React.createElement(\"div\", {\n    className: \"ApkEditPopup_pn_rightWrap\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 134\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"ApkEditPopup_pn_rw_topWrap\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 135\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"ApkEditPopup_packageName-text\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 136\n    },\n    __self: this\n  }, \"io.wizschool.\".concat(apk.packageName))), React.createElement(\"div\", {\n    className: \"ApkEditPopup_pn_rw-description\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 138\n    },\n    __self: this\n  }, \"\\uBC88\\uB4E4 \\uC774\\uB984\\uC740 \\uBCC0\\uACBD\\uD560 \\uC218 \\uC5C6\\uC2B5\\uB2C8\\uB2E4.\"))), React.createElement(\"div\", {\n    className: \"ApkEditPopup_appIcon\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 143\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"ApkEditPopup_appIcon-title\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 144\n    },\n    __self: this\n  }, \"\\uC571 \\uC544\\uC774\\uCF58\"), React.createElement(\"div\", {\n    className: \"ApkEditPopup_appIcon-icon\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 145\n    },\n    __self: this\n  }, React.createElement(\"img\", {\n    src: appIcon,\n    alt: \"icon\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 146\n    },\n    __self: this\n  })), React.createElement(\"div\", {\n    className: \"ApkEditPopup_appIcon-addBtn\",\n    onClick: function onClick() {\n      document.getElementById(\"ApkEditPopup_appIcon-input-appIcon\").click();\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 148\n    },\n    __self: this\n  }, appIcon ? \"수정하기\" : \"추가하기\"), React.createElement(\"input\", {\n    id: \"ApkEditPopup_appIcon-input-appIcon\",\n    type: \"file\",\n    accept: \".png\",\n    name: \"appIcon\",\n    onChange: onChangeInput,\n    hidden: true,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 158\n    },\n    __self: this\n  })), React.createElement(\"div\", {\n    className: \"ApkEditPopup_footer\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 167\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"ApkEditPopup_ft-editBtn\",\n    onClick: onClickEdit,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 168\n    },\n    __self: this\n  }, \"AAB \\uC218\\uC815\"))));\n};\n\nexport default ApkEditPopup;","map":{"version":3,"sources":["/Users/jimmy/Documents/Wizschool/wizlab_web2/src/Page/MyAPK/Components/APKEditPopup/index.js"],"names":["React","useState","useEffect","ReactDOM","request","URL","ApkEditPopup","props","apk","onClickEditPopupSubmit","dismiss","popup","document","getElementById","render","body","classList","remove","apkVersion","appName","setAppName","appIcon","setAppIcon","isValidAppName","setIsValidAppName","isValidAppIcon","setIsValidAppIcon","checkIsValidAppName","checkIsValidAppIcon","emptyString","whiteSpace","length","onChangeInput","e","name","target","value","file","files","getUploadedImageName","filename","url","S3_WIZLABAPK","emptyIcon","undefined","uploadImage","uploadInfo","success","data","FormData","append","uploadWizlabAPKIcon","then","res","json","catch","console","error","message","onClickEdit","postUpdateAPK","updateInfo","updateWizlabAPK","packageName","exclamationImg","click"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport \"./index.scss\";\nimport ReactDOM from \"react-dom\";\nimport * as request from \"../../../../Common/Util/HTTPRequest\";\nimport { URL } from \"../../../../Common/Util/Constant\";\nimport exclamationImg from \"../../../../Image/exclamation-mark.svg\";\nconst ApkEditPopup = props => {\n  const { apk } = props;\n  const { onClickEditPopupSubmit } = props;\n  const dismiss = () => {\n    const popup = document.getElementById(\"popup\");\n    if (!popup) return;\n    ReactDOM.render(null, popup);\n    document.body.classList.remove(\"body-unsrollable\");\n  };\n\n  const [appName, setAppName] = useState(apk.apkVersion.appName);\n  const [appIcon, setAppIcon] = useState(apk.apkVersion.appIcon);\n  const [isValidAppName, setIsValidAppName] = useState(true);\n  const [isValidAppIcon, setIsValidAppIcon] = useState(true);\n\n  useEffect(() => {\n    checkIsValidAppName();\n  }, [appName]);\n\n  useEffect(() => {\n    checkIsValidAppIcon();\n  }, [appIcon]);\n\n  const checkIsValidAppName = () => {\n    const emptyString = appName === \"\";\n    const whiteSpace = appName.length > 0 ? appName[0] === \" \" : false;\n    const isValidAppName = !emptyString && !whiteSpace;\n    setIsValidAppName(isValidAppName);\n  };\n\n  const onChangeInput = async e => {\n    const name = e.target.name;\n    const value = e.target.value;\n    switch (name) {\n      case \"appName\":\n        setAppName(value);\n        break;\n\n      case \"appIcon\":\n        const file = e.target.files[0];\n        if (!file) return;\n        const filename = await getUploadedImageName(file);\n        const url = URL.S3_WIZLABAPK + \"/\" + filename;\n        setAppIcon(url);\n        break;\n      default:\n        break;\n    }\n  };\n\n  const checkIsValidAppIcon = () => {\n    const emptyIcon = appIcon === undefined;\n    setIsValidAppIcon(!emptyIcon);\n  };\n\n  const getUploadedImageName = async file => {\n    const uploadInfo = await uploadImage(file);\n    if (!uploadInfo || !uploadInfo.success) {\n      // error handling\n      return;\n    }\n    return uploadInfo.filename;\n  };\n\n  const uploadImage = async file => {\n    const data = new FormData();\n    data.append(\"file\", file);\n    const json = await request\n      .uploadWizlabAPKIcon(data)\n      .then(res => res.json())\n      .catch(e => {\n        console.error(e.message);\n        return undefined;\n      });\n\n    return json;\n  };\n\n  const onClickEdit = async () => {\n    if (isValidAppName && isValidAppIcon) {\n      const updateInfo = await postUpdateAPK();\n      if (!updateInfo || !updateInfo.success) {\n        return;\n      }\n      onClickEditPopupSubmit(apk);\n      dismiss();\n    }\n  };\n\n  const postUpdateAPK = async () => {\n    const updateInfo = await request\n      .updateWizlabAPK({\n        appName,\n        appIcon,\n        packageName: apk.packageName\n      })\n      .then(res => res.json())\n      .catch(e => {\n        console.error(e);\n        return undefined;\n      });\n    return updateInfo;\n  };\n\n  return (\n    <div className=\"ApkEditPopup\">\n      <div className=\"ApkEditPopup_inner\">\n        <div className=\"ApkEditPopup-title\">AAB 세부 정보를 입력해 주세요</div>\n        <div className=\"ApkEditPopup_ft-hint\">\n          <img src={exclamationImg} className=\"hint__img\" alt=\"hint\" />\n          “AAB 수정”에서는 앱 이름과 아이콘 변경만 가능합니다. 앱 업데이트는\n          프로젝트 퍼블리싱 시 자동 반영됩니다.\n        </div>\n        <div className=\"ApkEditPopup_appName\">\n          <div className=\"ApkEditPopup_appName-title\">앱 이름</div>\n          <input\n            className={`ApkEditPopup_appName-input ${!isValidAppName &&\n              \"ApkEditPopup-warning\"}`}\n            type=\"text\"\n            name=\"appName\"\n            placeholder={`${apk.apkVersion.appName}`}\n            value={appName}\n            onChange={onChangeInput}\n          />\n        </div>\n        <div className=\"ApkEditPopup_packageName\">\n          <div className=\"ApkEditPopup_packageName-title\">번들 이름</div>\n          <div className=\"ApkEditPopup_pn_rightWrap\">\n            <div className=\"ApkEditPopup_pn_rw_topWrap\">\n              <div className=\"ApkEditPopup_packageName-text\">{`io.wizschool.${apk.packageName}`}</div>\n            </div>\n            <div className=\"ApkEditPopup_pn_rw-description\">\n              {`번들 이름은 변경할 수 없습니다.`}\n            </div>\n          </div>\n        </div>\n        <div className=\"ApkEditPopup_appIcon\">\n          <div className=\"ApkEditPopup_appIcon-title\">앱 아이콘</div>\n          <div className={`ApkEditPopup_appIcon-icon`}>\n            <img src={appIcon} alt=\"icon\" />\n          </div>\n          <div\n            className=\"ApkEditPopup_appIcon-addBtn\"\n            onClick={() => {\n              document\n                .getElementById(`ApkEditPopup_appIcon-input-appIcon`)\n                .click();\n            }}\n          >\n            {appIcon ? \"수정하기\" : \"추가하기\"}\n          </div>\n          <input\n            id={`ApkEditPopup_appIcon-input-appIcon`}\n            type=\"file\"\n            accept=\".png\"\n            name=\"appIcon\"\n            onChange={onChangeInput}\n            hidden\n          />\n        </div>\n        <div className=\"ApkEditPopup_footer\">\n          <div className=\"ApkEditPopup_ft-editBtn\" onClick={onClickEdit}>\n            AAB 수정\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default ApkEditPopup;\n"]},"metadata":{},"sourceType":"module"}